W0620 01:02:54.810636 3595902 torch/distributed/run.py:793] 
W0620 01:02:54.810636 3595902 torch/distributed/run.py:793] *****************************************
W0620 01:02:54.810636 3595902 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0620 01:02:54.810636 3595902 torch/distributed/run.py:793] *****************************************
entity size:  8673
relation size:  20
entity size:  8673
relation size:  20
2025-06-20 01:02:56,493 INFO     Data loading | DONE!
2025-06-20 01:02:56,600 INFO     Using full datasets for training, validation, and testing.
2025-06-20 01:02:56,601 INFO     -------------------------
2025-06-20 01:02:56,601 INFO     | Pre-train Generator
2025-06-20 01:02:56,601 INFO     -------------------------
2025-06-20 01:02:56,738 INFO     >>>>> Generator: Training
2025-06-20 01:03:03,242 INFO     [E1000] Total: 1.372304 | Main: 1.652045 | Aux: 0.675700
2025-06-20 01:03:08,966 INFO     [E2000] Total: 1.302015 | Main: 1.567116 | Aux: 0.641151
2025-06-20 01:03:14,667 INFO     [E3000] Total: 1.297417 | Main: 1.561369 | Aux: 0.638421
2025-06-20 01:03:20,395 INFO     [E4000] Total: 1.291646 | Main: 1.554426 | Aux: 0.635557
2025-06-20 01:03:26,149 INFO     [E5000] Total: 1.286992 | Main: 1.548917 | Aux: 0.633842
2025-06-20 01:03:31,889 INFO     [E6000] Total: 1.287281 | Main: 1.548942 | Aux: 0.633145
2025-06-20 01:03:37,610 INFO     [E7000] Total: 1.284601 | Main: 1.546103 | Aux: 0.632213
2025-06-20 01:03:43,351 INFO     [E8000] Total: 1.284039 | Main: 1.545338 | Aux: 0.632716
2025-06-20 01:03:49,105 INFO     [E9000] Total: 1.283000 | Main: 1.543921 | Aux: 0.631320
2025-06-20 01:03:54,817 INFO     [E10000] Total: 1.279053 | Main: 1.539336 | Aux: 0.630484
2025-06-20 01:03:54,818 INFO     -------------------------
2025-06-20 01:03:54,818 INFO     | EM Iteration: 1/5
2025-06-20 01:03:54,818 INFO     -------------------------
2025-06-20 01:03:54,818 INFO     >>>>> Generator: Rule generation with sampling
2025-06-20 01:03:54,931 INFO     Predictor: read 1242 rules from list.
2025-06-20 01:03:54,931 INFO     Initializing distributed process group
2025-06-20 01:03:54,958 INFO     Predictor: read 1242 rules from list.
2025-06-20 01:03:54,961 INFO     Preprocess training set
2025-06-20 01:03:54,961 INFO     >>>>> Predictor: Training
[rank0]:[W620 01:03:55.421741979 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W620 01:03:55.445294095 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-06-20 01:04:31,897 INFO     1000 2980 41.387888 69305.9
2025-06-20 01:05:07,969 INFO     2000 2980 39.237904 69297.3
2025-06-20 01:05:44,048 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 01:05:47,784 INFO     Data : 2077
2025-06-20 01:05:47,784 INFO     Hit1 : 0.035628
2025-06-20 01:05:47,784 INFO     Hit3 : 0.069331
2025-06-20 01:05:47,785 INFO     Hit10: 0.124699
2025-06-20 01:05:47,785 INFO     MR   : 1271.441261
2025-06-20 01:05:47,785 INFO     MRR  : 0.066807
2025-06-20 01:05:47,785 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 01:05:51,959 INFO     Data : 2342
2025-06-20 01:05:51,959 INFO     Hit1 : 0.047234
2025-06-20 01:05:51,959 INFO     Hit3 : 0.079149
2025-06-20 01:05:51,959 INFO     Hit10: 0.132340
2025-06-20 01:05:51,959 INFO     MR   : 1182.722128
2025-06-20 01:05:51,959 INFO     MRR  : 0.076530
2025-06-20 01:05:51,959 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-20 01:06:54,566 INFO     1000 2980
2025-06-20 01:07:56,211 INFO     2000 2980
2025-06-20 01:08:56,574 INFO     >>>>> Generator: Training
2025-06-20 01:08:57,099 INFO     -------------------------
2025-06-20 01:08:57,099 INFO     | EM Iteration: 2/5
2025-06-20 01:08:57,099 INFO     -------------------------
2025-06-20 01:08:57,099 INFO     >>>>> Generator: Rule generation with sampling
2025-06-20 01:08:57,170 INFO     Predictor: read 1338 rules from list.
2025-06-20 01:08:57,171 INFO     Preprocess training set
2025-06-20 01:08:57,171 INFO     >>>>> Predictor: Training
2025-06-20 01:08:57,172 INFO     Predictor: read 1338 rules from list.
2025-06-20 01:09:36,143 INFO     1000 2980 41.721685 69349.3
2025-06-20 01:10:14,860 INFO     2000 2980 38.855644 69227.9
2025-06-20 01:10:53,199 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 01:10:57,202 INFO     Data : 2077
2025-06-20 01:10:57,202 INFO     Hit1 : 0.042369
2025-06-20 01:10:57,202 INFO     Hit3 : 0.073664
2025-06-20 01:10:57,202 INFO     Hit10: 0.139624
2025-06-20 01:10:57,202 INFO     MR   : 1253.714492
2025-06-20 01:10:57,203 INFO     MRR  : 0.075922
2025-06-20 01:10:57,204 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 01:11:01,697 INFO     Data : 2342
2025-06-20 01:11:01,697 INFO     Hit1 : 0.051915
2025-06-20 01:11:01,698 INFO     Hit3 : 0.085532
2025-06-20 01:11:01,698 INFO     Hit10: 0.142979
2025-06-20 01:11:01,698 INFO     MR   : 1142.283404
2025-06-20 01:11:01,698 INFO     MRR  : 0.084239
2025-06-20 01:11:01,698 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-20 01:12:09,054 INFO     1000 2980
2025-06-20 01:13:16,200 INFO     2000 2980
2025-06-20 01:14:21,732 INFO     >>>>> Generator: Training
2025-06-20 01:14:22,334 INFO     -------------------------
2025-06-20 01:14:22,335 INFO     | EM Iteration: 3/5
2025-06-20 01:14:22,335 INFO     -------------------------
2025-06-20 01:14:22,335 INFO     >>>>> Generator: Rule generation with sampling
2025-06-20 01:14:22,408 INFO     Predictor: read 1421 rules from list.
2025-06-20 01:14:22,408 INFO     Preprocess training set
2025-06-20 01:14:22,409 INFO     >>>>> Predictor: Training
2025-06-20 01:14:22,411 INFO     Predictor: read 1421 rules from list.
2025-06-20 01:15:01,714 INFO     1000 2980 41.877313 69323.3
2025-06-20 01:15:41,341 INFO     2000 2980 37.888897 69358.0
2025-06-20 01:16:20,122 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 01:16:24,286 INFO     Data : 2077
2025-06-20 01:16:24,287 INFO     Hit1 : 0.039480
2025-06-20 01:16:24,287 INFO     Hit3 : 0.073182
2025-06-20 01:16:24,287 INFO     Hit10: 0.137699
2025-06-20 01:16:24,287 INFO     MR   : 1228.522870
2025-06-20 01:16:24,287 INFO     MRR  : 0.073608
2025-06-20 01:16:24,287 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 01:16:28,989 INFO     Data : 2342
2025-06-20 01:16:28,989 INFO     Hit1 : 0.043404
2025-06-20 01:16:28,989 INFO     Hit3 : 0.076596
2025-06-20 01:16:28,989 INFO     Hit10: 0.140000
2025-06-20 01:16:28,989 INFO     MR   : 1146.033830
2025-06-20 01:16:28,989 INFO     MRR  : 0.076373
2025-06-20 01:16:28,989 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-20 01:17:37,499 INFO     1000 2980
2025-06-20 01:18:45,936 INFO     2000 2980
2025-06-20 01:19:52,888 INFO     >>>>> Generator: Training
2025-06-20 01:19:53,435 INFO     -------------------------
2025-06-20 01:19:53,435 INFO     | EM Iteration: 4/5
2025-06-20 01:19:53,435 INFO     -------------------------
2025-06-20 01:19:53,435 INFO     >>>>> Generator: Rule generation with sampling
2025-06-20 01:19:53,507 INFO     Predictor: read 1456 rules from list.
2025-06-20 01:19:53,508 INFO     Preprocess training set
2025-06-20 01:19:53,508 INFO     >>>>> Predictor: Training
2025-06-20 01:19:53,509 INFO     Predictor: read 1456 rules from list.
2025-06-20 01:20:33,565 INFO     1000 2980 41.862408 69366.7
2025-06-20 01:21:13,755 INFO     2000 2980 38.693390 69305.9
2025-06-20 01:21:53,135 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 01:21:57,426 INFO     Data : 2077
2025-06-20 01:21:57,426 INFO     Hit1 : 0.045739
2025-06-20 01:21:57,426 INFO     Hit3 : 0.087145
2025-06-20 01:21:57,426 INFO     Hit10: 0.158883
2025-06-20 01:21:57,426 INFO     MR   : 1225.560664
2025-06-20 01:21:57,426 INFO     MRR  : 0.083277
2025-06-20 01:21:57,426 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 01:22:02,268 INFO     Data : 2342
2025-06-20 01:22:02,269 INFO     Hit1 : 0.057021
2025-06-20 01:22:02,269 INFO     Hit3 : 0.097872
2025-06-20 01:22:02,269 INFO     Hit10: 0.166383
2025-06-20 01:22:02,269 INFO     MR   : 1119.404043
2025-06-20 01:22:02,269 INFO     MRR  : 0.093724
2025-06-20 01:22:02,269 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-20 01:23:10,347 INFO     1000 2980
2025-06-20 01:24:19,802 INFO     2000 2980
2025-06-20 01:25:26,376 INFO     >>>>> Generator: Training
2025-06-20 01:25:26,988 INFO     Predictor: read 1543 rules from list.
2025-06-20 01:25:26,998 INFO     -------------------------
2025-06-20 01:25:26,998 INFO     | EM Iteration: 5/5
2025-06-20 01:25:26,998 INFO     -------------------------
2025-06-20 01:25:26,998 INFO     >>>>> Generator: Rule generation with sampling
2025-06-20 01:25:27,050 INFO     Predictor: read 1543 rules from list.
2025-06-20 01:25:27,051 INFO     Preprocess training set
2025-06-20 01:25:27,051 INFO     >>>>> Predictor: Training
2025-06-20 01:26:09,070 INFO     1000 2980 41.463725 69271.3
2025-06-20 01:26:51,740 INFO     2000 2980 38.763271 69332.0
2025-06-20 01:27:32,998 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 01:27:37,589 INFO     Data : 2077
2025-06-20 01:27:37,589 INFO     Hit1 : 0.041406
2025-06-20 01:27:37,589 INFO     Hit3 : 0.074145
2025-06-20 01:27:37,589 INFO     Hit10: 0.147328
2025-06-20 01:27:37,589 INFO     MR   : 1240.694511
2025-06-20 01:27:37,589 INFO     MRR  : 0.076198
2025-06-20 01:27:37,589 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 01:27:42,756 INFO     Data : 2342
2025-06-20 01:27:42,756 INFO     Hit1 : 0.056170
2025-06-20 01:27:42,756 INFO     Hit3 : 0.097447
2025-06-20 01:27:42,756 INFO     Hit10: 0.157872
2025-06-20 01:27:42,756 INFO     MR   : 1146.585957
2025-06-20 01:27:42,756 INFO     MRR  : 0.091138
2025-06-20 01:27:42,756 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-20 01:28:55,561 INFO     1000 2980
2025-06-20 01:30:08,377 INFO     2000 2980
2025-06-20 01:31:19,745 INFO     >>>>> Generator: Training
2025-06-20 01:31:20,276 INFO     -------------------------
2025-06-20 01:31:20,276 INFO     | Post-train Generator
2025-06-20 01:31:20,276 INFO     -------------------------
2025-06-20 01:31:20,280 INFO     >>>>> Generator: Training
2025-06-20 01:31:26,021 INFO     [E1000] Total: 1.463269 | Main: 1.766077 | Aux: 0.730675
2025-06-20 01:31:26,021 INFO     -------------------------
2025-06-20 01:31:26,022 INFO     | Beam Search Best Rules
2025-06-20 01:31:26,022 INFO     -------------------------
2025-06-20 01:31:26,022 INFO     >>>>> Generator: Rule generation with beam search
2025-06-20 01:31:26,309 INFO     >>>>> Generator: Rule generation with beam search
2025-06-20 01:31:27,958 INFO     >>>>> Generator: Rule generation with beam search
2025-06-20 01:31:40,870 INFO     >>>>> Generator: Rule generation with beam search
2025-06-20 01:31:49,703 INFO     >>>>> Generator: Rule generation with beam search
2025-06-20 01:31:55,512 INFO     Predictor+: read 18420 rules from list.
2025-06-20 01:31:55,588 INFO     -------------------------
2025-06-20 01:31:55,588 INFO     | Train Final Predictor+
2025-06-20 01:31:55,588 INFO     -------------------------
2025-06-20 01:31:55,681 INFO     Predictor+: read 18420 rules from list.
2025-06-20 01:31:55,729 INFO     Preprocess training set
2025-06-20 01:31:55,730 INFO     -------------------------
2025-06-20 01:31:55,730 INFO     | Iteration: 1/5
2025-06-20 01:31:55,730 INFO     -------------------------
2025-06-20 01:31:55,730 INFO     >>>>> Predictor: Training
2025-06-20 01:43:23,270 INFO     1000 2980 23.329346 69384.0
2025-06-20 01:54:47,502 INFO     2000 2980 22.757394 69236.6
2025-06-20 02:06:07,665 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 02:07:32,292 INFO     Data : 2077
2025-06-20 02:07:32,292 INFO     Hit1 : 0.101589
2025-06-20 02:07:32,292 INFO     Hit3 : 0.193067
2025-06-20 02:07:32,292 INFO     Hit10: 0.322099
2025-06-20 02:07:32,292 INFO     MR   : 931.868801
2025-06-20 02:07:32,292 INFO     MRR  : 0.173503
2025-06-20 02:07:32,292 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 02:09:08,205 INFO     Data : 2342
2025-06-20 02:09:08,205 INFO     Hit1 : 0.133191
2025-06-20 02:09:08,205 INFO     Hit3 : 0.215745
2025-06-20 02:09:08,205 INFO     Hit10: 0.323830
2025-06-20 02:09:08,205 INFO     MR   : 854.675106
2025-06-20 02:09:08,206 INFO     MRR  : 0.197344
2025-06-20 02:09:08,206 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/task1_next_clus/random_init/cluster_3/0618_all_filtered/adaptive/triple_count_sqrt_20250620_010253/predictor.pt
2025-06-20 02:09:08,212 INFO     -------------------------
2025-06-20 02:09:08,213 INFO     | Iteration: 2/5
2025-06-20 02:09:08,213 INFO     -------------------------
2025-06-20 02:09:08,213 INFO     >>>>> Predictor: Training
2025-06-20 02:20:40,720 INFO     1000 2980 21.909187 69245.2
2025-06-20 02:32:03,058 INFO     2000 2980 21.825353 69349.3
2025-06-20 02:43:05,130 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 02:44:28,168 INFO     Data : 2077
2025-06-20 02:44:28,169 INFO     Hit1 : 0.094367
2025-06-20 02:44:28,169 INFO     Hit3 : 0.188252
2025-06-20 02:44:28,169 INFO     Hit10: 0.311988
2025-06-20 02:44:28,169 INFO     MR   : 910.244584
2025-06-20 02:44:28,169 INFO     MRR  : 0.166343
2025-06-20 02:44:28,169 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 02:46:02,050 INFO     Data : 2342
2025-06-20 02:46:02,050 INFO     Hit1 : 0.125106
2025-06-20 02:46:02,050 INFO     Hit3 : 0.211915
2025-06-20 02:46:02,050 INFO     Hit10: 0.321702
2025-06-20 02:46:02,050 INFO     MR   : 834.398936
2025-06-20 02:46:02,050 INFO     MRR  : 0.190702
2025-06-20 02:46:02,051 INFO     -------------------------
2025-06-20 02:46:02,051 INFO     | Iteration: 3/5
2025-06-20 02:46:02,051 INFO     -------------------------
2025-06-20 02:46:02,051 INFO     >>>>> Predictor: Training
2025-06-20 02:57:18,555 INFO     1000 2980 22.109783 69193.2
2025-06-20 03:08:38,166 INFO     2000 2980 21.704608 69271.3
2025-06-20 03:19:48,482 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 03:21:14,005 INFO     Data : 2077
2025-06-20 03:21:14,005 INFO     Hit1 : 0.096293
2025-06-20 03:21:14,005 INFO     Hit3 : 0.193067
2025-06-20 03:21:14,005 INFO     Hit10: 0.311026
2025-06-20 03:21:14,005 INFO     MR   : 907.399133
2025-06-20 03:21:14,005 INFO     MRR  : 0.168420
2025-06-20 03:21:14,005 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 03:22:51,524 INFO     Data : 2342
2025-06-20 03:22:51,525 INFO     Hit1 : 0.129787
2025-06-20 03:22:51,525 INFO     Hit3 : 0.210213
2025-06-20 03:22:51,525 INFO     Hit10: 0.325532
2025-06-20 03:22:51,525 INFO     MR   : 831.815532
2025-06-20 03:22:51,525 INFO     MRR  : 0.193208
2025-06-20 03:22:51,525 INFO     -------------------------
2025-06-20 03:22:51,525 INFO     | Iteration: 4/5
2025-06-20 03:22:51,525 INFO     -------------------------
2025-06-20 03:22:51,525 INFO     >>>>> Predictor: Training
2025-06-20 03:34:17,144 INFO     1000 2980 21.730342 69340.6
2025-06-20 03:45:41,465 INFO     2000 2980 21.725761 69175.8
2025-06-20 03:56:49,504 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 03:58:13,123 INFO     Data : 2077
2025-06-20 03:58:13,123 INFO     Hit1 : 0.091960
2025-06-20 03:58:13,123 INFO     Hit3 : 0.189697
2025-06-20 03:58:13,123 INFO     Hit10: 0.314877
2025-06-20 03:58:13,123 INFO     MR   : 892.614829
2025-06-20 03:58:13,123 INFO     MRR  : 0.166452
2025-06-20 03:58:13,124 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 03:59:47,513 INFO     Data : 2342
2025-06-20 03:59:47,513 INFO     Hit1 : 0.122553
2025-06-20 03:59:47,513 INFO     Hit3 : 0.204255
2025-06-20 03:59:47,513 INFO     Hit10: 0.324255
2025-06-20 03:59:47,513 INFO     MR   : 820.806809
2025-06-20 03:59:47,513 INFO     MRR  : 0.189015
2025-06-20 03:59:47,513 INFO     -------------------------
2025-06-20 03:59:47,513 INFO     | Iteration: 5/5
2025-06-20 03:59:47,513 INFO     -------------------------
2025-06-20 03:59:47,513 INFO     >>>>> Predictor: Training
2025-06-20 04:11:09,853 INFO     1000 2980 21.312627 69184.5
2025-06-20 04:22:35,057 INFO     2000 2980 21.713865 69366.7
2025-06-20 04:33:47,736 INFO     >>>>> Predictor: Evaluating on valid
2025-06-20 04:35:12,503 INFO     Data : 2077
2025-06-20 04:35:12,503 INFO     Hit1 : 0.091960
2025-06-20 04:35:12,503 INFO     Hit3 : 0.185364
2025-06-20 04:35:12,503 INFO     Hit10: 0.309100
2025-06-20 04:35:12,503 INFO     MR   : 891.948724
2025-06-20 04:35:12,503 INFO     MRR  : 0.164211
2025-06-20 04:35:12,503 INFO     >>>>> Predictor: Evaluating on test
2025-06-20 04:36:48,521 INFO     Data : 2342
2025-06-20 04:36:48,521 INFO     Hit1 : 0.122128
2025-06-20 04:36:48,521 INFO     Hit3 : 0.206383
2025-06-20 04:36:48,521 INFO     Hit10: 0.325532
2025-06-20 04:36:48,521 INFO     MR   : 820.308085
2025-06-20 04:36:48,521 INFO     MRR  : 0.188267
2025-06-20 04:36:48,521 INFO     -------------------------
2025-06-20 04:36:48,521 INFO     | Final Test MRR: 0.197344
2025-06-20 04:36:48,521 INFO     -------------------------
