W0619 13:48:08.691235 3577738 torch/distributed/run.py:793] 
W0619 13:48:08.691235 3577738 torch/distributed/run.py:793] *****************************************
W0619 13:48:08.691235 3577738 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0619 13:48:08.691235 3577738 torch/distributed/run.py:793] *****************************************
entity size:  8673
relation size:  20
entity size:  8673
relation size:  20
2025-06-19 13:48:10,428 INFO     Data loading | DONE!
2025-06-19 13:48:10,538 INFO     Using full datasets for training, validation, and testing.
2025-06-19 13:48:10,538 INFO     -------------------------
2025-06-19 13:48:10,538 INFO     | Pre-train Generator
2025-06-19 13:48:10,538 INFO     -------------------------
2025-06-19 13:48:10,660 INFO     >>>>> Generator: Training
2025-06-19 13:48:17,199 INFO     [E1000] Total: 1.372304 | Main: 1.652045 | Aux: 0.675700
2025-06-19 13:48:22,930 INFO     [E2000] Total: 1.302015 | Main: 1.567116 | Aux: 0.641151
2025-06-19 13:48:28,632 INFO     [E3000] Total: 1.297417 | Main: 1.561369 | Aux: 0.638421
2025-06-19 13:48:34,345 INFO     [E4000] Total: 1.291646 | Main: 1.554426 | Aux: 0.635557
2025-06-19 13:48:40,140 INFO     [E5000] Total: 1.286992 | Main: 1.548917 | Aux: 0.633842
2025-06-19 13:48:45,854 INFO     [E6000] Total: 1.287281 | Main: 1.548942 | Aux: 0.633145
2025-06-19 13:48:51,518 INFO     [E7000] Total: 1.284601 | Main: 1.546103 | Aux: 0.632213
2025-06-19 13:48:57,235 INFO     [E8000] Total: 1.284039 | Main: 1.545338 | Aux: 0.632716
2025-06-19 13:49:02,927 INFO     [E9000] Total: 1.283000 | Main: 1.543921 | Aux: 0.631320
2025-06-19 13:49:08,637 INFO     [E10000] Total: 1.279053 | Main: 1.539336 | Aux: 0.630484
2025-06-19 13:49:08,637 INFO     -------------------------
2025-06-19 13:49:08,638 INFO     | EM Iteration: 1/5
2025-06-19 13:49:08,638 INFO     -------------------------
2025-06-19 13:49:08,638 INFO     >>>>> Generator: Rule generation with sampling
2025-06-19 13:49:08,702 INFO     Predictor: read 1242 rules from list.
2025-06-19 13:49:08,740 INFO     Predictor: read 1242 rules from list.
2025-06-19 13:49:08,740 INFO     Initializing distributed process group
2025-06-19 13:49:08,743 INFO     Preprocess training set
2025-06-19 13:49:08,743 INFO     >>>>> Predictor: Training
[rank0]:[W619 13:49:09.206877047 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W619 13:49:09.227943050 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-06-19 13:49:45,009 INFO     1000 2980 265.371699 69305.9
2025-06-19 13:50:20,463 INFO     2000 2980 264.123471 69297.3
2025-06-19 13:50:55,585 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 13:50:59,206 INFO     Data : 2077
2025-06-19 13:50:59,207 INFO     Hit1 : 0.037073
2025-06-19 13:50:59,207 INFO     Hit3 : 0.070294
2025-06-19 13:50:59,207 INFO     Hit10: 0.129032
2025-06-19 13:50:59,207 INFO     MR   : 1299.652383
2025-06-19 13:50:59,207 INFO     MRR  : 0.068294
2025-06-19 13:50:59,207 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 13:51:03,282 INFO     Data : 2342
2025-06-19 13:51:03,282 INFO     Hit1 : 0.047234
2025-06-19 13:51:03,282 INFO     Hit3 : 0.085532
2025-06-19 13:51:03,282 INFO     Hit10: 0.137872
2025-06-19 13:51:03,282 INFO     MR   : 1201.986170
2025-06-19 13:51:03,282 INFO     MRR  : 0.078805
2025-06-19 13:51:03,282 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-19 13:52:03,973 INFO     1000 2980
2025-06-19 13:53:03,729 INFO     2000 2980
2025-06-19 13:54:02,223 INFO     >>>>> Generator: Training
2025-06-19 13:54:02,828 INFO     -------------------------
2025-06-19 13:54:02,828 INFO     | EM Iteration: 2/5
2025-06-19 13:54:02,828 INFO     -------------------------
2025-06-19 13:54:02,828 INFO     >>>>> Generator: Rule generation with sampling
2025-06-19 13:54:02,899 INFO     Predictor: read 1338 rules from list.
2025-06-19 13:54:02,899 INFO     Preprocess training set
2025-06-19 13:54:02,900 INFO     >>>>> Predictor: Training
2025-06-19 13:54:02,904 INFO     Predictor: read 1338 rules from list.
2025-06-19 13:54:41,631 INFO     1000 2980 267.941479 69349.3
2025-06-19 13:55:20,316 INFO     2000 2980 254.654173 69227.9
2025-06-19 13:55:58,027 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 13:56:01,910 INFO     Data : 2077
2025-06-19 13:56:01,910 INFO     Hit1 : 0.040443
2025-06-19 13:56:01,911 INFO     Hit3 : 0.078960
2025-06-19 13:56:01,911 INFO     Hit10: 0.142995
2025-06-19 13:56:01,911 INFO     MR   : 1264.508185
2025-06-19 13:56:01,911 INFO     MRR  : 0.075904
2025-06-19 13:56:01,911 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 13:56:06,281 INFO     Data : 2342
2025-06-19 13:56:06,281 INFO     Hit1 : 0.052766
2025-06-19 13:56:06,281 INFO     Hit3 : 0.088085
2025-06-19 13:56:06,281 INFO     Hit10: 0.146809
2025-06-19 13:56:06,281 INFO     MR   : 1155.588298
2025-06-19 13:56:06,281 INFO     MRR  : 0.086692
2025-06-19 13:56:06,281 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-19 13:57:11,637 INFO     1000 2980
2025-06-19 13:58:16,884 INFO     2000 2980
2025-06-19 13:59:20,461 INFO     >>>>> Generator: Training
2025-06-19 13:59:20,991 INFO     -------------------------
2025-06-19 13:59:20,991 INFO     | EM Iteration: 3/5
2025-06-19 13:59:20,991 INFO     -------------------------
2025-06-19 13:59:20,991 INFO     >>>>> Generator: Rule generation with sampling
2025-06-19 13:59:21,063 INFO     Predictor: read 1421 rules from list.
2025-06-19 13:59:21,063 INFO     Preprocess training set
2025-06-19 13:59:21,064 INFO     >>>>> Predictor: Training
2025-06-19 13:59:21,064 INFO     Predictor: read 1421 rules from list.
2025-06-19 13:59:59,918 INFO     1000 2980 286.096094 69323.3
2025-06-19 14:00:38,864 INFO     2000 2980 244.041902 69358.0
2025-06-19 14:01:16,935 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 14:01:21,022 INFO     Data : 2077
2025-06-19 14:01:21,022 INFO     Hit1 : 0.043332
2025-06-19 14:01:21,022 INFO     Hit3 : 0.077997
2025-06-19 14:01:21,022 INFO     Hit10: 0.142513
2025-06-19 14:01:21,022 INFO     MR   : 1236.623495
2025-06-19 14:01:21,022 INFO     MRR  : 0.078791
2025-06-19 14:01:21,022 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 14:01:25,628 INFO     Data : 2342
2025-06-19 14:01:25,628 INFO     Hit1 : 0.049787
2025-06-19 14:01:25,628 INFO     Hit3 : 0.082128
2025-06-19 14:01:25,628 INFO     Hit10: 0.151489
2025-06-19 14:01:25,628 INFO     MR   : 1153.715106
2025-06-19 14:01:25,628 INFO     MRR  : 0.083546
2025-06-19 14:01:25,628 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-19 14:02:32,104 INFO     1000 2980
2025-06-19 14:03:38,331 INFO     2000 2980
2025-06-19 14:04:43,234 INFO     >>>>> Generator: Training
2025-06-19 14:04:43,775 INFO     -------------------------
2025-06-19 14:04:43,775 INFO     | EM Iteration: 4/5
2025-06-19 14:04:43,775 INFO     -------------------------
2025-06-19 14:04:43,776 INFO     >>>>> Generator: Rule generation with sampling
2025-06-19 14:04:43,847 INFO     Predictor: read 1458 rules from list.
2025-06-19 14:04:43,847 INFO     Preprocess training set
2025-06-19 14:04:43,848 INFO     >>>>> Predictor: Training
2025-06-19 14:04:43,848 INFO     Predictor: read 1458 rules from list.
2025-06-19 14:05:23,061 INFO     1000 2980 276.977395 69366.7
2025-06-19 14:06:02,401 INFO     2000 2980 252.614465 69305.9
2025-06-19 14:06:40,904 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 14:06:45,099 INFO     Data : 2077
2025-06-19 14:06:45,100 INFO     Hit1 : 0.039961
2025-06-19 14:06:45,100 INFO     Hit3 : 0.079923
2025-06-19 14:06:45,100 INFO     Hit10: 0.147328
2025-06-19 14:06:45,100 INFO     MR   : 1247.580886
2025-06-19 14:06:45,100 INFO     MRR  : 0.078446
2025-06-19 14:06:45,100 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 14:06:49,825 INFO     Data : 2342
2025-06-19 14:06:49,825 INFO     Hit1 : 0.054468
2025-06-19 14:06:49,826 INFO     Hit3 : 0.091915
2025-06-19 14:06:49,826 INFO     Hit10: 0.158298
2025-06-19 14:06:49,826 INFO     MR   : 1144.946383
2025-06-19 14:06:49,826 INFO     MRR  : 0.090346
2025-06-19 14:06:49,826 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-19 14:07:56,891 INFO     1000 2980
2025-06-19 14:09:04,515 INFO     2000 2980
2025-06-19 14:10:10,684 INFO     >>>>> Generator: Training
2025-06-19 14:10:11,227 INFO     -------------------------
2025-06-19 14:10:11,227 INFO     | EM Iteration: 5/5
2025-06-19 14:10:11,227 INFO     -------------------------
2025-06-19 14:10:11,228 INFO     >>>>> Generator: Rule generation with sampling
2025-06-19 14:10:11,299 INFO     Predictor: read 1543 rules from list.
2025-06-19 14:10:11,300 INFO     Preprocess training set
2025-06-19 14:10:11,300 INFO     >>>>> Predictor: Training
2025-06-19 14:10:11,301 INFO     Predictor: read 1543 rules from list.
2025-06-19 14:10:52,124 INFO     1000 2980 265.326561 69271.3
2025-06-19 14:11:32,888 INFO     2000 2980 254.844824 69332.0
2025-06-19 14:12:12,709 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 14:12:17,041 INFO     Data : 2077
2025-06-19 14:12:17,041 INFO     Hit1 : 0.040443
2025-06-19 14:12:17,041 INFO     Hit3 : 0.072701
2025-06-19 14:12:17,041 INFO     Hit10: 0.147809
2025-06-19 14:12:17,041 INFO     MR   : 1257.845691
2025-06-19 14:12:17,041 INFO     MRR  : 0.074941
2025-06-19 14:12:17,041 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 14:12:21,906 INFO     Data : 2342
2025-06-19 14:12:21,906 INFO     Hit1 : 0.051915
2025-06-19 14:12:21,906 INFO     Hit3 : 0.092340
2025-06-19 14:12:21,906 INFO     Hit10: 0.154043
2025-06-19 14:12:21,906 INFO     MR   : 1161.804255
2025-06-19 14:12:21,906 INFO     MRR  : 0.088464
2025-06-19 14:12:21,906 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-19 14:13:31,001 INFO     1000 2980
2025-06-19 14:14:40,115 INFO     2000 2980
2025-06-19 14:15:47,896 INFO     >>>>> Generator: Training
2025-06-19 14:15:48,413 INFO     -------------------------
2025-06-19 14:15:48,413 INFO     | Post-train Generator
2025-06-19 14:15:48,413 INFO     -------------------------
2025-06-19 14:15:48,416 INFO     >>>>> Generator: Training
2025-06-19 14:15:54,150 INFO     [E1000] Total: 1.462696 | Main: 1.765354 | Aux: 0.730364
2025-06-19 14:15:54,150 INFO     -------------------------
2025-06-19 14:15:54,150 INFO     | Beam Search Best Rules
2025-06-19 14:15:54,150 INFO     -------------------------
2025-06-19 14:15:54,150 INFO     >>>>> Generator: Rule generation with beam search
2025-06-19 14:15:54,437 INFO     >>>>> Generator: Rule generation with beam search
2025-06-19 14:15:56,099 INFO     >>>>> Generator: Rule generation with beam search
2025-06-19 14:16:09,138 INFO     >>>>> Generator: Rule generation with beam search
2025-06-19 14:16:18,022 INFO     >>>>> Generator: Rule generation with beam search
2025-06-19 14:16:24,049 INFO     Predictor+: read 18420 rules from list.
2025-06-19 14:16:24,057 INFO     -------------------------
2025-06-19 14:16:24,057 INFO     | Train Final Predictor+
2025-06-19 14:16:24,058 INFO     -------------------------
2025-06-19 14:16:24,063 INFO     Predictor+: read 18420 rules from list.
2025-06-19 14:16:24,110 INFO     Preprocess training set
2025-06-19 14:16:24,111 INFO     -------------------------
2025-06-19 14:16:24,111 INFO     | Iteration: 1/5
2025-06-19 14:16:24,111 INFO     -------------------------
2025-06-19 14:16:24,111 INFO     >>>>> Predictor: Training
2025-06-19 14:27:32,370 INFO     1000 2980 149.579050 69384.0
2025-06-19 14:38:47,552 INFO     2000 2980 148.385978 69236.6
2025-06-19 14:49:43,405 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 14:51:04,857 INFO     Data : 2077
2025-06-19 14:51:04,857 INFO     Hit1 : 0.101107
2025-06-19 14:51:04,857 INFO     Hit3 : 0.194511
2025-06-19 14:51:04,857 INFO     Hit10: 0.317285
2025-06-19 14:51:04,857 INFO     MR   : 956.857487
2025-06-19 14:51:04,857 INFO     MRR  : 0.173473
2025-06-19 14:51:04,857 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 14:52:36,920 INFO     Data : 2342
2025-06-19 14:52:36,921 INFO     Hit1 : 0.131489
2025-06-19 14:52:36,921 INFO     Hit3 : 0.217872
2025-06-19 14:52:36,921 INFO     Hit10: 0.322979
2025-06-19 14:52:36,921 INFO     MR   : 888.003830
2025-06-19 14:52:36,921 INFO     MRR  : 0.197847
2025-06-19 14:52:36,921 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/task1_next_clus/random_init/cluster_3/0618_all_filtered/adaptive/triple_count_20250619_134807/predictor.pt
2025-06-19 14:52:36,928 INFO     -------------------------
2025-06-19 14:52:36,928 INFO     | Iteration: 2/5
2025-06-19 14:52:36,928 INFO     -------------------------
2025-06-19 14:52:36,928 INFO     >>>>> Predictor: Training
2025-06-19 15:03:52,934 INFO     1000 2980 135.098657 69245.2
2025-06-19 15:15:06,424 INFO     2000 2980 135.336157 69349.3
2025-06-19 15:26:06,561 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 15:27:31,128 INFO     Data : 2077
2025-06-19 15:27:31,128 INFO     Hit1 : 0.098700
2025-06-19 15:27:31,128 INFO     Hit3 : 0.193548
2025-06-19 15:27:31,128 INFO     Hit10: 0.311507
2025-06-19 15:27:31,128 INFO     MR   : 941.475205
2025-06-19 15:27:31,128 INFO     MRR  : 0.170966
2025-06-19 15:27:31,128 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 15:29:06,810 INFO     Data : 2342
2025-06-19 15:29:06,810 INFO     Hit1 : 0.131064
2025-06-19 15:29:06,810 INFO     Hit3 : 0.207660
2025-06-19 15:29:06,810 INFO     Hit10: 0.322128
2025-06-19 15:29:06,810 INFO     MR   : 871.245106
2025-06-19 15:29:06,810 INFO     MRR  : 0.192992
2025-06-19 15:29:06,810 INFO     -------------------------
2025-06-19 15:29:06,810 INFO     | Iteration: 3/5
2025-06-19 15:29:06,810 INFO     -------------------------
2025-06-19 15:29:06,810 INFO     >>>>> Predictor: Training
2025-06-19 15:40:28,585 INFO     1000 2980 141.699198 69193.2
2025-06-19 15:51:45,837 INFO     2000 2980 134.342509 69271.3
2025-06-19 16:02:42,533 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 16:04:04,065 INFO     Data : 2077
2025-06-19 16:04:04,065 INFO     Hit1 : 0.092922
2025-06-19 16:04:04,065 INFO     Hit3 : 0.193067
2025-06-19 16:04:04,065 INFO     Hit10: 0.316803
2025-06-19 16:04:04,065 INFO     MR   : 946.128310
2025-06-19 16:04:04,065 INFO     MRR  : 0.168214
2025-06-19 16:04:04,066 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 16:05:36,192 INFO     Data : 2342
2025-06-19 16:05:36,192 INFO     Hit1 : 0.128936
2025-06-19 16:05:36,192 INFO     Hit3 : 0.209362
2025-06-19 16:05:36,192 INFO     Hit10: 0.319149
2025-06-19 16:05:36,192 INFO     MR   : 874.282979
2025-06-19 16:05:36,192 INFO     MRR  : 0.192692
2025-06-19 16:05:36,193 INFO     -------------------------
2025-06-19 16:05:36,193 INFO     | Iteration: 4/5
2025-06-19 16:05:36,193 INFO     -------------------------
2025-06-19 16:05:36,193 INFO     >>>>> Predictor: Training
2025-06-19 16:16:54,882 INFO     1000 2980 135.061245 69340.6
2025-06-19 16:28:15,081 INFO     2000 2980 132.142132 69175.8
2025-06-19 16:39:17,511 INFO     >>>>> Predictor: Evaluating on valid
2025-06-19 16:40:41,533 INFO     Data : 2077
2025-06-19 16:40:41,533 INFO     Hit1 : 0.092441
2025-06-19 16:40:41,533 INFO     Hit3 : 0.190178
2025-06-19 16:40:41,533 INFO     Hit10: 0.313914
2025-06-19 16:40:41,533 INFO     MR   : 937.866153
2025-06-19 16:40:41,533 INFO     MRR  : 0.166947
2025-06-19 16:40:41,533 INFO     >>>>> Predictor: Evaluating on test
2025-06-19 16:42:16,495 INFO     Data : 2342
2025-06-19 16:42:16,495 INFO     Hit1 : 0.124681
2025-06-19 16:42:16,495 INFO     Hit3 : 0.206383
2025-06-19 16:42:16,495 INFO     Hit10: 0.320426
2025-06-19 16:42:16,495 INFO     MR   : 875.705745
2025-06-19 16:42:16,495 INFO     MRR  : 0.188457
2025-06-19 16:42:16,495 INFO     -------------------------
2025-06-19 16:42:16,496 INFO     | Iteration: 5/5
2025-06-19 16:42:16,496 INFO     -------------------------
2025-06-19 16:42:16,496 INFO     >>>>> Predictor: Training
