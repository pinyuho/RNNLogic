2025-06-29 23:51:33,517 INFO     Data loading | DONE!
2025-06-29 23:51:33,611 INFO     Using full datasets for training, validation, and testing.
2025-06-29 23:51:33,726 INFO     -------------------------
2025-06-29 23:51:33,726 INFO     | EM Iteration: 1/5
2025-06-29 23:51:33,726 INFO     -------------------------
2025-06-29 23:51:33,726 INFO     >>>>> Using miner's rule
2025-06-29 23:51:33,798 INFO     Predictor: read 13661 rules from list.
2025-06-29 23:51:34,464 INFO     Preprocess training set
2025-06-29 23:51:34,527 INFO     >>>>> Predictor: Training
2025-06-29 23:59:58,332 INFO     1000 5959 8.299284 69314.6
2025-06-30 00:08:15,818 INFO     2000 5959 7.689227 69271.3
2025-06-30 00:16:14,983 INFO     3000 5959 7.425850 69245.2
2025-06-30 00:24:26,084 INFO     4000 5959 7.285955 69340.6
2025-06-30 00:32:38,156 INFO     5000 5959 7.136692 69340.6
2025-06-30 00:40:29,612 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 00:42:31,444 INFO     Data : 2077
2025-06-30 00:42:31,444 INFO     Hit1 : 0.065479
2025-06-30 00:42:31,444 INFO     Hit3 : 0.127106
2025-06-30 00:42:31,444 INFO     Hit10: 0.199326
2025-06-30 00:42:31,444 INFO     MR   : 1120.920077
2025-06-30 00:42:31,444 INFO     MRR  : 0.114382
2025-06-30 00:42:31,444 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 00:44:46,669 INFO     Data : 2342
2025-06-30 00:44:46,669 INFO     Hit1 : 0.078992
2025-06-30 00:44:46,669 INFO     Hit3 : 0.124253
2025-06-30 00:44:46,669 INFO     Hit10: 0.208796
2025-06-30 00:44:46,669 INFO     MR   : 1044.279889
2025-06-30 00:44:46,669 INFO     MRR  : 0.122250
2025-06-30 00:44:46,670 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 01:16:02,210 INFO     1000 5959
2025-06-30 01:46:52,591 INFO     2000 5959
2025-06-30 02:17:00,132 INFO     3000 5959
2025-06-30 02:47:18,244 INFO     4000 5959
2025-06-30 03:17:47,038 INFO     5000 5959
2025-06-30 03:48:44,749 INFO     >>>>> Generator: Training
2025-06-30 03:48:53,547 INFO     -------------------------
2025-06-30 03:48:53,547 INFO     | EM Iteration: 2/5
2025-06-30 03:48:53,547 INFO     -------------------------
2025-06-30 03:48:53,547 INFO     >>>>> Using Generator's sample rule
2025-06-30 03:48:53,548 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 03:48:54,040 INFO     Predictor: read 1906 rules from list.
2025-06-30 03:48:54,041 INFO     Preprocess training set
2025-06-30 03:48:54,050 INFO     >>>>> Predictor: Training
2025-06-30 03:49:44,573 INFO     1000 5959 8.787476 69332.0
2025-06-30 03:50:35,311 INFO     2000 5959 8.398160 69349.3
2025-06-30 03:51:26,538 INFO     3000 5959 8.126260 69184.5
2025-06-30 03:52:16,761 INFO     4000 5959 7.935441 69253.9
2025-06-30 03:53:08,467 INFO     5000 5959 7.802471 69332.0
2025-06-30 03:53:56,887 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 03:54:07,633 INFO     Data : 2077
2025-06-30 03:54:07,634 INFO     Hit1 : 0.018296
2025-06-30 03:54:07,634 INFO     Hit3 : 0.032740
2025-06-30 03:54:07,634 INFO     Hit10: 0.060664
2025-06-30 03:54:07,634 INFO     MR   : 1452.574627
2025-06-30 03:54:07,634 INFO     MRR  : 0.034410
2025-06-30 03:54:07,634 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 03:54:19,631 INFO     Data : 2342
2025-06-30 03:54:19,631 INFO     Hit1 : 0.018360
2025-06-30 03:54:19,631 INFO     Hit3 : 0.036294
2025-06-30 03:54:19,631 INFO     Hit10: 0.064048
2025-06-30 03:54:19,632 INFO     MR   : 1340.637276
2025-06-30 03:54:19,632 INFO     MRR  : 0.036042
2025-06-30 03:54:19,632 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 03:56:45,067 INFO     1000 5959
2025-06-30 03:59:13,948 INFO     2000 5959
2025-06-30 04:01:40,857 INFO     3000 5959
2025-06-30 04:04:08,142 INFO     4000 5959
2025-06-30 04:06:32,919 INFO     5000 5959
2025-06-30 04:08:54,519 INFO     >>>>> Generator: Training
2025-06-30 04:09:02,894 INFO     -------------------------
2025-06-30 04:09:02,894 INFO     | EM Iteration: 3/5
2025-06-30 04:09:02,894 INFO     -------------------------
2025-06-30 04:09:02,894 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:09:02,894 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:09:03,450 INFO     Predictor: read 1886 rules from list.
2025-06-30 04:09:03,451 INFO     Preprocess training set
2025-06-30 04:09:03,451 INFO     >>>>> Predictor: Training
2025-06-30 04:09:54,249 INFO     1000 5959 8.805263 69271.3
2025-06-30 04:10:45,634 INFO     2000 5959 8.433749 69340.6
2025-06-30 04:11:37,453 INFO     3000 5959 8.187949 69384.0
2025-06-30 04:12:27,846 INFO     4000 5959 8.023776 69262.6
2025-06-30 04:13:17,864 INFO     5000 5959 7.902552 69332.0
2025-06-30 04:14:05,967 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:14:15,865 INFO     Data : 2077
2025-06-30 04:14:15,865 INFO     Hit1 : 0.013000
2025-06-30 04:14:15,865 INFO     Hit3 : 0.019740
2025-06-30 04:14:15,865 INFO     Hit10: 0.036110
2025-06-30 04:14:15,865 INFO     MR   : 1498.267212
2025-06-30 04:14:15,865 INFO     MRR  : 0.023819
2025-06-30 04:14:15,865 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:14:26,950 INFO     Data : 2342
2025-06-30 04:14:26,950 INFO     Hit1 : 0.012810
2025-06-30 04:14:26,950 INFO     Hit3 : 0.020495
2025-06-30 04:14:26,950 INFO     Hit10: 0.032451
2025-06-30 04:14:26,950 INFO     MR   : 1389.743168
2025-06-30 04:14:26,950 INFO     MRR  : 0.023078
2025-06-30 04:14:26,950 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:16:47,762 INFO     1000 5959
2025-06-30 04:19:12,566 INFO     2000 5959
2025-06-30 04:21:35,356 INFO     3000 5959
2025-06-30 04:23:56,546 INFO     4000 5959
2025-06-30 04:26:18,973 INFO     5000 5959
2025-06-30 04:28:35,971 INFO     >>>>> Generator: Training
2025-06-30 04:28:45,085 INFO     -------------------------
2025-06-30 04:28:45,086 INFO     | EM Iteration: 4/5
2025-06-30 04:28:45,086 INFO     -------------------------
2025-06-30 04:28:45,086 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:28:45,086 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:28:45,623 INFO     Predictor: read 1869 rules from list.
2025-06-30 04:28:45,623 INFO     Preprocess training set
2025-06-30 04:28:45,624 INFO     >>>>> Predictor: Training
2025-06-30 04:29:33,532 INFO     1000 5959 8.795982 69332.0
2025-06-30 04:30:20,902 INFO     2000 5959 8.408008 69349.3
2025-06-30 04:31:07,647 INFO     3000 5959 8.130086 69340.6
2025-06-30 04:31:54,469 INFO     4000 5959 7.933438 69297.3
2025-06-30 04:32:41,284 INFO     5000 5959 7.752270 69219.2
2025-06-30 04:33:25,930 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:33:35,734 INFO     Data : 2077
2025-06-30 04:33:35,734 INFO     Hit1 : 0.035147
2025-06-30 04:33:35,734 INFO     Hit3 : 0.062109
2025-06-30 04:33:35,734 INFO     Hit10: 0.090515
2025-06-30 04:33:35,734 INFO     MR   : 1432.709437
2025-06-30 04:33:35,734 INFO     MRR  : 0.058255
2025-06-30 04:33:35,734 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:33:46,820 INFO     Data : 2342
2025-06-30 04:33:46,820 INFO     Hit1 : 0.032451
2025-06-30 04:33:46,820 INFO     Hit3 : 0.060632
2025-06-30 04:33:46,820 INFO     Hit10: 0.090521
2025-06-30 04:33:46,820 INFO     MR   : 1331.554441
2025-06-30 04:33:46,820 INFO     MRR  : 0.056206
2025-06-30 04:33:46,820 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:36:02,831 INFO     1000 5959
2025-06-30 04:38:20,012 INFO     2000 5959
2025-06-30 04:40:37,125 INFO     3000 5959
2025-06-30 04:42:54,185 INFO     4000 5959
2025-06-30 04:45:10,825 INFO     5000 5959
2025-06-30 04:47:24,965 INFO     >>>>> Generator: Training
2025-06-30 04:47:34,014 INFO     -------------------------
2025-06-30 04:47:34,014 INFO     | EM Iteration: 5/5
2025-06-30 04:47:34,014 INFO     -------------------------
2025-06-30 04:47:34,014 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:47:34,014 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:47:34,527 INFO     Predictor: read 1708 rules from list.
2025-06-30 04:47:34,527 INFO     Preprocess training set
2025-06-30 04:47:34,527 INFO     >>>>> Predictor: Training
2025-06-30 04:48:17,328 INFO     1000 5959 8.798162 69271.3
2025-06-30 04:49:00,449 INFO     2000 5959 8.428705 69332.0
2025-06-30 04:49:43,471 INFO     3000 5959 8.195794 69375.3
2025-06-30 04:50:27,080 INFO     4000 5959 8.014858 69279.9
2025-06-30 04:51:10,860 INFO     5000 5959 7.900923 69349.3
2025-06-30 04:51:52,332 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:52:01,080 INFO     Data : 2077
2025-06-30 04:52:01,080 INFO     Hit1 : 0.025999
2025-06-30 04:52:01,080 INFO     Hit3 : 0.051998
2025-06-30 04:52:01,080 INFO     Hit10: 0.091960
2025-06-30 04:52:01,080 INFO     MR   : 1376.842802
2025-06-30 04:52:01,080 INFO     MRR  : 0.050451
2025-06-30 04:52:01,080 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:52:10,895 INFO     Data : 2342
2025-06-30 04:52:10,895 INFO     Hit1 : 0.027754
2025-06-30 04:52:10,895 INFO     Hit3 : 0.048249
2025-06-30 04:52:10,895 INFO     Hit10: 0.083689
2025-06-30 04:52:10,895 INFO     MR   : 1272.001708
2025-06-30 04:52:10,895 INFO     MRR  : 0.049921
2025-06-30 04:52:10,895 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:54:18,368 INFO     1000 5959
2025-06-30 04:56:28,170 INFO     2000 5959
2025-06-30 04:58:37,196 INFO     3000 5959
2025-06-30 05:00:46,232 INFO     4000 5959
2025-06-30 05:02:54,915 INFO     5000 5959
2025-06-30 05:05:01,012 INFO     >>>>> Generator: Training
2025-06-30 05:05:09,999 INFO     -------------------------
2025-06-30 05:05:09,999 INFO     | Post-train Generator
2025-06-30 05:05:09,999 INFO     -------------------------
2025-06-30 05:05:11,173 INFO     >>>>> Generator: Training
2025-06-30 05:06:42,889 INFO     [E01000] Total 2.508038 | Main 2.586174 | RelClus 1.479896 | EntType 2.911093
2025-06-30 05:06:42,890 INFO     -------------------------
2025-06-30 05:06:42,890 INFO     | Beam Search Best Rules
2025-06-30 05:06:42,890 INFO     -------------------------
2025-06-30 05:06:42,890 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:06:45,041 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:07:04,034 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:12:05,557 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:16:21,847 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:19:18,230 INFO     -------------------------
2025-06-30 05:19:18,230 INFO     | Train Final Predictor+
2025-06-30 05:19:18,230 INFO     -------------------------
2025-06-30 05:19:18,323 INFO     Predictor+: read 18420 rules from list.
2025-06-30 05:19:18,367 INFO     Preprocess training set
2025-06-30 05:19:18,379 INFO     -------------------------
2025-06-30 05:19:18,379 INFO     | Iteration: 1/5
2025-06-30 05:19:18,379 INFO     -------------------------
2025-06-30 05:19:18,379 INFO     >>>>> Predictor: Training
2025-06-30 05:23:56,391 INFO     1000 5959 4.914594 69366.7
2025-06-30 05:28:39,570 INFO     2000 5959 4.748533 69375.3
2025-06-30 05:33:20,475 INFO     3000 5959 4.719820 69219.2
2025-06-30 05:38:03,146 INFO     4000 5959 4.710271 69305.9
2025-06-30 05:42:40,498 INFO     5000 5959 4.670098 69288.6
2025-06-30 05:47:04,526 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:48:12,154 INFO     Data : 2077
2025-06-30 05:48:12,154 INFO     Hit1 : 0.096293
2025-06-30 05:48:12,154 INFO     Hit3 : 0.183919
2025-06-30 05:48:12,154 INFO     Hit10: 0.315840
2025-06-30 05:48:12,154 INFO     MR   : 973.670920
2025-06-30 05:48:12,154 INFO     MRR  : 0.166251
2025-06-30 05:48:12,154 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:49:28,404 INFO     Data : 2342
2025-06-30 05:49:28,405 INFO     Hit1 : 0.125534
2025-06-30 05:49:28,405 INFO     Hit3 : 0.208796
2025-06-30 05:49:28,405 INFO     Hit10: 0.318531
2025-06-30 05:49:28,405 INFO     MR   : 896.444065
2025-06-30 05:49:28,405 INFO     MRR  : 0.189709
2025-06-30 05:49:28,405 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_6_20250629_235132/predictor.pt
2025-06-30 05:49:28,412 INFO     -------------------------
2025-06-30 05:49:28,412 INFO     | Iteration: 2/5
2025-06-30 05:49:28,412 INFO     -------------------------
2025-06-30 05:49:28,412 INFO     >>>>> Predictor: Training
2025-06-30 05:54:03,855 INFO     1000 5959 4.645459 69288.6
2025-06-30 05:58:41,915 INFO     2000 5959 4.647383 69288.6
2025-06-30 06:03:20,100 INFO     3000 5959 4.623006 69340.6
2025-06-30 06:07:58,348 INFO     4000 5959 4.632749 69271.3
2025-06-30 06:12:36,853 INFO     5000 5959 4.657796 69219.2
2025-06-30 06:17:05,565 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:18:14,602 INFO     Data : 2077
2025-06-30 06:18:14,602 INFO     Hit1 : 0.083775
2025-06-30 06:18:14,602 INFO     Hit3 : 0.171883
2025-06-30 06:18:14,603 INFO     Hit10: 0.298989
2025-06-30 06:18:14,603 INFO     MR   : 949.980982
2025-06-30 06:18:14,603 INFO     MRR  : 0.155074
2025-06-30 06:18:14,603 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:19:32,007 INFO     Data : 2342
2025-06-30 06:19:32,008 INFO     Hit1 : 0.115286
2025-06-30 06:19:32,008 INFO     Hit3 : 0.195132
2025-06-30 06:19:32,008 INFO     Hit10: 0.314261
2025-06-30 06:19:32,008 INFO     MR   : 872.492528
2025-06-30 06:19:32,008 INFO     MRR  : 0.178589
2025-06-30 06:19:32,008 INFO     -------------------------
2025-06-30 06:19:32,008 INFO     | Iteration: 3/5
2025-06-30 06:19:32,008 INFO     -------------------------
2025-06-30 06:19:32,008 INFO     >>>>> Predictor: Training
2025-06-30 06:24:10,635 INFO     1000 5959 4.610492 69340.6
2025-06-30 06:28:47,669 INFO     2000 5959 4.580904 69184.5
2025-06-30 06:33:25,262 INFO     3000 5959 4.636313 69253.9
2025-06-30 06:38:00,358 INFO     4000 5959 4.609811 69340.6
2025-06-30 06:42:35,011 INFO     5000 5959 4.607991 69384.0
2025-06-30 06:46:58,373 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:48:06,486 INFO     Data : 2077
2025-06-30 06:48:06,486 INFO     Hit1 : 0.093404
2025-06-30 06:48:06,486 INFO     Hit3 : 0.183919
2025-06-30 06:48:06,486 INFO     Hit10: 0.311026
2025-06-30 06:48:06,486 INFO     MR   : 931.188012
2025-06-30 06:48:06,486 INFO     MRR  : 0.164064
2025-06-30 06:48:06,486 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:49:22,963 INFO     Data : 2342
2025-06-30 06:49:22,964 INFO     Hit1 : 0.128950
2025-06-30 06:49:22,964 INFO     Hit3 : 0.209650
2025-06-30 06:49:22,964 INFO     Hit10: 0.314688
2025-06-30 06:49:22,964 INFO     MR   : 860.884927
2025-06-30 06:49:22,964 INFO     MRR  : 0.190540
2025-06-30 06:49:22,964 INFO     -------------------------
2025-06-30 06:49:22,964 INFO     | Iteration: 4/5
2025-06-30 06:49:22,964 INFO     -------------------------
2025-06-30 06:49:22,964 INFO     >>>>> Predictor: Training
2025-06-30 06:53:57,782 INFO     1000 5959 4.610719 69323.3
2025-06-30 06:58:35,063 INFO     2000 5959 4.587364 69332.0
2025-06-30 07:03:15,539 INFO     3000 5959 4.620249 69219.2
2025-06-30 07:07:56,531 INFO     4000 5959 4.622626 69297.3
2025-06-30 07:12:30,962 INFO     5000 5959 4.580795 69332.0
2025-06-30 07:16:54,360 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:18:02,078 INFO     Data : 2077
2025-06-30 07:18:02,078 INFO     Hit1 : 0.090034
2025-06-30 07:18:02,078 INFO     Hit3 : 0.184882
2025-06-30 07:18:02,078 INFO     Hit10: 0.313433
2025-06-30 07:18:02,078 INFO     MR   : 925.490852
2025-06-30 07:18:02,078 INFO     MRR  : 0.161765
2025-06-30 07:18:02,078 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:19:18,584 INFO     Data : 2342
2025-06-30 07:19:18,584 INFO     Hit1 : 0.130658
2025-06-30 07:19:18,584 INFO     Hit3 : 0.211785
2025-06-30 07:19:18,584 INFO     Hit10: 0.315542
2025-06-30 07:19:18,584 INFO     MR   : 854.201110
2025-06-30 07:19:18,584 INFO     MRR  : 0.192287
2025-06-30 07:19:18,585 INFO     -------------------------
2025-06-30 07:19:18,585 INFO     | Iteration: 5/5
2025-06-30 07:19:18,585 INFO     -------------------------
2025-06-30 07:19:18,585 INFO     >>>>> Predictor: Training
2025-06-30 07:23:52,882 INFO     1000 5959 4.554216 69245.2
2025-06-30 07:28:31,736 INFO     2000 5959 4.548519 69262.6
2025-06-30 07:33:15,101 INFO     3000 5959 4.603237 69332.0
2025-06-30 07:37:57,087 INFO     4000 5959 4.605406 69366.7
2025-06-30 07:42:35,820 INFO     5000 5959 4.617129 69262.6
2025-06-30 07:47:08,602 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:48:18,529 INFO     Data : 2077
2025-06-30 07:48:18,529 INFO     Hit1 : 0.091478
2025-06-30 07:48:18,529 INFO     Hit3 : 0.172364
2025-06-30 07:48:18,529 INFO     Hit10: 0.308618
2025-06-30 07:48:18,529 INFO     MR   : 920.551757
2025-06-30 07:48:18,529 INFO     MRR  : 0.160784
2025-06-30 07:48:18,529 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:49:37,399 INFO     Data : 2342
2025-06-30 07:49:37,400 INFO     Hit1 : 0.126388
2025-06-30 07:49:37,400 INFO     Hit3 : 0.204526
2025-06-30 07:49:37,400 INFO     Hit10: 0.315115
2025-06-30 07:49:37,400 INFO     MR   : 855.502348
2025-06-30 07:49:37,400 INFO     MRR  : 0.188243
2025-06-30 07:49:37,400 INFO     -------------------------
2025-06-30 07:49:37,400 INFO     | Final Test MRR: 0.189709
2025-06-30 07:49:37,400 INFO     -------------------------
entity size:  8673
relation size:  20
