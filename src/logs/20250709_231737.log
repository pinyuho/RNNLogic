2025-07-09 23:17:38,859 INFO     is_soft_label: False
2025-07-09 23:17:38,859 INFO     is_scheduled_sampling: False
2025-07-09 23:17:38,859 INFO     is_test_mode: False
2025-07-09 23:17:39,064 INFO     Data loading | DONE!
2025-07-09 23:17:39,159 INFO     Using full datasets for training, validation, and testing.
2025-07-09 23:17:39,277 INFO     -------------------------
2025-07-09 23:17:39,278 INFO     | EM Iteration: 1/5
2025-07-09 23:17:39,278 INFO     -------------------------
2025-07-09 23:17:39,278 INFO     >>>>> Using miner's rule
2025-07-09 23:17:39,302 INFO     Predictor: read 13661 rules from list.
/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(os.path.join(cfg.data.data_path, 'predictor_init.pt'))
2025-07-09 23:17:40,011 INFO     Preprocess training set
2025-07-09 23:17:40,012 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 23:19:33,665 INFO     Data : 2077
2025-07-09 23:19:33,666 INFO     Hit1 : 0.065479
2025-07-09 23:19:33,666 INFO     Hit3 : 0.127106
2025-07-09 23:19:33,666 INFO     Hit10: 0.199326
2025-07-09 23:19:33,666 INFO     MR   : 1120.902022
2025-07-09 23:19:33,666 INFO     MRR  : 0.114382
2025-07-09 23:19:33,666 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 23:21:41,782 INFO     Data : 2342
2025-07-09 23:21:41,782 INFO     Hit1 : 0.078992
2025-07-09 23:21:41,782 INFO     Hit3 : 0.124253
2025-07-09 23:21:41,782 INFO     Hit10: 0.208796
2025-07-09 23:21:41,783 INFO     MR   : 1044.269001
2025-07-09 23:21:41,783 INFO     MRR  : 0.122250
2025-07-09 23:21:41,783 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 23:49:29,425 INFO     1000 5959
2025-07-10 00:17:43,212 INFO     2000 5959
2025-07-10 00:46:09,725 INFO     3000 5959
2025-07-10 01:14:32,132 INFO     4000 5959
2025-07-10 01:42:25,112 INFO     5000 5959
2025-07-10 02:11:11,350 INFO     >>>>> Generator: Training
2025-07-10 02:11:15,330 INFO     -------------------------
2025-07-10 02:11:15,330 INFO     | EM Iteration: 2/5
2025-07-10 02:11:15,330 INFO     -------------------------
2025-07-10 02:11:15,330 INFO     >>>>> Using Generator's sample rule
2025-07-10 02:11:15,330 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 02:11:15,502 INFO     Predictor: read 1911 rules from list.
2025-07-10 02:11:15,503 INFO     Preprocess training set
2025-07-10 02:11:15,504 INFO     >>>>> Predictor: Training
2025-07-10 02:12:03,024 INFO     1000 5959 8.782327 69314.6
2025-07-10 02:12:50,058 INFO     2000 5959 8.410087 69271.3
2025-07-10 02:13:36,845 INFO     3000 5959 8.219261 69245.2
2025-07-10 02:14:24,154 INFO     4000 5959 8.065555 69340.6
2025-07-10 02:15:11,331 INFO     5000 5959 7.941184 69340.6
2025-07-10 02:15:57,208 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 02:16:06,937 INFO     Data : 2077
2025-07-10 02:16:06,937 INFO     Hit1 : 0.025036
2025-07-10 02:16:06,937 INFO     Hit3 : 0.040924
2025-07-10 02:16:06,937 INFO     Hit10: 0.064035
2025-07-10 02:16:06,937 INFO     MR   : 1406.502407
2025-07-10 02:16:06,937 INFO     MRR  : 0.041153
2025-07-10 02:16:06,937 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 02:16:17,949 INFO     Data : 2342
2025-07-10 02:16:17,949 INFO     Hit1 : 0.019641
2025-07-10 02:16:17,949 INFO     Hit3 : 0.030743
2025-07-10 02:16:17,949 INFO     Hit10: 0.056362
2025-07-10 02:16:17,949 INFO     MR   : 1316.072801
2025-07-10 02:16:17,949 INFO     MRR  : 0.034766
2025-07-10 02:16:17,950 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 02:18:35,725 INFO     1000 5959
2025-07-10 02:20:52,193 INFO     2000 5959
2025-07-10 02:23:06,940 INFO     3000 5959
2025-07-10 02:25:21,841 INFO     4000 5959
2025-07-10 02:27:36,459 INFO     5000 5959
2025-07-10 02:29:47,837 INFO     >>>>> Generator: Training
2025-07-10 02:29:51,555 INFO     -------------------------
2025-07-10 02:29:51,555 INFO     | EM Iteration: 3/5
2025-07-10 02:29:51,555 INFO     -------------------------
2025-07-10 02:29:51,555 INFO     >>>>> Using Generator's sample rule
2025-07-10 02:29:51,555 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 02:29:51,687 INFO     Predictor: read 1895 rules from list.
2025-07-10 02:29:51,687 INFO     Preprocess training set
2025-07-10 02:29:51,688 INFO     >>>>> Predictor: Training
2025-07-10 02:30:38,059 INFO     1000 5959 8.811603 69332.0
2025-07-10 02:31:24,248 INFO     2000 5959 8.474918 69349.3
2025-07-10 02:32:10,638 INFO     3000 5959 8.263376 69184.5
2025-07-10 02:32:57,063 INFO     4000 5959 8.094895 69253.9
2025-07-10 02:33:44,055 INFO     5000 5959 8.003043 69332.0
2025-07-10 02:34:29,086 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 02:34:38,475 INFO     Data : 2077
2025-07-10 02:34:38,475 INFO     Hit1 : 0.000963
2025-07-10 02:34:38,475 INFO     Hit3 : 0.006740
2025-07-10 02:34:38,475 INFO     Hit10: 0.017333
2025-07-10 02:34:38,475 INFO     MR   : 1507.602311
2025-07-10 02:34:38,475 INFO     MRR  : 0.009847
2025-07-10 02:34:38,475 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 02:34:49,034 INFO     Data : 2342
2025-07-10 02:34:49,034 INFO     Hit1 : 0.001708
2025-07-10 02:34:49,034 INFO     Hit3 : 0.004697
2025-07-10 02:34:49,034 INFO     Hit10: 0.013664
2025-07-10 02:34:49,034 INFO     MR   : 1393.290137
2025-07-10 02:34:49,034 INFO     MRR  : 0.009002
2025-07-10 02:34:49,034 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 02:37:02,541 INFO     1000 5959
2025-07-10 02:39:16,064 INFO     2000 5959
2025-07-10 02:41:30,004 INFO     3000 5959
2025-07-10 02:43:44,504 INFO     4000 5959
2025-07-10 02:45:58,324 INFO     5000 5959
2025-07-10 02:48:10,798 INFO     >>>>> Generator: Training
2025-07-10 02:48:14,528 INFO     -------------------------
2025-07-10 02:48:14,528 INFO     | EM Iteration: 4/5
2025-07-10 02:48:14,528 INFO     -------------------------
2025-07-10 02:48:14,528 INFO     >>>>> Using Generator's sample rule
2025-07-10 02:48:14,528 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 02:48:14,663 INFO     Predictor: read 1938 rules from list.
2025-07-10 02:48:14,664 INFO     Preprocess training set
2025-07-10 02:48:14,664 INFO     >>>>> Predictor: Training
2025-07-10 02:49:03,178 INFO     1000 5959 8.796021 69271.3
2025-07-10 02:49:51,702 INFO     2000 5959 8.415856 69340.6
2025-07-10 02:50:40,291 INFO     3000 5959 8.157768 69384.0
2025-07-10 02:51:28,875 INFO     4000 5959 7.991901 69262.6
2025-07-10 02:52:17,514 INFO     5000 5959 7.849085 69332.0
2025-07-10 02:53:04,058 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 02:53:13,737 INFO     Data : 2077
2025-07-10 02:53:13,738 INFO     Hit1 : 0.001444
2025-07-10 02:53:13,738 INFO     Hit3 : 0.004333
2025-07-10 02:53:13,738 INFO     Hit10: 0.014444
2025-07-10 02:53:13,738 INFO     MR   : 1510.151420
2025-07-10 02:53:13,738 INFO     MRR  : 0.009348
2025-07-10 02:53:13,738 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 02:53:24,656 INFO     Data : 2342
2025-07-10 02:53:24,656 INFO     Hit1 : 0.001281
2025-07-10 02:53:24,657 INFO     Hit3 : 0.008540
2025-07-10 02:53:24,657 INFO     Hit10: 0.017933
2025-07-10 02:53:24,657 INFO     MR   : 1399.256832
2025-07-10 02:53:24,657 INFO     MRR  : 0.010711
2025-07-10 02:53:24,657 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 02:55:39,355 INFO     1000 5959
2025-07-10 02:57:55,278 INFO     2000 5959
2025-07-10 03:00:11,142 INFO     3000 5959
2025-07-10 03:02:27,971 INFO     4000 5959
2025-07-10 03:04:46,128 INFO     5000 5959
2025-07-10 03:06:58,704 INFO     >>>>> Generator: Training
2025-07-10 03:07:02,483 INFO     -------------------------
2025-07-10 03:07:02,483 INFO     | EM Iteration: 5/5
2025-07-10 03:07:02,483 INFO     -------------------------
2025-07-10 03:07:02,483 INFO     >>>>> Using Generator's sample rule
2025-07-10 03:07:02,483 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 03:07:02,616 INFO     Predictor: read 1972 rules from list.
2025-07-10 03:07:02,617 INFO     Preprocess training set
2025-07-10 03:07:02,617 INFO     >>>>> Predictor: Training
2025-07-10 03:07:51,586 INFO     1000 5959 8.834594 69332.0
2025-07-10 03:08:40,970 INFO     2000 5959 8.524487 69349.3
2025-07-10 03:09:30,439 INFO     3000 5959 8.342480 69340.6
2025-07-10 03:10:18,926 INFO     4000 5959 8.214950 69297.3
2025-07-10 03:11:07,124 INFO     5000 5959 8.119422 69219.2
2025-07-10 03:11:54,165 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 03:12:04,109 INFO     Data : 2077
2025-07-10 03:12:04,109 INFO     Hit1 : 0.001444
2025-07-10 03:12:04,109 INFO     Hit3 : 0.006259
2025-07-10 03:12:04,109 INFO     Hit10: 0.015888
2025-07-10 03:12:04,109 INFO     MR   : 1543.473038
2025-07-10 03:12:04,110 INFO     MRR  : 0.010174
2025-07-10 03:12:04,110 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 03:12:15,670 INFO     Data : 2342
2025-07-10 03:12:15,671 INFO     Hit1 : 0.002989
2025-07-10 03:12:15,671 INFO     Hit3 : 0.009394
2025-07-10 03:12:15,671 INFO     Hit10: 0.017933
2025-07-10 03:12:15,671 INFO     MR   : 1423.962852
2025-07-10 03:12:15,671 INFO     MRR  : 0.012100
2025-07-10 03:12:15,671 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 03:14:34,126 INFO     1000 5959
2025-07-10 03:16:51,323 INFO     2000 5959
2025-07-10 03:19:08,515 INFO     3000 5959
2025-07-10 03:21:28,744 INFO     4000 5959
2025-07-10 03:23:46,717 INFO     5000 5959
2025-07-10 03:26:00,235 INFO     >>>>> Generator: Training
2025-07-10 03:26:04,038 INFO     -------------------------
2025-07-10 03:26:04,039 INFO     | Post-train Generator
2025-07-10 03:26:04,039 INFO     -------------------------
2025-07-10 03:26:04,716 INFO     >>>>> Generator: Training
2025-07-10 03:26:43,499 INFO     [E01000] Total 3.158241 | Main 3.168869 | RelClus 2.129153 | EntType 2.997087
2025-07-10 03:26:43,500 INFO     -------------------------
2025-07-10 03:26:43,500 INFO     | Beam Search Best Rules
2025-07-10 03:26:43,500 INFO     -------------------------
2025-07-10 03:26:43,500 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 03:26:44,199 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 03:26:49,324 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 03:27:54,586 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 03:28:48,099 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 03:29:24,925 INFO     -------------------------
2025-07-10 03:29:24,925 INFO     | Train Final Predictor+
2025-07-10 03:29:24,925 INFO     -------------------------
2025-07-10 03:29:25,019 INFO     Predictor+: read 18420 rules from list.
2025-07-10 03:29:25,059 INFO     Preprocess training set
2025-07-10 03:29:25,060 INFO     -------------------------
2025-07-10 03:29:25,060 INFO     | Iteration: 1/5
2025-07-10 03:29:25,060 INFO     -------------------------
2025-07-10 03:29:25,060 INFO     >>>>> Predictor: Training
2025-07-10 03:33:35,035 INFO     1000 5959 4.899755 69271.3
2025-07-10 03:37:44,715 INFO     2000 5959 4.726724 69332.0
2025-07-10 03:41:53,851 INFO     3000 5959 4.709986 69375.3
2025-07-10 03:46:02,879 INFO     4000 5959 4.709850 69279.9
2025-07-10 03:50:12,947 INFO     5000 5959 4.679851 69349.3
2025-07-10 03:54:13,481 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 03:55:15,255 INFO     Data : 2077
2025-07-10 03:55:15,255 INFO     Hit1 : 0.099663
2025-07-10 03:55:15,255 INFO     Hit3 : 0.185845
2025-07-10 03:55:15,255 INFO     Hit10: 0.314877
2025-07-10 03:55:15,255 INFO     MR   : 984.097015
2025-07-10 03:55:15,255 INFO     MRR  : 0.167583
2025-07-10 03:55:15,256 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 03:56:24,938 INFO     Data : 2342
2025-07-10 03:56:24,938 INFO     Hit1 : 0.127669
2025-07-10 03:56:24,938 INFO     Hit3 : 0.208369
2025-07-10 03:56:24,938 INFO     Hit10: 0.316823
2025-07-10 03:56:24,938 INFO     MR   : 918.766866
2025-07-10 03:56:24,938 INFO     MRR  : 0.190755
2025-07-10 03:56:24,939 INFO     Save checkpoint to results/semmeddb/10_times_each/cluster_k/5_20250709_231737/predictor.pt
2025-07-10 03:56:24,945 INFO     -------------------------
2025-07-10 03:56:24,945 INFO     | Iteration: 2/5
2025-07-10 03:56:24,945 INFO     -------------------------
2025-07-10 03:56:24,945 INFO     >>>>> Predictor: Training
2025-07-10 04:00:34,551 INFO     1000 5959 4.601107 69366.7
2025-07-10 04:04:44,196 INFO     2000 5959 4.651302 69375.3
2025-07-10 04:08:53,410 INFO     3000 5959 4.639365 69219.2
2025-07-10 04:13:02,953 INFO     4000 5959 4.652658 69305.9
2025-07-10 04:17:12,713 INFO     5000 5959 4.617072 69288.6
2025-07-10 04:21:13,396 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 04:22:16,282 INFO     Data : 2077
2025-07-10 04:22:16,282 INFO     Hit1 : 0.093404
2025-07-10 04:22:16,282 INFO     Hit3 : 0.182475
2025-07-10 04:22:16,282 INFO     Hit10: 0.313914
2025-07-10 04:22:16,282 INFO     MR   : 945.221955
2025-07-10 04:22:16,282 INFO     MRR  : 0.163382
2025-07-10 04:22:16,282 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 04:23:27,054 INFO     Data : 2342
2025-07-10 04:23:27,054 INFO     Hit1 : 0.124253
2025-07-10 04:23:27,054 INFO     Hit3 : 0.213066
2025-07-10 04:23:27,054 INFO     Hit10: 0.321947
2025-07-10 04:23:27,054 INFO     MR   : 883.555508
2025-07-10 04:23:27,054 INFO     MRR  : 0.190094
2025-07-10 04:23:27,054 INFO     -------------------------
2025-07-10 04:23:27,054 INFO     | Iteration: 3/5
2025-07-10 04:23:27,054 INFO     -------------------------
2025-07-10 04:23:27,054 INFO     >>>>> Predictor: Training
2025-07-10 04:27:42,492 INFO     1000 5959 4.617842 69288.6
2025-07-10 04:31:51,986 INFO     2000 5959 4.619170 69288.6
2025-07-10 04:36:07,752 INFO     3000 5959 4.606540 69340.6
2025-07-10 04:40:22,059 INFO     4000 5959 4.617073 69271.3
2025-07-10 04:44:40,302 INFO     5000 5959 4.637269 69219.2
2025-07-10 04:48:45,758 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 04:49:49,754 INFO     Data : 2077
2025-07-10 04:49:49,754 INFO     Hit1 : 0.086663
2025-07-10 04:49:49,754 INFO     Hit3 : 0.172364
2025-07-10 04:49:49,754 INFO     Hit10: 0.302841
2025-07-10 04:49:49,754 INFO     MR   : 932.932114
2025-07-10 04:49:49,754 INFO     MRR  : 0.157539
2025-07-10 04:49:49,754 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 04:51:01,946 INFO     Data : 2342
2025-07-10 04:51:01,946 INFO     Hit1 : 0.112724
2025-07-10 04:51:01,947 INFO     Hit3 : 0.197267
2025-07-10 04:51:01,947 INFO     Hit10: 0.314261
2025-07-10 04:51:01,947 INFO     MR   : 862.658198
2025-07-10 04:51:01,947 INFO     MRR  : 0.178580
2025-07-10 04:51:01,947 INFO     -------------------------
2025-07-10 04:51:01,947 INFO     | Iteration: 4/5
2025-07-10 04:51:01,947 INFO     -------------------------
2025-07-10 04:51:01,947 INFO     >>>>> Predictor: Training
2025-07-10 04:55:12,927 INFO     1000 5959 4.593834 69340.6
2025-07-10 04:59:22,190 INFO     2000 5959 4.563689 69184.5
2025-07-10 05:03:31,394 INFO     3000 5959 4.626380 69253.9
2025-07-10 05:07:41,162 INFO     4000 5959 4.601493 69340.6
2025-07-10 05:11:50,614 INFO     5000 5959 4.596988 69384.0
2025-07-10 05:15:49,625 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 05:16:51,503 INFO     Data : 2077
2025-07-10 05:16:51,503 INFO     Hit1 : 0.094367
2025-07-10 05:16:51,503 INFO     Hit3 : 0.178623
2025-07-10 05:16:51,503 INFO     Hit10: 0.313433
2025-07-10 05:16:51,503 INFO     MR   : 927.402022
2025-07-10 05:16:51,504 INFO     MRR  : 0.164021
2025-07-10 05:16:51,504 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 05:18:01,284 INFO     Data : 2342
2025-07-10 05:18:01,284 INFO     Hit1 : 0.130658
2025-07-10 05:18:01,284 INFO     Hit3 : 0.215628
2025-07-10 05:18:01,284 INFO     Hit10: 0.324082
2025-07-10 05:18:01,284 INFO     MR   : 860.262810
2025-07-10 05:18:01,284 INFO     MRR  : 0.194810
2025-07-10 05:18:01,284 INFO     -------------------------
2025-07-10 05:18:01,285 INFO     | Iteration: 5/5
2025-07-10 05:18:01,285 INFO     -------------------------
2025-07-10 05:18:01,285 INFO     >>>>> Predictor: Training
2025-07-10 05:22:10,606 INFO     1000 5959 4.604397 69323.3
2025-07-10 05:26:19,758 INFO     2000 5959 4.583425 69332.0
2025-07-10 05:30:29,624 INFO     3000 5959 4.616644 69219.2
2025-07-10 05:34:39,206 INFO     4000 5959 4.611959 69297.3
2025-07-10 05:38:48,885 INFO     5000 5959 4.576152 69332.0
2025-07-10 05:42:48,263 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 05:43:50,208 INFO     Data : 2077
2025-07-10 05:43:50,208 INFO     Hit1 : 0.086663
2025-07-10 05:43:50,208 INFO     Hit3 : 0.181030
2025-07-10 05:43:50,208 INFO     Hit10: 0.323544
2025-07-10 05:43:50,208 INFO     MR   : 918.987963
2025-07-10 05:43:50,208 INFO     MRR  : 0.161136
2025-07-10 05:43:50,208 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 05:45:00,012 INFO     Data : 2342
2025-07-10 05:45:00,012 INFO     Hit1 : 0.128096
2025-07-10 05:45:00,012 INFO     Hit3 : 0.211358
2025-07-10 05:45:00,012 INFO     Hit10: 0.318958
2025-07-10 05:45:00,012 INFO     MR   : 852.869342
2025-07-10 05:45:00,012 INFO     MRR  : 0.192575
2025-07-10 05:45:00,013 INFO     -------------------------
2025-07-10 05:45:00,013 INFO     | Final Test MRR: 0.190755
2025-07-10 05:45:00,013 INFO     -------------------------
entity size:  8673
relation size:  20
