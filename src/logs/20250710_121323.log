2025-07-10 12:13:24,566 INFO     is_soft_label: False
2025-07-10 12:13:24,566 INFO     is_scheduled_sampling: False
2025-07-10 12:13:24,566 INFO     is_test_mode: False
2025-07-10 12:13:24,766 INFO     Data loading | DONE!
2025-07-10 12:13:24,861 INFO     Using full datasets for training, validation, and testing.
2025-07-10 12:13:24,978 INFO     -------------------------
2025-07-10 12:13:24,978 INFO     | EM Iteration: 1/5
2025-07-10 12:13:24,978 INFO     -------------------------
2025-07-10 12:13:24,978 INFO     >>>>> Using miner's rule
2025-07-10 12:13:25,002 INFO     Predictor: read 13661 rules from list.
/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(os.path.join(cfg.data.data_path, 'predictor_init.pt'))
2025-07-10 12:13:25,702 INFO     Preprocess training set
2025-07-10 12:13:25,703 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 12:15:19,757 INFO     Data : 2077
2025-07-10 12:15:19,757 INFO     Hit1 : 0.065479
2025-07-10 12:15:19,757 INFO     Hit3 : 0.127106
2025-07-10 12:15:19,757 INFO     Hit10: 0.199326
2025-07-10 12:15:19,757 INFO     MR   : 1120.902022
2025-07-10 12:15:19,757 INFO     MRR  : 0.114382
2025-07-10 12:15:19,758 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 12:17:28,494 INFO     Data : 2342
2025-07-10 12:17:28,494 INFO     Hit1 : 0.078992
2025-07-10 12:17:28,494 INFO     Hit3 : 0.124253
2025-07-10 12:17:28,494 INFO     Hit10: 0.208796
2025-07-10 12:17:28,494 INFO     MR   : 1044.269001
2025-07-10 12:17:28,495 INFO     MRR  : 0.122250
2025-07-10 12:17:28,495 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 12:45:15,771 INFO     1000 5959
2025-07-10 13:13:33,534 INFO     2000 5959
2025-07-10 13:41:36,357 INFO     3000 5959
2025-07-10 14:10:10,773 INFO     4000 5959
2025-07-10 14:38:31,957 INFO     5000 5959
2025-07-10 15:07:09,701 INFO     >>>>> Generator: Training
2025-07-10 15:07:13,649 INFO     -------------------------
2025-07-10 15:07:13,649 INFO     | EM Iteration: 2/5
2025-07-10 15:07:13,649 INFO     -------------------------
2025-07-10 15:07:13,649 INFO     >>>>> Using Generator's sample rule
2025-07-10 15:07:13,649 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 15:07:13,817 INFO     Predictor: read 1910 rules from list.
2025-07-10 15:07:13,817 INFO     Preprocess training set
2025-07-10 15:07:13,818 INFO     >>>>> Predictor: Training
2025-07-10 15:08:00,798 INFO     1000 5959 8.782325 69314.6
2025-07-10 15:08:48,677 INFO     2000 5959 8.410056 69271.3
2025-07-10 15:09:36,723 INFO     3000 5959 8.219226 69245.2
2025-07-10 15:10:25,190 INFO     4000 5959 8.065491 69340.6
2025-07-10 15:11:13,785 INFO     5000 5959 7.941079 69340.6
2025-07-10 15:11:59,877 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 15:12:09,486 INFO     Data : 2077
2025-07-10 15:12:09,486 INFO     Hit1 : 0.025036
2025-07-10 15:12:09,486 INFO     Hit3 : 0.040924
2025-07-10 15:12:09,486 INFO     Hit10: 0.064035
2025-07-10 15:12:09,486 INFO     MR   : 1408.811748
2025-07-10 15:12:09,486 INFO     MRR  : 0.041152
2025-07-10 15:12:09,487 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 15:12:20,239 INFO     Data : 2342
2025-07-10 15:12:20,239 INFO     Hit1 : 0.019641
2025-07-10 15:12:20,239 INFO     Hit3 : 0.030743
2025-07-10 15:12:20,239 INFO     Hit10: 0.056362
2025-07-10 15:12:20,239 INFO     MR   : 1317.984629
2025-07-10 15:12:20,239 INFO     MRR  : 0.034765
2025-07-10 15:12:20,239 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 15:14:34,242 INFO     1000 5959
2025-07-10 15:16:47,474 INFO     2000 5959
2025-07-10 15:19:00,594 INFO     3000 5959
2025-07-10 15:21:13,618 INFO     4000 5959
2025-07-10 15:23:26,735 INFO     5000 5959
2025-07-10 15:25:36,633 INFO     >>>>> Generator: Training
2025-07-10 15:25:40,357 INFO     -------------------------
2025-07-10 15:25:40,357 INFO     | EM Iteration: 3/5
2025-07-10 15:25:40,357 INFO     -------------------------
2025-07-10 15:25:40,358 INFO     >>>>> Using Generator's sample rule
2025-07-10 15:25:40,358 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 15:25:40,492 INFO     Predictor: read 1896 rules from list.
2025-07-10 15:25:40,492 INFO     Preprocess training set
2025-07-10 15:25:40,492 INFO     >>>>> Predictor: Training
2025-07-10 15:26:26,622 INFO     1000 5959 8.811197 69332.0
2025-07-10 15:27:12,711 INFO     2000 5959 8.473411 69349.3
2025-07-10 15:27:59,862 INFO     3000 5959 8.261821 69184.5
2025-07-10 15:28:47,010 INFO     4000 5959 8.093503 69253.9
2025-07-10 15:29:34,461 INFO     5000 5959 8.000298 69332.0
2025-07-10 15:30:19,741 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 15:30:29,067 INFO     Data : 2077
2025-07-10 15:30:29,067 INFO     Hit1 : 0.010111
2025-07-10 15:30:29,067 INFO     Hit3 : 0.025036
2025-07-10 15:30:29,067 INFO     Hit10: 0.050072
2025-07-10 15:30:29,067 INFO     MR   : 1451.096533
2025-07-10 15:30:29,067 INFO     MRR  : 0.026038
2025-07-10 15:30:29,067 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 15:30:39,571 INFO     Data : 2342
2025-07-10 15:30:39,571 INFO     Hit1 : 0.014518
2025-07-10 15:30:39,571 INFO     Hit3 : 0.026046
2025-07-10 15:30:39,571 INFO     Hit10: 0.048249
2025-07-10 15:30:39,571 INFO     MR   : 1341.749360
2025-07-10 15:30:39,571 INFO     MRR  : 0.028313
2025-07-10 15:30:39,571 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 15:32:54,700 INFO     1000 5959
2025-07-10 15:35:08,403 INFO     2000 5959
2025-07-10 15:37:23,358 INFO     3000 5959
2025-07-10 15:39:38,577 INFO     4000 5959
2025-07-10 15:41:54,621 INFO     5000 5959
2025-07-10 15:44:05,437 INFO     >>>>> Generator: Training
2025-07-10 15:44:09,192 INFO     -------------------------
2025-07-10 15:44:09,192 INFO     | EM Iteration: 4/5
2025-07-10 15:44:09,192 INFO     -------------------------
2025-07-10 15:44:09,192 INFO     >>>>> Using Generator's sample rule
2025-07-10 15:44:09,192 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 15:44:09,326 INFO     Predictor: read 1934 rules from list.
2025-07-10 15:44:09,326 INFO     Preprocess training set
2025-07-10 15:44:09,326 INFO     >>>>> Predictor: Training
2025-07-10 15:44:57,438 INFO     1000 5959 8.802737 69271.3
2025-07-10 15:45:45,441 INFO     2000 5959 8.436243 69340.6
2025-07-10 15:46:33,522 INFO     3000 5959 8.194957 69384.0
2025-07-10 15:47:21,654 INFO     4000 5959 8.041632 69262.6
2025-07-10 15:48:08,960 INFO     5000 5959 7.903123 69332.0
2025-07-10 15:48:54,726 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 15:49:04,265 INFO     Data : 2077
2025-07-10 15:49:04,266 INFO     Hit1 : 0.001444
2025-07-10 15:49:04,266 INFO     Hit3 : 0.004333
2025-07-10 15:49:04,266 INFO     Hit10: 0.014444
2025-07-10 15:49:04,266 INFO     MR   : 1510.703900
2025-07-10 15:49:04,266 INFO     MRR  : 0.009332
2025-07-10 15:49:04,266 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 15:49:15,003 INFO     Data : 2342
2025-07-10 15:49:15,004 INFO     Hit1 : 0.001281
2025-07-10 15:49:15,004 INFO     Hit3 : 0.008540
2025-07-10 15:49:15,004 INFO     Hit10: 0.017933
2025-07-10 15:49:15,004 INFO     MR   : 1399.617635
2025-07-10 15:49:15,004 INFO     MRR  : 0.010699
2025-07-10 15:49:15,004 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 15:51:31,704 INFO     1000 5959
2025-07-10 15:53:47,591 INFO     2000 5959
2025-07-10 15:56:04,355 INFO     3000 5959
2025-07-10 15:58:24,038 INFO     4000 5959
2025-07-10 16:00:43,255 INFO     5000 5959
2025-07-10 16:02:55,397 INFO     >>>>> Generator: Training
2025-07-10 16:02:59,173 INFO     -------------------------
2025-07-10 16:02:59,173 INFO     | EM Iteration: 5/5
2025-07-10 16:02:59,173 INFO     -------------------------
2025-07-10 16:02:59,173 INFO     >>>>> Using Generator's sample rule
2025-07-10 16:02:59,173 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 16:02:59,308 INFO     Predictor: read 1974 rules from list.
2025-07-10 16:02:59,308 INFO     Preprocess training set
2025-07-10 16:02:59,308 INFO     >>>>> Predictor: Training
2025-07-10 16:03:47,943 INFO     1000 5959 8.829779 69332.0
2025-07-10 16:04:36,324 INFO     2000 5959 8.508991 69349.3
2025-07-10 16:05:25,224 INFO     3000 5959 8.317712 69340.6
2025-07-10 16:06:13,865 INFO     4000 5959 8.183019 69297.3
2025-07-10 16:07:02,782 INFO     5000 5959 8.065172 69219.2
2025-07-10 16:07:50,069 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 16:08:00,282 INFO     Data : 2077
2025-07-10 16:08:00,282 INFO     Hit1 : 0.010111
2025-07-10 16:08:00,282 INFO     Hit3 : 0.019740
2025-07-10 16:08:00,282 INFO     Hit10: 0.038036
2025-07-10 16:08:00,282 INFO     MR   : 1523.251324
2025-07-10 16:08:00,282 INFO     MRR  : 0.022905
2025-07-10 16:08:00,282 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 16:08:11,479 INFO     Data : 2342
2025-07-10 16:08:11,480 INFO     Hit1 : 0.009821
2025-07-10 16:08:11,480 INFO     Hit3 : 0.020068
2025-07-10 16:08:11,480 INFO     Hit10: 0.037575
2025-07-10 16:08:11,480 INFO     MR   : 1398.325790
2025-07-10 16:08:11,480 INFO     MRR  : 0.022728
2025-07-10 16:08:11,480 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 16:10:31,127 INFO     1000 5959
2025-07-10 16:12:50,672 INFO     2000 5959
2025-07-10 16:15:09,998 INFO     3000 5959
2025-07-10 16:17:29,714 INFO     4000 5959
2025-07-10 16:19:49,633 INFO     5000 5959
2025-07-10 16:22:05,909 INFO     >>>>> Generator: Training
2025-07-10 16:22:09,711 INFO     -------------------------
2025-07-10 16:22:09,712 INFO     | Post-train Generator
2025-07-10 16:22:09,712 INFO     -------------------------
2025-07-10 16:22:10,454 INFO     >>>>> Generator: Training
2025-07-10 16:22:49,276 INFO     [E01000] Total 3.103626 | Main 3.058703 | RelClus 2.321141 | EntType 2.898398
2025-07-10 16:22:49,276 INFO     -------------------------
2025-07-10 16:22:49,276 INFO     | Beam Search Best Rules
2025-07-10 16:22:49,276 INFO     -------------------------
2025-07-10 16:22:49,277 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 16:22:49,964 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 16:22:54,964 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 16:23:58,631 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 16:24:51,032 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 16:25:27,091 INFO     -------------------------
2025-07-10 16:25:27,091 INFO     | Train Final Predictor+
2025-07-10 16:25:27,091 INFO     -------------------------
2025-07-10 16:25:27,096 INFO     Predictor+: read 18420 rules from list.
2025-07-10 16:25:27,135 INFO     Preprocess training set
2025-07-10 16:25:27,136 INFO     -------------------------
2025-07-10 16:25:27,136 INFO     | Iteration: 1/5
2025-07-10 16:25:27,136 INFO     -------------------------
2025-07-10 16:25:27,136 INFO     >>>>> Predictor: Training
2025-07-10 16:29:45,112 INFO     1000 5959 4.899696 69271.3
2025-07-10 16:34:03,465 INFO     2000 5959 4.722531 69332.0
2025-07-10 16:38:21,751 INFO     3000 5959 4.709397 69375.3
2025-07-10 16:42:40,333 INFO     4000 5959 4.712098 69279.9
2025-07-10 16:46:56,023 INFO     5000 5959 4.682209 69349.3
2025-07-10 16:50:55,698 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 16:51:58,982 INFO     Data : 2077
2025-07-10 16:51:58,982 INFO     Hit1 : 0.099663
2025-07-10 16:51:58,982 INFO     Hit3 : 0.182956
2025-07-10 16:51:58,982 INFO     Hit10: 0.314877
2025-07-10 16:51:58,982 INFO     MR   : 985.876023
2025-07-10 16:51:58,982 INFO     MRR  : 0.168475
2025-07-10 16:51:58,983 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 16:53:10,402 INFO     Data : 2342
2025-07-10 16:53:10,402 INFO     Hit1 : 0.129804
2025-07-10 16:53:10,402 INFO     Hit3 : 0.205380
2025-07-10 16:53:10,402 INFO     Hit10: 0.314688
2025-07-10 16:53:10,402 INFO     MR   : 920.283518
2025-07-10 16:53:10,402 INFO     MRR  : 0.191115
2025-07-10 16:53:10,402 INFO     Save checkpoint to results/semmeddb/10_times_each/cluster_k/7_20250710_121323/predictor.pt
2025-07-10 16:53:10,409 INFO     -------------------------
2025-07-10 16:53:10,409 INFO     | Iteration: 2/5
2025-07-10 16:53:10,409 INFO     -------------------------
2025-07-10 16:53:10,409 INFO     >>>>> Predictor: Training
2025-07-10 16:57:26,831 INFO     1000 5959 4.602087 69366.7
2025-07-10 17:01:40,580 INFO     2000 5959 4.652367 69375.3
2025-07-10 17:05:51,129 INFO     3000 5959 4.643194 69219.2
2025-07-10 17:10:01,847 INFO     4000 5959 4.652533 69305.9
2025-07-10 17:14:12,402 INFO     5000 5959 4.619806 69288.6
2025-07-10 17:18:13,133 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 17:19:15,308 INFO     Data : 2077
2025-07-10 17:19:15,309 INFO     Hit1 : 0.094848
2025-07-10 17:19:15,309 INFO     Hit3 : 0.187289
2025-07-10 17:19:15,309 INFO     Hit10: 0.315359
2025-07-10 17:19:15,309 INFO     MR   : 951.714251
2025-07-10 17:19:15,309 INFO     MRR  : 0.166250
2025-07-10 17:19:15,309 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 17:20:25,255 INFO     Data : 2342
2025-07-10 17:20:25,255 INFO     Hit1 : 0.125107
2025-07-10 17:20:25,255 INFO     Hit3 : 0.210504
2025-07-10 17:20:25,255 INFO     Hit10: 0.320666
2025-07-10 17:20:25,255 INFO     MR   : 882.649658
2025-07-10 17:20:25,255 INFO     MRR  : 0.189845
2025-07-10 17:20:25,255 INFO     -------------------------
2025-07-10 17:20:25,255 INFO     | Iteration: 3/5
2025-07-10 17:20:25,255 INFO     -------------------------
2025-07-10 17:20:25,255 INFO     >>>>> Predictor: Training
2025-07-10 17:24:35,869 INFO     1000 5959 4.617591 69288.6
2025-07-10 17:28:47,087 INFO     2000 5959 4.619127 69288.6
2025-07-10 17:33:01,722 INFO     3000 5959 4.609882 69340.6
2025-07-10 17:37:18,077 INFO     4000 5959 4.617531 69271.3
2025-07-10 17:41:33,663 INFO     5000 5959 4.639622 69219.2
2025-07-10 17:45:37,953 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 17:46:40,952 INFO     Data : 2077
2025-07-10 17:46:40,952 INFO     Hit1 : 0.087626
2025-07-10 17:46:40,952 INFO     Hit3 : 0.176216
2025-07-10 17:46:40,952 INFO     Hit10: 0.298989
2025-07-10 17:46:40,952 INFO     MR   : 938.780693
2025-07-10 17:46:40,952 INFO     MRR  : 0.157700
2025-07-10 17:46:40,952 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 17:47:51,706 INFO     Data : 2342
2025-07-10 17:47:51,706 INFO     Hit1 : 0.114859
2025-07-10 17:47:51,706 INFO     Hit3 : 0.196413
2025-07-10 17:47:51,706 INFO     Hit10: 0.309991
2025-07-10 17:47:51,706 INFO     MR   : 863.814475
2025-07-10 17:47:51,706 INFO     MRR  : 0.178638
2025-07-10 17:47:51,707 INFO     -------------------------
2025-07-10 17:47:51,707 INFO     | Iteration: 4/5
2025-07-10 17:47:51,707 INFO     -------------------------
2025-07-10 17:47:51,707 INFO     >>>>> Predictor: Training
2025-07-10 17:52:03,486 INFO     1000 5959 4.595846 69340.6
2025-07-10 17:56:14,740 INFO     2000 5959 4.564860 69184.5
2025-07-10 18:00:25,609 INFO     3000 5959 4.625963 69253.9
2025-07-10 18:04:36,897 INFO     4000 5959 4.602567 69340.6
2025-07-10 18:08:49,693 INFO     5000 5959 4.601001 69384.0
2025-07-10 18:12:53,434 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 18:13:56,518 INFO     Data : 2077
2025-07-10 18:13:56,518 INFO     Hit1 : 0.097256
2025-07-10 18:13:56,518 INFO     Hit3 : 0.180549
2025-07-10 18:13:56,518 INFO     Hit10: 0.309581
2025-07-10 18:13:56,518 INFO     MR   : 931.649013
2025-07-10 18:13:56,518 INFO     MRR  : 0.165053
2025-07-10 18:13:56,519 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 18:15:07,521 INFO     Data : 2342
2025-07-10 18:15:07,521 INFO     Hit1 : 0.126815
2025-07-10 18:15:07,521 INFO     Hit3 : 0.206661
2025-07-10 18:15:07,521 INFO     Hit10: 0.315542
2025-07-10 18:15:07,521 INFO     MR   : 859.773057
2025-07-10 18:15:07,521 INFO     MRR  : 0.189732
2025-07-10 18:15:07,521 INFO     -------------------------
2025-07-10 18:15:07,521 INFO     | Iteration: 5/5
2025-07-10 18:15:07,521 INFO     -------------------------
2025-07-10 18:15:07,521 INFO     >>>>> Predictor: Training
2025-07-10 18:19:22,236 INFO     1000 5959 4.605278 69323.3
2025-07-10 18:23:36,825 INFO     2000 5959 4.584692 69332.0
2025-07-10 18:27:51,833 INFO     3000 5959 4.614491 69219.2
2025-07-10 18:32:04,362 INFO     4000 5959 4.612877 69297.3
2025-07-10 18:36:19,967 INFO     5000 5959 4.577109 69332.0
2025-07-10 18:40:25,041 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 18:41:28,417 INFO     Data : 2077
2025-07-10 18:41:28,417 INFO     Hit1 : 0.092441
2025-07-10 18:41:28,417 INFO     Hit3 : 0.177179
2025-07-10 18:41:28,417 INFO     Hit10: 0.314396
2025-07-10 18:41:28,418 INFO     MR   : 922.021425
2025-07-10 18:41:28,418 INFO     MRR  : 0.163095
2025-07-10 18:41:28,418 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 18:42:39,700 INFO     Data : 2342
2025-07-10 18:42:39,700 INFO     Hit1 : 0.128096
2025-07-10 18:42:39,701 INFO     Hit3 : 0.203672
2025-07-10 18:42:39,701 INFO     Hit10: 0.318104
2025-07-10 18:42:39,701 INFO     MR   : 850.122118
2025-07-10 18:42:39,701 INFO     MRR  : 0.189960
2025-07-10 18:42:39,701 INFO     -------------------------
2025-07-10 18:42:39,701 INFO     | Final Test MRR: 0.191115
2025-07-10 18:42:39,701 INFO     -------------------------
entity size:  8673
relation size:  20
