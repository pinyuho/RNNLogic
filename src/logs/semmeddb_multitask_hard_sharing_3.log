2025-06-27 10:25:00,672 INFO     Data loading | DONE!
2025-06-27 10:25:00,756 INFO     Using full datasets for training, validation, and testing.
2025-06-27 10:25:00,867 INFO     -------------------------
2025-06-27 10:25:00,867 INFO     | EM Iteration: 1/5
2025-06-27 10:25:00,867 INFO     -------------------------
2025-06-27 10:25:00,867 INFO     >>>>> Using miner's rule
2025-06-27 10:25:00,890 INFO     Predictor: read 13661 rules from list.
2025-06-27 10:25:01,568 INFO     Preprocess training set
2025-06-27 10:25:01,568 INFO     >>>>> Predictor: Training
2025-06-27 10:32:43,315 INFO     1000 5959 8.299284 69314.6
2025-06-27 10:40:22,554 INFO     2000 5959 7.689227 69271.3
2025-06-27 10:47:43,854 INFO     3000 5959 7.425850 69245.2
2025-06-27 10:55:10,915 INFO     4000 5959 7.285955 69340.6
2025-06-27 11:02:44,938 INFO     5000 5959 7.136692 69340.6
2025-06-27 11:10:02,608 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 11:11:55,824 INFO     Data : 2077
2025-06-27 11:11:55,824 INFO     Hit1 : 0.065479
2025-06-27 11:11:55,824 INFO     Hit3 : 0.127106
2025-06-27 11:11:55,824 INFO     Hit10: 0.199326
2025-06-27 11:11:55,824 INFO     MR   : 1120.920077
2025-06-27 11:11:55,824 INFO     MRR  : 0.114382
2025-06-27 11:11:55,825 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 11:14:03,114 INFO     Data : 2342
2025-06-27 11:14:03,114 INFO     Hit1 : 0.078992
2025-06-27 11:14:03,114 INFO     Hit3 : 0.124253
2025-06-27 11:14:03,114 INFO     Hit10: 0.208796
2025-06-27 11:14:03,114 INFO     MR   : 1044.279889
2025-06-27 11:14:03,114 INFO     MRR  : 0.122250
2025-06-27 11:14:03,115 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 11:44:15,116 INFO     1000 5959
2025-06-27 12:21:01,905 INFO     2000 5959
2025-06-27 12:57:38,980 INFO     3000 5959
2025-06-27 13:34:18,556 INFO     4000 5959
2025-06-27 14:07:03,328 INFO     5000 5959
2025-06-27 14:35:36,136 INFO     >>>>> Generator: Training
2025-06-27 14:35:37,596 INFO     -------------------------
2025-06-27 14:35:37,597 INFO     | EM Iteration: 2/5
2025-06-27 14:35:37,597 INFO     -------------------------
2025-06-27 14:35:37,597 INFO     >>>>> Using Generator's sample rule
2025-06-27 14:35:37,597 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 14:35:37,695 INFO     Predictor: read 1876 rules from list.
2025-06-27 14:35:37,695 INFO     Preprocess training set
2025-06-27 14:35:37,697 INFO     >>>>> Predictor: Training
2025-06-27 14:36:22,937 INFO     1000 5959 8.798643 69332.0
2025-06-27 14:37:08,323 INFO     2000 5959 8.421757 69349.3
2025-06-27 14:37:53,730 INFO     3000 5959 8.177750 69184.5
2025-06-27 14:38:39,065 INFO     4000 5959 7.990411 69253.9
2025-06-27 14:39:24,198 INFO     5000 5959 7.856989 69332.0
2025-06-27 14:40:07,663 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 14:40:17,230 INFO     Data : 2077
2025-06-27 14:40:17,230 INFO     Hit1 : 0.012037
2025-06-27 14:40:17,231 INFO     Hit3 : 0.022629
2025-06-27 14:40:17,231 INFO     Hit10: 0.042850
2025-06-27 14:40:17,231 INFO     MR   : 1480.959076
2025-06-27 14:40:17,231 INFO     MRR  : 0.025082
2025-06-27 14:40:17,231 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 14:40:28,022 INFO     Data : 2342
2025-06-27 14:40:28,022 INFO     Hit1 : 0.011529
2025-06-27 14:40:28,022 INFO     Hit3 : 0.020068
2025-06-27 14:40:28,022 INFO     Hit10: 0.040564
2025-06-27 14:40:28,022 INFO     MR   : 1362.793553
2025-06-27 14:40:28,022 INFO     MRR  : 0.023653
2025-06-27 14:40:28,023 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 14:42:40,812 INFO     1000 5959
2025-06-27 14:44:53,685 INFO     2000 5959
2025-06-27 14:47:07,013 INFO     3000 5959
2025-06-27 14:49:19,471 INFO     4000 5959
2025-06-27 14:51:35,154 INFO     5000 5959
2025-06-27 14:53:46,722 INFO     >>>>> Generator: Training
2025-06-27 14:53:48,166 INFO     -------------------------
2025-06-27 14:53:48,166 INFO     | EM Iteration: 3/5
2025-06-27 14:53:48,166 INFO     -------------------------
2025-06-27 14:53:48,166 INFO     >>>>> Using Generator's sample rule
2025-06-27 14:53:48,166 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 14:53:48,228 INFO     Predictor: read 1868 rules from list.
2025-06-27 14:53:48,229 INFO     Preprocess training set
2025-06-27 14:53:48,229 INFO     >>>>> Predictor: Training
2025-06-27 14:54:34,029 INFO     1000 5959 8.783918 69271.3
2025-06-27 14:55:19,927 INFO     2000 5959 8.396180 69340.6
2025-06-27 14:56:06,010 INFO     3000 5959 8.112075 69384.0
2025-06-27 14:56:52,022 INFO     4000 5959 7.935302 69262.6
2025-06-27 14:57:38,087 INFO     5000 5959 7.798320 69332.0
2025-06-27 14:58:21,394 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 14:58:30,865 INFO     Data : 2077
2025-06-27 14:58:30,865 INFO     Hit1 : 0.013000
2025-06-27 14:58:30,865 INFO     Hit3 : 0.026962
2025-06-27 14:58:30,865 INFO     Hit10: 0.063072
2025-06-27 14:58:30,865 INFO     MR   : 1454.843524
2025-06-27 14:58:30,865 INFO     MRR  : 0.031329
2025-06-27 14:58:30,865 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 14:58:41,567 INFO     Data : 2342
2025-06-27 14:58:41,567 INFO     Hit1 : 0.011529
2025-06-27 14:58:41,567 INFO     Hit3 : 0.028181
2025-06-27 14:58:41,567 INFO     Hit10: 0.059778
2025-06-27 14:58:41,567 INFO     MR   : 1353.545901
2025-06-27 14:58:41,567 INFO     MRR  : 0.029602
2025-06-27 14:58:41,567 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:00:54,393 INFO     1000 5959
2025-06-27 15:03:08,592 INFO     2000 5959
2025-06-27 15:05:20,897 INFO     3000 5959
2025-06-27 15:07:33,068 INFO     4000 5959
2025-06-27 15:09:47,787 INFO     5000 5959
2025-06-27 15:12:03,059 INFO     >>>>> Generator: Training
2025-06-27 15:12:04,615 INFO     -------------------------
2025-06-27 15:12:04,615 INFO     | EM Iteration: 4/5
2025-06-27 15:12:04,616 INFO     -------------------------
2025-06-27 15:12:04,616 INFO     >>>>> Using Generator's sample rule
2025-06-27 15:12:04,616 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 15:12:04,681 INFO     Predictor: read 1829 rules from list.
2025-06-27 15:12:04,682 INFO     Preprocess training set
2025-06-27 15:12:04,682 INFO     >>>>> Predictor: Training
2025-06-27 15:12:51,661 INFO     1000 5959 8.784388 69332.0
2025-06-27 15:13:39,019 INFO     2000 5959 8.380326 69349.3
2025-06-27 15:14:25,936 INFO     3000 5959 8.130445 69340.6
2025-06-27 15:15:12,584 INFO     4000 5959 7.931115 69297.3
2025-06-27 15:16:00,066 INFO     5000 5959 7.776129 69219.2
2025-06-27 15:16:45,441 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 15:16:54,760 INFO     Data : 2077
2025-06-27 15:16:54,760 INFO     Hit1 : 0.005778
2025-06-27 15:16:54,760 INFO     Hit3 : 0.013962
2025-06-27 15:16:54,760 INFO     Hit10: 0.025518
2025-06-27 15:16:54,760 INFO     MR   : 1528.439817
2025-06-27 15:16:54,760 INFO     MRR  : 0.016049
2025-06-27 15:16:54,760 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 15:17:05,310 INFO     Data : 2342
2025-06-27 15:17:05,310 INFO     Hit1 : 0.002989
2025-06-27 15:17:05,310 INFO     Hit3 : 0.011529
2025-06-27 15:17:05,310 INFO     Hit10: 0.021349
2025-06-27 15:17:05,310 INFO     MR   : 1406.525833
2025-06-27 15:17:05,310 INFO     MRR  : 0.013233
2025-06-27 15:17:05,310 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:19:20,982 INFO     1000 5959
2025-06-27 15:21:37,093 INFO     2000 5959
2025-06-27 15:23:53,978 INFO     3000 5959
2025-06-27 15:26:09,924 INFO     4000 5959
2025-06-27 15:28:24,721 INFO     5000 5959
2025-06-27 15:30:35,479 INFO     >>>>> Generator: Training
2025-06-27 15:30:37,079 INFO     -------------------------
2025-06-27 15:30:37,079 INFO     | EM Iteration: 5/5
2025-06-27 15:30:37,079 INFO     -------------------------
2025-06-27 15:30:37,079 INFO     >>>>> Using Generator's sample rule
2025-06-27 15:30:37,079 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 15:30:37,146 INFO     Predictor: read 1719 rules from list.
2025-06-27 15:30:37,146 INFO     Preprocess training set
2025-06-27 15:30:37,147 INFO     >>>>> Predictor: Training
2025-06-27 15:31:20,489 INFO     1000 5959 8.782062 69271.3
2025-06-27 15:32:03,733 INFO     2000 5959 8.359201 69332.0
2025-06-27 15:32:46,801 INFO     3000 5959 8.070970 69375.3
2025-06-27 15:33:29,335 INFO     4000 5959 7.859779 69279.9
2025-06-27 15:34:10,267 INFO     5000 5959 7.687891 69349.3
2025-06-27 15:34:49,916 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 15:34:58,196 INFO     Data : 2077
2025-06-27 15:34:58,196 INFO     Hit1 : 0.038036
2025-06-27 15:34:58,196 INFO     Hit3 : 0.064998
2025-06-27 15:34:58,196 INFO     Hit10: 0.090034
2025-06-27 15:34:58,196 INFO     MR   : 1410.684401
2025-06-27 15:34:58,196 INFO     MRR  : 0.059397
2025-06-27 15:34:58,196 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 15:35:07,551 INFO     Data : 2342
2025-06-27 15:35:07,551 INFO     Hit1 : 0.041845
2025-06-27 15:35:07,551 INFO     Hit3 : 0.065329
2025-06-27 15:35:07,551 INFO     Hit10: 0.088386
2025-06-27 15:35:07,551 INFO     MR   : 1316.509180
2025-06-27 15:35:07,551 INFO     MRR  : 0.061929
2025-06-27 15:35:07,551 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:37:10,517 INFO     1000 5959
2025-06-27 15:39:13,857 INFO     2000 5959
2025-06-27 15:41:23,557 INFO     3000 5959
2025-06-27 15:43:33,451 INFO     4000 5959
2025-06-27 15:45:42,214 INFO     5000 5959
2025-06-27 15:47:47,727 INFO     >>>>> Generator: Training
2025-06-27 15:47:49,235 INFO     -------------------------
2025-06-27 15:47:49,235 INFO     | Post-train Generator
2025-06-27 15:47:49,235 INFO     -------------------------
2025-06-27 15:47:50,209 INFO     >>>>> Generator: Training
2025-06-27 15:48:06,663 INFO     [E01000] Total 3.067318 | main 2.677555 | aux_rel_cluster 0.568289 | aux_ent_type 8.684457
2025-06-27 15:48:06,664 INFO     -------------------------
2025-06-27 15:48:06,664 INFO     | Beam Search Best Rules
2025-06-27 15:48:06,664 INFO     -------------------------
2025-06-27 15:48:06,664 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:06,957 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:09,562 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:56,108 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:49:37,233 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:50:05,755 INFO     -------------------------
2025-06-27 15:50:05,755 INFO     | Train Final Predictor+
2025-06-27 15:50:05,755 INFO     -------------------------
2025-06-27 15:50:05,760 INFO     Predictor+: read 18420 rules from list.
2025-06-27 15:50:05,895 INFO     Preprocess training set
2025-06-27 15:50:05,896 INFO     -------------------------
2025-06-27 15:50:05,896 INFO     | Iteration: 1/5
2025-06-27 15:50:05,896 INFO     -------------------------
2025-06-27 15:50:05,896 INFO     >>>>> Predictor: Training
2025-06-27 15:54:30,402 INFO     1000 5959 4.875591 69366.7
2025-06-27 15:58:56,644 INFO     2000 5959 4.748836 69375.3
2025-06-27 16:03:25,537 INFO     3000 5959 4.717498 69219.2
2025-06-27 16:07:48,873 INFO     4000 5959 4.707682 69305.9
2025-06-27 16:12:08,347 INFO     5000 5959 4.670831 69288.6
2025-06-27 16:16:17,037 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 16:17:22,260 INFO     Data : 2077
2025-06-27 16:17:22,261 INFO     Hit1 : 0.095330
2025-06-27 16:17:22,261 INFO     Hit3 : 0.187289
2025-06-27 16:17:22,261 INFO     Hit10: 0.313433
2025-06-27 16:17:22,261 INFO     MR   : 972.651180
2025-06-27 16:17:22,261 INFO     MRR  : 0.165820
2025-06-27 16:17:22,261 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 16:18:35,492 INFO     Data : 2342
2025-06-27 16:18:35,492 INFO     Hit1 : 0.128096
2025-06-27 16:18:35,492 INFO     Hit3 : 0.209650
2025-06-27 16:18:35,492 INFO     Hit10: 0.317250
2025-06-27 16:18:35,492 INFO     MR   : 897.822588
2025-06-27 16:18:35,492 INFO     MRR  : 0.190269
2025-06-27 16:18:35,492 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_hard_sharing_3_20250627_102459/predictor.pt
2025-06-27 16:18:35,499 INFO     -------------------------
2025-06-27 16:18:35,499 INFO     | Iteration: 2/5
2025-06-27 16:18:35,499 INFO     -------------------------
2025-06-27 16:18:35,499 INFO     >>>>> Predictor: Training
2025-06-27 16:22:55,081 INFO     1000 5959 4.645226 69288.6
2025-06-27 16:27:15,117 INFO     2000 5959 4.647719 69288.6
2025-06-27 16:31:30,726 INFO     3000 5959 4.629891 69340.6
2025-06-27 16:35:43,092 INFO     4000 5959 4.636690 69271.3
2025-06-27 16:39:54,445 INFO     5000 5959 4.658320 69219.2
2025-06-27 16:43:56,904 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 16:45:00,052 INFO     Data : 2077
2025-06-27 16:45:00,052 INFO     Hit1 : 0.090034
2025-06-27 16:45:00,052 INFO     Hit3 : 0.182475
2025-06-27 16:45:00,052 INFO     Hit10: 0.302359
2025-06-27 16:45:00,052 INFO     MR   : 962.670438
2025-06-27 16:45:00,052 INFO     MRR  : 0.161450
2025-06-27 16:45:00,053 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 16:46:11,319 INFO     Data : 2342
2025-06-27 16:46:11,319 INFO     Hit1 : 0.118275
2025-06-27 16:46:11,319 INFO     Hit3 : 0.201110
2025-06-27 16:46:11,320 INFO     Hit10: 0.313407
2025-06-27 16:46:11,320 INFO     MR   : 883.560632
2025-06-27 16:46:11,320 INFO     MRR  : 0.182434
2025-06-27 16:46:11,320 INFO     -------------------------
2025-06-27 16:46:11,320 INFO     | Iteration: 3/5
2025-06-27 16:46:11,320 INFO     -------------------------
2025-06-27 16:46:11,320 INFO     >>>>> Predictor: Training
2025-06-27 16:50:43,337 INFO     1000 5959 4.611316 69340.6
2025-06-27 16:55:40,175 INFO     2000 5959 4.580002 69184.5
2025-06-27 17:00:37,533 INFO     3000 5959 4.638791 69253.9
2025-06-27 17:05:34,402 INFO     4000 5959 4.618595 69340.6
2025-06-27 17:10:33,816 INFO     5000 5959 4.615708 69384.0
2025-06-27 17:15:22,141 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 17:16:37,737 INFO     Data : 2077
2025-06-27 17:16:37,737 INFO     Hit1 : 0.094367
2025-06-27 17:16:37,737 INFO     Hit3 : 0.179104
2025-06-27 17:16:37,737 INFO     Hit10: 0.310063
2025-06-27 17:16:37,737 INFO     MR   : 944.933077
2025-06-27 17:16:37,737 INFO     MRR  : 0.163235
2025-06-27 17:16:37,738 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 17:18:02,932 INFO     Data : 2342
2025-06-27 17:18:02,932 INFO     Hit1 : 0.127242
2025-06-27 17:18:02,932 INFO     Hit3 : 0.201110
2025-06-27 17:18:02,932 INFO     Hit10: 0.319385
2025-06-27 17:18:02,932 INFO     MR   : 869.064475
2025-06-27 17:18:02,932 INFO     MRR  : 0.188173
2025-06-27 17:18:02,932 INFO     -------------------------
2025-06-27 17:18:02,932 INFO     | Iteration: 4/5
2025-06-27 17:18:02,932 INFO     -------------------------
2025-06-27 17:18:02,932 INFO     >>>>> Predictor: Training
2025-06-27 17:23:07,829 INFO     1000 5959 4.619203 69323.3
2025-06-27 17:28:11,559 INFO     2000 5959 4.593332 69332.0
2025-06-27 17:33:12,732 INFO     3000 5959 4.627969 69219.2
2025-06-27 17:38:15,331 INFO     4000 5959 4.621211 69297.3
2025-06-27 17:43:19,189 INFO     5000 5959 4.586489 69332.0
2025-06-27 17:48:09,764 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 17:49:23,703 INFO     Data : 2077
2025-06-27 17:49:23,703 INFO     Hit1 : 0.093885
2025-06-27 17:49:23,703 INFO     Hit3 : 0.183919
2025-06-27 17:49:23,703 INFO     Hit10: 0.311026
2025-06-27 17:49:23,703 INFO     MR   : 927.002648
2025-06-27 17:49:23,703 INFO     MRR  : 0.165097
2025-06-27 17:49:23,703 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 17:50:46,575 INFO     Data : 2342
2025-06-27 17:50:46,575 INFO     Hit1 : 0.131085
2025-06-27 17:50:46,575 INFO     Hit3 : 0.206234
2025-06-27 17:50:46,575 INFO     Hit10: 0.321520
2025-06-27 17:50:46,576 INFO     MR   : 856.511742
2025-06-27 17:50:46,576 INFO     MRR  : 0.192542
2025-06-27 17:50:46,576 INFO     -------------------------
2025-06-27 17:50:46,576 INFO     | Iteration: 5/5
2025-06-27 17:50:46,576 INFO     -------------------------
2025-06-27 17:50:46,576 INFO     >>>>> Predictor: Training
2025-06-27 17:55:40,691 INFO     1000 5959 4.560424 69245.2
2025-06-27 18:00:33,480 INFO     2000 5959 4.552656 69262.6
2025-06-27 18:05:28,105 INFO     3000 5959 4.610292 69332.0
2025-06-27 18:10:24,898 INFO     4000 5959 4.613616 69366.7
2025-06-27 18:15:19,171 INFO     5000 5959 4.622824 69262.6
2025-06-27 18:20:06,304 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 18:21:20,129 INFO     Data : 2077
2025-06-27 18:21:20,129 INFO     Hit1 : 0.098219
2025-06-27 18:21:20,129 INFO     Hit3 : 0.186326
2025-06-27 18:21:20,129 INFO     Hit10: 0.308137
2025-06-27 18:21:20,129 INFO     MR   : 925.314636
2025-06-27 18:21:20,129 INFO     MRR  : 0.167375
2025-06-27 18:21:20,129 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 18:22:42,535 INFO     Data : 2342
2025-06-27 18:22:42,535 INFO     Hit1 : 0.133219
2025-06-27 18:22:42,535 INFO     Hit3 : 0.208796
2025-06-27 18:22:42,535 INFO     Hit10: 0.320666
2025-06-27 18:22:42,535 INFO     MR   : 856.851836
2025-06-27 18:22:42,535 INFO     MRR  : 0.194398
2025-06-27 18:22:42,535 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_hard_sharing_3_20250627_102459/predictor.pt
2025-06-27 18:22:42,544 INFO     -------------------------
2025-06-27 18:22:42,544 INFO     | Final Test MRR: 0.194398
2025-06-27 18:22:42,544 INFO     -------------------------
entity size:  8673
relation size:  20
