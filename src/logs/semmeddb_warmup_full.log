2025-06-10 02:09:11,430 INFO     Data loading | DONE!
2025-06-10 02:09:11,579 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 02:09:11,579 INFO     Subset ratio: 0.1
2025-06-10 02:09:11,580 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 02:09:11,580 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 02:09:11,580 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 02:09:11,581 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 02:09:11,581 INFO     -------------------------
2025-06-10 02:09:11,581 INFO     | Pre-train Generator
2025-06-10 02:09:11,581 INFO     -------------------------
2025-06-10 02:09:11,685 INFO     >>>>> Generator: Training
2025-06-10 02:09:31,586 INFO     [E1000] Total: 0.995491 | Main: 1.018759 | Aux: 0.533948
2025-06-10 02:09:50,493 INFO     [E2000] Total: 0.893682 | Main: 0.915467 | Aux: 0.479779
2025-06-10 02:10:09,364 INFO     [E3000] Total: 0.891524 | Main: 0.913434 | Aux: 0.475229
2025-06-10 02:10:28,390 INFO     [E4000] Total: 0.886313 | Main: 0.908032 | Aux: 0.473652
2025-06-10 02:10:47,340 INFO     [E5000] Total: 0.885233 | Main: 0.906933 | Aux: 0.472938
2025-06-10 02:11:06,417 INFO     [E6000] Total: 0.883323 | Main: 0.904973 | Aux: 0.471985
2025-06-10 02:11:25,311 INFO     [E7000] Total: 0.886345 | Main: 0.908176 | Aux: 0.471555
2025-06-10 02:11:44,420 INFO     [E8000] Total: 0.882768 | Main: 0.904438 | Aux: 0.471049
2025-06-10 02:12:03,429 INFO     [E9000] Total: 0.885201 | Main: 0.907017 | Aux: 0.470699
2025-06-10 02:12:22,341 INFO     [E10000] Total: 0.884058 | Main: 0.905807 | Aux: 0.470826
2025-06-10 02:12:22,341 INFO     -------------------------
2025-06-10 02:12:22,342 INFO     | EM Iteration: 1/5
2025-06-10 02:12:22,342 INFO     -------------------------
2025-06-10 02:12:22,342 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:12:22,720 INFO     Predictor: read 823 rules from list.
2025-06-10 02:12:22,721 INFO     Preprocess training set
2025-06-10 02:12:22,721 INFO     >>>>> Predictor: Training
2025-06-10 02:14:37,959 INFO     1000 1231 8.591445 69297.3
2025-06-10 02:15:08,297 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:15:12,097 INFO     Data : 376
2025-06-10 02:15:12,097 INFO     Hit1 : 0.013298
2025-06-10 02:15:12,097 INFO     Hit3 : 0.045213
2025-06-10 02:15:12,097 INFO     Hit10: 0.101064
2025-06-10 02:15:12,097 INFO     MR   : 1275.869681
2025-06-10 02:15:12,097 INFO     MRR  : 0.045301
2025-06-10 02:15:12,097 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:15:16,585 INFO     Data : 440
2025-06-10 02:15:16,585 INFO     Hit1 : 0.036364
2025-06-10 02:15:16,585 INFO     Hit3 : 0.061364
2025-06-10 02:15:16,585 INFO     Hit10: 0.129545
2025-06-10 02:15:16,585 INFO     MR   : 1275.894318
2025-06-10 02:15:16,585 INFO     MRR  : 0.066486
2025-06-10 02:15:16,585 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:17:58,941 INFO     1000 1231
2025-06-10 02:18:35,278 INFO     >>>>> Generator: Training
2025-06-10 02:18:37,084 INFO     -------------------------
2025-06-10 02:18:37,084 INFO     | EM Iteration: 2/5
2025-06-10 02:18:37,084 INFO     -------------------------
2025-06-10 02:18:37,084 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:18:37,426 INFO     Predictor: read 858 rules from list.
2025-06-10 02:18:37,427 INFO     Preprocess training set
2025-06-10 02:18:37,427 INFO     >>>>> Predictor: Training
2025-06-10 02:20:56,173 INFO     1000 1231 8.625896 69384.0
2025-06-10 02:21:27,324 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:21:30,669 INFO     Data : 376
2025-06-10 02:21:30,670 INFO     Hit1 : 0.026596
2025-06-10 02:21:30,670 INFO     Hit3 : 0.055851
2025-06-10 02:21:30,670 INFO     Hit10: 0.117021
2025-06-10 02:21:30,670 INFO     MR   : 1237.291223
2025-06-10 02:21:30,670 INFO     MRR  : 0.056734
2025-06-10 02:21:30,670 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:21:34,651 INFO     Data : 440
2025-06-10 02:21:34,651 INFO     Hit1 : 0.045455
2025-06-10 02:21:34,651 INFO     Hit3 : 0.081818
2025-06-10 02:21:34,651 INFO     Hit10: 0.147727
2025-06-10 02:21:34,651 INFO     MR   : 1240.137500
2025-06-10 02:21:34,651 INFO     MRR  : 0.080032
2025-06-10 02:21:34,651 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:24:20,449 INFO     1000 1231
2025-06-10 02:24:57,833 INFO     >>>>> Generator: Training
2025-06-10 02:24:59,642 INFO     -------------------------
2025-06-10 02:24:59,642 INFO     | EM Iteration: 3/5
2025-06-10 02:24:59,642 INFO     -------------------------
2025-06-10 02:24:59,642 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:24:59,979 INFO     Predictor: read 921 rules from list.
2025-06-10 02:24:59,979 INFO     Preprocess training set
2025-06-10 02:24:59,979 INFO     >>>>> Predictor: Training
2025-06-10 02:27:26,825 INFO     1000 1231 8.602935 69340.6
2025-06-10 02:27:59,924 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:28:04,510 INFO     Data : 376
2025-06-10 02:28:04,511 INFO     Hit1 : 0.021277
2025-06-10 02:28:04,511 INFO     Hit3 : 0.047872
2025-06-10 02:28:04,511 INFO     Hit10: 0.125000
2025-06-10 02:28:04,511 INFO     MR   : 1136.736702
2025-06-10 02:28:04,511 INFO     MRR  : 0.055049
2025-06-10 02:28:04,511 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:28:09,840 INFO     Data : 440
2025-06-10 02:28:09,841 INFO     Hit1 : 0.054545
2025-06-10 02:28:09,841 INFO     Hit3 : 0.102273
2025-06-10 02:28:09,841 INFO     Hit10: 0.161364
2025-06-10 02:28:09,841 INFO     MR   : 1179.405682
2025-06-10 02:28:09,841 INFO     MRR  : 0.093328
2025-06-10 02:28:09,841 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:31:06,649 INFO     1000 1231
2025-06-10 02:31:46,334 INFO     >>>>> Generator: Training
2025-06-10 02:31:48,267 INFO     -------------------------
2025-06-10 02:31:48,267 INFO     | EM Iteration: 4/5
2025-06-10 02:31:48,268 INFO     -------------------------
2025-06-10 02:31:48,268 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:31:48,608 INFO     Predictor: read 970 rules from list.
2025-06-10 02:31:48,609 INFO     Preprocess training set
2025-06-10 02:31:48,609 INFO     >>>>> Predictor: Training
2025-06-10 02:34:17,246 INFO     1000 1231 8.604509 69366.7
2025-06-10 02:34:52,389 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:34:58,426 INFO     Data : 376
2025-06-10 02:34:58,426 INFO     Hit1 : 0.026596
2025-06-10 02:34:58,426 INFO     Hit3 : 0.047872
2025-06-10 02:34:58,426 INFO     Hit10: 0.103723
2025-06-10 02:34:58,426 INFO     MR   : 1292.917553
2025-06-10 02:34:58,426 INFO     MRR  : 0.054692
2025-06-10 02:34:58,427 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:35:05,664 INFO     Data : 440
2025-06-10 02:35:05,664 INFO     Hit1 : 0.043182
2025-06-10 02:35:05,664 INFO     Hit3 : 0.081818
2025-06-10 02:35:05,664 INFO     Hit10: 0.147727
2025-06-10 02:35:05,664 INFO     MR   : 1262.440909
2025-06-10 02:35:05,664 INFO     MRR  : 0.078509
2025-06-10 02:35:05,664 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:38:04,963 INFO     1000 1231
2025-06-10 02:38:47,502 INFO     >>>>> Generator: Training
2025-06-10 02:38:49,353 INFO     -------------------------
2025-06-10 02:38:49,353 INFO     | EM Iteration: 5/5
2025-06-10 02:38:49,353 INFO     -------------------------
2025-06-10 02:38:49,353 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:38:49,694 INFO     Predictor: read 996 rules from list.
2025-06-10 02:38:49,694 INFO     Preprocess training set
2025-06-10 02:38:49,694 INFO     >>>>> Predictor: Training
2025-06-10 02:41:22,817 INFO     1000 1231 8.607464 69384.0
2025-06-10 02:41:58,538 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:42:04,628 INFO     Data : 376
2025-06-10 02:42:04,629 INFO     Hit1 : 0.029255
2025-06-10 02:42:04,629 INFO     Hit3 : 0.071809
2025-06-10 02:42:04,629 INFO     Hit10: 0.130319
2025-06-10 02:42:04,629 INFO     MR   : 1244.299202
2025-06-10 02:42:04,629 INFO     MRR  : 0.065687
2025-06-10 02:42:04,629 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:42:11,749 INFO     Data : 440
2025-06-10 02:42:11,749 INFO     Hit1 : 0.063636
2025-06-10 02:42:11,749 INFO     Hit3 : 0.100000
2025-06-10 02:42:11,749 INFO     Hit10: 0.154545
2025-06-10 02:42:11,749 INFO     MR   : 1177.635227
2025-06-10 02:42:11,749 INFO     MRR  : 0.096559
2025-06-10 02:42:11,749 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:45:15,708 INFO     1000 1231
2025-06-10 02:45:58,461 INFO     >>>>> Generator: Training
2025-06-10 02:46:00,305 INFO     -------------------------
2025-06-10 02:46:00,305 INFO     | Post-train Generator
2025-06-10 02:46:00,305 INFO     -------------------------
2025-06-10 02:46:00,307 INFO     >>>>> Generator: Training
2025-06-10 02:46:19,445 INFO     [E1000] Total: 1.220601 | Main: 1.257558 | Aux: 0.509977
2025-06-10 02:46:19,445 INFO     -------------------------
2025-06-10 02:46:19,445 INFO     | Beam Search Best Rules
2025-06-10 02:46:19,446 INFO     -------------------------
2025-06-10 02:46:19,446 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:46:20,278 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:46:25,307 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:05,794 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:34,181 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:53,832 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 02:47:53,833 INFO     Subset ratio: 0.1
2025-06-10 02:47:53,834 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 02:47:53,834 INFO     -------------------------
2025-06-10 02:47:53,834 INFO     | Train Final Predictor+
2025-06-10 02:47:53,834 INFO     -------------------------
2025-06-10 02:47:53,835 INFO     Predictor+: read 1842 rules from list.
2025-06-10 02:47:53,841 INFO     Preprocess training set
2025-06-10 02:47:53,842 INFO     -------------------------
2025-06-10 02:47:53,842 INFO     | Iteration: 1/5
2025-06-10 02:47:53,842 INFO     -------------------------
2025-06-10 02:47:53,842 INFO     >>>>> Predictor: Training
2025-06-10 02:51:15,058 INFO     1000 1231 6.323329 69305.9
2025-06-10 02:52:01,317 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:52:09,646 INFO     Data : 376
2025-06-10 02:52:09,646 INFO     Hit1 : 0.045213
2025-06-10 02:52:09,646 INFO     Hit3 : 0.093085
2025-06-10 02:52:09,646 INFO     Hit10: 0.175532
2025-06-10 02:52:09,646 INFO     MR   : 1371.390957
2025-06-10 02:52:09,646 INFO     MRR  : 0.089931
2025-06-10 02:52:09,646 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:52:19,215 INFO     Data : 440
2025-06-10 02:52:19,215 INFO     Hit1 : 0.040909
2025-06-10 02:52:19,215 INFO     Hit3 : 0.079545
2025-06-10 02:52:19,215 INFO     Hit10: 0.145455
2025-06-10 02:52:19,215 INFO     MR   : 1394.893182
2025-06-10 02:52:19,215 INFO     MRR  : 0.075324
2025-06-10 02:52:19,216 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/warmup/predictor.pt
2025-06-10 02:52:19,219 INFO     -------------------------
2025-06-10 02:52:19,219 INFO     | Iteration: 2/5
2025-06-10 02:52:19,219 INFO     -------------------------
2025-06-10 02:52:19,219 INFO     >>>>> Predictor: Training
2025-06-10 02:55:40,468 INFO     1000 1231 6.130407 69366.7
2025-06-10 02:56:26,864 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:56:34,977 INFO     Data : 376
2025-06-10 02:56:34,977 INFO     Hit1 : 0.031915
2025-06-10 02:56:34,977 INFO     Hit3 : 0.093085
2025-06-10 02:56:34,977 INFO     Hit10: 0.183511
2025-06-10 02:56:34,977 INFO     MR   : 1243.402926
2025-06-10 02:56:34,977 INFO     MRR  : 0.081293
2025-06-10 02:56:34,977 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:56:44,486 INFO     Data : 440
2025-06-10 02:56:44,486 INFO     Hit1 : 0.045455
2025-06-10 02:56:44,486 INFO     Hit3 : 0.088636
2025-06-10 02:56:44,486 INFO     Hit10: 0.161364
2025-06-10 02:56:44,486 INFO     MR   : 1249.904545
2025-06-10 02:56:44,486 INFO     MRR  : 0.082111
2025-06-10 02:56:44,486 INFO     -------------------------
2025-06-10 02:56:44,486 INFO     | Iteration: 3/5
2025-06-10 02:56:44,486 INFO     -------------------------
2025-06-10 02:56:44,487 INFO     >>>>> Predictor: Training
2025-06-10 03:00:08,324 INFO     1000 1231 6.044687 69384.0
2025-06-10 03:00:55,132 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:01:03,243 INFO     Data : 376
2025-06-10 03:01:03,243 INFO     Hit1 : 0.042553
2025-06-10 03:01:03,243 INFO     Hit3 : 0.090426
2025-06-10 03:01:03,243 INFO     Hit10: 0.180851
2025-06-10 03:01:03,243 INFO     MR   : 1232.053191
2025-06-10 03:01:03,243 INFO     MRR  : 0.086707
2025-06-10 03:01:03,243 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:01:12,690 INFO     Data : 440
2025-06-10 03:01:12,690 INFO     Hit1 : 0.043182
2025-06-10 03:01:12,690 INFO     Hit3 : 0.088636
2025-06-10 03:01:12,690 INFO     Hit10: 0.145455
2025-06-10 03:01:12,690 INFO     MR   : 1213.347727
2025-06-10 03:01:12,690 INFO     MRR  : 0.079436
2025-06-10 03:01:12,690 INFO     -------------------------
2025-06-10 03:01:12,690 INFO     | Iteration: 4/5
2025-06-10 03:01:12,690 INFO     -------------------------
2025-06-10 03:01:12,690 INFO     >>>>> Predictor: Training
2025-06-10 03:04:35,241 INFO     1000 1231 6.023838 69340.6
2025-06-10 03:05:21,679 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:05:29,747 INFO     Data : 376
2025-06-10 03:05:29,748 INFO     Hit1 : 0.037234
2025-06-10 03:05:29,748 INFO     Hit3 : 0.087766
2025-06-10 03:05:29,748 INFO     Hit10: 0.180851
2025-06-10 03:05:29,748 INFO     MR   : 1197.160904
2025-06-10 03:05:29,748 INFO     MRR  : 0.082610
2025-06-10 03:05:29,748 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:05:39,099 INFO     Data : 440
2025-06-10 03:05:39,100 INFO     Hit1 : 0.043182
2025-06-10 03:05:39,100 INFO     Hit3 : 0.084091
2025-06-10 03:05:39,100 INFO     Hit10: 0.152273
2025-06-10 03:05:39,100 INFO     MR   : 1161.448864
2025-06-10 03:05:39,100 INFO     MRR  : 0.078840
2025-06-10 03:05:39,100 INFO     -------------------------
2025-06-10 03:05:39,100 INFO     | Iteration: 5/5
2025-06-10 03:05:39,100 INFO     -------------------------
2025-06-10 03:05:39,100 INFO     >>>>> Predictor: Training
2025-06-10 03:09:01,939 INFO     1000 1231 6.088246 69340.6
2025-06-10 03:09:48,165 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:09:56,329 INFO     Data : 376
2025-06-10 03:09:56,329 INFO     Hit1 : 0.037234
2025-06-10 03:09:56,329 INFO     Hit3 : 0.074468
2025-06-10 03:09:56,329 INFO     Hit10: 0.167553
2025-06-10 03:09:56,329 INFO     MR   : 1169.553191
2025-06-10 03:09:56,329 INFO     MRR  : 0.079288
2025-06-10 03:09:56,330 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:10:05,912 INFO     Data : 440
2025-06-10 03:10:05,912 INFO     Hit1 : 0.034091
2025-06-10 03:10:05,912 INFO     Hit3 : 0.086364
2025-06-10 03:10:05,912 INFO     Hit10: 0.147727
2025-06-10 03:10:05,912 INFO     MR   : 1162.893182
2025-06-10 03:10:05,912 INFO     MRR  : 0.075674
2025-06-10 03:10:05,912 INFO     -------------------------
2025-06-10 03:10:05,912 INFO     | Final Test MRR: 0.075324
2025-06-10 03:10:05,912 INFO     -------------------------
entity size:  8673
relation size:  20
