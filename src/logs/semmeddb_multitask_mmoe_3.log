W0630 12:38:36.928367 3975372 torch/distributed/run.py:793] 
W0630 12:38:36.928367 3975372 torch/distributed/run.py:793] *****************************************
W0630 12:38:36.928367 3975372 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0630 12:38:36.928367 3975372 torch/distributed/run.py:793] *****************************************
entity size:  8673
relation size:  20
entity size:  8673
relation size:  20
2025-06-30 12:38:38,324 INFO     Data loading | DONE!
2025-06-30 12:38:38,422 INFO     Using subset datasets for training, validation, and testing.
2025-06-30 12:38:38,423 INFO     Subset ratio: 0.01
2025-06-30 12:38:38,424 INFO     [Subset] TrainDataset: 59/5959 samples (1%)
2025-06-30 12:38:38,424 INFO     [Subset] ValidDataset: 2/260 samples (1%)
2025-06-30 12:38:38,424 INFO     [Subset] TestDataset: 2/293 samples (1%)
2025-06-30 12:38:38,425 INFO     [Subset] RuleDataset: 136/13661 samples (1%)
2025-06-30 12:38:38,549 INFO     -------------------------
2025-06-30 12:38:38,549 INFO     | EM Iteration: 1/2
2025-06-30 12:38:38,549 INFO     -------------------------
2025-06-30 12:38:38,549 INFO     >>>>> Using miner's rule
2025-06-30 12:38:38,584 INFO     >>>>> Using miner's rule
2025-06-30 12:38:38,633 INFO     Predictor: read 13661 rules from list.
2025-06-30 12:38:38,665 INFO     Predictor: read 13661 rules from list.
2025-06-30 12:38:39,344 INFO     Initializing distributed process group
2025-06-30 12:38:39,346 INFO     Preprocess training set
2025-06-30 12:38:39,441 INFO     >>>>> Predictor: Training
[rank1]:[W630 12:38:39.090568489 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank0]:[W630 12:38:40.386844910 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-06-30 12:38:54,204 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 12:38:54,595 INFO     Data : 16
2025-06-30 12:38:54,595 INFO     Hit1 : 0.000000
2025-06-30 12:38:54,595 INFO     Hit3 : 0.000000
2025-06-30 12:38:54,596 INFO     Hit10: 0.000000
2025-06-30 12:38:54,596 INFO     MR   : 2993.968750
2025-06-30 12:38:54,596 INFO     MRR  : 0.010929
2025-06-30 12:38:54,596 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 12:38:54,993 INFO     Data : 16
2025-06-30 12:38:54,993 INFO     Hit1 : 0.000000
2025-06-30 12:38:54,993 INFO     Hit3 : 0.125000
2025-06-30 12:38:54,993 INFO     Hit10: 0.125000
2025-06-30 12:38:54,993 INFO     MR   : 2557.781250
2025-06-30 12:38:54,993 INFO     MRR  : 0.057487
2025-06-30 12:38:54,993 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 12:40:16,288 INFO     >>>>> Using Generator's sample rule
2025-06-30 12:40:16,337 INFO     >>>>> Generator: Training
2025-06-30 12:40:16,427 INFO     Predictor: read 199 rules from list.
2025-06-30 12:40:16,526 INFO     [E00001] Total 90.234947 | Main 3.037014 | RelClus 1.085099 | EntType 94.078110
2025-06-30 12:40:16,635 INFO     [E00002] Total 90.228561 | Main 3.030985 | RelClus 1.084280 | EntType 94.065781
2025-06-30 12:40:16,669 INFO     [E00003] Total 90.212105 | Main 3.042770 | RelClus 1.084855 | EntType 94.059929
2025-06-30 12:40:16,701 INFO     [E00004] Total 90.210381 | Main 3.036469 | RelClus 1.084224 | EntType 94.052216
2025-06-30 12:40:16,732 INFO     [E00005] Total 90.197197 | Main 3.039292 | RelClus 1.083825 | EntType 94.041069
2025-06-30 12:40:16,766 INFO     [E00006] Total 90.185226 | Main 3.042023 | RelClus 1.083902 | EntType 94.031471
2025-06-30 12:40:16,798 INFO     [E00007] Total 90.180313 | Main 3.037908 | RelClus 1.084858 | EntType 94.023872
2025-06-30 12:40:16,832 INFO     [E00008] Total 90.171455 | Main 3.037680 | RelClus 1.085208 | EntType 94.015114
2025-06-30 12:40:16,866 INFO     [E00009] Total 90.159714 | Main 3.040249 | RelClus 1.085146 | EntType 94.005486
2025-06-30 12:40:16,897 INFO     [E00010] Total 90.155525 | Main 3.034547 | RelClus 1.085122 | EntType 93.996368
2025-06-30 12:40:16,898 INFO     -------------------------
2025-06-30 12:40:16,898 INFO     | EM Iteration: 2/2
2025-06-30 12:40:16,898 INFO     -------------------------
2025-06-30 12:40:16,898 INFO     >>>>> Using Generator's sample rule
2025-06-30 12:40:16,898 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 12:40:17,602 INFO     Predictor: read 199 rules from list.
2025-06-30 12:40:17,602 INFO     Preprocess training set
2025-06-30 12:40:17,604 INFO     >>>>> Predictor: Training
2025-06-30 12:40:17,842 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 12:40:17,858 INFO     Data : 16
2025-06-30 12:40:17,858 INFO     Hit1 : 0.000000
2025-06-30 12:40:17,858 INFO     Hit3 : 0.000000
2025-06-30 12:40:17,858 INFO     Hit10: 0.000000
2025-06-30 12:40:17,858 INFO     MR   : 2135.468750
2025-06-30 12:40:17,858 INFO     MRR  : 0.003475
2025-06-30 12:40:17,859 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 12:40:17,876 INFO     Data : 16
2025-06-30 12:40:17,876 INFO     Hit1 : 0.000000
2025-06-30 12:40:17,876 INFO     Hit3 : 0.062500
2025-06-30 12:40:17,876 INFO     Hit10: 0.062500
2025-06-30 12:40:17,876 INFO     MR   : 2394.531250
2025-06-30 12:40:17,876 INFO     MRR  : 0.034147
2025-06-30 12:40:17,876 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 12:40:18,679 INFO     >>>>> Generator: Training
2025-06-30 12:40:18,699 INFO     [E00001] Total 90.156929 | Main 3.035978 | RelClus 1.083543 | EntType 93.997581
2025-06-30 12:40:18,716 INFO     [E00002] Total 90.147598 | Main 3.035987 | RelClus 1.083549 | EntType 93.988235
2025-06-30 12:40:18,733 INFO     [E00003] Total 90.140648 | Main 3.036019 | RelClus 1.083538 | EntType 93.981277
2025-06-30 12:40:18,750 INFO     [E00004] Total 90.132492 | Main 3.036046 | RelClus 1.083304 | EntType 93.972923
2025-06-30 12:40:18,767 INFO     [E00005] Total 90.122162 | Main 3.036170 | RelClus 1.083784 | EntType 93.963097
2025-06-30 12:40:18,783 INFO     [E00006] Total 90.114296 | Main 3.036092 | RelClus 1.083543 | EntType 93.954926
2025-06-30 12:40:18,800 INFO     [E00007] Total 90.104591 | Main 3.036136 | RelClus 1.083853 | EntType 93.945511
2025-06-30 12:40:18,817 INFO     [E00008] Total 90.095131 | Main 3.036038 | RelClus 1.083746 | EntType 93.935852
2025-06-30 12:40:18,834 INFO     [E00009] Total 90.087257 | Main 3.036101 | RelClus 1.083966 | EntType 93.928200
2025-06-30 12:40:18,851 INFO     [E00010] Total 90.079880 | Main 3.036040 | RelClus 1.083932 | EntType 93.920715
2025-06-30 12:40:18,852 INFO     -------------------------
2025-06-30 12:40:18,852 INFO     | Post-train Generator
2025-06-30 12:40:18,852 INFO     -------------------------
2025-06-30 12:40:18,923 INFO     >>>>> Generator: Training
2025-06-30 12:40:18,948 INFO     [E00001] Total 89.996620 | Main 3.107362 | RelClus 1.085611 | EntType 93.899910
2025-06-30 12:40:18,977 INFO     [E00002] Total 90.042030 | Main 3.043912 | RelClus 1.085697 | EntType 93.891106
2025-06-30 12:40:19,000 INFO     [E00003] Total 90.025291 | Main 3.058027 | RelClus 1.085299 | EntType 93.886078
2025-06-30 12:40:19,021 INFO     [E00004] Total 90.028404 | Main 3.044032 | RelClus 1.085283 | EntType 93.877174
2025-06-30 12:40:19,044 INFO     [E00005] Total 90.005127 | Main 3.060274 | RelClus 1.085199 | EntType 93.867699
2025-06-30 12:40:19,066 INFO     [E00006] Total 89.932335 | Main 3.134181 | RelClus 1.085231 | EntType 93.858047
2025-06-30 12:40:19,090 INFO     [E00007] Total 90.012604 | Main 3.032487 | RelClus 1.085218 | EntType 93.851349
2025-06-30 12:40:19,118 INFO     [E00008] Total 89.995735 | Main 3.039885 | RelClus 1.085029 | EntType 93.840622
2025-06-30 12:40:19,142 INFO     [E00009] Total 89.624527 | Main 3.465783 | RelClus 1.086038 | EntType 93.831673
2025-06-30 12:40:19,167 INFO     [E00010] Total 89.972504 | Main 3.044914 | RelClus 1.086038 | EntType 93.822548
2025-06-30 12:40:19,167 INFO     -------------------------
2025-06-30 12:40:19,168 INFO     | Beam Search Best Rules
2025-06-30 12:40:19,168 INFO     -------------------------
2025-06-30 12:40:19,168 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 12:40:20,141 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-30 12:40:20,141 INFO     Subset ratio: 0.01
2025-06-30 12:40:20,141 INFO     Subset sizes: train=59, valid=2, test=2, rule dataset=4
2025-06-30 12:40:20,141 INFO     -------------------------
2025-06-30 12:40:20,141 INFO     | Train Final Predictor+
2025-06-30 12:40:20,141 INFO     -------------------------
2025-06-30 12:40:20,141 INFO     Predictor+: read 4 rules from list.
2025-06-30 12:40:20,142 INFO     Preprocess training set
2025-06-30 12:40:20,143 INFO     -------------------------
2025-06-30 12:40:20,143 INFO     | Iteration: 1/1
2025-06-30 12:40:20,144 INFO     -------------------------
2025-06-30 12:40:20,144 INFO     >>>>> Predictor: Training
W0630 12:48:30.879665 3975372 torch/distributed/elastic/agent/server/api.py:704] Received Signals.SIGINT death signal, shutting down workers
W0630 12:48:30.880248 3975372 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3975401 closing signal SIGINT
W0630 12:48:30.880406 3975372 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3975402 closing signal SIGINT
W0630 12:48:31.047110 3975372 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3975401 closing signal SIGTERM
W0630 12:48:31.047466 3975372 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3975402 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 696, in run
    result = self._invoke_run(role)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 855, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 3975372 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/emma/polly_env_py39/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 260, in launch_agent
    result = agent.run()
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 137, in wrapper
    result = f(*args, **kwargs)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 705, in run
    self._shutdown(e.sigval)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 365, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 572, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 909, in _close
    handler.proc.wait(time_to_wait)
  File "/usr/lib/python3.9/subprocess.py", line 1189, in wait
    return self._wait(timeout=timeout)
  File "/usr/lib/python3.9/subprocess.py", line 1927, in _wait
    time.sleep(delay)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 3975372 got signal: 2
