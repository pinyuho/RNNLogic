2025-06-10 01:08:44,869 INFO     Data loading | DONE!
2025-06-10 01:08:45,014 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 01:08:45,014 INFO     Subset ratio: 0.1
2025-06-10 01:08:45,015 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 01:08:45,015 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 01:08:45,015 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 01:08:45,016 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 01:08:45,016 INFO     -------------------------
2025-06-10 01:08:45,016 INFO     | Pre-train Generator
2025-06-10 01:08:45,016 INFO     -------------------------
2025-06-10 01:08:45,119 INFO     >>>>> Generator: Training
2025-06-10 01:09:04,630 INFO     [E1000] Total: 0.915077 | Main: 1.017204 | Aux: 0.506568
2025-06-10 01:09:23,341 INFO     [E2000] Total: 0.827251 | Main: 0.915226 | Aux: 0.475349
2025-06-10 01:09:41,948 INFO     [E3000] Total: 0.825334 | Main: 0.913349 | Aux: 0.473273
2025-06-10 01:10:00,578 INFO     [E4000] Total: 0.820813 | Main: 0.907936 | Aux: 0.472319
2025-06-10 01:10:19,150 INFO     [E5000] Total: 0.819824 | Main: 0.906846 | Aux: 0.471737
2025-06-10 01:10:38,022 INFO     [E6000] Total: 0.818156 | Main: 0.904903 | Aux: 0.471167
2025-06-10 01:10:56,751 INFO     [E7000] Total: 0.820637 | Main: 0.908111 | Aux: 0.470741
2025-06-10 01:11:15,694 INFO     [E8000] Total: 0.817600 | Main: 0.904406 | Aux: 0.470378
2025-06-10 01:11:34,459 INFO     [E9000] Total: 0.819640 | Main: 0.907022 | Aux: 0.470110
2025-06-10 01:11:53,278 INFO     [E10000] Total: 0.818533 | Main: 0.905657 | Aux: 0.470036
2025-06-10 01:11:53,278 INFO     -------------------------
2025-06-10 01:11:53,278 INFO     | EM Iteration: 1/5
2025-06-10 01:11:53,278 INFO     -------------------------
2025-06-10 01:11:53,278 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:11:53,666 INFO     Predictor: read 844 rules from list.
2025-06-10 01:11:53,666 INFO     Preprocess training set
2025-06-10 01:11:53,666 INFO     >>>>> Predictor: Training
2025-06-10 01:14:08,823 INFO     1000 1231 8.591231 69297.3
2025-06-10 01:14:39,227 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:14:43,055 INFO     Data : 376
2025-06-10 01:14:43,055 INFO     Hit1 : 0.013298
2025-06-10 01:14:43,055 INFO     Hit3 : 0.045213
2025-06-10 01:14:43,055 INFO     Hit10: 0.101064
2025-06-10 01:14:43,055 INFO     MR   : 1274.998670
2025-06-10 01:14:43,055 INFO     MRR  : 0.045193
2025-06-10 01:14:43,055 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:14:47,483 INFO     Data : 440
2025-06-10 01:14:47,483 INFO     Hit1 : 0.036364
2025-06-10 01:14:47,483 INFO     Hit3 : 0.063636
2025-06-10 01:14:47,483 INFO     Hit10: 0.129545
2025-06-10 01:14:47,483 INFO     MR   : 1276.577273
2025-06-10 01:14:47,483 INFO     MRR  : 0.067499
2025-06-10 01:14:47,483 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:17:26,837 INFO     1000 1231
2025-06-10 01:18:02,669 INFO     >>>>> Generator: Training
2025-06-10 01:18:04,503 INFO     -------------------------
2025-06-10 01:18:04,503 INFO     | EM Iteration: 2/5
2025-06-10 01:18:04,503 INFO     -------------------------
2025-06-10 01:18:04,503 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:18:04,840 INFO     Predictor: read 871 rules from list.
2025-06-10 01:18:04,840 INFO     Preprocess training set
2025-06-10 01:18:04,840 INFO     >>>>> Predictor: Training
2025-06-10 01:20:21,431 INFO     1000 1231 8.625179 69384.0
2025-06-10 01:20:51,953 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:20:55,252 INFO     Data : 376
2025-06-10 01:20:55,253 INFO     Hit1 : 0.026596
2025-06-10 01:20:55,253 INFO     Hit3 : 0.055851
2025-06-10 01:20:55,253 INFO     Hit10: 0.117021
2025-06-10 01:20:55,253 INFO     MR   : 1237.412234
2025-06-10 01:20:55,253 INFO     MRR  : 0.056725
2025-06-10 01:20:55,253 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:20:59,049 INFO     Data : 440
2025-06-10 01:20:59,050 INFO     Hit1 : 0.045455
2025-06-10 01:20:59,050 INFO     Hit3 : 0.081818
2025-06-10 01:20:59,050 INFO     Hit10: 0.147727
2025-06-10 01:20:59,050 INFO     MR   : 1240.238636
2025-06-10 01:20:59,050 INFO     MRR  : 0.080040
2025-06-10 01:20:59,050 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:23:41,050 INFO     1000 1231
2025-06-10 01:24:17,310 INFO     >>>>> Generator: Training
2025-06-10 01:24:19,147 INFO     -------------------------
2025-06-10 01:24:19,148 INFO     | EM Iteration: 3/5
2025-06-10 01:24:19,148 INFO     -------------------------
2025-06-10 01:24:19,148 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:24:19,486 INFO     Predictor: read 935 rules from list.
2025-06-10 01:24:19,486 INFO     Preprocess training set
2025-06-10 01:24:19,486 INFO     >>>>> Predictor: Training
2025-06-10 01:26:48,095 INFO     1000 1231 8.602055 69340.6
2025-06-10 01:27:21,437 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:27:25,800 INFO     Data : 376
2025-06-10 01:27:25,800 INFO     Hit1 : 0.021277
2025-06-10 01:27:25,800 INFO     Hit3 : 0.055851
2025-06-10 01:27:25,800 INFO     Hit10: 0.130319
2025-06-10 01:27:25,800 INFO     MR   : 1136.585106
2025-06-10 01:27:25,800 INFO     MRR  : 0.057037
2025-06-10 01:27:25,800 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:27:30,906 INFO     Data : 440
2025-06-10 01:27:30,906 INFO     Hit1 : 0.056818
2025-06-10 01:27:30,906 INFO     Hit3 : 0.100000
2025-06-10 01:27:30,906 INFO     Hit10: 0.163636
2025-06-10 01:27:30,906 INFO     MR   : 1174.578409
2025-06-10 01:27:30,906 INFO     MRR  : 0.092870
2025-06-10 01:27:30,906 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:30:27,466 INFO     1000 1231
2025-06-10 01:31:07,329 INFO     >>>>> Generator: Training
2025-06-10 01:31:09,298 INFO     -------------------------
2025-06-10 01:31:09,298 INFO     | EM Iteration: 4/5
2025-06-10 01:31:09,298 INFO     -------------------------
2025-06-10 01:31:09,298 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:31:09,634 INFO     Predictor: read 985 rules from list.
2025-06-10 01:31:09,634 INFO     Preprocess training set
2025-06-10 01:31:09,635 INFO     >>>>> Predictor: Training
2025-06-10 01:33:38,461 INFO     1000 1231 8.602392 69366.7
2025-06-10 01:34:13,362 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:34:19,585 INFO     Data : 376
2025-06-10 01:34:19,585 INFO     Hit1 : 0.026596
2025-06-10 01:34:19,585 INFO     Hit3 : 0.045213
2025-06-10 01:34:19,585 INFO     Hit10: 0.106383
2025-06-10 01:34:19,585 INFO     MR   : 1293.910904
2025-06-10 01:34:19,585 INFO     MRR  : 0.054370
2025-06-10 01:34:19,585 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:34:26,909 INFO     Data : 440
2025-06-10 01:34:26,909 INFO     Hit1 : 0.043182
2025-06-10 01:34:26,909 INFO     Hit3 : 0.079545
2025-06-10 01:34:26,909 INFO     Hit10: 0.138636
2025-06-10 01:34:26,909 INFO     MR   : 1262.655682
2025-06-10 01:34:26,909 INFO     MRR  : 0.078053
2025-06-10 01:34:26,909 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:37:25,883 INFO     1000 1231
2025-06-10 01:38:07,496 INFO     >>>>> Generator: Training
2025-06-10 01:38:09,357 INFO     -------------------------
2025-06-10 01:38:09,357 INFO     | EM Iteration: 5/5
2025-06-10 01:38:09,357 INFO     -------------------------
2025-06-10 01:38:09,357 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:38:09,689 INFO     Predictor: read 1000 rules from list.
2025-06-10 01:38:09,689 INFO     Preprocess training set
2025-06-10 01:38:09,690 INFO     >>>>> Predictor: Training
2025-06-10 01:40:41,402 INFO     1000 1231 8.609097 69384.0
2025-06-10 01:41:16,599 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:41:22,444 INFO     Data : 376
2025-06-10 01:41:22,444 INFO     Hit1 : 0.031915
2025-06-10 01:41:22,444 INFO     Hit3 : 0.077128
2025-06-10 01:41:22,444 INFO     Hit10: 0.132979
2025-06-10 01:41:22,444 INFO     MR   : 1239.509309
2025-06-10 01:41:22,444 INFO     MRR  : 0.068982
2025-06-10 01:41:22,444 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:41:29,333 INFO     Data : 440
2025-06-10 01:41:29,333 INFO     Hit1 : 0.052273
2025-06-10 01:41:29,333 INFO     Hit3 : 0.090909
2025-06-10 01:41:29,333 INFO     Hit10: 0.159091
2025-06-10 01:41:29,333 INFO     MR   : 1174.951136
2025-06-10 01:41:29,333 INFO     MRR  : 0.089524
2025-06-10 01:41:29,333 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:44:30,546 INFO     1000 1231
2025-06-10 01:45:12,723 INFO     >>>>> Generator: Training
2025-06-10 01:45:14,612 INFO     -------------------------
2025-06-10 01:45:14,612 INFO     | Post-train Generator
2025-06-10 01:45:14,612 INFO     -------------------------
2025-06-10 01:45:14,615 INFO     >>>>> Generator: Training
2025-06-10 01:45:33,379 INFO     [E1000] Total: 1.121909 | Main: 1.277988 | Aux: 0.497590
2025-06-10 01:45:33,379 INFO     -------------------------
2025-06-10 01:45:33,379 INFO     | Beam Search Best Rules
2025-06-10 01:45:33,380 INFO     -------------------------
2025-06-10 01:45:33,380 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:45:34,215 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:45:39,206 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:46:19,711 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:46:47,840 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:47:08,047 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 01:47:08,047 INFO     Subset ratio: 0.1
2025-06-10 01:47:08,048 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 01:47:08,048 INFO     -------------------------
2025-06-10 01:47:08,048 INFO     | Train Final Predictor+
2025-06-10 01:47:08,048 INFO     -------------------------
2025-06-10 01:47:08,050 INFO     Predictor+: read 1842 rules from list.
2025-06-10 01:47:08,055 INFO     Preprocess training set
2025-06-10 01:47:08,057 INFO     -------------------------
2025-06-10 01:47:08,057 INFO     | Iteration: 1/5
2025-06-10 01:47:08,057 INFO     -------------------------
2025-06-10 01:47:08,057 INFO     >>>>> Predictor: Training
2025-06-10 01:50:20,386 INFO     1000 1231 6.145111 69305.9
2025-06-10 01:51:06,814 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:51:15,144 INFO     Data : 376
2025-06-10 01:51:15,144 INFO     Hit1 : 0.034574
2025-06-10 01:51:15,145 INFO     Hit3 : 0.071809
2025-06-10 01:51:15,145 INFO     Hit10: 0.148936
2025-06-10 01:51:15,145 INFO     MR   : 1643.930851
2025-06-10 01:51:15,145 INFO     MRR  : 0.071900
2025-06-10 01:51:15,145 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:51:24,958 INFO     Data : 440
2025-06-10 01:51:24,958 INFO     Hit1 : 0.043182
2025-06-10 01:51:24,958 INFO     Hit3 : 0.072727
2025-06-10 01:51:24,958 INFO     Hit10: 0.145455
2025-06-10 01:51:24,958 INFO     MR   : 1585.385227
2025-06-10 01:51:24,958 INFO     MRR  : 0.076230
2025-06-10 01:51:24,958 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 01:51:24,961 INFO     -------------------------
2025-06-10 01:51:24,961 INFO     | Iteration: 2/5
2025-06-10 01:51:24,961 INFO     -------------------------
2025-06-10 01:51:24,961 INFO     >>>>> Predictor: Training
2025-06-10 01:54:46,643 INFO     1000 1231 5.930874 69366.7
2025-06-10 01:55:32,547 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:55:40,853 INFO     Data : 376
2025-06-10 01:55:40,853 INFO     Hit1 : 0.031915
2025-06-10 01:55:40,853 INFO     Hit3 : 0.090426
2025-06-10 01:55:40,853 INFO     Hit10: 0.170213
2025-06-10 01:55:40,853 INFO     MR   : 1518.765957
2025-06-10 01:55:40,853 INFO     MRR  : 0.077256
2025-06-10 01:55:40,854 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:55:50,650 INFO     Data : 440
2025-06-10 01:55:50,651 INFO     Hit1 : 0.047727
2025-06-10 01:55:50,651 INFO     Hit3 : 0.077273
2025-06-10 01:55:50,651 INFO     Hit10: 0.145455
2025-06-10 01:55:50,651 INFO     MR   : 1476.281818
2025-06-10 01:55:50,651 INFO     MRR  : 0.079748
2025-06-10 01:55:50,651 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 01:55:50,654 INFO     -------------------------
2025-06-10 01:55:50,654 INFO     | Iteration: 3/5
2025-06-10 01:55:50,654 INFO     -------------------------
2025-06-10 01:55:50,654 INFO     >>>>> Predictor: Training
2025-06-10 01:59:12,818 INFO     1000 1231 5.838607 69384.0
2025-06-10 01:59:59,577 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:00:07,919 INFO     Data : 376
2025-06-10 02:00:07,920 INFO     Hit1 : 0.042553
2025-06-10 02:00:07,920 INFO     Hit3 : 0.082447
2025-06-10 02:00:07,920 INFO     Hit10: 0.154255
2025-06-10 02:00:07,920 INFO     MR   : 1481.058511
2025-06-10 02:00:07,920 INFO     MRR  : 0.081142
2025-06-10 02:00:07,920 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:00:17,779 INFO     Data : 440
2025-06-10 02:00:17,779 INFO     Hit1 : 0.050000
2025-06-10 02:00:17,779 INFO     Hit3 : 0.088636
2025-06-10 02:00:17,779 INFO     Hit10: 0.150000
2025-06-10 02:00:17,780 INFO     MR   : 1459.114773
2025-06-10 02:00:17,780 INFO     MRR  : 0.084461
2025-06-10 02:00:17,780 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 02:00:17,783 INFO     -------------------------
2025-06-10 02:00:17,783 INFO     | Iteration: 4/5
2025-06-10 02:00:17,783 INFO     -------------------------
2025-06-10 02:00:17,783 INFO     >>>>> Predictor: Training
2025-06-10 02:03:39,277 INFO     1000 1231 5.849686 69340.6
2025-06-10 02:04:25,551 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:04:33,837 INFO     Data : 376
2025-06-10 02:04:33,837 INFO     Hit1 : 0.047872
2025-06-10 02:04:33,837 INFO     Hit3 : 0.087766
2025-06-10 02:04:33,837 INFO     Hit10: 0.170213
2025-06-10 02:04:33,837 INFO     MR   : 1448.289894
2025-06-10 02:04:33,837 INFO     MRR  : 0.085613
2025-06-10 02:04:33,837 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:04:43,498 INFO     Data : 440
2025-06-10 02:04:43,498 INFO     Hit1 : 0.043182
2025-06-10 02:04:43,498 INFO     Hit3 : 0.090909
2025-06-10 02:04:43,498 INFO     Hit10: 0.147727
2025-06-10 02:04:43,498 INFO     MR   : 1371.406818
2025-06-10 02:04:43,498 INFO     MRR  : 0.081985
2025-06-10 02:04:43,498 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 02:04:43,502 INFO     -------------------------
2025-06-10 02:04:43,502 INFO     | Iteration: 5/5
2025-06-10 02:04:43,502 INFO     -------------------------
2025-06-10 02:04:43,502 INFO     >>>>> Predictor: Training
2025-06-10 02:08:04,669 INFO     1000 1231 5.847723 69340.6
2025-06-10 02:08:50,553 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:08:58,871 INFO     Data : 376
2025-06-10 02:08:58,871 INFO     Hit1 : 0.039894
2025-06-10 02:08:58,871 INFO     Hit3 : 0.071809
2025-06-10 02:08:58,871 INFO     Hit10: 0.170213
2025-06-10 02:08:58,871 INFO     MR   : 1452.513298
2025-06-10 02:08:58,871 INFO     MRR  : 0.077646
2025-06-10 02:08:58,871 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:09:08,725 INFO     Data : 440
2025-06-10 02:09:08,726 INFO     Hit1 : 0.036364
2025-06-10 02:09:08,726 INFO     Hit3 : 0.084091
2025-06-10 02:09:08,726 INFO     Hit10: 0.150000
2025-06-10 02:09:08,726 INFO     MR   : 1385.234091
2025-06-10 02:09:08,726 INFO     MRR  : 0.075558
2025-06-10 02:09:08,726 INFO     -------------------------
2025-06-10 02:09:08,726 INFO     | Final Test MRR: 0.081985
2025-06-10 02:09:08,726 INFO     -------------------------
entity size:  8673
relation size:  20
