2025-07-09 10:08:30,628 INFO     is_soft_label: False
2025-07-09 10:08:30,628 INFO     is_scheduled_sampling: False
2025-07-09 10:08:30,628 INFO     is_test_mode: True
2025-07-09 10:08:30,829 INFO     Data loading | DONE!
2025-07-09 10:08:30,923 INFO     Using full datasets for training, validation, and testing.
2025-07-09 10:08:31,041 INFO     -------------------------
2025-07-09 10:08:31,041 INFO     | EM Iteration: 1/2
2025-07-09 10:08:31,041 INFO     -------------------------
2025-07-09 10:08:31,041 INFO     >>>>> Using miner's rule
2025-07-09 10:08:31,041 INFO     Predictor: read 10 rules from list.
2025-07-09 10:08:31,680 INFO     Preprocess training set
2025-07-09 10:08:31,743 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:08:35,682 INFO     Data : 2077
2025-07-09 10:08:35,683 INFO     Hit1 : 0.000115
2025-07-09 10:08:35,683 INFO     Hit3 : 0.000346
2025-07-09 10:08:35,683 INFO     Hit10: 0.001154
2025-07-09 10:08:35,683 INFO     MR   : 4331.678382
2025-07-09 10:08:35,683 INFO     MRR  : 0.001113
2025-07-09 10:08:35,683 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:08:39,881 INFO     Data : 2342
2025-07-09 10:08:39,881 INFO     Hit1 : 0.000115
2025-07-09 10:08:39,881 INFO     Hit3 : 0.000346
2025-07-09 10:08:39,881 INFO     Hit10: 0.001155
2025-07-09 10:08:39,881 INFO     MR   : 4329.545474
2025-07-09 10:08:39,881 INFO     MRR  : 0.001114
2025-07-09 10:08:39,882 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:08:40,468 INFO     1000 5959
2025-07-09 10:08:40,977 INFO     2000 5959
2025-07-09 10:08:41,485 INFO     3000 5959
2025-07-09 10:08:42,003 INFO     4000 5959
2025-07-09 10:08:42,551 INFO     5000 5959
2025-07-09 10:08:43,037 INFO     >>>>> Generator: Training
2025-07-09 10:08:43,209 INFO     [E00001] Total 90.051292 | Main 3.042316 | RelClus 1.933772 | EntType 94.648384
2025-07-09 10:08:43,234 INFO     [E00002] Total 90.038010 | Main 3.042093 | RelClus 1.935131 | EntType 94.636047
2025-07-09 10:08:43,259 INFO     [E00003] Total 90.031464 | Main 3.041987 | RelClus 1.935379 | EntType 94.629601
2025-07-09 10:08:43,284 INFO     [E00004] Total 90.018929 | Main 3.042516 | RelClus 1.935709 | EntType 94.617760
2025-07-09 10:08:43,309 INFO     [E00005] Total 90.002625 | Main 3.041474 | RelClus 1.936035 | EntType 94.600792
2025-07-09 10:08:43,334 INFO     [E00006] Total 89.988403 | Main 3.042185 | RelClus 1.935471 | EntType 94.586617
2025-07-09 10:08:43,359 INFO     [E00007] Total 89.981644 | Main 3.041915 | RelClus 1.936867 | EntType 94.580826
2025-07-09 10:08:43,383 INFO     [E00008] Total 89.968155 | Main 3.042340 | RelClus 1.936049 | EntType 94.566940
2025-07-09 10:08:43,408 INFO     [E00009] Total 89.952194 | Main 3.042441 | RelClus 1.936188 | EntType 94.551117
2025-07-09 10:08:43,434 INFO     [E00010] Total 89.937462 | Main 3.041855 | RelClus 1.937541 | EntType 94.537003
2025-07-09 10:08:43,434 INFO     -------------------------
2025-07-09 10:08:43,434 INFO     | EM Iteration: 2/2
2025-07-09 10:08:43,434 INFO     -------------------------
2025-07-09 10:08:43,434 INFO     >>>>> Using Generator's sample rule
2025-07-09 10:08:43,434 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 10:08:43,597 INFO     Predictor: read 200 rules from list.
2025-07-09 10:08:43,597 INFO     Preprocess training set
2025-07-09 10:08:43,597 INFO     >>>>> Predictor: Training
2025-07-09 10:08:44,356 INFO     100 5959 9.046578 69210.5
2025-07-09 10:08:45,032 INFO     200 5959 8.987846 69384.0
2025-07-09 10:08:45,715 INFO     300 5959 8.936760 69384.0
2025-07-09 10:08:46,404 INFO     400 5959 8.890705 68863.6
2025-07-09 10:08:47,107 INFO     500 5959 8.854964 69384.0
2025-07-09 10:08:47,788 INFO     600 5959 8.800026 69384.0
2025-07-09 10:08:48,465 INFO     700 5959 8.768143 69384.0
2025-07-09 10:08:49,139 INFO     800 5959 8.762313 69384.0
2025-07-09 10:08:49,823 INFO     900 5959 8.683546 69384.0
2025-07-09 10:08:50,498 INFO     1000 5959 8.655065 69384.0
2025-07-09 10:08:50,499 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:08:52,200 INFO     Data : 2077
2025-07-09 10:08:52,200 INFO     Hit1 : 0.001444
2025-07-09 10:08:52,200 INFO     Hit3 : 0.002407
2025-07-09 10:08:52,200 INFO     Hit10: 0.010111
2025-07-09 10:08:52,200 INFO     MR   : 1630.250120
2025-07-09 10:08:52,200 INFO     MRR  : 0.007905
2025-07-09 10:08:52,200 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:08:54,093 INFO     Data : 2342
2025-07-09 10:08:54,093 INFO     Hit1 : 0.001708
2025-07-09 10:08:54,093 INFO     Hit3 : 0.002135
2025-07-09 10:08:54,093 INFO     Hit10: 0.008967
2025-07-09 10:08:54,093 INFO     MR   : 1540.195986
2025-07-09 10:08:54,093 INFO     MRR  : 0.007465
2025-07-09 10:08:54,093 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:09:08,690 INFO     1000 5959
2025-07-09 10:09:23,244 INFO     2000 5959
2025-07-09 10:09:37,992 INFO     3000 5959
2025-07-09 10:09:52,591 INFO     4000 5959
2025-07-09 10:10:07,187 INFO     5000 5959
2025-07-09 10:10:21,394 INFO     >>>>> Generator: Training
2025-07-09 10:10:21,438 INFO     [E00001] Total 89.960129 | Main 3.048073 | RelClus 1.942273 | EntType 94.569138
2025-07-09 10:10:21,470 INFO     [E00002] Total 89.950172 | Main 3.048157 | RelClus 1.942561 | EntType 94.559456
2025-07-09 10:10:21,501 INFO     [E00003] Total 89.940933 | Main 3.048177 | RelClus 1.942533 | EntType 94.550171
2025-07-09 10:10:21,532 INFO     [E00004] Total 89.932350 | Main 3.047962 | RelClus 1.942502 | EntType 94.541344
2025-07-09 10:10:21,563 INFO     [E00005] Total 89.925262 | Main 3.047804 | RelClus 1.942702 | EntType 94.534271
2025-07-09 10:10:21,593 INFO     [E00006] Total 89.915092 | Main 3.048141 | RelClus 1.942825 | EntType 94.524467
2025-07-09 10:10:21,624 INFO     [E00007] Total 89.907738 | Main 3.048269 | RelClus 1.942490 | EntType 94.516899
2025-07-09 10:10:21,655 INFO     [E00008] Total 89.897896 | Main 3.048020 | RelClus 1.942920 | EntType 94.507164
2025-07-09 10:10:21,685 INFO     [E00009] Total 89.888672 | Main 3.048196 | RelClus 1.942952 | EntType 94.498093
2025-07-09 10:10:21,716 INFO     [E00010] Total 89.880760 | Main 3.048164 | RelClus 1.942998 | EntType 94.490158
2025-07-09 10:10:21,716 INFO     -------------------------
2025-07-09 10:10:21,716 INFO     | Post-train Generator
2025-07-09 10:10:21,716 INFO     -------------------------
2025-07-09 10:10:21,743 INFO     >>>>> Generator: Training
2025-07-09 10:10:21,776 INFO     [E00001] Total 89.869400 | Main 3.048638 | RelClus 1.942863 | EntType 94.479034
2025-07-09 10:10:21,808 INFO     [E00002] Total 89.860321 | Main 3.048491 | RelClus 1.942871 | EntType 94.469810
2025-07-09 10:10:21,838 INFO     [E00003] Total 89.852814 | Main 3.048491 | RelClus 1.942906 | EntType 94.462303
2025-07-09 10:10:21,869 INFO     [E00004] Total 89.843231 | Main 3.048379 | RelClus 1.943154 | EntType 94.452797
2025-07-09 10:10:21,900 INFO     [E00005] Total 89.833252 | Main 3.048455 | RelClus 1.943291 | EntType 94.442970
2025-07-09 10:10:21,931 INFO     [E00006] Total 89.824562 | Main 3.048378 | RelClus 1.943318 | EntType 94.434212
2025-07-09 10:10:21,961 INFO     [E00007] Total 89.814980 | Main 3.048617 | RelClus 1.943483 | EntType 94.424927
2025-07-09 10:10:21,993 INFO     [E00008] Total 89.806572 | Main 3.048708 | RelClus 1.943089 | EntType 94.416229
2025-07-09 10:10:22,024 INFO     [E00009] Total 89.796600 | Main 3.048769 | RelClus 1.943410 | EntType 94.406548
2025-07-09 10:10:22,055 INFO     [E00010] Total 89.786987 | Main 3.048543 | RelClus 1.943666 | EntType 94.396935
2025-07-09 10:10:22,056 INFO     -------------------------
2025-07-09 10:10:22,056 INFO     | Beam Search Best Rules
2025-07-09 10:10:22,056 INFO     -------------------------
2025-07-09 10:10:22,056 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 10:10:22,766 INFO     -------------------------
2025-07-09 10:10:22,766 INFO     | Train Final Predictor+
2025-07-09 10:10:22,766 INFO     -------------------------
2025-07-09 10:10:22,767 INFO     Predictor+: read 420 rules from list.
2025-07-09 10:10:22,768 INFO     Preprocess training set
2025-07-09 10:10:22,769 INFO     -------------------------
2025-07-09 10:10:22,769 INFO     | Iteration: 1/1
2025-07-09 10:10:22,769 INFO     -------------------------
2025-07-09 10:10:22,769 INFO     >>>>> Predictor: Training
2025-07-09 10:10:23,563 INFO     100 5959 5.937507 69384.0
2025-07-09 10:10:24,313 INFO     200 5959 5.318260 69384.0
2025-07-09 10:10:25,058 INFO     300 5959 5.199891 69384.0
2025-07-09 10:10:25,804 INFO     400 5959 5.363072 69384.0
2025-07-09 10:10:26,539 INFO     500 5959 5.293802 69210.5
2025-07-09 10:10:27,269 INFO     600 5959 5.187811 69037.1
2025-07-09 10:10:28,001 INFO     700 5959 5.167365 69384.0
2025-07-09 10:10:28,743 INFO     800 5959 5.139065 69384.0
2025-07-09 10:10:29,486 INFO     900 5959 5.082262 69384.0
2025-07-09 10:10:30,228 INFO     1000 5959 5.231181 69384.0
2025-07-09 10:10:30,228 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:10:32,096 INFO     Data : 2077
2025-07-09 10:10:32,096 INFO     Hit1 : 0.062590
2025-07-09 10:10:32,096 INFO     Hit3 : 0.107366
2025-07-09 10:10:32,096 INFO     Hit10: 0.170438
2025-07-09 10:10:32,096 INFO     MR   : 1451.920799
2025-07-09 10:10:32,096 INFO     MRR  : 0.098662
2025-07-09 10:10:32,097 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:10:34,195 INFO     Data : 2342
2025-07-09 10:10:34,195 INFO     Hit1 : 0.077711
2025-07-09 10:10:34,195 INFO     Hit3 : 0.121691
2025-07-09 10:10:34,195 INFO     Hit10: 0.171221
2025-07-09 10:10:34,195 INFO     MR   : 1396.666524
2025-07-09 10:10:34,195 INFO     MRR  : 0.110814
2025-07-09 10:10:34,195 INFO     Save checkpoint to results/sm_test/semmeddb/10_times_each/cluster_k/7_20250709_100829/predictor.pt
2025-07-09 10:10:34,198 INFO     -------------------------
2025-07-09 10:10:34,198 INFO     | Final Test MRR: 0.110814
2025-07-09 10:10:34,198 INFO     -------------------------
entity size:  8673
relation size:  20
