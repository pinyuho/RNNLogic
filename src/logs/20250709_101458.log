2025-07-09 10:14:59,819 INFO     is_soft_label: False
2025-07-09 10:14:59,819 INFO     is_scheduled_sampling: False
2025-07-09 10:14:59,819 INFO     is_test_mode: False
2025-07-09 10:15:00,022 INFO     Data loading | DONE!
2025-07-09 10:15:00,115 INFO     Using full datasets for training, validation, and testing.
2025-07-09 10:15:00,235 INFO     -------------------------
2025-07-09 10:15:00,235 INFO     | EM Iteration: 1/5
2025-07-09 10:15:00,235 INFO     -------------------------
2025-07-09 10:15:00,235 INFO     >>>>> Using miner's rule
2025-07-09 10:15:00,259 INFO     Predictor: read 13661 rules from list.
/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(os.path.join(cfg.data.data_path, 'predictor_init.pt'))
2025-07-09 10:15:00,962 INFO     Preprocess training set
2025-07-09 10:15:00,963 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:16:55,999 INFO     Data : 2077
2025-07-09 10:16:55,999 INFO     Hit1 : 0.065479
2025-07-09 10:16:55,999 INFO     Hit3 : 0.127106
2025-07-09 10:16:55,999 INFO     Hit10: 0.199326
2025-07-09 10:16:55,999 INFO     MR   : 1120.902022
2025-07-09 10:16:55,999 INFO     MRR  : 0.114382
2025-07-09 10:16:56,000 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:19:03,862 INFO     Data : 2342
2025-07-09 10:19:03,862 INFO     Hit1 : 0.078992
2025-07-09 10:19:03,862 INFO     Hit3 : 0.124253
2025-07-09 10:19:03,862 INFO     Hit10: 0.208796
2025-07-09 10:19:03,862 INFO     MR   : 1044.269001
2025-07-09 10:19:03,862 INFO     MRR  : 0.122250
2025-07-09 10:19:03,862 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:46:59,064 INFO     1000 5959
2025-07-09 11:15:32,969 INFO     2000 5959
2025-07-09 11:43:47,388 INFO     3000 5959
2025-07-09 12:12:17,852 INFO     4000 5959
2025-07-09 12:40:37,101 INFO     5000 5959
2025-07-09 13:09:26,312 INFO     >>>>> Generator: Training
2025-07-09 13:09:30,348 INFO     -------------------------
2025-07-09 13:09:30,349 INFO     | EM Iteration: 2/5
2025-07-09 13:09:30,349 INFO     -------------------------
2025-07-09 13:09:30,349 INFO     >>>>> Using Generator's sample rule
2025-07-09 13:09:30,349 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 13:09:30,516 INFO     Predictor: read 1909 rules from list.
2025-07-09 13:09:30,517 INFO     Preprocess training set
2025-07-09 13:09:30,518 INFO     >>>>> Predictor: Training
2025-07-09 13:10:17,873 INFO     1000 5959 8.782359 69314.6
2025-07-09 13:11:05,267 INFO     2000 5959 8.410202 69271.3
2025-07-09 13:11:53,039 INFO     3000 5959 8.219380 69245.2
2025-07-09 13:12:40,459 INFO     4000 5959 8.065945 69340.6
2025-07-09 13:13:27,900 INFO     5000 5959 7.942117 69340.6
2025-07-09 13:14:13,537 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 13:14:23,157 INFO     Data : 2077
2025-07-09 13:14:23,157 INFO     Hit1 : 0.025036
2025-07-09 13:14:23,157 INFO     Hit3 : 0.040924
2025-07-09 13:14:23,157 INFO     Hit10: 0.064516
2025-07-09 13:14:23,157 INFO     MR   : 1409.490371
2025-07-09 13:14:23,158 INFO     MRR  : 0.041246
2025-07-09 13:14:23,158 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 13:14:33,941 INFO     Data : 2342
2025-07-09 13:14:33,941 INFO     Hit1 : 0.019641
2025-07-09 13:14:33,942 INFO     Hit3 : 0.031170
2025-07-09 13:14:33,942 INFO     Hit10: 0.058497
2025-07-09 13:14:33,942 INFO     MR   : 1316.030316
2025-07-09 13:14:33,942 INFO     MRR  : 0.035233
2025-07-09 13:14:33,942 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 13:16:50,921 INFO     1000 5959
2025-07-09 13:19:06,036 INFO     2000 5959
2025-07-09 13:21:20,628 INFO     3000 5959
2025-07-09 13:23:34,908 INFO     4000 5959
2025-07-09 13:25:49,387 INFO     5000 5959
2025-07-09 13:28:00,661 INFO     >>>>> Generator: Training
2025-07-09 13:28:04,392 INFO     -------------------------
2025-07-09 13:28:04,393 INFO     | EM Iteration: 3/5
2025-07-09 13:28:04,393 INFO     -------------------------
2025-07-09 13:28:04,393 INFO     >>>>> Using Generator's sample rule
2025-07-09 13:28:04,393 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 13:28:04,523 INFO     Predictor: read 1891 rules from list.
2025-07-09 13:28:04,524 INFO     Preprocess training set
2025-07-09 13:28:04,524 INFO     >>>>> Predictor: Training
2025-07-09 13:28:51,210 INFO     1000 5959 8.811351 69332.0
2025-07-09 13:29:38,092 INFO     2000 5959 8.473575 69349.3
2025-07-09 13:30:24,854 INFO     3000 5959 8.262602 69184.5
2025-07-09 13:31:11,365 INFO     4000 5959 8.094345 69253.9
2025-07-09 13:31:57,016 INFO     5000 5959 8.001122 69332.0
2025-07-09 13:32:40,861 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 13:32:50,090 INFO     Data : 2077
2025-07-09 13:32:50,090 INFO     Hit1 : 0.010592
2025-07-09 13:32:50,090 INFO     Hit3 : 0.025518
2025-07-09 13:32:50,090 INFO     Hit10: 0.051517
2025-07-09 13:32:50,090 INFO     MR   : 1449.479297
2025-07-09 13:32:50,090 INFO     MRR  : 0.026726
2025-07-09 13:32:50,091 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 13:33:00,715 INFO     Data : 2342
2025-07-09 13:33:00,716 INFO     Hit1 : 0.014091
2025-07-09 13:33:00,716 INFO     Hit3 : 0.024765
2025-07-09 13:33:00,716 INFO     Hit10: 0.047395
2025-07-09 13:33:00,716 INFO     MR   : 1338.970111
2025-07-09 13:33:00,716 INFO     MRR  : 0.028010
2025-07-09 13:33:00,716 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 13:35:11,219 INFO     1000 5959
2025-07-09 13:37:21,835 INFO     2000 5959
2025-07-09 13:39:32,218 INFO     3000 5959
2025-07-09 13:41:43,188 INFO     4000 5959
2025-07-09 13:43:54,835 INFO     5000 5959
2025-07-09 13:46:03,582 INFO     >>>>> Generator: Training
2025-07-09 13:46:07,294 INFO     -------------------------
2025-07-09 13:46:07,294 INFO     | EM Iteration: 4/5
2025-07-09 13:46:07,294 INFO     -------------------------
2025-07-09 13:46:07,294 INFO     >>>>> Using Generator's sample rule
2025-07-09 13:46:07,294 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 13:46:07,426 INFO     Predictor: read 1925 rules from list.
2025-07-09 13:46:07,427 INFO     Preprocess training set
2025-07-09 13:46:07,427 INFO     >>>>> Predictor: Training
2025-07-09 13:46:55,085 INFO     1000 5959 8.795411 69271.3
2025-07-09 13:47:42,612 INFO     2000 5959 8.414998 69340.6
2025-07-09 13:48:30,101 INFO     3000 5959 8.156684 69384.0
2025-07-09 13:49:17,595 INFO     4000 5959 7.988088 69262.6
2025-07-09 13:50:05,112 INFO     5000 5959 7.847948 69332.0
2025-07-09 13:50:50,581 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 13:51:00,143 INFO     Data : 2077
2025-07-09 13:51:00,143 INFO     Hit1 : 0.001444
2025-07-09 13:51:00,143 INFO     Hit3 : 0.004333
2025-07-09 13:51:00,143 INFO     Hit10: 0.014444
2025-07-09 13:51:00,143 INFO     MR   : 1507.776601
2025-07-09 13:51:00,143 INFO     MRR  : 0.009350
2025-07-09 13:51:00,144 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 13:51:10,933 INFO     Data : 2342
2025-07-09 13:51:10,933 INFO     Hit1 : 0.001281
2025-07-09 13:51:10,934 INFO     Hit3 : 0.008540
2025-07-09 13:51:10,934 INFO     Hit10: 0.017933
2025-07-09 13:51:10,934 INFO     MR   : 1397.216482
2025-07-09 13:51:10,934 INFO     MRR  : 0.010721
2025-07-09 13:51:10,934 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 13:53:27,430 INFO     1000 5959
2025-07-09 13:55:43,140 INFO     2000 5959
2025-07-09 13:57:57,853 INFO     3000 5959
2025-07-09 14:00:14,641 INFO     4000 5959
2025-07-09 14:02:31,626 INFO     5000 5959
2025-07-09 14:04:42,721 INFO     >>>>> Generator: Training
2025-07-09 14:04:46,432 INFO     -------------------------
2025-07-09 14:04:46,432 INFO     | EM Iteration: 5/5
2025-07-09 14:04:46,432 INFO     -------------------------
2025-07-09 14:04:46,432 INFO     >>>>> Using Generator's sample rule
2025-07-09 14:04:46,432 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 14:04:46,564 INFO     Predictor: read 1962 rules from list.
2025-07-09 14:04:46,564 INFO     Preprocess training set
2025-07-09 14:04:46,564 INFO     >>>>> Predictor: Training
2025-07-09 14:05:35,281 INFO     1000 5959 8.829939 69332.0
2025-07-09 14:06:24,330 INFO     2000 5959 8.509451 69349.3
2025-07-09 14:07:13,530 INFO     3000 5959 8.320671 69340.6
2025-07-09 14:08:02,602 INFO     4000 5959 8.181525 69297.3
2025-07-09 14:08:51,744 INFO     5000 5959 8.064870 69219.2
2025-07-09 14:09:37,971 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 14:09:48,132 INFO     Data : 2077
2025-07-09 14:09:48,132 INFO     Hit1 : 0.011074
2025-07-09 14:09:48,132 INFO     Hit3 : 0.019740
2025-07-09 14:09:48,132 INFO     Hit10: 0.038036
2025-07-09 14:09:48,132 INFO     MR   : 1527.052480
2025-07-09 14:09:48,132 INFO     MRR  : 0.023447
2025-07-09 14:09:48,133 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 14:09:59,568 INFO     Data : 2342
2025-07-09 14:09:59,568 INFO     Hit1 : 0.012383
2025-07-09 14:09:59,568 INFO     Hit3 : 0.020922
2025-07-09 14:09:59,568 INFO     Hit10: 0.035440
2025-07-09 14:09:59,568 INFO     MR   : 1405.402007
2025-07-09 14:09:59,569 INFO     MRR  : 0.024157
2025-07-09 14:09:59,569 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 14:12:15,648 INFO     1000 5959
2025-07-09 14:14:32,005 INFO     2000 5959
2025-07-09 14:16:47,928 INFO     3000 5959
2025-07-09 14:19:06,065 INFO     4000 5959
2025-07-09 14:21:24,463 INFO     5000 5959
2025-07-09 14:23:36,616 INFO     >>>>> Generator: Training
2025-07-09 14:23:40,362 INFO     -------------------------
2025-07-09 14:23:40,362 INFO     | Post-train Generator
2025-07-09 14:23:40,362 INFO     -------------------------
2025-07-09 14:23:41,090 INFO     >>>>> Generator: Training
2025-07-09 14:24:19,542 INFO     [E01000] Total 2.978315 | Main 2.891368 | RelClus 1.706351 | EntType 2.861243
2025-07-09 14:24:19,543 INFO     -------------------------
2025-07-09 14:24:19,543 INFO     | Beam Search Best Rules
2025-07-09 14:24:19,543 INFO     -------------------------
2025-07-09 14:24:19,543 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 14:24:20,210 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 14:24:25,097 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 14:25:29,271 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 14:26:21,862 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 14:26:57,927 INFO     -------------------------
2025-07-09 14:26:57,927 INFO     | Train Final Predictor+
2025-07-09 14:26:57,927 INFO     -------------------------
2025-07-09 14:26:57,931 INFO     Predictor+: read 18420 rules from list.
2025-07-09 14:26:57,974 INFO     Preprocess training set
2025-07-09 14:26:57,975 INFO     -------------------------
2025-07-09 14:26:57,975 INFO     | Iteration: 1/5
2025-07-09 14:26:57,975 INFO     -------------------------
2025-07-09 14:26:57,975 INFO     >>>>> Predictor: Training
2025-07-09 14:31:13,146 INFO     1000 5959 4.902960 69271.3
2025-07-09 14:35:27,845 INFO     2000 5959 4.729505 69332.0
2025-07-09 14:39:42,340 INFO     3000 5959 4.709775 69375.3
2025-07-09 14:44:05,931 INFO     4000 5959 4.713605 69279.9
2025-07-09 14:48:29,941 INFO     5000 5959 4.682847 69349.3
2025-07-09 14:52:42,870 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 14:53:48,476 INFO     Data : 2077
2025-07-09 14:53:48,476 INFO     Hit1 : 0.104478
2025-07-09 14:53:48,476 INFO     Hit3 : 0.186808
2025-07-09 14:53:48,476 INFO     Hit10: 0.319210
2025-07-09 14:53:48,476 INFO     MR   : 981.503852
2025-07-09 14:53:48,476 INFO     MRR  : 0.172556
2025-07-09 14:53:48,476 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 14:55:02,093 INFO     Data : 2342
2025-07-09 14:55:02,093 INFO     Hit1 : 0.129804
2025-07-09 14:55:02,093 INFO     Hit3 : 0.213493
2025-07-09 14:55:02,093 INFO     Hit10: 0.317250
2025-07-09 14:55:02,093 INFO     MR   : 919.049317
2025-07-09 14:55:02,093 INFO     MRR  : 0.192756
2025-07-09 14:55:02,094 INFO     Save checkpoint to results/semmeddb/10_times_each/cluster_k/3_20250709_101458/predictor.pt
2025-07-09 14:55:02,101 INFO     -------------------------
2025-07-09 14:55:02,101 INFO     | Iteration: 2/5
2025-07-09 14:55:02,101 INFO     -------------------------
2025-07-09 14:55:02,101 INFO     >>>>> Predictor: Training
2025-07-09 14:59:17,948 INFO     1000 5959 4.604696 69366.7
2025-07-09 15:03:39,211 INFO     2000 5959 4.654195 69375.3
2025-07-09 15:08:03,264 INFO     3000 5959 4.641002 69219.2
2025-07-09 15:12:27,127 INFO     4000 5959 4.654038 69305.9
2025-07-09 15:16:44,897 INFO     5000 5959 4.617525 69288.6
2025-07-09 15:20:51,633 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 15:21:55,293 INFO     Data : 2077
2025-07-09 15:21:55,293 INFO     Hit1 : 0.094367
2025-07-09 15:21:55,293 INFO     Hit3 : 0.183919
2025-07-09 15:21:55,293 INFO     Hit10: 0.310063
2025-07-09 15:21:55,293 INFO     MR   : 948.281656
2025-07-09 15:21:55,293 INFO     MRR  : 0.164004
2025-07-09 15:21:55,293 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 15:23:08,603 INFO     Data : 2342
2025-07-09 15:23:08,603 INFO     Hit1 : 0.124253
2025-07-09 15:23:08,603 INFO     Hit3 : 0.206661
2025-07-09 15:23:08,603 INFO     Hit10: 0.315969
2025-07-09 15:23:08,603 INFO     MR   : 881.872972
2025-07-09 15:23:08,603 INFO     MRR  : 0.188337
2025-07-09 15:23:08,603 INFO     -------------------------
2025-07-09 15:23:08,603 INFO     | Iteration: 3/5
2025-07-09 15:23:08,603 INFO     -------------------------
2025-07-09 15:23:08,603 INFO     >>>>> Predictor: Training
2025-07-09 15:27:33,181 INFO     1000 5959 4.619913 69288.6
2025-07-09 15:31:57,828 INFO     2000 5959 4.618828 69288.6
2025-07-09 15:36:28,263 INFO     3000 5959 4.609075 69340.6
2025-07-09 15:40:49,362 INFO     4000 5959 4.616950 69271.3
2025-07-09 15:45:16,214 INFO     5000 5959 4.642066 69219.2
2025-07-09 15:49:29,833 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 15:50:35,452 INFO     Data : 2077
2025-07-09 15:50:35,452 INFO     Hit1 : 0.089071
2025-07-09 15:50:35,452 INFO     Hit3 : 0.178142
2025-07-09 15:50:35,452 INFO     Hit10: 0.302841
2025-07-09 15:50:35,452 INFO     MR   : 939.012759
2025-07-09 15:50:35,452 INFO     MRR  : 0.160120
2025-07-09 15:50:35,452 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 15:51:49,281 INFO     Data : 2342
2025-07-09 15:51:49,281 INFO     Hit1 : 0.120410
2025-07-09 15:51:49,281 INFO     Hit3 : 0.202818
2025-07-09 15:51:49,281 INFO     Hit10: 0.315969
2025-07-09 15:51:49,281 INFO     MR   : 865.896243
2025-07-09 15:51:49,281 INFO     MRR  : 0.184298
2025-07-09 15:51:49,281 INFO     -------------------------
2025-07-09 15:51:49,282 INFO     | Iteration: 4/5
2025-07-09 15:51:49,282 INFO     -------------------------
2025-07-09 15:51:49,282 INFO     >>>>> Predictor: Training
2025-07-09 15:56:07,387 INFO     1000 5959 4.596143 69340.6
2025-07-09 16:00:23,261 INFO     2000 5959 4.565378 69184.5
2025-07-09 16:04:38,460 INFO     3000 5959 4.628923 69253.9
2025-07-09 16:08:54,007 INFO     4000 5959 4.602533 69340.6
2025-07-09 16:13:13,732 INFO     5000 5959 4.600640 69384.0
2025-07-09 16:17:22,593 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 16:18:26,978 INFO     Data : 2077
2025-07-09 16:18:26,978 INFO     Hit1 : 0.096293
2025-07-09 16:18:26,978 INFO     Hit3 : 0.184401
2025-07-09 16:18:26,978 INFO     Hit10: 0.311026
2025-07-09 16:18:26,978 INFO     MR   : 929.734954
2025-07-09 16:18:26,978 INFO     MRR  : 0.165463
2025-07-09 16:18:26,978 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 16:19:39,298 INFO     Data : 2342
2025-07-09 16:19:39,298 INFO     Hit1 : 0.119556
2025-07-09 16:19:39,298 INFO     Hit3 : 0.209650
2025-07-09 16:19:39,298 INFO     Hit10: 0.321520
2025-07-09 16:19:39,298 INFO     MR   : 861.121477
2025-07-09 16:19:39,298 INFO     MRR  : 0.186349
2025-07-09 16:19:39,299 INFO     -------------------------
2025-07-09 16:19:39,299 INFO     | Iteration: 5/5
2025-07-09 16:19:39,299 INFO     -------------------------
2025-07-09 16:19:39,299 INFO     >>>>> Predictor: Training
2025-07-09 16:23:58,733 INFO     1000 5959 4.607870 69323.3
2025-07-09 16:28:17,975 INFO     2000 5959 4.585963 69332.0
2025-07-09 16:32:37,928 INFO     3000 5959 4.615986 69219.2
2025-07-09 16:36:57,291 INFO     4000 5959 4.613604 69297.3
2025-07-09 16:41:16,819 INFO     5000 5959 4.577016 69332.0
2025-07-09 16:45:25,345 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 16:46:29,691 INFO     Data : 2077
2025-07-09 16:46:29,692 INFO     Hit1 : 0.092441
2025-07-09 16:46:29,692 INFO     Hit3 : 0.180067
2025-07-09 16:46:29,692 INFO     Hit10: 0.316322
2025-07-09 16:46:29,692 INFO     MR   : 919.735195
2025-07-09 16:46:29,692 INFO     MRR  : 0.163006
2025-07-09 16:46:29,692 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 16:47:42,133 INFO     Data : 2342
2025-07-09 16:47:42,133 INFO     Hit1 : 0.127242
2025-07-09 16:47:42,133 INFO     Hit3 : 0.213066
2025-07-09 16:47:42,133 INFO     Hit10: 0.318531
2025-07-09 16:47:42,133 INFO     MR   : 853.373399
2025-07-09 16:47:42,133 INFO     MRR  : 0.191486
2025-07-09 16:47:42,133 INFO     -------------------------
2025-07-09 16:47:42,133 INFO     | Final Test MRR: 0.192756
2025-07-09 16:47:42,133 INFO     -------------------------
entity size:  8673
relation size:  20
