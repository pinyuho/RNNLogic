2025-07-09 10:04:24,446 INFO     is_soft_label: False
2025-07-09 10:04:24,446 INFO     is_scheduled_sampling: False
2025-07-09 10:04:24,446 INFO     is_test_mode: True
2025-07-09 10:04:24,646 INFO     Data loading | DONE!
2025-07-09 10:04:24,741 INFO     Using full datasets for training, validation, and testing.
2025-07-09 10:04:24,858 INFO     -------------------------
2025-07-09 10:04:24,858 INFO     | EM Iteration: 1/2
2025-07-09 10:04:24,858 INFO     -------------------------
2025-07-09 10:04:24,858 INFO     >>>>> Using miner's rule
2025-07-09 10:04:24,858 INFO     Predictor: read 10 rules from list.
2025-07-09 10:04:25,507 INFO     Preprocess training set
2025-07-09 10:04:25,564 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:04:29,539 INFO     Data : 2077
2025-07-09 10:04:29,539 INFO     Hit1 : 0.000115
2025-07-09 10:04:29,539 INFO     Hit3 : 0.000346
2025-07-09 10:04:29,539 INFO     Hit10: 0.001154
2025-07-09 10:04:29,539 INFO     MR   : 4331.678382
2025-07-09 10:04:29,539 INFO     MRR  : 0.001113
2025-07-09 10:04:29,539 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:04:33,743 INFO     Data : 2342
2025-07-09 10:04:33,743 INFO     Hit1 : 0.000115
2025-07-09 10:04:33,743 INFO     Hit3 : 0.000346
2025-07-09 10:04:33,743 INFO     Hit10: 0.001155
2025-07-09 10:04:33,743 INFO     MR   : 4329.545474
2025-07-09 10:04:33,743 INFO     MRR  : 0.001114
2025-07-09 10:04:33,744 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:04:34,315 INFO     1000 5959
2025-07-09 10:04:34,810 INFO     2000 5959
2025-07-09 10:04:35,323 INFO     3000 5959
2025-07-09 10:04:35,818 INFO     4000 5959
2025-07-09 10:04:36,352 INFO     5000 5959
2025-07-09 10:04:36,828 INFO     >>>>> Generator: Training
2025-07-09 10:04:36,999 INFO     [E00001] Total 90.109039 | Main 3.041937 | RelClus 1.637858 | EntType 94.447495
2025-07-09 10:04:37,024 INFO     [E00002] Total 90.091896 | Main 3.042294 | RelClus 1.637078 | EntType 94.429916
2025-07-09 10:04:37,049 INFO     [E00003] Total 90.083282 | Main 3.042482 | RelClus 1.638557 | EntType 94.422714
2025-07-09 10:04:37,073 INFO     [E00004] Total 90.066429 | Main 3.042003 | RelClus 1.638634 | EntType 94.405472
2025-07-09 10:04:37,098 INFO     [E00005] Total 90.050285 | Main 3.042837 | RelClus 1.638197 | EntType 94.389595
2025-07-09 10:04:37,123 INFO     [E00006] Total 90.041046 | Main 3.042876 | RelClus 1.638844 | EntType 94.380928
2025-07-09 10:04:37,149 INFO     [E00007] Total 90.027580 | Main 3.042104 | RelClus 1.639139 | EntType 94.367027
2025-07-09 10:04:37,173 INFO     [E00008] Total 90.016609 | Main 3.043448 | RelClus 1.638628 | EntType 94.356705
2025-07-09 10:04:37,198 INFO     [E00009] Total 90.006187 | Main 3.043582 | RelClus 1.637565 | EntType 94.345428
2025-07-09 10:04:37,223 INFO     [E00010] Total 89.988655 | Main 3.043456 | RelClus 1.640289 | EntType 94.330116
2025-07-09 10:04:37,223 INFO     -------------------------
2025-07-09 10:04:37,223 INFO     | EM Iteration: 2/2
2025-07-09 10:04:37,223 INFO     -------------------------
2025-07-09 10:04:37,223 INFO     >>>>> Using Generator's sample rule
2025-07-09 10:04:37,223 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 10:04:37,381 INFO     Predictor: read 200 rules from list.
2025-07-09 10:04:37,382 INFO     Preprocess training set
2025-07-09 10:04:37,382 INFO     >>>>> Predictor: Training
2025-07-09 10:04:38,121 INFO     100 5959 9.046578 69210.5
2025-07-09 10:04:38,784 INFO     200 5959 8.987846 69384.0
2025-07-09 10:04:39,457 INFO     300 5959 8.936760 69384.0
2025-07-09 10:04:40,143 INFO     400 5959 8.890705 68863.6
2025-07-09 10:04:40,827 INFO     500 5959 8.854964 69384.0
2025-07-09 10:04:41,502 INFO     600 5959 8.800026 69384.0
2025-07-09 10:04:42,207 INFO     700 5959 8.768143 69384.0
2025-07-09 10:04:42,881 INFO     800 5959 8.762313 69384.0
2025-07-09 10:04:43,558 INFO     900 5959 8.683546 69384.0
2025-07-09 10:04:44,227 INFO     1000 5959 8.655065 69384.0
2025-07-09 10:04:44,227 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:04:45,909 INFO     Data : 2077
2025-07-09 10:04:45,910 INFO     Hit1 : 0.001444
2025-07-09 10:04:45,910 INFO     Hit3 : 0.002407
2025-07-09 10:04:45,910 INFO     Hit10: 0.010111
2025-07-09 10:04:45,910 INFO     MR   : 1630.250120
2025-07-09 10:04:45,910 INFO     MRR  : 0.007905
2025-07-09 10:04:45,910 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:04:47,786 INFO     Data : 2342
2025-07-09 10:04:47,786 INFO     Hit1 : 0.001708
2025-07-09 10:04:47,787 INFO     Hit3 : 0.002135
2025-07-09 10:04:47,787 INFO     Hit10: 0.008967
2025-07-09 10:04:47,787 INFO     MR   : 1540.195986
2025-07-09 10:04:47,787 INFO     MRR  : 0.007465
2025-07-09 10:04:47,787 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:05:02,113 INFO     1000 5959
2025-07-09 10:05:16,587 INFO     2000 5959
2025-07-09 10:05:31,031 INFO     3000 5959
2025-07-09 10:05:45,415 INFO     4000 5959
2025-07-09 10:05:59,773 INFO     5000 5959
2025-07-09 10:06:13,714 INFO     >>>>> Generator: Training
2025-07-09 10:06:13,757 INFO     [E00001] Total 90.050880 | Main 3.048049 | RelClus 1.620092 | EntType 94.378708
2025-07-09 10:06:13,790 INFO     [E00002] Total 90.041924 | Main 3.048206 | RelClus 1.619975 | EntType 94.369751
2025-07-09 10:06:13,821 INFO     [E00003] Total 90.033417 | Main 3.048204 | RelClus 1.620348 | EntType 94.361542
2025-07-09 10:06:13,852 INFO     [E00004] Total 90.025223 | Main 3.047892 | RelClus 1.620222 | EntType 94.352936
2025-07-09 10:06:13,883 INFO     [E00005] Total 90.016136 | Main 3.048121 | RelClus 1.620332 | EntType 94.344116
2025-07-09 10:06:13,914 INFO     [E00006] Total 90.006973 | Main 3.048160 | RelClus 1.620254 | EntType 94.334885
2025-07-09 10:06:13,945 INFO     [E00007] Total 89.997597 | Main 3.048384 | RelClus 1.620476 | EntType 94.325859
2025-07-09 10:06:13,976 INFO     [E00008] Total 89.989357 | Main 3.048171 | RelClus 1.620431 | EntType 94.317375
2025-07-09 10:06:14,007 INFO     [E00009] Total 89.980125 | Main 3.048130 | RelClus 1.620466 | EntType 94.308113
2025-07-09 10:06:14,038 INFO     [E00010] Total 89.971176 | Main 3.048733 | RelClus 1.620644 | EntType 94.299797
2025-07-09 10:06:14,039 INFO     -------------------------
2025-07-09 10:06:14,039 INFO     | Post-train Generator
2025-07-09 10:06:14,039 INFO     -------------------------
2025-07-09 10:06:14,066 INFO     >>>>> Generator: Training
2025-07-09 10:06:14,100 INFO     [E00001] Total 89.959602 | Main 3.048397 | RelClus 1.621760 | EntType 94.288879
2025-07-09 10:06:14,131 INFO     [E00002] Total 89.948860 | Main 3.048357 | RelClus 1.621991 | EntType 94.278267
2025-07-09 10:06:14,161 INFO     [E00003] Total 89.940063 | Main 3.048849 | RelClus 1.621950 | EntType 94.269829
2025-07-09 10:06:14,192 INFO     [E00004] Total 89.932022 | Main 3.048532 | RelClus 1.621915 | EntType 94.261459
2025-07-09 10:06:14,223 INFO     [E00005] Total 89.922539 | Main 3.048457 | RelClus 1.622292 | EntType 94.252205
2025-07-09 10:06:14,255 INFO     [E00006] Total 89.915230 | Main 3.048632 | RelClus 1.622017 | EntType 94.244774
2025-07-09 10:06:14,286 INFO     [E00007] Total 89.905701 | Main 3.048636 | RelClus 1.622143 | EntType 94.235336
2025-07-09 10:06:14,317 INFO     [E00008] Total 89.896790 | Main 3.048439 | RelClus 1.622387 | EntType 94.226440
2025-07-09 10:06:14,348 INFO     [E00009] Total 89.885155 | Main 3.048713 | RelClus 1.622778 | EntType 94.215332
2025-07-09 10:06:14,379 INFO     [E00010] Total 89.877113 | Main 3.048799 | RelClus 1.622595 | EntType 94.207184
2025-07-09 10:06:14,380 INFO     -------------------------
2025-07-09 10:06:14,380 INFO     | Beam Search Best Rules
2025-07-09 10:06:14,380 INFO     -------------------------
2025-07-09 10:06:14,380 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 10:06:15,078 INFO     -------------------------
2025-07-09 10:06:15,078 INFO     | Train Final Predictor+
2025-07-09 10:06:15,078 INFO     -------------------------
2025-07-09 10:06:15,079 INFO     Predictor+: read 420 rules from list.
2025-07-09 10:06:15,080 INFO     Preprocess training set
2025-07-09 10:06:15,081 INFO     -------------------------
2025-07-09 10:06:15,081 INFO     | Iteration: 1/1
2025-07-09 10:06:15,081 INFO     -------------------------
2025-07-09 10:06:15,081 INFO     >>>>> Predictor: Training
2025-07-09 10:06:15,864 INFO     100 5959 5.978299 69384.0
2025-07-09 10:06:16,585 INFO     200 5959 5.345207 69384.0
2025-07-09 10:06:17,306 INFO     300 5959 5.201655 69384.0
2025-07-09 10:06:18,035 INFO     400 5959 5.365152 69384.0
2025-07-09 10:06:18,758 INFO     500 5959 5.306408 69210.5
2025-07-09 10:06:19,481 INFO     600 5959 5.189974 69037.1
2025-07-09 10:06:20,218 INFO     700 5959 5.168572 69384.0
2025-07-09 10:06:20,955 INFO     800 5959 5.143486 69384.0
2025-07-09 10:06:21,688 INFO     900 5959 5.096069 69384.0
2025-07-09 10:06:22,435 INFO     1000 5959 5.232721 69384.0
2025-07-09 10:06:22,435 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:06:24,306 INFO     Data : 2077
2025-07-09 10:06:24,306 INFO     Hit1 : 0.064035
2025-07-09 10:06:24,306 INFO     Hit3 : 0.103996
2025-07-09 10:06:24,306 INFO     Hit10: 0.171883
2025-07-09 10:06:24,306 INFO     MR   : 1452.676216
2025-07-09 10:06:24,306 INFO     MRR  : 0.098119
2025-07-09 10:06:24,306 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:06:26,406 INFO     Data : 2342
2025-07-09 10:06:26,406 INFO     Hit1 : 0.075149
2025-07-09 10:06:26,406 INFO     Hit3 : 0.115713
2025-07-09 10:06:26,406 INFO     Hit10: 0.167805
2025-07-09 10:06:26,406 INFO     MR   : 1392.435739
2025-07-09 10:06:26,406 INFO     MRR  : 0.108225
2025-07-09 10:06:26,406 INFO     Save checkpoint to results/sm_test/semmeddb/10_times_each/cluster_k/5_20250709_100423/predictor.pt
2025-07-09 10:06:26,409 INFO     -------------------------
2025-07-09 10:06:26,409 INFO     | Final Test MRR: 0.108225
2025-07-09 10:06:26,409 INFO     -------------------------
entity size:  8673
relation size:  20
