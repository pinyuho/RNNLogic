2025-06-23 21:28:00,851 INFO     Data loading | DONE!
2025-06-23 21:28:02,084 INFO     Using subset datasets for training, validation, and testing.
2025-06-23 21:28:02,085 INFO     Subset ratio: 0.1
2025-06-23 21:28:02,088 INFO     [Subset] TrainDataset: 595/5959 samples (10%)
2025-06-23 21:28:02,091 INFO     [Subset] ValidDataset: 26/260 samples (10%)
2025-06-23 21:28:02,093 INFO     [Subset] TestDataset: 29/293 samples (10%)
2025-06-23 21:28:02,096 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-23 21:28:02,097 INFO     -------------------------
2025-06-23 21:28:02,098 INFO     | Pre-train Generator
2025-06-23 21:28:02,099 INFO     -------------------------
2025-06-23 21:28:02,752 INFO     >>>>> Generator: Training
2025-06-23 21:28:11,611 INFO     1 10 3.035268
2025-06-23 21:28:11,661 INFO     2 10 2.901269
2025-06-23 21:28:11,712 INFO     3 10 2.854052
2025-06-23 21:28:11,762 INFO     4 10 2.508984
2025-06-23 21:28:11,808 INFO     5 10 2.461400
2025-06-23 21:28:11,849 INFO     6 10 2.393885
2025-06-23 21:28:11,900 INFO     7 10 2.247263
2025-06-23 21:28:11,953 INFO     8 10 2.249944
2025-06-23 21:28:11,996 INFO     9 10 2.097890
2025-06-23 21:28:12,048 INFO     10 10 1.988451
2025-06-23 21:28:12,050 INFO     -------------------------
2025-06-23 21:28:12,051 INFO     | EM Iteration: 1/1
2025-06-23 21:28:12,051 INFO     -------------------------
2025-06-23 21:28:12,051 INFO     >>>>> Generator: Rule generation with sampling
2025-06-23 21:28:13,084 INFO     Predictor: read 182 rules from list.
2025-06-23 21:28:13,087 INFO     Preprocess training set
2025-06-23 21:28:13,473 INFO     >>>>> Predictor: Training
2025-06-23 21:28:20,983 INFO     100 595 9.044236 69384.0
2025-06-23 21:28:28,018 INFO     200 595 8.982674 68863.6
2025-06-23 21:28:35,178 INFO     300 595 8.932099 69384.0
2025-06-23 21:28:42,038 INFO     400 595 8.882923 69037.1
2025-06-23 21:28:49,343 INFO     500 595 8.831002 69384.0
2025-06-23 21:28:55,408 INFO     >>>>> Predictor: Evaluating on valid
2025-06-23 21:28:57,148 INFO     Data : 208
2025-06-23 21:28:57,149 INFO     Hit1 : 0.038462
2025-06-23 21:28:57,149 INFO     Hit3 : 0.057692
2025-06-23 21:28:57,149 INFO     Hit10: 0.115385
2025-06-23 21:28:57,149 INFO     MR   : 1639.692308
2025-06-23 21:28:57,149 INFO     MRR  : 0.062746
2025-06-23 21:28:57,150 INFO     >>>>> Predictor: Evaluating on test
2025-06-23 21:28:58,633 INFO     Data : 232
2025-06-23 21:28:58,634 INFO     Hit1 : 0.043103
2025-06-23 21:28:58,636 INFO     Hit3 : 0.081897
2025-06-23 21:28:58,636 INFO     Hit10: 0.133621
2025-06-23 21:28:58,637 INFO     MR   : 1466.237069
2025-06-23 21:28:58,638 INFO     MRR  : 0.075189
2025-06-23 21:28:58,643 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-23 21:29:47,510 INFO     >>>>> Generator: Training
2025-06-23 21:29:47,554 INFO     1 10 2.615498
2025-06-23 21:29:47,584 INFO     2 10 2.613709
2025-06-23 21:29:47,615 INFO     3 10 2.611925
2025-06-23 21:29:47,640 INFO     4 10 2.610145
2025-06-23 21:29:47,671 INFO     5 10 2.608370
2025-06-23 21:29:47,692 INFO     6 10 2.606594
2025-06-23 21:29:47,716 INFO     7 10 2.604822
2025-06-23 21:29:47,745 INFO     8 10 2.603059
2025-06-23 21:29:47,776 INFO     9 10 2.601300
2025-06-23 21:29:47,798 INFO     10 10 2.599548
2025-06-23 21:29:47,800 INFO     -------------------------
2025-06-23 21:29:47,801 INFO     | Post-train Generator
2025-06-23 21:29:47,802 INFO     -------------------------
2025-06-23 21:29:47,803 INFO     >>>>> Generator: Training
2025-06-23 21:29:47,836 INFO     1 10 2.597800
2025-06-23 21:29:47,861 INFO     2 10 2.596044
2025-06-23 21:29:47,887 INFO     3 10 2.594300
2025-06-23 21:29:47,928 INFO     4 10 2.592557
2025-06-23 21:29:47,963 INFO     5 10 2.590819
2025-06-23 21:29:48,002 INFO     6 10 2.589091
2025-06-23 21:29:48,029 INFO     7 10 2.587363
2025-06-23 21:29:48,056 INFO     8 10 2.585635
2025-06-23 21:29:48,083 INFO     9 10 2.583917
2025-06-23 21:29:48,118 INFO     10 10 2.582201
2025-06-23 21:29:48,121 INFO     -------------------------
2025-06-23 21:29:48,123 INFO     | Beam Search Best Rules
2025-06-23 21:29:48,124 INFO     -------------------------
2025-06-23 21:29:48,126 INFO     >>>>> Generator: Rule generation with beam search
2025-06-23 21:29:50,983 INFO     >>>>> Generator: Rule generation with beam search
2025-06-23 21:31:56,369 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-23 21:31:56,370 INFO     Subset ratio: 0.1
2025-06-23 21:31:56,379 INFO     Subset sizes: train=595, valid=26, test=29, rule dataset=1042
2025-06-23 21:31:56,380 INFO     -------------------------
2025-06-23 21:31:56,381 INFO     | Train Final Predictor+
2025-06-23 21:31:56,382 INFO     -------------------------
2025-06-23 21:31:56,395 INFO     Predictor+: read 1042 rules from list.
2025-06-23 21:31:56,416 INFO     Preprocess training set
2025-06-23 21:31:56,425 INFO     -------------------------
2025-06-23 21:31:56,426 INFO     | Iteration: 1/1
2025-06-23 21:31:56,427 INFO     -------------------------
2025-06-23 21:31:56,427 INFO     >>>>> Predictor: Training
2025-06-23 21:32:47,452 INFO     100 595 8.272977 68776.9
2025-06-23 21:33:39,900 INFO     200 595 7.891151 69384.0
2025-06-23 21:34:24,411 INFO     300 595 7.502378 69384.0
2025-06-23 21:35:18,791 INFO     400 595 7.728127 69384.0
2025-06-23 21:36:11,530 INFO     500 595 7.651444 69384.0
entity size:  8673
relation size:  20
Traceback (most recent call last):
  File "/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py", line 214, in <module>
    main(parse_args())
  File "/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py", line 196, in main
    solver_p.train(**cfg.predictorplus.train)
  File "/home/emma/emma/bilab_archive/polly/RNNLogic/src/trainer.py", line 93, in train
    logits, mask = model(all_h, all_r, edges_to_remove) # 這邊的 logits 是 score
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/emma/emma/bilab_archive/polly/RNNLogic/src/predictors.py", line 241, in forward
    count, _ = self.graph.grounding_with_count(all_h, r_head, r_body, edges_to_remove)
  File "/home/emma/emma/bilab_archive/polly/RNNLogic/src/data.py", line 181, in grounding_with_count
    x = torch.nn.functional.one_hot(h, self.entity_size).transpose(0, 1).unsqueeze(-1).cuda(device)
KeyboardInterrupt
