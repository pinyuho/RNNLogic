2025-07-10 05:45:01,732 INFO     is_soft_label: False
2025-07-10 05:45:01,732 INFO     is_scheduled_sampling: False
2025-07-10 05:45:01,732 INFO     is_test_mode: False
2025-07-10 05:45:01,936 INFO     Data loading | DONE!
2025-07-10 05:45:02,029 INFO     Using full datasets for training, validation, and testing.
2025-07-10 05:45:02,153 INFO     -------------------------
2025-07-10 05:45:02,153 INFO     | EM Iteration: 1/5
2025-07-10 05:45:02,153 INFO     -------------------------
2025-07-10 05:45:02,153 INFO     >>>>> Using miner's rule
2025-07-10 05:45:02,177 INFO     Predictor: read 13661 rules from list.
/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(os.path.join(cfg.data.data_path, 'predictor_init.pt'))
2025-07-10 05:45:02,884 INFO     Preprocess training set
2025-07-10 05:45:02,884 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 05:46:57,930 INFO     Data : 2077
2025-07-10 05:46:57,930 INFO     Hit1 : 0.065479
2025-07-10 05:46:57,930 INFO     Hit3 : 0.127106
2025-07-10 05:46:57,930 INFO     Hit10: 0.199326
2025-07-10 05:46:57,930 INFO     MR   : 1120.902022
2025-07-10 05:46:57,930 INFO     MRR  : 0.114382
2025-07-10 05:46:57,930 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 05:49:07,461 INFO     Data : 2342
2025-07-10 05:49:07,461 INFO     Hit1 : 0.078992
2025-07-10 05:49:07,461 INFO     Hit3 : 0.124253
2025-07-10 05:49:07,461 INFO     Hit10: 0.208796
2025-07-10 05:49:07,461 INFO     MR   : 1044.269001
2025-07-10 05:49:07,461 INFO     MRR  : 0.122250
2025-07-10 05:49:07,461 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 06:17:15,617 INFO     1000 5959
2025-07-10 06:45:47,883 INFO     2000 5959
2025-07-10 07:13:58,084 INFO     3000 5959
2025-07-10 07:42:19,521 INFO     4000 5959
2025-07-10 08:10:27,803 INFO     5000 5959
2025-07-10 08:39:06,956 INFO     >>>>> Generator: Training
2025-07-10 08:39:10,866 INFO     -------------------------
2025-07-10 08:39:10,866 INFO     | EM Iteration: 2/5
2025-07-10 08:39:10,867 INFO     -------------------------
2025-07-10 08:39:10,867 INFO     >>>>> Using Generator's sample rule
2025-07-10 08:39:10,867 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 08:39:11,032 INFO     Predictor: read 1910 rules from list.
2025-07-10 08:39:11,032 INFO     Preprocess training set
2025-07-10 08:39:11,033 INFO     >>>>> Predictor: Training
2025-07-10 08:39:58,806 INFO     1000 5959 8.782461 69314.6
2025-07-10 08:40:45,809 INFO     2000 5959 8.410559 69271.3
2025-07-10 08:41:32,664 INFO     3000 5959 8.220156 69245.2
2025-07-10 08:42:19,467 INFO     4000 5959 8.066888 69340.6
2025-07-10 08:43:06,493 INFO     5000 5959 7.944344 69340.6
2025-07-10 08:43:51,037 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 08:44:00,443 INFO     Data : 2077
2025-07-10 08:44:00,443 INFO     Hit1 : 0.025036
2025-07-10 08:44:00,443 INFO     Hit3 : 0.040924
2025-07-10 08:44:00,443 INFO     Hit10: 0.064516
2025-07-10 08:44:00,443 INFO     MR   : 1407.097015
2025-07-10 08:44:00,443 INFO     MRR  : 0.041241
2025-07-10 08:44:00,443 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 08:44:11,007 INFO     Data : 2342
2025-07-10 08:44:11,007 INFO     Hit1 : 0.019641
2025-07-10 08:44:11,007 INFO     Hit3 : 0.031170
2025-07-10 08:44:11,007 INFO     Hit10: 0.058497
2025-07-10 08:44:11,007 INFO     MR   : 1313.751921
2025-07-10 08:44:11,007 INFO     MRR  : 0.035162
2025-07-10 08:44:11,008 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 08:46:26,467 INFO     1000 5959
2025-07-10 08:48:41,813 INFO     2000 5959
2025-07-10 08:50:56,066 INFO     3000 5959
2025-07-10 08:53:09,414 INFO     4000 5959
2025-07-10 08:55:23,010 INFO     5000 5959
2025-07-10 08:57:34,580 INFO     >>>>> Generator: Training
2025-07-10 08:57:38,349 INFO     -------------------------
2025-07-10 08:57:38,349 INFO     | EM Iteration: 3/5
2025-07-10 08:57:38,349 INFO     -------------------------
2025-07-10 08:57:38,349 INFO     >>>>> Using Generator's sample rule
2025-07-10 08:57:38,349 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 08:57:38,485 INFO     Predictor: read 1894 rules from list.
2025-07-10 08:57:38,486 INFO     Preprocess training set
2025-07-10 08:57:38,486 INFO     >>>>> Predictor: Training
2025-07-10 08:58:25,637 INFO     1000 5959 8.811209 69332.0
2025-07-10 08:59:11,702 INFO     2000 5959 8.473440 69349.3
2025-07-10 08:59:57,870 INFO     3000 5959 8.261875 69184.5
2025-07-10 09:00:44,250 INFO     4000 5959 8.093606 69253.9
2025-07-10 09:01:31,407 INFO     5000 5959 8.000334 69332.0
2025-07-10 09:02:16,845 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 09:02:26,633 INFO     Data : 2077
2025-07-10 09:02:26,633 INFO     Hit1 : 0.010592
2025-07-10 09:02:26,633 INFO     Hit3 : 0.025518
2025-07-10 09:02:26,633 INFO     Hit10: 0.051517
2025-07-10 09:02:26,633 INFO     MR   : 1451.022870
2025-07-10 09:02:26,634 INFO     MRR  : 0.026743
2025-07-10 09:02:26,634 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 09:02:37,653 INFO     Data : 2342
2025-07-10 09:02:37,653 INFO     Hit1 : 0.014091
2025-07-10 09:02:37,653 INFO     Hit3 : 0.024765
2025-07-10 09:02:37,653 INFO     Hit10: 0.047395
2025-07-10 09:02:37,653 INFO     MR   : 1340.602263
2025-07-10 09:02:37,653 INFO     MRR  : 0.027999
2025-07-10 09:02:37,653 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 09:04:54,843 INFO     1000 5959
2025-07-10 09:07:09,392 INFO     2000 5959
2025-07-10 09:09:21,858 INFO     3000 5959
2025-07-10 09:11:34,768 INFO     4000 5959
2025-07-10 09:13:47,554 INFO     5000 5959
2025-07-10 09:15:56,348 INFO     >>>>> Generator: Training
2025-07-10 09:16:00,075 INFO     -------------------------
2025-07-10 09:16:00,075 INFO     | EM Iteration: 4/5
2025-07-10 09:16:00,075 INFO     -------------------------
2025-07-10 09:16:00,075 INFO     >>>>> Using Generator's sample rule
2025-07-10 09:16:00,075 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 09:16:00,208 INFO     Predictor: read 1933 rules from list.
2025-07-10 09:16:00,209 INFO     Preprocess training set
2025-07-10 09:16:00,209 INFO     >>>>> Predictor: Training
2025-07-10 09:16:47,347 INFO     1000 5959 8.796442 69271.3
2025-07-10 09:17:35,162 INFO     2000 5959 8.417035 69340.6
2025-07-10 09:18:23,532 INFO     3000 5959 8.160797 69384.0
2025-07-10 09:19:12,101 INFO     4000 5959 7.993579 69262.6
2025-07-10 09:20:00,552 INFO     5000 5959 7.853057 69332.0
2025-07-10 09:20:47,172 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 09:20:56,968 INFO     Data : 2077
2025-07-10 09:20:56,968 INFO     Hit1 : 0.001444
2025-07-10 09:20:56,968 INFO     Hit3 : 0.004333
2025-07-10 09:20:56,968 INFO     Hit10: 0.014444
2025-07-10 09:20:56,968 INFO     MR   : 1508.780934
2025-07-10 09:20:56,969 INFO     MRR  : 0.009344
2025-07-10 09:20:56,969 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 09:21:07,811 INFO     Data : 2342
2025-07-10 09:21:07,811 INFO     Hit1 : 0.001281
2025-07-10 09:21:07,811 INFO     Hit3 : 0.008540
2025-07-10 09:21:07,811 INFO     Hit10: 0.017933
2025-07-10 09:21:07,811 INFO     MR   : 1398.422929
2025-07-10 09:21:07,811 INFO     MRR  : 0.010721
2025-07-10 09:21:07,812 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 09:23:24,673 INFO     1000 5959
2025-07-10 09:25:42,117 INFO     2000 5959
2025-07-10 09:27:59,592 INFO     3000 5959
2025-07-10 09:30:16,393 INFO     4000 5959
2025-07-10 09:32:33,976 INFO     5000 5959
2025-07-10 09:34:48,097 INFO     >>>>> Generator: Training
2025-07-10 09:34:51,837 INFO     -------------------------
2025-07-10 09:34:51,837 INFO     | EM Iteration: 5/5
2025-07-10 09:34:51,837 INFO     -------------------------
2025-07-10 09:34:51,837 INFO     >>>>> Using Generator's sample rule
2025-07-10 09:34:51,837 INFO     >>>>> Generator: Rule generation with sampling
2025-07-10 09:34:52,041 INFO     Predictor: read 1966 rules from list.
2025-07-10 09:34:52,042 INFO     Preprocess training set
2025-07-10 09:34:52,042 INFO     >>>>> Predictor: Training
2025-07-10 09:35:40,251 INFO     1000 5959 8.833061 69332.0
2025-07-10 09:36:28,273 INFO     2000 5959 8.518960 69349.3
2025-07-10 09:37:16,992 INFO     3000 5959 8.330672 69340.6
2025-07-10 09:38:05,594 INFO     4000 5959 8.201629 69297.3
2025-07-10 09:38:54,066 INFO     5000 5959 8.083130 69219.2
2025-07-10 09:39:40,041 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 09:39:49,852 INFO     Data : 2077
2025-07-10 09:39:49,852 INFO     Hit1 : 0.014444
2025-07-10 09:39:49,852 INFO     Hit3 : 0.020703
2025-07-10 09:39:49,852 INFO     Hit10: 0.034184
2025-07-10 09:39:49,852 INFO     MR   : 1534.200048
2025-07-10 09:39:49,852 INFO     MRR  : 0.024229
2025-07-10 09:39:49,853 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 09:40:00,919 INFO     Data : 2342
2025-07-10 09:40:00,919 INFO     Hit1 : 0.011102
2025-07-10 09:40:00,919 INFO     Hit3 : 0.017506
2025-07-10 09:40:00,920 INFO     Hit10: 0.030316
2025-07-10 09:40:00,920 INFO     MR   : 1413.308497
2025-07-10 09:40:00,920 INFO     MRR  : 0.020618
2025-07-10 09:40:00,920 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-10 09:42:16,248 INFO     1000 5959
2025-07-10 09:44:31,581 INFO     2000 5959
2025-07-10 09:46:46,882 INFO     3000 5959
2025-07-10 09:49:02,096 INFO     4000 5959
2025-07-10 09:51:17,269 INFO     5000 5959
2025-07-10 09:53:27,990 INFO     >>>>> Generator: Training
2025-07-10 09:53:31,753 INFO     -------------------------
2025-07-10 09:53:31,753 INFO     | Post-train Generator
2025-07-10 09:53:31,754 INFO     -------------------------
2025-07-10 09:53:32,402 INFO     >>>>> Generator: Training
2025-07-10 09:54:10,983 INFO     [E01000] Total 3.177369 | Main 3.067110 | RelClus 2.233257 | EntType 3.018921
2025-07-10 09:54:10,983 INFO     -------------------------
2025-07-10 09:54:10,983 INFO     | Beam Search Best Rules
2025-07-10 09:54:10,983 INFO     -------------------------
2025-07-10 09:54:10,984 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 09:54:11,653 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 09:54:16,455 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 09:55:19,257 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 09:56:11,097 INFO     >>>>> Generator: Rule generation with beam search
2025-07-10 09:56:46,617 INFO     -------------------------
2025-07-10 09:56:46,617 INFO     | Train Final Predictor+
2025-07-10 09:56:46,617 INFO     -------------------------
2025-07-10 09:56:46,621 INFO     Predictor+: read 18420 rules from list.
2025-07-10 09:56:46,757 INFO     Preprocess training set
2025-07-10 09:56:46,757 INFO     -------------------------
2025-07-10 09:56:46,758 INFO     | Iteration: 1/5
2025-07-10 09:56:46,758 INFO     -------------------------
2025-07-10 09:56:46,758 INFO     >>>>> Predictor: Training
2025-07-10 10:00:56,717 INFO     1000 5959 4.896438 69271.3
2025-07-10 10:05:06,926 INFO     2000 5959 4.726492 69332.0
2025-07-10 10:09:16,651 INFO     3000 5959 4.709085 69375.3
2025-07-10 10:13:27,297 INFO     4000 5959 4.709800 69279.9
2025-07-10 10:17:38,147 INFO     5000 5959 4.681113 69349.3
2025-07-10 10:21:37,953 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 10:22:39,784 INFO     Data : 2077
2025-07-10 10:22:39,784 INFO     Hit1 : 0.103996
2025-07-10 10:22:39,784 INFO     Hit3 : 0.185364
2025-07-10 10:22:39,784 INFO     Hit10: 0.314396
2025-07-10 10:22:39,784 INFO     MR   : 984.254213
2025-07-10 10:22:39,784 INFO     MRR  : 0.170226
2025-07-10 10:22:39,785 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 10:23:49,177 INFO     Data : 2342
2025-07-10 10:23:49,177 INFO     Hit1 : 0.128523
2025-07-10 10:23:49,178 INFO     Hit3 : 0.208369
2025-07-10 10:23:49,178 INFO     Hit10: 0.319385
2025-07-10 10:23:49,178 INFO     MR   : 917.968617
2025-07-10 10:23:49,178 INFO     MRR  : 0.190955
2025-07-10 10:23:49,178 INFO     Save checkpoint to results/semmeddb/10_times_each/cluster_k/6_20250710_054500/predictor.pt
2025-07-10 10:23:49,183 INFO     -------------------------
2025-07-10 10:23:49,183 INFO     | Iteration: 2/5
2025-07-10 10:23:49,183 INFO     -------------------------
2025-07-10 10:23:49,183 INFO     >>>>> Predictor: Training
2025-07-10 10:28:00,249 INFO     1000 5959 4.601495 69366.7
2025-07-10 10:32:11,209 INFO     2000 5959 4.650083 69375.3
2025-07-10 10:36:21,726 INFO     3000 5959 4.642119 69219.2
2025-07-10 10:40:32,182 INFO     4000 5959 4.649689 69305.9
2025-07-10 10:44:42,519 INFO     5000 5959 4.617804 69288.6
2025-07-10 10:48:42,740 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 10:49:44,568 INFO     Data : 2077
2025-07-10 10:49:44,568 INFO     Hit1 : 0.091960
2025-07-10 10:49:44,568 INFO     Hit3 : 0.181993
2025-07-10 10:49:44,568 INFO     Hit10: 0.306692
2025-07-10 10:49:44,568 INFO     MR   : 947.699567
2025-07-10 10:49:44,568 INFO     MRR  : 0.162187
2025-07-10 10:49:44,569 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 10:50:54,097 INFO     Data : 2342
2025-07-10 10:50:54,097 INFO     Hit1 : 0.119129
2025-07-10 10:50:54,097 INFO     Hit3 : 0.204953
2025-07-10 10:50:54,097 INFO     Hit10: 0.315115
2025-07-10 10:50:54,097 INFO     MR   : 881.100982
2025-07-10 10:50:54,097 INFO     MRR  : 0.185350
2025-07-10 10:50:54,097 INFO     -------------------------
2025-07-10 10:50:54,097 INFO     | Iteration: 3/5
2025-07-10 10:50:54,097 INFO     -------------------------
2025-07-10 10:50:54,097 INFO     >>>>> Predictor: Training
2025-07-10 10:55:04,992 INFO     1000 5959 4.613624 69288.6
2025-07-10 10:59:15,898 INFO     2000 5959 4.617837 69288.6
2025-07-10 11:03:30,315 INFO     3000 5959 4.607385 69340.6
2025-07-10 11:07:45,006 INFO     4000 5959 4.615123 69271.3
2025-07-10 11:11:59,022 INFO     5000 5959 4.637461 69219.2
2025-07-10 11:16:02,358 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 11:17:05,441 INFO     Data : 2077
2025-07-10 11:17:05,441 INFO     Hit1 : 0.093885
2025-07-10 11:17:05,441 INFO     Hit3 : 0.180549
2025-07-10 11:17:05,441 INFO     Hit10: 0.298989
2025-07-10 11:17:05,441 INFO     MR   : 937.972557
2025-07-10 11:17:05,441 INFO     MRR  : 0.161810
2025-07-10 11:17:05,441 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 11:18:16,203 INFO     Data : 2342
2025-07-10 11:18:16,203 INFO     Hit1 : 0.115286
2025-07-10 11:18:16,203 INFO     Hit3 : 0.201110
2025-07-10 11:18:16,203 INFO     Hit10: 0.318104
2025-07-10 11:18:16,204 INFO     MR   : 867.954953
2025-07-10 11:18:16,204 INFO     MRR  : 0.181831
2025-07-10 11:18:16,204 INFO     -------------------------
2025-07-10 11:18:16,204 INFO     | Iteration: 4/5
2025-07-10 11:18:16,204 INFO     -------------------------
2025-07-10 11:18:16,204 INFO     >>>>> Predictor: Training
2025-07-10 11:22:31,516 INFO     1000 5959 4.590553 69340.6
2025-07-10 11:26:46,854 INFO     2000 5959 4.561683 69184.5
2025-07-10 11:31:01,498 INFO     3000 5959 4.625438 69253.9
2025-07-10 11:35:16,778 INFO     4000 5959 4.600275 69340.6
2025-07-10 11:39:31,679 INFO     5000 5959 4.597505 69384.0
2025-07-10 11:43:37,392 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 11:44:41,321 INFO     Data : 2077
2025-07-10 11:44:41,321 INFO     Hit1 : 0.096293
2025-07-10 11:44:41,322 INFO     Hit3 : 0.184882
2025-07-10 11:44:41,322 INFO     Hit10: 0.309100
2025-07-10 11:44:41,322 INFO     MR   : 928.425614
2025-07-10 11:44:41,322 INFO     MRR  : 0.166057
2025-07-10 11:44:41,322 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 11:45:53,201 INFO     Data : 2342
2025-07-10 11:45:53,201 INFO     Hit1 : 0.125961
2025-07-10 11:45:53,201 INFO     Hit3 : 0.210931
2025-07-10 11:45:53,202 INFO     Hit10: 0.316396
2025-07-10 11:45:53,202 INFO     MR   : 858.582408
2025-07-10 11:45:53,202 INFO     MRR  : 0.191738
2025-07-10 11:45:53,202 INFO     -------------------------
2025-07-10 11:45:53,202 INFO     | Iteration: 5/5
2025-07-10 11:45:53,202 INFO     -------------------------
2025-07-10 11:45:53,202 INFO     >>>>> Predictor: Training
2025-07-10 11:50:10,039 INFO     1000 5959 4.601392 69323.3
2025-07-10 11:54:26,595 INFO     2000 5959 4.582812 69332.0
2025-07-10 11:58:42,028 INFO     3000 5959 4.613670 69219.2
2025-07-10 12:02:56,138 INFO     4000 5959 4.609889 69297.3
2025-07-10 12:07:09,862 INFO     5000 5959 4.574597 69332.0
2025-07-10 12:11:11,343 INFO     >>>>> Predictor: Evaluating on valid
2025-07-10 12:12:13,219 INFO     Data : 2077
2025-07-10 12:12:13,219 INFO     Hit1 : 0.095330
2025-07-10 12:12:13,219 INFO     Hit3 : 0.189697
2025-07-10 12:12:13,219 INFO     Hit10: 0.311026
2025-07-10 12:12:13,219 INFO     MR   : 919.415744
2025-07-10 12:12:13,219 INFO     MRR  : 0.166053
2025-07-10 12:12:13,219 INFO     >>>>> Predictor: Evaluating on test
2025-07-10 12:13:22,844 INFO     Data : 2342
2025-07-10 12:13:22,844 INFO     Hit1 : 0.122118
2025-07-10 12:13:22,844 INFO     Hit3 : 0.204953
2025-07-10 12:13:22,844 INFO     Hit10: 0.318104
2025-07-10 12:13:22,844 INFO     MR   : 850.432750
2025-07-10 12:13:22,844 INFO     MRR  : 0.187264
2025-07-10 12:13:22,845 INFO     -------------------------
2025-07-10 12:13:22,845 INFO     | Final Test MRR: 0.190955
2025-07-10 12:13:22,845 INFO     -------------------------
entity size:  8673
relation size:  20
