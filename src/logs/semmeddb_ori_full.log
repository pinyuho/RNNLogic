W0618 12:55:05.013147 3519075 torch/distributed/run.py:793] 
W0618 12:55:05.013147 3519075 torch/distributed/run.py:793] *****************************************
W0618 12:55:05.013147 3519075 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0618 12:55:05.013147 3519075 torch/distributed/run.py:793] *****************************************
entity size:  8673
relation size:  20
entity size:  8673
relation size:  20
2025-06-18 12:55:06,709 INFO     Data loading | DONE!
2025-06-18 12:55:06,816 INFO     Using full datasets for training, validation, and testing.
2025-06-18 12:55:06,816 INFO     -------------------------
2025-06-18 12:55:06,816 INFO     | Pre-train Generator
2025-06-18 12:55:06,816 INFO     -------------------------
2025-06-18 12:55:06,947 INFO     >>>>> Generator: Training
2025-06-18 12:55:12,062 INFO     1000 10000 1.640829
2025-06-18 12:55:16,352 INFO     2000 10000 1.555844
2025-06-18 12:55:20,605 INFO     3000 10000 1.544617
2025-06-18 12:55:24,905 INFO     4000 10000 1.539628
2025-06-18 12:55:29,174 INFO     5000 10000 1.541232
2025-06-18 12:55:33,466 INFO     6000 10000 1.537140
2025-06-18 12:55:37,782 INFO     7000 10000 1.535005
2025-06-18 12:55:42,071 INFO     8000 10000 1.534639
2025-06-18 12:55:46,322 INFO     9000 10000 1.533593
2025-06-18 12:55:50,575 INFO     10000 10000 1.531518
2025-06-18 12:55:50,576 INFO     -------------------------
2025-06-18 12:55:50,576 INFO     | EM Iteration: 1/5
2025-06-18 12:55:50,576 INFO     -------------------------
2025-06-18 12:55:50,576 INFO     >>>>> Generator: Rule generation with sampling
2025-06-18 12:55:50,675 INFO     Predictor: read 1273 rules from list.
2025-06-18 12:55:50,675 INFO     Initializing distributed process group
2025-06-18 12:55:50,730 INFO     Predictor: read 1273 rules from list.
2025-06-18 12:55:50,732 INFO     Preprocess training set
2025-06-18 12:55:50,733 INFO     >>>>> Predictor: Training
[rank0]:[W618 12:55:51.201662855 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W618 12:55:51.227156077 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-06-18 12:56:29,071 INFO     1000 2980 8.362119 69305.9
2025-06-18 12:57:06,860 INFO     2000 2980 7.794615 69297.3
2025-06-18 12:57:43,741 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 12:57:47,663 INFO     Data : 2077
2025-06-18 12:57:47,663 INFO     Hit1 : 0.036591
2025-06-18 12:57:47,663 INFO     Hit3 : 0.071257
2025-06-18 12:57:47,663 INFO     Hit10: 0.131921
2025-06-18 12:57:47,664 INFO     MR   : 1244.617477
2025-06-18 12:57:47,664 INFO     MRR  : 0.069399
2025-06-18 12:57:47,664 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 12:57:52,086 INFO     Data : 2342
2025-06-18 12:57:52,086 INFO     Hit1 : 0.038723
2025-06-18 12:57:52,086 INFO     Hit3 : 0.077021
2025-06-18 12:57:52,086 INFO     Hit10: 0.136596
2025-06-18 12:57:52,086 INFO     MR   : 1156.860851
2025-06-18 12:57:52,086 INFO     MRR  : 0.073737
2025-06-18 12:57:52,086 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-18 12:58:54,408 INFO     1000 2980
2025-06-18 12:59:56,010 INFO     2000 2980
2025-06-18 13:00:59,506 INFO     >>>>> Generator: Training
2025-06-18 13:00:59,896 INFO     -------------------------
2025-06-18 13:00:59,896 INFO     | EM Iteration: 2/5
2025-06-18 13:00:59,896 INFO     -------------------------
2025-06-18 13:00:59,896 INFO     >>>>> Generator: Rule generation with sampling
2025-06-18 13:01:00,029 INFO     Predictor: read 1342 rules from list.
2025-06-18 13:01:00,029 INFO     Preprocess training set
2025-06-18 13:01:00,029 INFO     >>>>> Predictor: Training
2025-06-18 13:01:00,030 INFO     Predictor: read 1342 rules from list.
2025-06-18 13:01:39,245 INFO     1000 2980 8.393676 69349.3
2025-06-18 13:02:18,245 INFO     2000 2980 7.804280 69227.9
2025-06-18 13:02:55,874 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 13:02:59,522 INFO     Data : 2077
2025-06-18 13:02:59,522 INFO     Hit1 : 0.046221
2025-06-18 13:02:59,522 INFO     Hit3 : 0.077034
2025-06-18 13:02:59,522 INFO     Hit10: 0.141550
2025-06-18 13:02:59,522 INFO     MR   : 1238.048146
2025-06-18 13:02:59,522 INFO     MRR  : 0.078114
2025-06-18 13:02:59,522 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 13:03:03,604 INFO     Data : 2342
2025-06-18 13:03:03,604 INFO     Hit1 : 0.054043
2025-06-18 13:03:03,604 INFO     Hit3 : 0.087660
2025-06-18 13:03:03,605 INFO     Hit10: 0.142128
2025-06-18 13:03:03,605 INFO     MR   : 1129.164043
2025-06-18 13:03:03,605 INFO     MRR  : 0.085770
2025-06-18 13:03:03,605 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-18 13:04:08,246 INFO     1000 2980
2025-06-18 13:05:12,909 INFO     2000 2980
2025-06-18 13:06:19,142 INFO     >>>>> Generator: Training
2025-06-18 13:06:19,532 INFO     -------------------------
2025-06-18 13:06:19,532 INFO     | EM Iteration: 3/5
2025-06-18 13:06:19,532 INFO     -------------------------
2025-06-18 13:06:19,532 INFO     >>>>> Generator: Rule generation with sampling
2025-06-18 13:06:19,596 INFO     Predictor: read 1412 rules from list.
2025-06-18 13:06:19,596 INFO     Preprocess training set
2025-06-18 13:06:19,596 INFO     Predictor: read 1412 rules from list.
2025-06-18 13:06:19,596 INFO     >>>>> Predictor: Training
2025-06-18 13:06:59,169 INFO     1000 2980 8.349985 69323.3
2025-06-18 13:07:38,577 INFO     2000 2980 7.703440 69358.0
2025-06-18 13:08:17,480 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 13:08:21,478 INFO     Data : 2077
2025-06-18 13:08:21,478 INFO     Hit1 : 0.038517
2025-06-18 13:08:21,478 INFO     Hit3 : 0.071738
2025-06-18 13:08:21,478 INFO     Hit10: 0.139143
2025-06-18 13:08:21,478 INFO     MR   : 1232.864709
2025-06-18 13:08:21,479 INFO     MRR  : 0.071862
2025-06-18 13:08:21,479 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 13:08:25,966 INFO     Data : 2342
2025-06-18 13:08:25,967 INFO     Hit1 : 0.040851
2025-06-18 13:08:25,967 INFO     Hit3 : 0.076170
2025-06-18 13:08:25,967 INFO     Hit10: 0.135745
2025-06-18 13:08:25,967 INFO     MR   : 1152.449149
2025-06-18 13:08:25,967 INFO     MRR  : 0.073675
2025-06-18 13:08:25,967 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-18 13:09:33,990 INFO     1000 2980
2025-06-18 13:10:40,507 INFO     2000 2980
2025-06-18 13:11:45,189 INFO     >>>>> Generator: Training
2025-06-18 13:11:45,596 INFO     -------------------------
2025-06-18 13:11:45,596 INFO     | EM Iteration: 4/5
2025-06-18 13:11:45,596 INFO     -------------------------
2025-06-18 13:11:45,596 INFO     >>>>> Generator: Rule generation with sampling
2025-06-18 13:11:45,660 INFO     Predictor: read 1424 rules from list.
2025-06-18 13:11:45,661 INFO     Preprocess training set
2025-06-18 13:11:45,661 INFO     >>>>> Predictor: Training
2025-06-18 13:11:45,664 INFO     Predictor: read 1424 rules from list.
2025-06-18 13:12:25,539 INFO     1000 2980 8.357754 69366.7
2025-06-18 13:13:05,439 INFO     2000 2980 7.754565 69305.9
2025-06-18 13:13:44,657 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 13:13:48,998 INFO     Data : 2077
2025-06-18 13:13:48,998 INFO     Hit1 : 0.048146
2025-06-18 13:13:48,998 INFO     Hit3 : 0.092441
2025-06-18 13:13:48,998 INFO     Hit10: 0.151180
2025-06-18 13:13:48,998 INFO     MR   : 1214.486760
2025-06-18 13:13:48,998 INFO     MRR  : 0.086368
2025-06-18 13:13:48,999 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 13:13:53,966 INFO     Data : 2342
2025-06-18 13:13:53,966 INFO     Hit1 : 0.059574
2025-06-18 13:13:53,966 INFO     Hit3 : 0.102128
2025-06-18 13:13:53,966 INFO     Hit10: 0.171489
2025-06-18 13:13:53,966 INFO     MR   : 1110.890000
2025-06-18 13:13:53,966 INFO     MRR  : 0.097107
2025-06-18 13:13:53,967 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-18 13:15:00,641 INFO     1000 2980
2025-06-18 13:16:07,795 INFO     2000 2980
2025-06-18 13:17:14,651 INFO     >>>>> Generator: Training
2025-06-18 13:17:15,116 INFO     Predictor: read 1485 rules from list.
2025-06-18 13:17:15,137 INFO     -------------------------
2025-06-18 13:17:15,137 INFO     | EM Iteration: 5/5
2025-06-18 13:17:15,137 INFO     -------------------------
2025-06-18 13:17:15,137 INFO     >>>>> Generator: Rule generation with sampling
2025-06-18 13:17:15,180 INFO     Predictor: read 1485 rules from list.
2025-06-18 13:17:15,180 INFO     Preprocess training set
2025-06-18 13:17:15,180 INFO     >>>>> Predictor: Training
2025-06-18 13:17:55,711 INFO     1000 2980 8.385511 69271.3
2025-06-18 13:18:35,939 INFO     2000 2980 7.818142 69332.0
2025-06-18 13:19:15,643 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 13:19:20,032 INFO     Data : 2077
2025-06-18 13:19:20,032 INFO     Hit1 : 0.042369
2025-06-18 13:19:20,032 INFO     Hit3 : 0.081367
2025-06-18 13:19:20,032 INFO     Hit10: 0.137217
2025-06-18 13:19:20,032 INFO     MR   : 1256.511314
2025-06-18 13:19:20,032 INFO     MRR  : 0.076521
2025-06-18 13:19:20,033 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 13:19:25,000 INFO     Data : 2342
2025-06-18 13:19:25,000 INFO     Hit1 : 0.050213
2025-06-18 13:19:25,000 INFO     Hit3 : 0.086383
2025-06-18 13:19:25,000 INFO     Hit10: 0.137021
2025-06-18 13:19:25,000 INFO     MR   : 1164.163191
2025-06-18 13:19:25,001 INFO     MRR  : 0.082536
2025-06-18 13:19:25,001 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-18 13:20:33,691 INFO     1000 2980
2025-06-18 13:21:42,807 INFO     2000 2980
2025-06-18 13:22:50,383 INFO     >>>>> Generator: Training
2025-06-18 13:22:50,796 INFO     -------------------------
2025-06-18 13:22:50,796 INFO     | Post-train Generator
2025-06-18 13:22:50,796 INFO     -------------------------
2025-06-18 13:22:50,799 INFO     >>>>> Generator: Training
2025-06-18 13:22:55,076 INFO     1000 1000 1.741632
2025-06-18 13:22:55,076 INFO     -------------------------
2025-06-18 13:22:55,076 INFO     | Beam Search Best Rules
2025-06-18 13:22:55,076 INFO     -------------------------
2025-06-18 13:22:55,076 INFO     >>>>> Generator: Rule generation with beam search
2025-06-18 13:22:55,327 INFO     >>>>> Generator: Rule generation with beam search
2025-06-18 13:22:56,810 INFO     >>>>> Generator: Rule generation with beam search
2025-06-18 13:23:08,074 INFO     >>>>> Generator: Rule generation with beam search
2025-06-18 13:23:15,615 INFO     >>>>> Generator: Rule generation with beam search
2025-06-18 13:23:20,682 INFO     -------------------------
2025-06-18 13:23:20,682 INFO     | Train Final Predictor+
2025-06-18 13:23:20,682 INFO     -------------------------
2025-06-18 13:23:20,770 INFO     Predictor+: read 18420 rules from list.
2025-06-18 13:23:20,816 INFO     Preprocess training set
2025-06-18 13:23:20,819 INFO     -------------------------
2025-06-18 13:23:20,819 INFO     | Iteration: 1/5
2025-06-18 13:23:20,819 INFO     -------------------------
2025-06-18 13:23:20,819 INFO     >>>>> Predictor: Training
2025-06-18 13:23:23,556 INFO     Predictor+: read 18420 rules from list.
2025-06-18 13:34:45,602 INFO     1000 2980 4.796699 69384.0
2025-06-18 13:46:07,241 INFO     2000 2980 4.652163 69236.6
2025-06-18 13:57:15,797 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 13:58:40,509 INFO     Data : 2077
2025-06-18 13:58:40,509 INFO     Hit1 : 0.103033
2025-06-18 13:58:40,509 INFO     Hit3 : 0.194511
2025-06-18 13:58:40,509 INFO     Hit10: 0.316803
2025-06-18 13:58:40,509 INFO     MR   : 944.138421
2025-06-18 13:58:40,509 INFO     MRR  : 0.173075
2025-06-18 13:58:40,509 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 14:00:16,154 INFO     Data : 2342
2025-06-18 14:00:16,154 INFO     Hit1 : 0.130213
2025-06-18 14:00:16,154 INFO     Hit3 : 0.215745
2025-06-18 14:00:16,154 INFO     Hit10: 0.325532
2025-06-18 14:00:16,154 INFO     MR   : 862.331489
2025-06-18 14:00:16,154 INFO     MRR  : 0.195026
2025-06-18 14:00:16,154 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/task1_next_clus/random_init/cluster_3/0618_all_filtered/ori/predictor.pt
2025-06-18 14:00:16,160 INFO     -------------------------
2025-06-18 14:00:16,161 INFO     | Iteration: 2/5
2025-06-18 14:00:16,161 INFO     -------------------------
2025-06-18 14:00:16,161 INFO     >>>>> Predictor: Training
2025-06-18 14:11:37,807 INFO     1000 2980 4.543888 69245.2
2025-06-18 14:22:53,075 INFO     2000 2980 4.515764 69349.3
2025-06-18 14:33:53,817 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 14:35:16,504 INFO     Data : 2077
2025-06-18 14:35:16,504 INFO     Hit1 : 0.090997
2025-06-18 14:35:16,505 INFO     Hit3 : 0.181030
2025-06-18 14:35:16,505 INFO     Hit10: 0.303322
2025-06-18 14:35:16,505 INFO     MR   : 911.663938
2025-06-18 14:35:16,505 INFO     MRR  : 0.160407
2025-06-18 14:35:16,505 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 14:36:49,867 INFO     Data : 2342
2025-06-18 14:36:49,867 INFO     Hit1 : 0.121702
2025-06-18 14:36:49,867 INFO     Hit3 : 0.201702
2025-06-18 14:36:49,867 INFO     Hit10: 0.317447
2025-06-18 14:36:49,867 INFO     MR   : 833.462340
2025-06-18 14:36:49,867 INFO     MRR  : 0.185121
2025-06-18 14:36:49,867 INFO     -------------------------
2025-06-18 14:36:49,868 INFO     | Iteration: 3/5
2025-06-18 14:36:49,868 INFO     -------------------------
2025-06-18 14:36:49,868 INFO     >>>>> Predictor: Training
2025-06-18 14:47:59,540 INFO     1000 2980 4.504926 69193.2
2025-06-18 14:59:12,194 INFO     2000 2980 4.513774 69271.3
2025-06-18 15:11:12,875 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 15:12:38,516 INFO     Data : 2077
2025-06-18 15:12:38,516 INFO     Hit1 : 0.090997
2025-06-18 15:12:38,516 INFO     Hit3 : 0.178142
2025-06-18 15:12:38,516 INFO     Hit10: 0.308137
2025-06-18 15:12:38,516 INFO     MR   : 920.121329
2025-06-18 15:12:38,516 INFO     MRR  : 0.161550
2025-06-18 15:12:38,516 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 15:14:15,107 INFO     Data : 2342
2025-06-18 15:14:15,107 INFO     Hit1 : 0.123404
2025-06-18 15:14:15,107 INFO     Hit3 : 0.205957
2025-06-18 15:14:15,107 INFO     Hit10: 0.322553
2025-06-18 15:14:15,107 INFO     MR   : 832.978085
2025-06-18 15:14:15,107 INFO     MRR  : 0.188098
2025-06-18 15:14:15,107 INFO     -------------------------
2025-06-18 15:14:15,107 INFO     | Iteration: 4/5
2025-06-18 15:14:15,107 INFO     -------------------------
2025-06-18 15:14:15,107 INFO     >>>>> Predictor: Training
2025-06-18 15:26:24,893 INFO     1000 2980 4.479328 69340.6
2025-06-18 15:37:35,882 INFO     2000 2980 4.514617 69175.8
2025-06-18 15:48:32,717 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 15:49:55,494 INFO     Data : 2077
2025-06-18 15:49:55,494 INFO     Hit1 : 0.085219
2025-06-18 15:49:55,494 INFO     Hit3 : 0.176697
2025-06-18 15:49:55,494 INFO     Hit10: 0.304766
2025-06-18 15:49:55,494 INFO     MR   : 902.954261
2025-06-18 15:49:55,494 INFO     MRR  : 0.156912
2025-06-18 15:49:55,494 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 15:51:29,118 INFO     Data : 2342
2025-06-18 15:51:29,118 INFO     Hit1 : 0.117872
2025-06-18 15:51:29,118 INFO     Hit3 : 0.205106
2025-06-18 15:51:29,118 INFO     Hit10: 0.319149
2025-06-18 15:51:29,118 INFO     MR   : 827.462128
2025-06-18 15:51:29,118 INFO     MRR  : 0.184760
2025-06-18 15:51:29,119 INFO     -------------------------
2025-06-18 15:51:29,119 INFO     | Iteration: 5/5
2025-06-18 15:51:29,119 INFO     -------------------------
2025-06-18 15:51:29,119 INFO     >>>>> Predictor: Training
2025-06-18 16:03:12,150 INFO     1000 2980 4.425392 69184.5
2025-06-18 16:14:42,016 INFO     2000 2980 4.476587 69366.7
2025-06-18 16:26:17,777 INFO     >>>>> Predictor: Evaluating on valid
2025-06-18 16:27:48,759 INFO     Data : 2077
2025-06-18 16:27:48,759 INFO     Hit1 : 0.089071
2025-06-18 16:27:48,759 INFO     Hit3 : 0.180067
2025-06-18 16:27:48,759 INFO     Hit10: 0.308618
2025-06-18 16:27:48,759 INFO     MR   : 913.800193
2025-06-18 16:27:48,759 INFO     MRR  : 0.158491
2025-06-18 16:27:48,759 INFO     >>>>> Predictor: Evaluating on test
2025-06-18 16:29:26,081 INFO     Data : 2342
2025-06-18 16:29:26,081 INFO     Hit1 : 0.117021
2025-06-18 16:29:26,081 INFO     Hit3 : 0.197872
2025-06-18 16:29:26,081 INFO     Hit10: 0.312340
2025-06-18 16:29:26,081 INFO     MR   : 843.230851
2025-06-18 16:29:26,081 INFO     MRR  : 0.180951
2025-06-18 16:29:26,081 INFO     -------------------------
2025-06-18 16:29:26,081 INFO     | Final Test MRR: 0.195026
2025-06-18 16:29:26,081 INFO     -------------------------
