2025-06-29 23:49:21,922 INFO     Data loading | DONE!
2025-06-29 23:49:22,023 INFO     Using full datasets for training, validation, and testing.
2025-06-29 23:49:22,133 INFO     -------------------------
2025-06-29 23:49:22,134 INFO     | EM Iteration: 1/5
2025-06-29 23:49:22,134 INFO     -------------------------
2025-06-29 23:49:22,134 INFO     >>>>> Using miner's rule
2025-06-29 23:49:22,206 INFO     Predictor: read 13661 rules from list.
2025-06-29 23:49:22,872 INFO     Preprocess training set
2025-06-29 23:49:22,872 INFO     >>>>> Predictor: Training
2025-06-29 23:58:52,116 INFO     1000 5959 8.299284 69314.6
2025-06-30 00:08:19,007 INFO     2000 5959 7.689227 69271.3
2025-06-30 00:17:25,694 INFO     3000 5959 7.425850 69245.2
2025-06-30 00:26:38,564 INFO     4000 5959 7.285955 69340.6
2025-06-30 00:35:53,738 INFO     5000 5959 7.136692 69340.6
2025-06-30 00:44:50,711 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 00:47:10,649 INFO     Data : 2077
2025-06-30 00:47:10,649 INFO     Hit1 : 0.065479
2025-06-30 00:47:10,649 INFO     Hit3 : 0.127106
2025-06-30 00:47:10,649 INFO     Hit10: 0.199326
2025-06-30 00:47:10,649 INFO     MR   : 1120.920077
2025-06-30 00:47:10,649 INFO     MRR  : 0.114382
2025-06-30 00:47:10,650 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 00:49:42,756 INFO     Data : 2342
2025-06-30 00:49:42,756 INFO     Hit1 : 0.078992
2025-06-30 00:49:42,756 INFO     Hit3 : 0.124253
2025-06-30 00:49:42,756 INFO     Hit10: 0.208796
2025-06-30 00:49:42,756 INFO     MR   : 1044.279889
2025-06-30 00:49:42,756 INFO     MRR  : 0.122250
2025-06-30 00:49:42,757 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 01:24:45,753 INFO     1000 5959
2025-06-30 01:59:21,070 INFO     2000 5959
2025-06-30 02:33:20,139 INFO     3000 5959
2025-06-30 03:07:24,943 INFO     4000 5959
2025-06-30 03:41:48,653 INFO     5000 5959
2025-06-30 04:17:06,929 INFO     >>>>> Generator: Training
2025-06-30 04:17:10,439 INFO     -------------------------
2025-06-30 04:17:10,439 INFO     | EM Iteration: 2/5
2025-06-30 04:17:10,439 INFO     -------------------------
2025-06-30 04:17:10,439 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:17:10,439 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:17:10,623 INFO     Predictor: read 1904 rules from list.
2025-06-30 04:17:10,624 INFO     Preprocess training set
2025-06-30 04:17:10,625 INFO     >>>>> Predictor: Training
2025-06-30 04:18:06,255 INFO     1000 5959 8.787464 69332.0
2025-06-30 04:18:54,954 INFO     2000 5959 8.398173 69349.3
2025-06-30 04:19:43,120 INFO     3000 5959 8.126257 69184.5
2025-06-30 04:20:32,141 INFO     4000 5959 7.935438 69253.9
2025-06-30 04:21:21,028 INFO     5000 5959 7.802489 69332.0
2025-06-30 04:22:07,448 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:22:17,864 INFO     Data : 2077
2025-06-30 04:22:17,865 INFO     Hit1 : 0.018296
2025-06-30 04:22:17,865 INFO     Hit3 : 0.032740
2025-06-30 04:22:17,865 INFO     Hit10: 0.060664
2025-06-30 04:22:17,865 INFO     MR   : 1451.351468
2025-06-30 04:22:17,865 INFO     MRR  : 0.034410
2025-06-30 04:22:17,865 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:22:29,559 INFO     Data : 2342
2025-06-30 04:22:29,559 INFO     Hit1 : 0.018360
2025-06-30 04:22:29,559 INFO     Hit3 : 0.036294
2025-06-30 04:22:29,559 INFO     Hit10: 0.064048
2025-06-30 04:22:29,559 INFO     MR   : 1339.881298
2025-06-30 04:22:29,559 INFO     MRR  : 0.036042
2025-06-30 04:22:29,559 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:24:49,872 INFO     1000 5959
2025-06-30 04:27:10,343 INFO     2000 5959
2025-06-30 04:29:40,552 INFO     3000 5959
2025-06-30 04:32:01,754 INFO     4000 5959
2025-06-30 04:34:24,068 INFO     5000 5959
2025-06-30 04:36:42,866 INFO     >>>>> Generator: Training
2025-06-30 04:36:45,654 INFO     -------------------------
2025-06-30 04:36:45,654 INFO     | EM Iteration: 3/5
2025-06-30 04:36:45,654 INFO     -------------------------
2025-06-30 04:36:45,654 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:36:45,654 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:36:45,760 INFO     Predictor: read 1883 rules from list.
2025-06-30 04:36:45,761 INFO     Preprocess training set
2025-06-30 04:36:45,761 INFO     >>>>> Predictor: Training
2025-06-30 04:37:34,084 INFO     1000 5959 8.805212 69271.3
2025-06-30 04:38:21,832 INFO     2000 5959 8.433574 69340.6
2025-06-30 04:39:09,633 INFO     3000 5959 8.187820 69384.0
2025-06-30 04:39:57,657 INFO     4000 5959 8.023671 69262.6
2025-06-30 04:40:44,811 INFO     5000 5959 7.902470 69332.0
2025-06-30 04:41:30,169 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:41:39,698 INFO     Data : 2077
2025-06-30 04:41:39,698 INFO     Hit1 : 0.013000
2025-06-30 04:41:39,698 INFO     Hit3 : 0.019740
2025-06-30 04:41:39,698 INFO     Hit10: 0.036110
2025-06-30 04:41:39,698 INFO     MR   : 1495.286712
2025-06-30 04:41:39,698 INFO     MRR  : 0.023818
2025-06-30 04:41:39,698 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:41:50,815 INFO     Data : 2342
2025-06-30 04:41:50,815 INFO     Hit1 : 0.012810
2025-06-30 04:41:50,815 INFO     Hit3 : 0.020495
2025-06-30 04:41:50,815 INFO     Hit10: 0.032451
2025-06-30 04:41:50,815 INFO     MR   : 1387.798249
2025-06-30 04:41:50,815 INFO     MRR  : 0.023086
2025-06-30 04:41:50,816 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:44:07,748 INFO     1000 5959
2025-06-30 04:46:24,991 INFO     2000 5959
2025-06-30 04:48:49,414 INFO     3000 5959
2025-06-30 04:51:08,389 INFO     4000 5959
2025-06-30 04:53:25,533 INFO     5000 5959
2025-06-30 04:55:38,693 INFO     >>>>> Generator: Training
2025-06-30 04:55:41,445 INFO     -------------------------
2025-06-30 04:55:41,445 INFO     | EM Iteration: 4/5
2025-06-30 04:55:41,445 INFO     -------------------------
2025-06-30 04:55:41,445 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:55:41,445 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:55:41,552 INFO     Predictor: read 1862 rules from list.
2025-06-30 04:55:41,553 INFO     Preprocess training set
2025-06-30 04:55:41,553 INFO     >>>>> Predictor: Training
2025-06-30 04:56:28,565 INFO     1000 5959 8.797468 69332.0
2025-06-30 04:57:15,231 INFO     2000 5959 8.412964 69349.3
2025-06-30 04:58:01,908 INFO     3000 5959 8.138549 69340.6
2025-06-30 04:58:48,500 INFO     4000 5959 7.944433 69297.3
2025-06-30 04:59:34,706 INFO     5000 5959 7.763990 69219.2
2025-06-30 05:00:19,002 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:00:28,637 INFO     Data : 2077
2025-06-30 05:00:28,638 INFO     Hit1 : 0.027443
2025-06-30 05:00:28,638 INFO     Hit3 : 0.045258
2025-06-30 05:00:28,638 INFO     Hit10: 0.065479
2025-06-30 05:00:28,638 INFO     MR   : 1474.557053
2025-06-30 05:00:28,638 INFO     MRR  : 0.043990
2025-06-30 05:00:28,638 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:00:39,484 INFO     Data : 2342
2025-06-30 05:00:39,484 INFO     Hit1 : 0.019641
2025-06-30 05:00:39,484 INFO     Hit3 : 0.040564
2025-06-30 05:00:39,484 INFO     Hit10: 0.066183
2025-06-30 05:00:39,484 INFO     MR   : 1363.219044
2025-06-30 05:00:39,484 INFO     MRR  : 0.038684
2025-06-30 05:00:39,484 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 05:02:53,217 INFO     1000 5959
2025-06-30 05:05:24,255 INFO     2000 5959
2025-06-30 05:16:42,352 INFO     3000 5959
2025-06-30 05:21:00,958 INFO     4000 5959
2025-06-30 05:23:13,513 INFO     5000 5959
2025-06-30 05:25:23,038 INFO     >>>>> Generator: Training
2025-06-30 05:25:25,738 INFO     -------------------------
2025-06-30 05:25:25,738 INFO     | EM Iteration: 5/5
2025-06-30 05:25:25,738 INFO     -------------------------
2025-06-30 05:25:25,738 INFO     >>>>> Using Generator's sample rule
2025-06-30 05:25:25,738 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 05:25:25,844 INFO     Predictor: read 1709 rules from list.
2025-06-30 05:25:25,844 INFO     Preprocess training set
2025-06-30 05:25:25,845 INFO     >>>>> Predictor: Training
2025-06-30 05:26:07,806 INFO     1000 5959 8.790601 69271.3
2025-06-30 05:26:50,068 INFO     2000 5959 8.390885 69332.0
2025-06-30 05:27:32,595 INFO     3000 5959 8.137609 69375.3
2025-06-30 05:28:15,465 INFO     4000 5959 7.945192 69279.9
2025-06-30 05:28:57,345 INFO     5000 5959 7.810893 69349.3
2025-06-30 05:29:37,923 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:29:46,256 INFO     Data : 2077
2025-06-30 05:29:46,256 INFO     Hit1 : 0.015407
2025-06-30 05:29:46,256 INFO     Hit3 : 0.029369
2025-06-30 05:29:46,256 INFO     Hit10: 0.060183
2025-06-30 05:29:46,256 INFO     MR   : 1427.884689
2025-06-30 05:29:46,256 INFO     MRR  : 0.033079
2025-06-30 05:29:46,256 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:29:55,780 INFO     Data : 2342
2025-06-30 05:29:55,780 INFO     Hit1 : 0.016652
2025-06-30 05:29:55,780 INFO     Hit3 : 0.029889
2025-06-30 05:29:55,780 INFO     Hit10: 0.052519
2025-06-30 05:29:55,780 INFO     MR   : 1316.325576
2025-06-30 05:29:55,780 INFO     MRR  : 0.033241
2025-06-30 05:29:55,780 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 05:32:00,637 INFO     1000 5959
2025-06-30 05:34:05,767 INFO     2000 5959
2025-06-30 05:36:11,715 INFO     3000 5959
2025-06-30 05:38:17,289 INFO     4000 5959
2025-06-30 05:40:23,630 INFO     5000 5959
2025-06-30 05:42:27,593 INFO     >>>>> Generator: Training
2025-06-30 05:42:30,232 INFO     -------------------------
2025-06-30 05:42:30,232 INFO     | Post-train Generator
2025-06-30 05:42:30,232 INFO     -------------------------
2025-06-30 05:42:31,568 INFO     >>>>> Generator: Training
2025-06-30 05:43:00,026 INFO     [E01000] Total 2.526185 | Main 2.584812 | RelClus 1.774768 | EntType 2.808587
2025-06-30 05:43:00,027 INFO     -------------------------
2025-06-30 05:43:00,027 INFO     | Beam Search Best Rules
2025-06-30 05:43:00,027 INFO     -------------------------
2025-06-30 05:43:00,027 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:43:00,565 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:43:04,741 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:44:04,426 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:44:54,033 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:45:28,055 INFO     -------------------------
2025-06-30 05:45:28,055 INFO     | Train Final Predictor+
2025-06-30 05:45:28,055 INFO     -------------------------
2025-06-30 05:45:28,060 INFO     Predictor+: read 18420 rules from list.
2025-06-30 05:45:28,195 INFO     Preprocess training set
2025-06-30 05:45:28,196 INFO     -------------------------
2025-06-30 05:45:28,196 INFO     | Iteration: 1/5
2025-06-30 05:45:28,196 INFO     -------------------------
2025-06-30 05:45:28,196 INFO     >>>>> Predictor: Training
2025-06-30 05:50:05,993 INFO     1000 5959 4.909668 69366.7
2025-06-30 05:54:46,031 INFO     2000 5959 4.742220 69375.3
2025-06-30 05:59:30,830 INFO     3000 5959 4.710566 69219.2
2025-06-30 06:04:13,561 INFO     4000 5959 4.703490 69305.9
2025-06-30 06:08:53,242 INFO     5000 5959 4.663824 69288.6
2025-06-30 06:13:21,855 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:14:29,539 INFO     Data : 2077
2025-06-30 06:14:29,539 INFO     Hit1 : 0.094367
2025-06-30 06:14:29,539 INFO     Hit3 : 0.183919
2025-06-30 06:14:29,539 INFO     Hit10: 0.318729
2025-06-30 06:14:29,539 INFO     MR   : 975.709677
2025-06-30 06:14:29,539 INFO     MRR  : 0.164676
2025-06-30 06:14:29,540 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:15:45,463 INFO     Data : 2342
2025-06-30 06:15:45,463 INFO     Hit1 : 0.126815
2025-06-30 06:15:45,463 INFO     Hit3 : 0.212212
2025-06-30 06:15:45,463 INFO     Hit10: 0.318958
2025-06-30 06:15:45,463 INFO     MR   : 898.533945
2025-06-30 06:15:45,463 INFO     MRR  : 0.191741
2025-06-30 06:15:45,463 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_8_20250629_234920/predictor.pt
2025-06-30 06:15:45,470 INFO     -------------------------
2025-06-30 06:15:45,470 INFO     | Iteration: 2/5
2025-06-30 06:15:45,470 INFO     -------------------------
2025-06-30 06:15:45,471 INFO     >>>>> Predictor: Training
2025-06-30 06:20:28,224 INFO     1000 5959 4.634410 69288.6
2025-06-30 06:25:14,779 INFO     2000 5959 4.637529 69288.6
2025-06-30 06:30:00,469 INFO     3000 5959 4.617531 69340.6
2025-06-30 06:34:42,881 INFO     4000 5959 4.626656 69271.3
2025-06-30 06:39:27,013 INFO     5000 5959 4.648247 69219.2
2025-06-30 06:43:54,573 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:45:02,443 INFO     Data : 2077
2025-06-30 06:45:02,443 INFO     Hit1 : 0.091478
2025-06-30 06:45:02,443 INFO     Hit3 : 0.179104
2025-06-30 06:45:02,443 INFO     Hit10: 0.304285
2025-06-30 06:45:02,443 INFO     MR   : 948.137458
2025-06-30 06:45:02,443 INFO     MRR  : 0.162198
2025-06-30 06:45:02,444 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:46:18,876 INFO     Data : 2342
2025-06-30 06:46:18,876 INFO     Hit1 : 0.118702
2025-06-30 06:46:18,876 INFO     Hit3 : 0.199402
2025-06-30 06:46:18,876 INFO     Hit10: 0.318958
2025-06-30 06:46:18,876 INFO     MR   : 875.622118
2025-06-30 06:46:18,876 INFO     MRR  : 0.182152
2025-06-30 06:46:18,876 INFO     -------------------------
2025-06-30 06:46:18,876 INFO     | Iteration: 3/5
2025-06-30 06:46:18,876 INFO     -------------------------
2025-06-30 06:46:18,876 INFO     >>>>> Predictor: Training
2025-06-30 06:51:00,873 INFO     1000 5959 4.598731 69340.6
2025-06-30 06:55:39,471 INFO     2000 5959 4.569134 69184.5
2025-06-30 07:00:15,636 INFO     3000 5959 4.626796 69253.9
2025-06-30 07:04:56,069 INFO     4000 5959 4.604608 69340.6
2025-06-30 07:09:35,652 INFO     5000 5959 4.602785 69384.0
2025-06-30 07:14:04,573 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:15:12,481 INFO     Data : 2077
2025-06-30 07:15:12,481 INFO     Hit1 : 0.094367
2025-06-30 07:15:12,481 INFO     Hit3 : 0.185845
2025-06-30 07:15:12,481 INFO     Hit10: 0.310063
2025-06-30 07:15:12,481 INFO     MR   : 931.364468
2025-06-30 07:15:12,481 INFO     MRR  : 0.164614
2025-06-30 07:15:12,481 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:16:28,956 INFO     Data : 2342
2025-06-30 07:16:28,957 INFO     Hit1 : 0.121264
2025-06-30 07:16:28,957 INFO     Hit3 : 0.209223
2025-06-30 07:16:28,957 INFO     Hit10: 0.315542
2025-06-30 07:16:28,957 INFO     MR   : 859.917805
2025-06-30 07:16:28,957 INFO     MRR  : 0.187067
2025-06-30 07:16:28,957 INFO     -------------------------
2025-06-30 07:16:28,957 INFO     | Iteration: 4/5
2025-06-30 07:16:28,957 INFO     -------------------------
2025-06-30 07:16:28,957 INFO     >>>>> Predictor: Training
2025-06-30 07:21:14,626 INFO     1000 5959 4.601591 69323.3
2025-06-30 07:25:59,378 INFO     2000 5959 4.579053 69332.0
2025-06-30 07:30:40,758 INFO     3000 5959 4.613627 69219.2
2025-06-30 07:35:20,865 INFO     4000 5959 4.608690 69297.3
2025-06-30 07:40:04,101 INFO     5000 5959 4.573342 69332.0
2025-06-30 07:44:33,194 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:45:41,201 INFO     Data : 2077
2025-06-30 07:45:41,201 INFO     Hit1 : 0.090034
2025-06-30 07:45:41,201 INFO     Hit3 : 0.178142
2025-06-30 07:45:41,201 INFO     Hit10: 0.312951
2025-06-30 07:45:41,201 INFO     MR   : 918.604478
2025-06-30 07:45:41,201 INFO     MRR  : 0.161992
2025-06-30 07:45:41,201 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:46:57,852 INFO     Data : 2342
2025-06-30 07:46:57,852 INFO     Hit1 : 0.126815
2025-06-30 07:46:57,852 INFO     Hit3 : 0.207942
2025-06-30 07:46:57,852 INFO     Hit10: 0.315542
2025-06-30 07:46:57,852 INFO     MR   : 849.454740
2025-06-30 07:46:57,852 INFO     MRR  : 0.189767
2025-06-30 07:46:57,852 INFO     -------------------------
2025-06-30 07:46:57,852 INFO     | Iteration: 5/5
2025-06-30 07:46:57,852 INFO     -------------------------
2025-06-30 07:46:57,852 INFO     >>>>> Predictor: Training
2025-06-30 07:51:35,840 INFO     1000 5959 4.545118 69245.2
2025-06-30 07:56:12,946 INFO     2000 5959 4.539790 69262.6
2025-06-30 08:00:50,016 INFO     3000 5959 4.593092 69332.0
2025-06-30 08:05:26,919 INFO     4000 5959 4.597850 69366.7
2025-06-30 08:09:59,794 INFO     5000 5959 4.609038 69262.6
2025-06-30 08:14:25,893 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 08:15:33,183 INFO     Data : 2077
2025-06-30 08:15:33,184 INFO     Hit1 : 0.093885
2025-06-30 08:15:33,184 INFO     Hit3 : 0.186326
2025-06-30 08:15:33,184 INFO     Hit10: 0.309581
2025-06-30 08:15:33,184 INFO     MR   : 918.985797
2025-06-30 08:15:33,184 INFO     MRR  : 0.163590
2025-06-30 08:15:33,184 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 08:16:46,829 INFO     Data : 2342
2025-06-30 08:16:46,829 INFO     Hit1 : 0.130231
2025-06-30 08:16:46,829 INFO     Hit3 : 0.204953
2025-06-30 08:16:46,829 INFO     Hit10: 0.315542
2025-06-30 08:16:46,829 INFO     MR   : 850.517506
2025-06-30 08:16:46,829 INFO     MRR  : 0.191059
2025-06-30 08:16:46,829 INFO     -------------------------
2025-06-30 08:16:46,829 INFO     | Final Test MRR: 0.191741
2025-06-30 08:16:46,829 INFO     -------------------------
entity size:  8673
relation size:  20
