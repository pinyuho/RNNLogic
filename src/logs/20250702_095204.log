2025-07-02 09:52:06,141 INFO     is_soft_label: True
2025-07-02 09:52:06,141 INFO     is_scheduled_sampling: False
2025-07-02 09:52:06,141 INFO     is_test_mode: False
2025-07-02 09:52:06,349 INFO     Data loading | DONE!
2025-07-02 09:52:06,439 INFO     Using full datasets for training, validation, and testing.
2025-07-02 09:52:06,552 INFO     -------------------------
2025-07-02 09:52:06,552 INFO     | EM Iteration: 1/5
2025-07-02 09:52:06,552 INFO     -------------------------
2025-07-02 09:52:06,552 INFO     >>>>> Using miner's rule
2025-07-02 09:52:06,621 INFO     Predictor: read 13661 rules from list.
2025-07-02 09:52:07,495 INFO     Preprocess training set
2025-07-02 09:52:07,495 INFO     >>>>> Predictor: Training
2025-07-02 10:00:19,843 INFO     1000 5959 8.299284 69314.6
2025-07-02 10:08:08,241 INFO     2000 5959 7.689227 69271.3
2025-07-02 10:15:52,969 INFO     3000 5959 7.425850 69245.2
2025-07-02 10:23:30,356 INFO     4000 5959 7.285955 69340.6
2025-07-02 10:31:38,552 INFO     5000 5959 7.136692 69340.6
2025-07-02 10:39:17,668 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 10:41:17,706 INFO     Data : 2077
2025-07-02 10:41:17,706 INFO     Hit1 : 0.065479
2025-07-02 10:41:17,706 INFO     Hit3 : 0.127106
2025-07-02 10:41:17,706 INFO     Hit10: 0.199326
2025-07-02 10:41:17,706 INFO     MR   : 1120.920077
2025-07-02 10:41:17,706 INFO     MRR  : 0.114382
2025-07-02 10:41:17,706 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 10:43:30,755 INFO     Data : 2342
2025-07-02 10:43:30,756 INFO     Hit1 : 0.078992
2025-07-02 10:43:30,756 INFO     Hit3 : 0.124253
2025-07-02 10:43:30,756 INFO     Hit10: 0.208796
2025-07-02 10:43:30,756 INFO     MR   : 1044.279889
2025-07-02 10:43:30,756 INFO     MRR  : 0.122250
2025-07-02 10:43:30,756 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 11:14:06,060 INFO     1000 5959
2025-07-02 11:43:17,532 INFO     2000 5959
2025-07-02 12:11:27,026 INFO     3000 5959
2025-07-02 12:39:49,001 INFO     4000 5959
2025-07-02 13:08:51,546 INFO     5000 5959
2025-07-02 13:38:13,981 INFO     >>>>> Generator: Training
2025-07-02 13:38:17,046 INFO     -------------------------
2025-07-02 13:38:17,046 INFO     | EM Iteration: 2/5
2025-07-02 13:38:17,046 INFO     -------------------------
2025-07-02 13:38:17,046 INFO     >>>>> Using Generator's sample rule
2025-07-02 13:38:17,046 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 13:38:17,204 INFO     Predictor: read 1901 rules from list.
2025-07-02 13:38:17,204 INFO     Preprocess training set
2025-07-02 13:38:17,206 INFO     >>>>> Predictor: Training
2025-07-02 13:39:06,371 INFO     1000 5959 8.787239 69332.0
2025-07-02 13:39:55,429 INFO     2000 5959 8.397578 69349.3
2025-07-02 13:40:45,012 INFO     3000 5959 8.125200 69184.5
2025-07-02 13:41:33,718 INFO     4000 5959 7.934502 69253.9
2025-07-02 13:42:23,534 INFO     5000 5959 7.802252 69332.0
2025-07-02 13:43:11,437 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 13:43:21,639 INFO     Data : 2077
2025-07-02 13:43:21,639 INFO     Hit1 : 0.017814
2025-07-02 13:43:21,639 INFO     Hit3 : 0.032740
2025-07-02 13:43:21,639 INFO     Hit10: 0.060664
2025-07-02 13:43:21,639 INFO     MR   : 1453.997593
2025-07-02 13:43:21,639 INFO     MRR  : 0.034058
2025-07-02 13:43:21,639 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 13:43:33,473 INFO     Data : 2342
2025-07-02 13:43:33,473 INFO     Hit1 : 0.017933
2025-07-02 13:43:33,473 INFO     Hit3 : 0.035867
2025-07-02 13:43:33,473 INFO     Hit10: 0.064048
2025-07-02 13:43:33,473 INFO     MR   : 1341.586038
2025-07-02 13:43:33,473 INFO     MRR  : 0.035672
2025-07-02 13:43:33,473 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 13:45:56,311 INFO     1000 5959
2025-07-02 13:48:19,927 INFO     2000 5959
2025-07-02 13:50:40,980 INFO     3000 5959
2025-07-02 13:53:02,950 INFO     4000 5959
2025-07-02 13:55:26,857 INFO     5000 5959
2025-07-02 13:57:48,370 INFO     >>>>> Generator: Training
2025-07-02 13:57:51,304 INFO     -------------------------
2025-07-02 13:57:51,304 INFO     | EM Iteration: 3/5
2025-07-02 13:57:51,304 INFO     -------------------------
2025-07-02 13:57:51,304 INFO     >>>>> Using Generator's sample rule
2025-07-02 13:57:51,304 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 13:57:51,411 INFO     Predictor: read 1877 rules from list.
2025-07-02 13:57:51,411 INFO     Preprocess training set
2025-07-02 13:57:51,412 INFO     >>>>> Predictor: Training
2025-07-02 13:58:41,317 INFO     1000 5959 8.804776 69271.3
2025-07-02 13:59:30,883 INFO     2000 5959 8.429317 69340.6
2025-07-02 14:00:20,533 INFO     3000 5959 8.186362 69384.0
2025-07-02 14:01:10,816 INFO     4000 5959 8.019071 69262.6
2025-07-02 14:02:00,873 INFO     5000 5959 7.894921 69332.0
2025-07-02 14:02:49,005 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 14:02:58,760 INFO     Data : 2077
2025-07-02 14:02:58,761 INFO     Hit1 : 0.014925
2025-07-02 14:02:58,761 INFO     Hit3 : 0.020703
2025-07-02 14:02:58,761 INFO     Hit10: 0.037073
2025-07-02 14:02:58,761 INFO     MR   : 1496.731103
2025-07-02 14:02:58,761 INFO     MRR  : 0.025150
2025-07-02 14:02:58,761 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 14:03:10,005 INFO     Data : 2342
2025-07-02 14:03:10,005 INFO     Hit1 : 0.013237
2025-07-02 14:03:10,005 INFO     Hit3 : 0.021349
2025-07-02 14:03:10,005 INFO     Hit10: 0.033305
2025-07-02 14:03:10,005 INFO     MR   : 1388.734629
2025-07-02 14:03:10,005 INFO     MRR  : 0.023763
2025-07-02 14:03:10,006 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 14:05:30,235 INFO     1000 5959
2025-07-02 14:07:51,206 INFO     2000 5959
2025-07-02 14:10:09,189 INFO     3000 5959
2025-07-02 14:12:27,029 INFO     4000 5959
2025-07-02 14:14:44,714 INFO     5000 5959
2025-07-02 14:16:59,888 INFO     >>>>> Generator: Training
2025-07-02 14:17:02,938 INFO     -------------------------
2025-07-02 14:17:02,938 INFO     | EM Iteration: 4/5
2025-07-02 14:17:02,938 INFO     -------------------------
2025-07-02 14:17:02,938 INFO     >>>>> Using Generator's sample rule
2025-07-02 14:17:02,938 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 14:17:03,049 INFO     Predictor: read 1842 rules from list.
2025-07-02 14:17:03,050 INFO     Preprocess training set
2025-07-02 14:17:03,050 INFO     >>>>> Predictor: Training
2025-07-02 14:17:49,421 INFO     1000 5959 8.796887 69332.0
2025-07-02 14:18:36,176 INFO     2000 5959 8.410776 69349.3
2025-07-02 14:19:22,019 INFO     3000 5959 8.135453 69340.6
2025-07-02 14:20:08,260 INFO     4000 5959 7.938077 69297.3
2025-07-02 14:20:54,383 INFO     5000 5959 7.755154 69219.2
2025-07-02 14:21:38,865 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 14:21:48,423 INFO     Data : 2077
2025-07-02 14:21:48,423 INFO     Hit1 : 0.028888
2025-07-02 14:21:48,423 INFO     Hit3 : 0.045258
2025-07-02 14:21:48,423 INFO     Hit10: 0.067405
2025-07-02 14:21:48,423 INFO     MR   : 1472.430429
2025-07-02 14:21:48,423 INFO     MRR  : 0.044810
2025-07-02 14:21:48,423 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 14:21:59,406 INFO     Data : 2342
2025-07-02 14:21:59,406 INFO     Hit1 : 0.018360
2025-07-02 14:21:59,406 INFO     Hit3 : 0.040564
2025-07-02 14:21:59,406 INFO     Hit10: 0.064048
2025-07-02 14:21:59,406 INFO     MR   : 1362.943638
2025-07-02 14:21:59,406 INFO     MRR  : 0.037713
2025-07-02 14:21:59,406 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 14:24:13,980 INFO     1000 5959
2025-07-02 14:26:27,548 INFO     2000 5959
2025-07-02 14:28:42,001 INFO     3000 5959
2025-07-02 14:30:56,572 INFO     4000 5959
2025-07-02 14:33:12,931 INFO     5000 5959
2025-07-02 14:35:52,592 INFO     >>>>> Generator: Training
2025-07-02 14:35:55,536 INFO     -------------------------
2025-07-02 14:35:55,536 INFO     | EM Iteration: 5/5
2025-07-02 14:35:55,536 INFO     -------------------------
2025-07-02 14:35:55,536 INFO     >>>>> Using Generator's sample rule
2025-07-02 14:35:55,536 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 14:35:55,645 INFO     Predictor: read 1676 rules from list.
2025-07-02 14:35:55,645 INFO     Preprocess training set
2025-07-02 14:35:55,645 INFO     >>>>> Predictor: Training
2025-07-02 14:36:38,153 INFO     1000 5959 8.796624 69271.3
2025-07-02 14:37:21,375 INFO     2000 5959 8.419255 69332.0
2025-07-02 14:38:03,689 INFO     3000 5959 8.168736 69375.3
2025-07-02 14:38:45,547 INFO     4000 5959 7.979277 69279.9
2025-07-02 14:39:32,463 INFO     5000 5959 7.854694 69349.3
2025-07-02 14:40:13,734 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 14:40:22,514 INFO     Data : 2077
2025-07-02 14:40:22,514 INFO     Hit1 : 0.014925
2025-07-02 14:40:22,514 INFO     Hit3 : 0.028406
2025-07-02 14:40:22,514 INFO     Hit10: 0.064035
2025-07-02 14:40:22,514 INFO     MR   : 1412.486038
2025-07-02 14:40:22,514 INFO     MRR  : 0.034058
2025-07-02 14:40:22,514 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 14:40:32,386 INFO     Data : 2342
2025-07-02 14:40:32,386 INFO     Hit1 : 0.015798
2025-07-02 14:40:32,386 INFO     Hit3 : 0.030316
2025-07-02 14:40:32,387 INFO     Hit10: 0.057216
2025-07-02 14:40:32,387 INFO     MR   : 1305.766225
2025-07-02 14:40:32,387 INFO     MRR  : 0.034173
2025-07-02 14:40:32,387 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 14:42:37,608 INFO     1000 5959
2025-07-02 14:44:42,390 INFO     2000 5959
2025-07-02 14:46:48,167 INFO     3000 5959
2025-07-02 14:48:55,058 INFO     4000 5959
2025-07-02 14:51:02,097 INFO     5000 5959
2025-07-02 14:53:06,812 INFO     >>>>> Generator: Training
2025-07-02 14:53:09,660 INFO     -------------------------
2025-07-02 14:53:09,660 INFO     | Post-train Generator
2025-07-02 14:53:09,660 INFO     -------------------------
2025-07-02 14:53:10,940 INFO     >>>>> Generator: Training
2025-07-02 14:53:40,329 INFO     [E01000] Total 1.999598 | Main 2.413656 | RelClus 1.005572 | EntType 0.000000
2025-07-02 14:53:40,330 INFO     -------------------------
2025-07-02 14:53:40,330 INFO     | Beam Search Best Rules
2025-07-02 14:53:40,330 INFO     -------------------------
2025-07-02 14:53:40,330 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 14:53:40,865 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 14:53:45,024 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 14:54:43,614 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 14:55:31,894 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 14:56:05,229 INFO     -------------------------
2025-07-02 14:56:05,230 INFO     | Train Final Predictor+
2025-07-02 14:56:05,230 INFO     -------------------------
2025-07-02 14:56:05,235 INFO     Predictor+: read 18420 rules from list.
2025-07-02 14:56:05,277 INFO     Preprocess training set
2025-07-02 14:56:05,278 INFO     -------------------------
2025-07-02 14:56:05,278 INFO     | Iteration: 1/5
2025-07-02 14:56:05,278 INFO     -------------------------
2025-07-02 14:56:05,278 INFO     >>>>> Predictor: Training
2025-07-02 15:00:57,542 INFO     1000 5959 5.243707 69366.7
2025-07-02 15:05:50,824 INFO     2000 5959 5.052115 69375.3
2025-07-02 15:10:38,221 INFO     3000 5959 5.014783 69219.2
2025-07-02 15:15:23,733 INFO     4000 5959 5.024720 69305.9
2025-07-02 15:20:16,929 INFO     5000 5959 4.981494 69288.6
2025-07-02 15:24:56,997 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 15:26:09,245 INFO     Data : 2077
2025-07-02 15:26:09,245 INFO     Hit1 : 0.088589
2025-07-02 15:26:09,245 INFO     Hit3 : 0.176697
2025-07-02 15:26:09,245 INFO     Hit10: 0.302359
2025-07-02 15:26:09,245 INFO     MR   : 1020.450169
2025-07-02 15:26:09,245 INFO     MRR  : 0.157447
2025-07-02 15:26:09,245 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 15:27:30,978 INFO     Data : 2342
2025-07-02 15:27:30,978 INFO     Hit1 : 0.117848
2025-07-02 15:27:30,978 INFO     Hit3 : 0.201537
2025-07-02 15:27:30,979 INFO     Hit10: 0.307003
2025-07-02 15:27:30,979 INFO     MR   : 940.308284
2025-07-02 15:27:30,979 INFO     MRR  : 0.181808
2025-07-02 15:27:30,979 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_mmoe_adaptive_matrix_3_type_soft_label_20250702_095204/predictor.pt
2025-07-02 15:27:30,988 INFO     -------------------------
2025-07-02 15:27:30,988 INFO     | Iteration: 2/5
2025-07-02 15:27:30,988 INFO     -------------------------
2025-07-02 15:27:30,988 INFO     >>>>> Predictor: Training
2025-07-02 15:32:22,824 INFO     1000 5959 4.955034 69288.6
2025-07-02 15:37:11,101 INFO     2000 5959 4.966767 69288.6
2025-07-02 15:42:04,462 INFO     3000 5959 4.942493 69340.6
2025-07-02 15:46:55,624 INFO     4000 5959 4.938573 69271.3
2025-07-02 15:51:48,168 INFO     5000 5959 4.975113 69219.2
2025-07-02 15:56:26,136 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 15:57:39,945 INFO     Data : 2077
2025-07-02 15:57:39,945 INFO     Hit1 : 0.086182
2025-07-02 15:57:39,945 INFO     Hit3 : 0.172364
2025-07-02 15:57:39,945 INFO     Hit10: 0.296582
2025-07-02 15:57:39,945 INFO     MR   : 998.963890
2025-07-02 15:57:39,945 INFO     MRR  : 0.154471
2025-07-02 15:57:39,945 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 16:02:31,595 INFO     Data : 2342
2025-07-02 16:02:31,596 INFO     Hit1 : 0.111443
2025-07-02 16:02:31,596 INFO     Hit3 : 0.189582
2025-07-02 16:02:31,596 INFO     Hit10: 0.304868
2025-07-02 16:02:31,596 INFO     MR   : 920.304227
2025-07-02 16:02:31,596 INFO     MRR  : 0.174153
2025-07-02 16:02:31,596 INFO     -------------------------
2025-07-02 16:02:31,596 INFO     | Iteration: 3/5
2025-07-02 16:02:31,596 INFO     -------------------------
2025-07-02 16:02:31,596 INFO     >>>>> Predictor: Training
2025-07-02 16:12:58,821 INFO     1000 5959 4.909020 69340.6
2025-07-02 16:17:44,986 INFO     2000 5959 4.902227 69184.5
2025-07-02 16:22:30,380 INFO     3000 5959 4.973395 69253.9
2025-07-02 16:27:22,896 INFO     4000 5959 4.941128 69340.6
2025-07-02 16:32:07,430 INFO     5000 5959 4.922771 69384.0
2025-07-02 16:36:40,605 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 16:37:50,352 INFO     Data : 2077
2025-07-02 16:37:50,352 INFO     Hit1 : 0.082330
2025-07-02 16:37:50,352 INFO     Hit3 : 0.168031
2025-07-02 16:37:50,352 INFO     Hit10: 0.293693
2025-07-02 16:37:50,352 INFO     MR   : 994.734473
2025-07-02 16:37:50,352 INFO     MRR  : 0.151616
2025-07-02 16:37:50,353 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 16:39:08,987 INFO     Data : 2342
2025-07-02 16:39:08,987 INFO     Hit1 : 0.119983
2025-07-02 16:39:08,987 INFO     Hit3 : 0.191716
2025-07-02 16:39:08,987 INFO     Hit10: 0.301452
2025-07-02 16:39:08,987 INFO     MR   : 920.075790
2025-07-02 16:39:08,987 INFO     MRR  : 0.179082
2025-07-02 16:39:08,988 INFO     -------------------------
2025-07-02 16:39:08,988 INFO     | Iteration: 4/5
2025-07-02 16:39:08,988 INFO     -------------------------
2025-07-02 16:39:08,988 INFO     >>>>> Predictor: Training
2025-07-02 16:43:54,423 INFO     1000 5959 4.932216 69323.3
2025-07-02 16:48:36,833 INFO     2000 5959 4.925798 69332.0
2025-07-02 16:53:24,496 INFO     3000 5959 4.948262 69219.2
2025-07-02 16:58:09,623 INFO     4000 5959 4.915415 69297.3
2025-07-02 17:02:51,815 INFO     5000 5959 4.899446 69332.0
2025-07-02 17:07:29,761 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 17:08:41,521 INFO     Data : 2077
2025-07-02 17:08:41,521 INFO     Hit1 : 0.081849
2025-07-02 17:08:41,521 INFO     Hit3 : 0.168512
2025-07-02 17:08:41,521 INFO     Hit10: 0.296100
2025-07-02 17:08:41,521 INFO     MR   : 982.585701
2025-07-02 17:08:41,521 INFO     MRR  : 0.150031
2025-07-02 17:08:41,521 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 17:10:03,811 INFO     Data : 2342
2025-07-02 17:10:03,812 INFO     Hit1 : 0.116994
2025-07-02 17:10:03,812 INFO     Hit3 : 0.191716
2025-07-02 17:10:03,812 INFO     Hit10: 0.307003
2025-07-02 17:10:03,812 INFO     MR   : 909.883219
2025-07-02 17:10:03,812 INFO     MRR  : 0.178005
2025-07-02 17:10:03,812 INFO     -------------------------
2025-07-02 17:10:03,812 INFO     | Iteration: 5/5
2025-07-02 17:10:03,812 INFO     -------------------------
2025-07-02 17:10:03,812 INFO     >>>>> Predictor: Training
2025-07-02 17:16:04,568 INFO     1000 5959 4.857720 69245.2
2025-07-02 17:20:51,574 INFO     2000 5959 4.888411 69262.6
2025-07-02 17:25:38,751 INFO     3000 5959 4.925212 69332.0
2025-07-02 17:30:27,606 INFO     4000 5959 4.942144 69366.7
2025-07-02 17:35:19,666 INFO     5000 5959 4.939197 69262.6
2025-07-02 17:40:02,766 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 17:41:16,921 INFO     Data : 2077
2025-07-02 17:41:16,921 INFO     Hit1 : 0.084256
2025-07-02 17:41:16,921 INFO     Hit3 : 0.174290
2025-07-02 17:41:16,921 INFO     Hit10: 0.298989
2025-07-02 17:41:16,921 INFO     MR   : 983.066923
2025-07-02 17:41:16,921 INFO     MRR  : 0.154124
2025-07-02 17:41:16,921 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 17:42:40,942 INFO     Data : 2342
2025-07-02 17:42:40,942 INFO     Hit1 : 0.124253
2025-07-02 17:42:40,942 INFO     Hit3 : 0.194705
2025-07-02 17:42:40,942 INFO     Hit10: 0.303587
2025-07-02 17:42:40,942 INFO     MR   : 910.254910
2025-07-02 17:42:40,942 INFO     MRR  : 0.182537
2025-07-02 17:42:40,942 INFO     -------------------------
2025-07-02 17:42:40,942 INFO     | Final Test MRR: 0.181808
2025-07-02 17:42:40,942 INFO     -------------------------
entity size:  8673
relation size:  20
