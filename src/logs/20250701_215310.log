W0701 21:53:11.759399 4066251 torch/distributed/run.py:793] 
W0701 21:53:11.759399 4066251 torch/distributed/run.py:793] *****************************************
W0701 21:53:11.759399 4066251 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0701 21:53:11.759399 4066251 torch/distributed/run.py:793] *****************************************
entity size:  8673
relation size:  20
entity size:  8673
relation size:  20
2025-07-01 21:53:13,107 INFO     Data loading | DONE!
2025-07-01 21:53:13,206 INFO     Using subset datasets for training, validation, and testing.
2025-07-01 21:53:13,206 INFO     Subset ratio: 0.01
2025-07-01 21:53:13,207 INFO     [Subset] TrainDataset: 59/5959 samples (1%)
2025-07-01 21:53:13,207 INFO     [Subset] ValidDataset: 2/260 samples (1%)
2025-07-01 21:53:13,207 INFO     [Subset] TestDataset: 2/293 samples (1%)
2025-07-01 21:53:13,208 INFO     [Subset] RuleDataset: 136/13661 samples (1%)
2025-07-01 21:53:13,344 INFO     -------------------------
2025-07-01 21:53:13,344 INFO     | EM Iteration: 1/2
2025-07-01 21:53:13,345 INFO     -------------------------
2025-07-01 21:53:13,345 INFO     >>>>> Using miner's rule
2025-07-01 21:53:13,345 INFO     >>>>> Using miner's rule
2025-07-01 21:53:13,345 INFO     Predictor: read 10 rules from list.
2025-07-01 21:53:13,345 INFO     Predictor: read 10 rules from list.
2025-07-01 21:53:14,003 INFO     Initializing distributed process group
2025-07-01 21:53:14,011 INFO     Preprocess training set
2025-07-01 21:53:14,072 INFO     >>>>> Predictor: Training
[rank1]:[W701 21:53:14.731421064 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-07-01 21:53:14,580 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 21:53:14,595 INFO     Data : 16
2025-07-01 21:53:14,596 INFO     Hit1 : 0.000000
2025-07-01 21:53:14,596 INFO     Hit3 : 0.000000
2025-07-01 21:53:14,596 INFO     Hit10: 0.000000
2025-07-01 21:53:14,596 INFO     MR   : 2376.687500
2025-07-01 21:53:14,596 INFO     MRR  : 0.006172
2025-07-01 21:53:14,596 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 21:53:14,606 INFO     Data : 16
2025-07-01 21:53:14,606 INFO     Hit1 : 0.000000
2025-07-01 21:53:14,606 INFO     Hit3 : 0.000000
2025-07-01 21:53:14,606 INFO     Hit10: 0.000000
2025-07-01 21:53:14,606 INFO     MR   : 2361.187500
2025-07-01 21:53:14,606 INFO     MRR  : 0.005045
2025-07-01 21:53:14,606 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 21:53:14,673 INFO     >>>>> Generator: Training
2025-07-01 21:53:14,821 INFO     [E00001] Total 2.549977 | Main 3.069973 | RelClus 1.104033 | EntType 0.000000
2025-07-01 21:53:14,835 INFO     [E00002] Total 2.548634 | Main 3.068386 | RelClus 1.103788 | EntType 0.000000
2025-07-01 21:53:14,850 INFO     [E00003] Total 2.546294 | Main 3.065775 | RelClus 1.104948 | EntType 0.000000
2025-07-01 21:53:14,872 INFO     [E00004] Total 2.547540 | Main 3.067125 | RelClus 1.103898 | EntType 0.000000
2025-07-01 21:53:14,883 INFO     >>>>> Using Generator's sample rule
2025-07-01 21:53:14,887 INFO     [E00005] Total 2.546141 | Main 3.065498 | RelClus 1.103896 | EntType 0.000000
2025-07-01 21:53:14,902 INFO     [E00006] Total 2.545912 | Main 3.065301 | RelClus 1.104632 | EntType 0.000000
2025-07-01 21:53:14,916 INFO     [E00007] Total 2.544487 | Main 3.063707 | RelClus 1.105312 | EntType 0.000000
2025-07-01 21:53:14,931 INFO     [E00008] Total 2.544099 | Main 3.063027 | RelClus 1.102880 | EntType 0.000000
2025-07-01 21:53:14,946 INFO     [E00009] Total 2.543819 | Main 3.062830 | RelClus 1.104246 | EntType 0.000000
2025-07-01 21:53:14,965 INFO     [E00010] Total 2.542347 | Main 3.061084 | RelClus 1.103885 | EntType 0.000000
2025-07-01 21:53:14,965 INFO     -------------------------
2025-07-01 21:53:14,965 INFO     | EM Iteration: 2/2
2025-07-01 21:53:14,965 INFO     -------------------------
2025-07-01 21:53:14,965 INFO     >>>>> Using Generator's sample rule
2025-07-01 21:53:14,965 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 21:53:15,013 INFO     Predictor: read 199 rules from list.
2025-07-01 21:53:15,496 INFO     Predictor: read 199 rules from list.
2025-07-01 21:53:15,496 INFO     Preprocess training set
2025-07-01 21:53:15,496 INFO     >>>>> Predictor: Training
[rank0]:[W701 21:53:15.705856391 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2025-07-01 21:53:15,719 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 21:53:15,731 INFO     Data : 16
2025-07-01 21:53:15,731 INFO     Hit1 : 0.000000
2025-07-01 21:53:15,731 INFO     Hit3 : 0.000000
2025-07-01 21:53:15,731 INFO     Hit10: 0.000000
2025-07-01 21:53:15,731 INFO     MR   : 2103.468750
2025-07-01 21:53:15,732 INFO     MRR  : 0.008418
2025-07-01 21:53:15,732 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 21:53:15,745 INFO     Data : 16
2025-07-01 21:53:15,746 INFO     Hit1 : 0.000000
2025-07-01 21:53:15,746 INFO     Hit3 : 0.000000
2025-07-01 21:53:15,746 INFO     Hit10: 0.000000
2025-07-01 21:53:15,746 INFO     MR   : 2329.062500
2025-07-01 21:53:15,746 INFO     MRR  : 0.008721
2025-07-01 21:53:15,746 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 21:53:16,153 INFO     >>>>> Generator: Training
2025-07-01 21:53:16,174 INFO     [E00001] Total 2.527196 | Main 3.043577 | RelClus 1.105378 | EntType 0.000000
2025-07-01 21:53:16,191 INFO     [E00002] Total 2.526998 | Main 3.043341 | RelClus 1.105317 | EntType 0.000000
2025-07-01 21:53:16,207 INFO     [E00003] Total 2.526611 | Main 3.042919 | RelClus 1.105643 | EntType 0.000000
2025-07-01 21:53:16,223 INFO     [E00004] Total 2.526517 | Main 3.042807 | RelClus 1.105609 | EntType 0.000000
2025-07-01 21:53:16,239 INFO     [E00005] Total 2.526074 | Main 3.042314 | RelClus 1.105873 | EntType 0.000000
2025-07-01 21:53:16,255 INFO     [E00006] Total 2.526089 | Main 3.042337 | RelClus 1.105945 | EntType 0.000000
2025-07-01 21:53:16,272 INFO     [E00007] Total 2.525869 | Main 3.042092 | RelClus 1.106065 | EntType 0.000000
2025-07-01 21:53:16,289 INFO     [E00008] Total 2.525465 | Main 3.041653 | RelClus 1.106428 | EntType 0.000000
2025-07-01 21:53:16,305 INFO     [E00009] Total 2.525534 | Main 3.041725 | RelClus 1.106342 | EntType 0.000000
2025-07-01 21:53:16,322 INFO     [E00010] Total 2.525394 | Main 3.041595 | RelClus 1.106715 | EntType 0.000000
2025-07-01 21:53:16,323 INFO     -------------------------
2025-07-01 21:53:16,323 INFO     | Post-train Generator
2025-07-01 21:53:16,323 INFO     -------------------------
2025-07-01 21:53:16,324 INFO     >>>>> Generator: Training
2025-07-01 21:53:16,342 INFO     [E00001] Total 2.524969 | Main 3.041071 | RelClus 1.106400 | EntType 0.000000
2025-07-01 21:53:16,358 INFO     [E00002] Total 2.524677 | Main 3.040728 | RelClus 1.106367 | EntType 0.000000
2025-07-01 21:53:16,374 INFO     [E00003] Total 2.524738 | Main 3.040846 | RelClus 1.106906 | EntType 0.000000
2025-07-01 21:53:16,391 INFO     [E00004] Total 2.524267 | Main 3.040297 | RelClus 1.106912 | EntType 0.000000
2025-07-01 21:53:16,406 INFO     [E00005] Total 2.524122 | Main 3.040124 | RelClus 1.106853 | EntType 0.000000
2025-07-01 21:53:16,422 INFO     [E00006] Total 2.523937 | Main 3.039927 | RelClus 1.107066 | EntType 0.000000
2025-07-01 21:53:16,439 INFO     [E00007] Total 2.523947 | Main 3.039939 | RelClus 1.107084 | EntType 0.000000
2025-07-01 21:53:16,455 INFO     [E00008] Total 2.523590 | Main 3.039550 | RelClus 1.107397 | EntType 0.000000
2025-07-01 21:53:16,471 INFO     [E00009] Total 2.523187 | Main 3.039096 | RelClus 1.107582 | EntType 0.000000
2025-07-01 21:53:16,487 INFO     [E00010] Total 2.523094 | Main 3.039016 | RelClus 1.107902 | EntType 0.000000
2025-07-01 21:53:16,487 INFO     -------------------------
2025-07-01 21:53:16,487 INFO     | Beam Search Best Rules
2025-07-01 21:53:16,487 INFO     -------------------------
2025-07-01 21:53:16,487 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 21:53:17,256 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-07-01 21:53:17,256 INFO     Subset ratio: 0.01
2025-07-01 21:53:17,256 INFO     Subset sizes: train=59, valid=2, test=2, rule dataset=4
2025-07-01 21:53:17,256 INFO     -------------------------
2025-07-01 21:53:17,256 INFO     | Train Final Predictor+
2025-07-01 21:53:17,257 INFO     -------------------------
2025-07-01 21:53:17,257 INFO     Predictor+: read 4 rules from list.
2025-07-01 21:53:17,257 INFO     Preprocess training set
2025-07-01 21:53:17,258 INFO     -------------------------
2025-07-01 21:53:17,258 INFO     | Iteration: 1/1
2025-07-01 21:53:17,258 INFO     -------------------------
2025-07-01 21:53:17,258 INFO     >>>>> Predictor: Training
W0701 21:54:53.702272 4066251 torch/distributed/elastic/agent/server/api.py:704] Received Signals.SIGINT death signal, shutting down workers
W0701 21:54:53.703010 4066251 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 4066277 closing signal SIGINT
W0701 21:54:53.703323 4066251 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 4066280 closing signal SIGINT
W0701 21:54:53.951975 4066251 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 4066277 closing signal SIGTERM
W0701 21:54:53.952271 4066251 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 4066280 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 696, in run
    result = self._invoke_run(role)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 855, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 4066251 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/emma/polly_env_py39/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 260, in launch_agent
    result = agent.run()
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 137, in wrapper
    result = f(*args, **kwargs)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 705, in run
    self._shutdown(e.sigval)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 365, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 572, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 909, in _close
    handler.proc.wait(time_to_wait)
  File "/usr/lib/python3.9/subprocess.py", line 1189, in wait
    return self._wait(timeout=timeout)
  File "/usr/lib/python3.9/subprocess.py", line 1927, in _wait
    time.sleep(delay)
  File "/home/emma/polly_env_py39/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 4066251 got signal: 2
