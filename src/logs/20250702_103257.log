2025-07-02 10:32:58,193 INFO     is_soft_label: False
2025-07-02 10:32:58,193 INFO     is_scheduled_sampling: False
2025-07-02 10:32:58,193 INFO     is_test_mode: False
2025-07-02 10:32:58,395 INFO     Data loading | DONE!
2025-07-02 10:32:58,482 INFO     Using full datasets for training, validation, and testing.
2025-07-02 10:32:58,588 INFO     -------------------------
2025-07-02 10:32:58,589 INFO     | EM Iteration: 1/5
2025-07-02 10:32:58,589 INFO     -------------------------
2025-07-02 10:32:58,589 INFO     >>>>> Using miner's rule
2025-07-02 10:32:58,657 INFO     Predictor: read 13661 rules from list.
2025-07-02 10:32:59,296 INFO     Preprocess training set
2025-07-02 10:32:59,350 INFO     >>>>> Predictor: Training
2025-07-02 10:41:10,784 INFO     1000 5959 8.299284 69314.6
2025-07-02 10:49:11,335 INFO     2000 5959 7.689227 69271.3
2025-07-02 10:56:59,050 INFO     3000 5959 7.425850 69245.2
2025-07-02 11:04:53,529 INFO     4000 5959 7.285955 69340.6
2025-07-02 11:13:37,898 INFO     5000 5959 7.136692 69340.6
2025-07-02 11:21:25,522 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 11:23:24,919 INFO     Data : 2077
2025-07-02 11:23:24,920 INFO     Hit1 : 0.065479
2025-07-02 11:23:24,920 INFO     Hit3 : 0.127106
2025-07-02 11:23:24,920 INFO     Hit10: 0.199326
2025-07-02 11:23:24,920 INFO     MR   : 1120.920077
2025-07-02 11:23:24,920 INFO     MRR  : 0.114382
2025-07-02 11:23:24,920 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 11:25:38,558 INFO     Data : 2342
2025-07-02 11:25:38,558 INFO     Hit1 : 0.078992
2025-07-02 11:25:38,558 INFO     Hit3 : 0.124253
2025-07-02 11:25:38,558 INFO     Hit10: 0.208796
2025-07-02 11:25:38,558 INFO     MR   : 1044.279889
2025-07-02 11:25:38,558 INFO     MRR  : 0.122250
2025-07-02 11:25:38,559 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 11:55:47,470 INFO     1000 5959
2025-07-02 12:25:34,569 INFO     2000 5959
2025-07-02 12:54:35,874 INFO     3000 5959
2025-07-02 13:24:14,738 INFO     4000 5959
2025-07-02 14:05:57,610 INFO     5000 5959
2025-07-02 14:39:17,793 INFO     >>>>> Generator: Training
2025-07-02 14:39:22,573 INFO     -------------------------
2025-07-02 14:39:22,574 INFO     | EM Iteration: 2/5
2025-07-02 14:39:22,574 INFO     -------------------------
2025-07-02 14:39:22,574 INFO     >>>>> Using Generator's sample rule
2025-07-02 14:39:22,574 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 14:39:22,980 INFO     Predictor: read 1896 rules from list.
2025-07-02 14:39:22,981 INFO     Preprocess training set
2025-07-02 14:39:22,988 INFO     >>>>> Predictor: Training
2025-07-02 14:40:12,074 INFO     1000 5959 8.801083 69332.0
2025-07-02 14:41:01,588 INFO     2000 5959 8.429491 69349.3
2025-07-02 14:41:51,208 INFO     3000 5959 8.190493 69184.5
2025-07-02 14:42:39,888 INFO     4000 5959 8.009892 69253.9
2025-07-02 14:43:29,171 INFO     5000 5959 7.880385 69332.0
2025-07-02 14:44:16,618 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 14:44:26,790 INFO     Data : 2077
2025-07-02 14:44:26,791 INFO     Hit1 : 0.012037
2025-07-02 14:44:26,791 INFO     Hit3 : 0.022629
2025-07-02 14:44:26,791 INFO     Hit10: 0.042850
2025-07-02 14:44:26,791 INFO     MR   : 1478.965575
2025-07-02 14:44:26,791 INFO     MRR  : 0.024982
2025-07-02 14:44:26,791 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 14:44:38,211 INFO     Data : 2342
2025-07-02 14:44:38,211 INFO     Hit1 : 0.011529
2025-07-02 14:44:38,211 INFO     Hit3 : 0.020068
2025-07-02 14:44:38,212 INFO     Hit10: 0.040564
2025-07-02 14:44:38,212 INFO     MR   : 1361.457301
2025-07-02 14:44:38,212 INFO     MRR  : 0.023627
2025-07-02 14:44:38,212 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 14:46:59,784 INFO     1000 5959
2025-07-02 14:49:21,423 INFO     2000 5959
2025-07-02 14:51:42,829 INFO     3000 5959
2025-07-02 14:54:05,013 INFO     4000 5959
2025-07-02 14:56:27,005 INFO     5000 5959
2025-07-02 14:58:45,777 INFO     >>>>> Generator: Training
2025-07-02 14:58:50,313 INFO     -------------------------
2025-07-02 14:58:50,314 INFO     | EM Iteration: 3/5
2025-07-02 14:58:50,314 INFO     -------------------------
2025-07-02 14:58:50,314 INFO     >>>>> Using Generator's sample rule
2025-07-02 14:58:50,314 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 14:58:50,680 INFO     Predictor: read 1922 rules from list.
2025-07-02 14:58:50,681 INFO     Preprocess training set
2025-07-02 14:58:50,681 INFO     >>>>> Predictor: Training
2025-07-02 14:59:40,832 INFO     1000 5959 8.818633 69271.3
2025-07-02 15:00:30,419 INFO     2000 5959 8.487878 69340.6
2025-07-02 15:01:19,955 INFO     3000 5959 8.275332 69384.0
2025-07-02 15:02:10,755 INFO     4000 5959 8.140576 69262.6
2025-07-02 15:03:01,233 INFO     5000 5959 8.037661 69332.0
2025-07-02 15:03:49,514 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 15:03:59,862 INFO     Data : 2077
2025-07-02 15:03:59,862 INFO     Hit1 : 0.012037
2025-07-02 15:03:59,862 INFO     Hit3 : 0.023110
2025-07-02 15:03:59,862 INFO     Hit10: 0.058257
2025-07-02 15:03:59,862 INFO     MR   : 1454.403226
2025-07-02 15:03:59,862 INFO     MRR  : 0.028506
2025-07-02 15:03:59,862 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 15:04:11,497 INFO     Data : 2342
2025-07-02 15:04:11,497 INFO     Hit1 : 0.010248
2025-07-02 15:04:11,497 INFO     Hit3 : 0.022630
2025-07-02 15:04:11,497 INFO     Hit10: 0.050811
2025-07-02 15:04:11,498 INFO     MR   : 1355.090307
2025-07-02 15:04:11,498 INFO     MRR  : 0.026250
2025-07-02 15:04:11,498 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 15:06:31,412 INFO     1000 5959
2025-07-02 15:08:51,185 INFO     2000 5959
2025-07-02 15:11:11,707 INFO     3000 5959
2025-07-02 15:13:32,003 INFO     4000 5959
2025-07-02 15:15:52,340 INFO     5000 5959
2025-07-02 15:18:10,845 INFO     >>>>> Generator: Training
2025-07-02 15:18:15,467 INFO     -------------------------
2025-07-02 15:18:15,467 INFO     | EM Iteration: 4/5
2025-07-02 15:18:15,467 INFO     -------------------------
2025-07-02 15:18:15,467 INFO     >>>>> Using Generator's sample rule
2025-07-02 15:18:15,467 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 15:18:15,824 INFO     Predictor: read 1944 rules from list.
2025-07-02 15:18:15,825 INFO     Preprocess training set
2025-07-02 15:18:15,825 INFO     >>>>> Predictor: Training
2025-07-02 15:19:06,576 INFO     1000 5959 8.808441 69332.0
2025-07-02 15:19:57,317 INFO     2000 5959 8.458967 69349.3
2025-07-02 15:20:46,810 INFO     3000 5959 8.262551 69340.6
2025-07-02 15:21:37,241 INFO     4000 5959 8.102423 69297.3
2025-07-02 15:22:27,175 INFO     5000 5959 7.974737 69219.2
2025-07-02 15:23:15,323 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 15:23:25,731 INFO     Data : 2077
2025-07-02 15:23:25,732 INFO     Hit1 : 0.001926
2025-07-02 15:23:25,732 INFO     Hit3 : 0.003370
2025-07-02 15:23:25,732 INFO     Hit10: 0.010592
2025-07-02 15:23:25,732 INFO     MR   : 1540.792248
2025-07-02 15:23:25,732 INFO     MRR  : 0.008614
2025-07-02 15:23:25,732 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 15:23:37,547 INFO     Data : 2342
2025-07-02 15:23:37,547 INFO     Hit1 : 0.000854
2025-07-02 15:23:37,547 INFO     Hit3 : 0.003843
2025-07-02 15:23:37,547 INFO     Hit10: 0.009394
2025-07-02 15:23:37,547 INFO     MR   : 1427.253416
2025-07-02 15:23:37,547 INFO     MRR  : 0.008127
2025-07-02 15:23:37,547 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 15:25:59,562 INFO     1000 5959
2025-07-02 15:28:21,406 INFO     2000 5959
2025-07-02 15:30:43,487 INFO     3000 5959
2025-07-02 15:33:05,420 INFO     4000 5959
2025-07-02 15:35:27,917 INFO     5000 5959
2025-07-02 15:37:45,673 INFO     >>>>> Generator: Training
2025-07-02 15:37:50,225 INFO     -------------------------
2025-07-02 15:37:50,225 INFO     | EM Iteration: 5/5
2025-07-02 15:37:50,225 INFO     -------------------------
2025-07-02 15:37:50,225 INFO     >>>>> Using Generator's sample rule
2025-07-02 15:37:50,225 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 15:37:50,587 INFO     Predictor: read 1964 rules from list.
2025-07-02 15:37:50,587 INFO     Preprocess training set
2025-07-02 15:37:50,588 INFO     >>>>> Predictor: Training
2025-07-02 15:38:42,410 INFO     1000 5959 8.832185 69271.3
2025-07-02 15:39:33,522 INFO     2000 5959 8.520310 69332.0
2025-07-02 15:40:24,539 INFO     3000 5959 8.338445 69375.3
2025-07-02 15:41:15,397 INFO     4000 5959 8.209087 69279.9
2025-07-02 15:42:06,184 INFO     5000 5959 8.125331 69349.3
2025-07-02 15:42:54,848 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 15:43:05,308 INFO     Data : 2077
2025-07-02 15:43:05,308 INFO     Hit1 : 0.012037
2025-07-02 15:43:05,308 INFO     Hit3 : 0.023110
2025-07-02 15:43:05,308 INFO     Hit10: 0.035147
2025-07-02 15:43:05,308 INFO     MR   : 1480.386375
2025-07-02 15:43:05,308 INFO     MRR  : 0.024428
2025-07-02 15:43:05,308 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 15:43:17,096 INFO     Data : 2342
2025-07-02 15:43:17,096 INFO     Hit1 : 0.013664
2025-07-02 15:43:17,096 INFO     Hit3 : 0.023484
2025-07-02 15:43:17,096 INFO     Hit10: 0.034586
2025-07-02 15:43:17,096 INFO     MR   : 1382.182109
2025-07-02 15:43:17,096 INFO     MRR  : 0.025623
2025-07-02 15:43:17,096 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 15:45:41,316 INFO     1000 5959
2025-07-02 15:48:05,156 INFO     2000 5959
2025-07-02 15:50:28,984 INFO     3000 5959
2025-07-02 15:52:52,855 INFO     4000 5959
2025-07-02 15:55:16,258 INFO     5000 5959
2025-07-02 15:57:35,184 INFO     >>>>> Generator: Training
2025-07-02 15:57:39,793 INFO     -------------------------
2025-07-02 15:57:39,794 INFO     | Post-train Generator
2025-07-02 15:57:39,794 INFO     -------------------------
2025-07-02 15:57:40,235 INFO     >>>>> Generator: Training
2025-07-02 15:58:26,384 INFO     [E01000] Total 7.088693 | Main 4.122947 | RelClus 3.063004 | EntType 8.638314
2025-07-02 15:58:26,384 INFO     -------------------------
2025-07-02 15:58:26,385 INFO     | Beam Search Best Rules
2025-07-02 15:58:26,385 INFO     -------------------------
2025-07-02 15:58:26,385 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 15:58:27,663 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 15:58:42,087 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 16:03:19,244 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 16:07:24,545 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 16:10:15,471 INFO     -------------------------
2025-07-02 16:10:15,471 INFO     | Train Final Predictor+
2025-07-02 16:10:15,471 INFO     -------------------------
2025-07-02 16:10:15,476 INFO     Predictor+: read 18420 rules from list.
2025-07-02 16:10:15,518 INFO     Preprocess training set
2025-07-02 16:10:15,526 INFO     -------------------------
2025-07-02 16:10:15,526 INFO     | Iteration: 1/5
2025-07-02 16:10:15,526 INFO     -------------------------
2025-07-02 16:10:15,526 INFO     >>>>> Predictor: Training
2025-07-02 16:14:38,229 INFO     1000 5959 4.870685 69366.7
2025-07-02 16:18:57,788 INFO     2000 5959 4.749681 69375.3
2025-07-02 16:23:21,217 INFO     3000 5959 4.717120 69219.2
2025-07-02 16:27:43,255 INFO     4000 5959 4.709103 69305.9
2025-07-02 16:32:05,600 INFO     5000 5959 4.671540 69288.6
2025-07-02 16:36:18,608 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 16:37:24,630 INFO     Data : 2077
2025-07-02 16:37:24,630 INFO     Hit1 : 0.093404
2025-07-02 16:37:24,630 INFO     Hit3 : 0.181030
2025-07-02 16:37:24,630 INFO     Hit10: 0.313433
2025-07-02 16:37:24,631 INFO     MR   : 976.393837
2025-07-02 16:37:24,631 INFO     MRR  : 0.163877
2025-07-02 16:37:24,631 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 16:38:39,096 INFO     Data : 2342
2025-07-02 16:38:39,097 INFO     Hit1 : 0.126388
2025-07-02 16:38:39,097 INFO     Hit3 : 0.201110
2025-07-02 16:38:39,097 INFO     Hit10: 0.314261
2025-07-02 16:38:39,097 INFO     MR   : 897.902220
2025-07-02 16:38:39,097 INFO     MRR  : 0.186993
2025-07-02 16:38:39,097 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_hard_sharing_adaptive_matrix_3_type_soft_label_20250702_103257/predictor.pt
2025-07-02 16:38:39,104 INFO     -------------------------
2025-07-02 16:38:39,104 INFO     | Iteration: 2/5
2025-07-02 16:38:39,104 INFO     -------------------------
2025-07-02 16:38:39,104 INFO     >>>>> Predictor: Training
2025-07-02 16:43:03,647 INFO     1000 5959 4.649672 69288.6
2025-07-02 16:47:31,370 INFO     2000 5959 4.649227 69288.6
2025-07-02 16:51:58,814 INFO     3000 5959 4.630909 69340.6
2025-07-02 16:56:26,571 INFO     4000 5959 4.639295 69271.3
2025-07-02 17:00:53,904 INFO     5000 5959 4.660508 69219.2
2025-07-02 17:05:12,440 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 17:06:18,584 INFO     Data : 2077
2025-07-02 17:06:18,584 INFO     Hit1 : 0.089071
2025-07-02 17:06:18,584 INFO     Hit3 : 0.179104
2025-07-02 17:06:18,584 INFO     Hit10: 0.298026
2025-07-02 17:06:18,584 INFO     MR   : 949.078960
2025-07-02 17:06:18,584 INFO     MRR  : 0.159628
2025-07-02 17:06:18,585 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 17:07:31,765 INFO     Data : 2342
2025-07-02 17:07:31,765 INFO     Hit1 : 0.114859
2025-07-02 17:07:31,765 INFO     Hit3 : 0.193424
2025-07-02 17:07:31,765 INFO     Hit10: 0.311699
2025-07-02 17:07:31,765 INFO     MR   : 875.988471
2025-07-02 17:07:31,765 INFO     MRR  : 0.178527
2025-07-02 17:07:31,765 INFO     -------------------------
2025-07-02 17:07:31,765 INFO     | Iteration: 3/5
2025-07-02 17:07:31,765 INFO     -------------------------
2025-07-02 17:07:31,765 INFO     >>>>> Predictor: Training
2025-07-02 17:13:46,403 INFO     1000 5959 4.611709 69340.6
2025-07-02 17:18:11,859 INFO     2000 5959 4.581786 69184.5
2025-07-02 17:22:35,746 INFO     3000 5959 4.641933 69253.9
2025-07-02 17:27:00,878 INFO     4000 5959 4.620885 69340.6
2025-07-02 17:31:34,055 INFO     5000 5959 4.615888 69384.0
2025-07-02 17:35:52,641 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 17:36:59,445 INFO     Data : 2077
2025-07-02 17:36:59,445 INFO     Hit1 : 0.099663
2025-07-02 17:36:59,446 INFO     Hit3 : 0.185364
2025-07-02 17:36:59,446 INFO     Hit10: 0.312951
2025-07-02 17:36:59,446 INFO     MR   : 937.357246
2025-07-02 17:36:59,446 INFO     MRR  : 0.167397
2025-07-02 17:36:59,446 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 17:38:14,759 INFO     Data : 2342
2025-07-02 17:38:14,759 INFO     Hit1 : 0.132792
2025-07-02 17:38:14,759 INFO     Hit3 : 0.207942
2025-07-02 17:38:14,759 INFO     Hit10: 0.319812
2025-07-02 17:38:14,759 INFO     MR   : 866.678907
2025-07-02 17:38:14,759 INFO     MRR  : 0.192367
2025-07-02 17:38:14,760 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_hard_sharing_adaptive_matrix_3_type_soft_label_20250702_103257/predictor.pt
2025-07-02 17:38:14,768 INFO     -------------------------
2025-07-02 17:38:14,768 INFO     | Iteration: 4/5
2025-07-02 17:38:14,768 INFO     -------------------------
2025-07-02 17:38:14,768 INFO     >>>>> Predictor: Training
2025-07-02 17:43:18,283 INFO     1000 5959 4.620465 69323.3
2025-07-02 17:48:24,346 INFO     2000 5959 4.597311 69332.0
2025-07-02 17:52:41,823 INFO     3000 5959 4.627587 69219.2
2025-07-02 17:58:22,643 INFO     4000 5959 4.624906 69297.3
2025-07-02 18:06:59,911 INFO     5000 5959 4.589775 69332.0
2025-07-02 18:15:15,110 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 18:17:02,969 INFO     Data : 2077
2025-07-02 18:17:02,969 INFO     Hit1 : 0.096293
2025-07-02 18:17:02,969 INFO     Hit3 : 0.185364
2025-07-02 18:17:02,969 INFO     Hit10: 0.315840
2025-07-02 18:17:02,969 INFO     MR   : 924.406837
2025-07-02 18:17:02,970 INFO     MRR  : 0.166551
2025-07-02 18:17:02,970 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 18:19:26,291 INFO     Data : 2342
2025-07-02 18:19:26,291 INFO     Hit1 : 0.125534
2025-07-02 18:19:26,291 INFO     Hit3 : 0.204099
2025-07-02 18:19:26,291 INFO     Hit10: 0.316823
2025-07-02 18:19:26,291 INFO     MR   : 856.548249
2025-07-02 18:19:26,291 INFO     MRR  : 0.188744
2025-07-02 18:19:26,291 INFO     -------------------------
2025-07-02 18:19:26,291 INFO     | Iteration: 5/5
2025-07-02 18:19:26,291 INFO     -------------------------
2025-07-02 18:19:26,291 INFO     >>>>> Predictor: Training
2025-07-02 18:28:02,187 INFO     1000 5959 4.563487 69245.2
2025-07-02 18:36:44,637 INFO     2000 5959 4.555988 69262.6
