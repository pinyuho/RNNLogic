2025-06-24 23:05:18,363 INFO     Data loading | DONE!
2025-06-24 23:05:18,466 INFO     Using subset datasets for training, validation, and testing.
2025-06-24 23:05:18,466 INFO     Subset ratio: 0.01
2025-06-24 23:05:18,466 INFO     [Subset] TrainDataset: 59/5959 samples (1%)
2025-06-24 23:05:18,466 INFO     [Subset] ValidDataset: 2/260 samples (1%)
2025-06-24 23:05:18,467 INFO     [Subset] TestDataset: 2/293 samples (1%)
2025-06-24 23:05:18,467 INFO     [Subset] RuleDataset: 136/13661 samples (1%)
2025-06-24 23:05:18,636 INFO     -------------------------
2025-06-24 23:05:18,636 INFO     | EM Iteration: 1/2
2025-06-24 23:05:18,636 INFO     -------------------------
2025-06-24 23:05:18,636 INFO     >>>>> Using miner's rule
2025-06-24 23:05:18,636 INFO     Predictor: read 10 rules from list.
2025-06-24 23:05:19,377 INFO     Preprocess training set
2025-06-24 23:05:19,498 INFO     >>>>> Predictor: Training
2025-06-24 23:05:26,026 INFO     >>>>> Predictor: Evaluating on valid
2025-06-24 23:05:26,367 INFO     Data : 16
2025-06-24 23:05:26,367 INFO     Hit1 : 0.000000
2025-06-24 23:05:26,367 INFO     Hit3 : 0.000000
2025-06-24 23:05:26,367 INFO     Hit10: 0.062500
2025-06-24 23:05:26,367 INFO     MR   : 2373.875000
2025-06-24 23:05:26,367 INFO     MRR  : 0.008906
2025-06-24 23:05:26,367 INFO     >>>>> Predictor: Evaluating on test
2025-06-24 23:05:26,670 INFO     Data : 16
2025-06-24 23:05:26,670 INFO     Hit1 : 0.000000
2025-06-24 23:05:26,670 INFO     Hit3 : 0.000000
2025-06-24 23:05:26,670 INFO     Hit10: 0.000000
2025-06-24 23:05:26,670 INFO     MR   : 2367.812500
2025-06-24 23:05:26,670 INFO     MRR  : 0.004095
2025-06-24 23:05:26,670 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-24 23:05:28,138 INFO     >>>>> Generator: Training
2025-06-24 23:05:28,709 INFO     [E00001] Total 2.967573 | Main 2.952748 | Aux1 1.172203 | Aux2 4.881544
2025-06-24 23:05:28,996 INFO     [E00002] Total 2.961949 | Main 2.946170 | Aux1 1.172213 | Aux2 4.877910
2025-06-24 23:05:29,285 INFO     [E00003] Total 2.956309 | Main 2.939571 | Aux1 1.172235 | Aux2 4.874288
2025-06-24 23:05:29,574 INFO     [E00004] Total 2.950683 | Main 2.932986 | Aux1 1.172278 | Aux2 4.870670
2025-06-24 23:05:29,865 INFO     [E00005] Total 2.945060 | Main 2.926409 | Aux1 1.172298 | Aux2 4.867030
2025-06-24 23:05:30,162 INFO     [E00006] Total 2.939426 | Main 2.919817 | Aux1 1.172322 | Aux2 4.863404
2025-06-24 23:05:30,452 INFO     [E00007] Total 2.933798 | Main 2.913232 | Aux1 1.172363 | Aux2 4.859759
2025-06-24 23:05:30,742 INFO     [E00008] Total 2.928186 | Main 2.906669 | Aux1 1.172384 | Aux2 4.856129
2025-06-24 23:05:31,041 INFO     [E00009] Total 2.922554 | Main 2.900082 | Aux1 1.172398 | Aux2 4.852490
2025-06-24 23:05:31,325 INFO     [E00010] Total 2.916929 | Main 2.893504 | Aux1 1.172434 | Aux2 4.848832
2025-06-24 23:05:31,325 INFO     -------------------------
2025-06-24 23:05:31,325 INFO     | EM Iteration: 2/2
2025-06-24 23:05:31,325 INFO     -------------------------
2025-06-24 23:05:31,325 INFO     >>>>> Using Generator's sample rule
2025-06-24 23:05:31,325 INFO     >>>>> Generator: Rule generation with sampling
2025-06-24 23:05:34,265 INFO     Predictor: read 199 rules from list.
2025-06-24 23:05:34,266 INFO     Preprocess training set
2025-06-24 23:05:34,270 INFO     >>>>> Predictor: Training
2025-06-24 23:05:54,511 INFO     >>>>> Predictor: Evaluating on valid
2025-06-24 23:05:55,132 INFO     Data : 16
2025-06-24 23:05:55,132 INFO     Hit1 : 0.000000
2025-06-24 23:05:55,132 INFO     Hit3 : 0.000000
2025-06-24 23:05:55,132 INFO     Hit10: 0.000000
2025-06-24 23:05:55,132 INFO     MR   : 1917.187500
2025-06-24 23:05:55,132 INFO     MRR  : 0.003349
2025-06-24 23:05:55,132 INFO     >>>>> Predictor: Evaluating on test
2025-06-24 23:05:55,867 INFO     Data : 16
2025-06-24 23:05:55,867 INFO     Hit1 : 0.000000
2025-06-24 23:05:55,868 INFO     Hit3 : 0.062500
2025-06-24 23:05:55,868 INFO     Hit10: 0.125000
2025-06-24 23:05:55,868 INFO     MR   : 2321.937500
2025-06-24 23:05:55,868 INFO     MRR  : 0.049243
2025-06-24 23:05:55,868 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-24 23:06:47,800 INFO     >>>>> Generator: Training
2025-06-24 23:06:48,091 INFO     [E00001] Total 3.029012 | Main 3.037990 | Aux1 1.098311 | Aux2 4.887888
2025-06-24 23:06:48,349 INFO     [E00002] Total 3.027728 | Main 3.036649 | Aux1 1.097579 | Aux2 4.886510
2025-06-24 23:06:48,627 INFO     [E00003] Total 3.026446 | Main 3.035310 | Aux1 1.096861 | Aux2 4.885120
2025-06-24 23:06:48,915 INFO     [E00004] Total 3.025163 | Main 3.033968 | Aux1 1.096143 | Aux2 4.883737
2025-06-24 23:06:49,204 INFO     [E00005] Total 3.023882 | Main 3.032631 | Aux1 1.095416 | Aux2 4.882359
2025-06-24 23:06:49,494 INFO     [E00006] Total 3.022601 | Main 3.031292 | Aux1 1.094699 | Aux2 4.880968
2025-06-24 23:06:49,785 INFO     [E00007] Total 3.021320 | Main 3.029954 | Aux1 1.093984 | Aux2 4.879583
2025-06-24 23:06:50,074 INFO     [E00008] Total 3.020041 | Main 3.028619 | Aux1 1.093255 | Aux2 4.878205
2025-06-24 23:06:50,363 INFO     [E00009] Total 3.018763 | Main 3.027284 | Aux1 1.092543 | Aux2 4.876814
2025-06-24 23:06:50,651 INFO     [E00010] Total 3.017485 | Main 3.025949 | Aux1 1.091830 | Aux2 4.875427
2025-06-24 23:06:50,651 INFO     -------------------------
2025-06-24 23:06:50,652 INFO     | Post-train Generator
2025-06-24 23:06:50,652 INFO     -------------------------
2025-06-24 23:06:50,652 INFO     >>>>> Generator: Training
2025-06-24 23:06:50,954 INFO     [E00001] Total 3.016462 | Main 3.024650 | Aux1 1.095131 | Aux2 4.872288
2025-06-24 23:06:51,283 INFO     [E00002] Total 3.015188 | Main 3.023312 | Aux1 1.094476 | Aux2 4.870911
2025-06-24 23:06:51,548 INFO     [E00003] Total 3.013914 | Main 3.021973 | Aux1 1.093821 | Aux2 4.869539
2025-06-24 23:06:51,853 INFO     [E00004] Total 3.012641 | Main 3.020636 | Aux1 1.093155 | Aux2 4.868168
2025-06-24 23:06:52,181 INFO     [E00005] Total 3.011366 | Main 3.019297 | Aux1 1.092501 | Aux2 4.866789
2025-06-24 23:06:52,471 INFO     [E00006] Total 3.010095 | Main 3.017961 | Aux1 1.091843 | Aux2 4.865415
2025-06-24 23:06:52,760 INFO     [E00007] Total 3.008820 | Main 3.016623 | Aux1 1.091176 | Aux2 4.864038
2025-06-24 23:06:53,053 INFO     [E00008] Total 3.007547 | Main 3.015287 | Aux1 1.090525 | Aux2 4.862651
2025-06-24 23:06:53,340 INFO     [E00009] Total 3.006275 | Main 3.013952 | Aux1 1.089869 | Aux2 4.861268
2025-06-24 23:06:53,630 INFO     [E00010] Total 3.004999 | Main 3.012611 | Aux1 1.089207 | Aux2 4.859886
2025-06-24 23:06:53,630 INFO     -------------------------
2025-06-24 23:06:53,630 INFO     | Beam Search Best Rules
2025-06-24 23:06:53,631 INFO     -------------------------
2025-06-24 23:06:53,631 INFO     >>>>> Generator: Rule generation with beam search
2025-06-24 23:07:04,790 INFO     >>>>> Generator: Rule generation with beam search
2025-06-24 23:43:28,485 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-24 23:43:28,485 INFO     Subset ratio: 0.01
2025-06-24 23:43:28,486 INFO     Subset sizes: train=59, valid=2, test=2, rule dataset=104
2025-06-24 23:43:28,486 INFO     -------------------------
2025-06-24 23:43:28,486 INFO     | Train Final Predictor+
2025-06-24 23:43:28,486 INFO     -------------------------
2025-06-24 23:43:28,487 INFO     Predictor+: read 104 rules from list.
2025-06-24 23:43:28,487 INFO     Preprocess training set
2025-06-24 23:43:28,524 INFO     -------------------------
2025-06-24 23:43:28,524 INFO     | Iteration: 1/1
2025-06-24 23:43:28,524 INFO     -------------------------
2025-06-24 23:43:28,524 INFO     >>>>> Predictor: Training
2025-06-24 23:43:51,635 INFO     >>>>> Predictor: Evaluating on valid
2025-06-24 23:43:53,024 INFO     Data : 16
2025-06-24 23:43:53,025 INFO     Hit1 : 0.000000
2025-06-24 23:43:53,025 INFO     Hit3 : 0.000000
2025-06-24 23:43:53,025 INFO     Hit10: 0.000000
2025-06-24 23:43:53,025 INFO     MR   : 1703.968750
2025-06-24 23:43:53,025 INFO     MRR  : 0.005014
2025-06-24 23:43:53,025 INFO     >>>>> Predictor: Evaluating on test
2025-06-24 23:43:54,288 INFO     Data : 16
2025-06-24 23:43:54,288 INFO     Hit1 : 0.000000
2025-06-24 23:43:54,288 INFO     Hit3 : 0.000000
2025-06-24 23:43:54,288 INFO     Hit10: 0.000000
2025-06-24 23:43:54,289 INFO     MR   : 1810.656250
2025-06-24 23:43:54,289 INFO     MRR  : 0.004143
2025-06-24 23:43:54,289 INFO     Save checkpoint to results/semmeddb/sm_test/tttt/predictor.pt
2025-06-24 23:43:54,292 INFO     -------------------------
2025-06-24 23:43:54,292 INFO     | Final Test MRR: 0.004143
2025-06-24 23:43:54,292 INFO     -------------------------
entity size:  8673
relation size:  20
