2025-07-09 10:02:18,624 INFO     is_soft_label: False
2025-07-09 10:02:18,624 INFO     is_scheduled_sampling: False
2025-07-09 10:02:18,624 INFO     is_test_mode: True
2025-07-09 10:02:18,828 INFO     Data loading | DONE!
2025-07-09 10:02:18,922 INFO     Using full datasets for training, validation, and testing.
2025-07-09 10:02:19,044 INFO     -------------------------
2025-07-09 10:02:19,044 INFO     | EM Iteration: 1/2
2025-07-09 10:02:19,044 INFO     -------------------------
2025-07-09 10:02:19,044 INFO     >>>>> Using miner's rule
2025-07-09 10:02:19,044 INFO     Predictor: read 10 rules from list.
2025-07-09 10:02:19,673 INFO     Preprocess training set
2025-07-09 10:02:19,728 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:02:23,679 INFO     Data : 2077
2025-07-09 10:02:23,679 INFO     Hit1 : 0.000115
2025-07-09 10:02:23,679 INFO     Hit3 : 0.000346
2025-07-09 10:02:23,679 INFO     Hit10: 0.001154
2025-07-09 10:02:23,679 INFO     MR   : 4331.678382
2025-07-09 10:02:23,679 INFO     MRR  : 0.001113
2025-07-09 10:02:23,680 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:02:27,884 INFO     Data : 2342
2025-07-09 10:02:27,884 INFO     Hit1 : 0.000115
2025-07-09 10:02:27,884 INFO     Hit3 : 0.000346
2025-07-09 10:02:27,884 INFO     Hit10: 0.001155
2025-07-09 10:02:27,884 INFO     MR   : 4329.545474
2025-07-09 10:02:27,884 INFO     MRR  : 0.001114
2025-07-09 10:02:27,884 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:02:28,464 INFO     1000 5959
2025-07-09 10:02:28,965 INFO     2000 5959
2025-07-09 10:02:29,465 INFO     3000 5959
2025-07-09 10:02:29,969 INFO     4000 5959
2025-07-09 10:02:30,514 INFO     5000 5959
2025-07-09 10:02:30,999 INFO     >>>>> Generator: Training
2025-07-09 10:02:31,177 INFO     [E00001] Total 89.928902 | Main 3.042661 | RelClus 1.377605 | EntType 94.037422
2025-07-09 10:02:31,203 INFO     [E00002] Total 89.914818 | Main 3.042434 | RelClus 1.377212 | EntType 94.022743
2025-07-09 10:02:31,228 INFO     [E00003] Total 89.903557 | Main 3.041585 | RelClus 1.377527 | EntType 94.011002
2025-07-09 10:02:31,253 INFO     [E00004] Total 89.891579 | Main 3.041880 | RelClus 1.378611 | EntType 94.000191
2025-07-09 10:02:31,277 INFO     [E00005] Total 89.876175 | Main 3.042399 | RelClus 1.378628 | EntType 93.985191
2025-07-09 10:02:31,303 INFO     [E00006] Total 89.868576 | Main 3.042326 | RelClus 1.378737 | EntType 93.977623
2025-07-09 10:02:31,328 INFO     [E00007] Total 89.849731 | Main 3.042698 | RelClus 1.378277 | EntType 93.958626
2025-07-09 10:02:31,352 INFO     [E00008] Total 89.844688 | Main 3.043031 | RelClus 1.378494 | EntType 93.954041
2025-07-09 10:02:31,377 INFO     [E00009] Total 89.834625 | Main 3.043170 | RelClus 1.378346 | EntType 93.943932
2025-07-09 10:02:31,402 INFO     [E00010] Total 89.816078 | Main 3.042942 | RelClus 1.379079 | EntType 93.925781
2025-07-09 10:02:31,402 INFO     -------------------------
2025-07-09 10:02:31,402 INFO     | EM Iteration: 2/2
2025-07-09 10:02:31,402 INFO     -------------------------
2025-07-09 10:02:31,402 INFO     >>>>> Using Generator's sample rule
2025-07-09 10:02:31,402 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 10:02:31,567 INFO     Predictor: read 200 rules from list.
2025-07-09 10:02:31,567 INFO     Preprocess training set
2025-07-09 10:02:31,568 INFO     >>>>> Predictor: Training
2025-07-09 10:02:32,331 INFO     100 5959 9.046578 69210.5
2025-07-09 10:02:32,990 INFO     200 5959 8.987846 69384.0
2025-07-09 10:02:33,662 INFO     300 5959 8.936760 69384.0
2025-07-09 10:02:34,335 INFO     400 5959 8.890705 68863.6
2025-07-09 10:02:35,008 INFO     500 5959 8.854964 69384.0
2025-07-09 10:02:35,663 INFO     600 5959 8.800026 69384.0
2025-07-09 10:02:36,330 INFO     700 5959 8.768143 69384.0
2025-07-09 10:02:36,999 INFO     800 5959 8.762313 69384.0
2025-07-09 10:02:37,686 INFO     900 5959 8.683546 69384.0
2025-07-09 10:02:38,382 INFO     1000 5959 8.655065 69384.0
2025-07-09 10:02:38,382 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:02:40,089 INFO     Data : 2077
2025-07-09 10:02:40,089 INFO     Hit1 : 0.001444
2025-07-09 10:02:40,089 INFO     Hit3 : 0.002407
2025-07-09 10:02:40,089 INFO     Hit10: 0.010111
2025-07-09 10:02:40,089 INFO     MR   : 1630.250120
2025-07-09 10:02:40,089 INFO     MRR  : 0.007905
2025-07-09 10:02:40,090 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:02:41,997 INFO     Data : 2342
2025-07-09 10:02:41,997 INFO     Hit1 : 0.001708
2025-07-09 10:02:41,997 INFO     Hit3 : 0.002135
2025-07-09 10:02:41,997 INFO     Hit10: 0.008967
2025-07-09 10:02:41,997 INFO     MR   : 1540.195986
2025-07-09 10:02:41,997 INFO     MRR  : 0.007465
2025-07-09 10:02:41,998 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 10:02:56,684 INFO     1000 5959
2025-07-09 10:03:11,407 INFO     2000 5959
2025-07-09 10:03:26,209 INFO     3000 5959
2025-07-09 10:03:41,010 INFO     4000 5959
2025-07-09 10:03:55,754 INFO     5000 5959
2025-07-09 10:04:10,003 INFO     >>>>> Generator: Training
2025-07-09 10:04:10,051 INFO     [E00001] Total 89.870308 | Main 3.047994 | RelClus 1.351997 | EntType 93.960434
2025-07-09 10:04:10,083 INFO     [E00002] Total 89.860527 | Main 3.048165 | RelClus 1.352140 | EntType 93.950897
2025-07-09 10:04:10,114 INFO     [E00003] Total 89.850456 | Main 3.047971 | RelClus 1.351905 | EntType 93.940430
2025-07-09 10:04:10,146 INFO     [E00004] Total 89.842957 | Main 3.048044 | RelClus 1.352373 | EntType 93.933365
2025-07-09 10:04:10,177 INFO     [E00005] Total 89.833488 | Main 3.048223 | RelClus 1.352302 | EntType 93.923973
2025-07-09 10:04:10,208 INFO     [E00006] Total 89.825325 | Main 3.048229 | RelClus 1.352244 | EntType 93.915733
2025-07-09 10:04:10,239 INFO     [E00007] Total 89.817429 | Main 3.048399 | RelClus 1.352466 | EntType 93.908142
2025-07-09 10:04:10,270 INFO     [E00008] Total 89.808601 | Main 3.048522 | RelClus 1.352603 | EntType 93.899529
2025-07-09 10:04:10,300 INFO     [E00009] Total 89.799477 | Main 3.048346 | RelClus 1.352643 | EntType 93.890266
2025-07-09 10:04:10,331 INFO     [E00010] Total 89.790871 | Main 3.048390 | RelClus 1.353026 | EntType 93.882011
2025-07-09 10:04:10,331 INFO     -------------------------
2025-07-09 10:04:10,331 INFO     | Post-train Generator
2025-07-09 10:04:10,331 INFO     -------------------------
2025-07-09 10:04:10,358 INFO     >>>>> Generator: Training
2025-07-09 10:04:10,392 INFO     [E00001] Total 89.779388 | Main 3.048306 | RelClus 1.354427 | EntType 93.871658
2025-07-09 10:04:10,423 INFO     [E00002] Total 89.769577 | Main 3.048806 | RelClus 1.354514 | EntType 93.862320
2025-07-09 10:04:10,454 INFO     [E00003] Total 89.760223 | Main 3.048797 | RelClus 1.354517 | EntType 93.852928
2025-07-09 10:04:10,485 INFO     [E00004] Total 89.752785 | Main 3.048472 | RelClus 1.354770 | EntType 93.845406
2025-07-09 10:04:10,517 INFO     [E00005] Total 89.743668 | Main 3.048593 | RelClus 1.354852 | EntType 93.836441
2025-07-09 10:04:10,548 INFO     [E00006] Total 89.734070 | Main 3.048586 | RelClus 1.354960 | EntType 93.826904
2025-07-09 10:04:10,579 INFO     [E00007] Total 89.724693 | Main 3.048844 | RelClus 1.354920 | EntType 93.817688
2025-07-09 10:04:10,610 INFO     [E00008] Total 89.716637 | Main 3.049172 | RelClus 1.354815 | EntType 93.809784
2025-07-09 10:04:10,642 INFO     [E00009] Total 89.706871 | Main 3.048855 | RelClus 1.355265 | EntType 93.800117
2025-07-09 10:04:10,673 INFO     [E00010] Total 89.698021 | Main 3.048833 | RelClus 1.355252 | EntType 93.791214
2025-07-09 10:04:10,673 INFO     -------------------------
2025-07-09 10:04:10,673 INFO     | Beam Search Best Rules
2025-07-09 10:04:10,673 INFO     -------------------------
2025-07-09 10:04:10,673 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 10:04:11,379 INFO     -------------------------
2025-07-09 10:04:11,379 INFO     | Train Final Predictor+
2025-07-09 10:04:11,379 INFO     -------------------------
2025-07-09 10:04:11,380 INFO     Predictor+: read 420 rules from list.
2025-07-09 10:04:11,381 INFO     Preprocess training set
2025-07-09 10:04:11,381 INFO     -------------------------
2025-07-09 10:04:11,381 INFO     | Iteration: 1/1
2025-07-09 10:04:11,382 INFO     -------------------------
2025-07-09 10:04:11,382 INFO     >>>>> Predictor: Training
2025-07-09 10:04:12,166 INFO     100 5959 5.923016 69384.0
2025-07-09 10:04:12,902 INFO     200 5959 5.315355 69384.0
2025-07-09 10:04:13,637 INFO     300 5959 5.214717 69384.0
2025-07-09 10:04:14,360 INFO     400 5959 5.370941 69384.0
2025-07-09 10:04:15,083 INFO     500 5959 5.302979 69210.5
2025-07-09 10:04:15,809 INFO     600 5959 5.177461 69037.1
2025-07-09 10:04:16,532 INFO     700 5959 5.165774 69384.0
2025-07-09 10:04:17,260 INFO     800 5959 5.135467 69384.0
2025-07-09 10:04:17,995 INFO     900 5959 5.074770 69384.0
2025-07-09 10:04:18,735 INFO     1000 5959 5.231658 69384.0
2025-07-09 10:04:18,736 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 10:04:20,612 INFO     Data : 2077
2025-07-09 10:04:20,612 INFO     Hit1 : 0.063553
2025-07-09 10:04:20,612 INFO     Hit3 : 0.108811
2025-07-09 10:04:20,612 INFO     Hit10: 0.172845
2025-07-09 10:04:20,612 INFO     MR   : 1435.376745
2025-07-09 10:04:20,612 INFO     MRR  : 0.098740
2025-07-09 10:04:20,612 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 10:04:22,750 INFO     Data : 2342
2025-07-09 10:04:22,750 INFO     Hit1 : 0.076857
2025-07-09 10:04:22,750 INFO     Hit3 : 0.117848
2025-07-09 10:04:22,750 INFO     Hit10: 0.168232
2025-07-09 10:04:22,750 INFO     MR   : 1381.596072
2025-07-09 10:04:22,750 INFO     MRR  : 0.109582
2025-07-09 10:04:22,750 INFO     Save checkpoint to results/sm_test/semmeddb/10_times_each/cluster_k/4_20250709_100217/predictor.pt
2025-07-09 10:04:22,753 INFO     -------------------------
2025-07-09 10:04:22,753 INFO     | Final Test MRR: 0.109582
2025-07-09 10:04:22,753 INFO     -------------------------
entity size:  8673
relation size:  20
