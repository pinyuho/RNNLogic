2025-07-09 16:47:43,868 INFO     is_soft_label: False
2025-07-09 16:47:43,868 INFO     is_scheduled_sampling: False
2025-07-09 16:47:43,868 INFO     is_test_mode: False
2025-07-09 16:47:44,068 INFO     Data loading | DONE!
2025-07-09 16:47:44,163 INFO     Using full datasets for training, validation, and testing.
2025-07-09 16:47:44,281 INFO     -------------------------
2025-07-09 16:47:44,281 INFO     | EM Iteration: 1/5
2025-07-09 16:47:44,281 INFO     -------------------------
2025-07-09 16:47:44,281 INFO     >>>>> Using miner's rule
2025-07-09 16:47:44,305 INFO     Predictor: read 13661 rules from list.
/home/emma/emma/bilab_archive/polly/RNNLogic/src/run_rnnlogic.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(os.path.join(cfg.data.data_path, 'predictor_init.pt'))
2025-07-09 16:47:45,014 INFO     Preprocess training set
2025-07-09 16:47:45,015 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 16:49:40,100 INFO     Data : 2077
2025-07-09 16:49:40,100 INFO     Hit1 : 0.065479
2025-07-09 16:49:40,100 INFO     Hit3 : 0.127106
2025-07-09 16:49:40,100 INFO     Hit10: 0.199326
2025-07-09 16:49:40,100 INFO     MR   : 1120.902022
2025-07-09 16:49:40,100 INFO     MRR  : 0.114382
2025-07-09 16:49:40,100 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 16:51:50,064 INFO     Data : 2342
2025-07-09 16:51:50,064 INFO     Hit1 : 0.078992
2025-07-09 16:51:50,064 INFO     Hit3 : 0.124253
2025-07-09 16:51:50,064 INFO     Hit10: 0.208796
2025-07-09 16:51:50,064 INFO     MR   : 1044.269001
2025-07-09 16:51:50,065 INFO     MRR  : 0.122250
2025-07-09 16:51:50,065 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 17:20:17,515 INFO     1000 5959
2025-07-09 17:48:58,684 INFO     2000 5959
2025-07-09 18:17:02,973 INFO     3000 5959
2025-07-09 18:45:24,329 INFO     4000 5959
2025-07-09 19:13:26,180 INFO     5000 5959
2025-07-09 19:42:02,472 INFO     >>>>> Generator: Training
2025-07-09 19:42:06,404 INFO     -------------------------
2025-07-09 19:42:06,404 INFO     | EM Iteration: 2/5
2025-07-09 19:42:06,404 INFO     -------------------------
2025-07-09 19:42:06,404 INFO     >>>>> Using Generator's sample rule
2025-07-09 19:42:06,404 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 19:42:06,576 INFO     Predictor: read 1910 rules from list.
2025-07-09 19:42:06,577 INFO     Preprocess training set
2025-07-09 19:42:06,578 INFO     >>>>> Predictor: Training
2025-07-09 19:42:52,835 INFO     1000 5959 8.782357 69314.6
2025-07-09 19:43:39,200 INFO     2000 5959 8.410201 69271.3
2025-07-09 19:44:25,495 INFO     3000 5959 8.219377 69245.2
2025-07-09 19:45:11,851 INFO     4000 5959 8.065942 69340.6
2025-07-09 19:45:58,226 INFO     5000 5959 7.942114 69340.6
2025-07-09 19:46:42,934 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 19:46:52,235 INFO     Data : 2077
2025-07-09 19:46:52,235 INFO     Hit1 : 0.025036
2025-07-09 19:46:52,235 INFO     Hit3 : 0.040924
2025-07-09 19:46:52,235 INFO     Hit10: 0.064516
2025-07-09 19:46:52,235 INFO     MR   : 1410.586423
2025-07-09 19:46:52,235 INFO     MRR  : 0.041209
2025-07-09 19:46:52,235 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 19:47:02,691 INFO     Data : 2342
2025-07-09 19:47:02,691 INFO     Hit1 : 0.019641
2025-07-09 19:47:02,691 INFO     Hit3 : 0.031170
2025-07-09 19:47:02,691 INFO     Hit10: 0.058497
2025-07-09 19:47:02,691 INFO     MR   : 1316.312340
2025-07-09 19:47:02,691 INFO     MRR  : 0.035233
2025-07-09 19:47:02,691 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 19:49:16,085 INFO     1000 5959
2025-07-09 19:51:29,577 INFO     2000 5959
2025-07-09 19:53:42,796 INFO     3000 5959
2025-07-09 19:55:55,918 INFO     4000 5959
2025-07-09 19:58:09,049 INFO     5000 5959
2025-07-09 20:00:19,014 INFO     >>>>> Generator: Training
2025-07-09 20:00:22,758 INFO     -------------------------
2025-07-09 20:00:22,758 INFO     | EM Iteration: 3/5
2025-07-09 20:00:22,758 INFO     -------------------------
2025-07-09 20:00:22,758 INFO     >>>>> Using Generator's sample rule
2025-07-09 20:00:22,758 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 20:00:22,894 INFO     Predictor: read 1897 rules from list.
2025-07-09 20:00:22,895 INFO     Preprocess training set
2025-07-09 20:00:22,896 INFO     >>>>> Predictor: Training
2025-07-09 20:01:09,054 INFO     1000 5959 8.811757 69332.0
2025-07-09 20:01:55,253 INFO     2000 5959 8.475093 69349.3
2025-07-09 20:02:41,560 INFO     3000 5959 8.264036 69184.5
2025-07-09 20:03:27,983 INFO     4000 5959 8.096472 69253.9
2025-07-09 20:04:14,178 INFO     5000 5959 8.004301 69332.0
2025-07-09 20:04:58,367 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 20:05:07,758 INFO     Data : 2077
2025-07-09 20:05:07,758 INFO     Hit1 : 0.001926
2025-07-09 20:05:07,758 INFO     Hit3 : 0.006740
2025-07-09 20:05:07,758 INFO     Hit10: 0.018777
2025-07-09 20:05:07,758 INFO     MR   : 1507.043332
2025-07-09 20:05:07,758 INFO     MRR  : 0.010949
2025-07-09 20:05:07,758 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 20:05:18,316 INFO     Data : 2342
2025-07-09 20:05:18,316 INFO     Hit1 : 0.001708
2025-07-09 20:05:18,316 INFO     Hit3 : 0.003416
2025-07-09 20:05:18,316 INFO     Hit10: 0.013664
2025-07-09 20:05:18,316 INFO     MR   : 1390.829633
2025-07-09 20:05:18,316 INFO     MRR  : 0.008999
2025-07-09 20:05:18,317 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 20:07:31,095 INFO     1000 5959
2025-07-09 20:09:47,724 INFO     2000 5959
2025-07-09 20:12:02,829 INFO     3000 5959
2025-07-09 20:14:19,012 INFO     4000 5959
2025-07-09 20:16:36,734 INFO     5000 5959
2025-07-09 20:18:50,295 INFO     >>>>> Generator: Training
2025-07-09 20:18:54,088 INFO     -------------------------
2025-07-09 20:18:54,088 INFO     | EM Iteration: 4/5
2025-07-09 20:18:54,088 INFO     -------------------------
2025-07-09 20:18:54,088 INFO     >>>>> Using Generator's sample rule
2025-07-09 20:18:54,088 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 20:18:54,225 INFO     Predictor: read 1937 rules from list.
2025-07-09 20:18:54,225 INFO     Preprocess training set
2025-07-09 20:18:54,226 INFO     >>>>> Predictor: Training
2025-07-09 20:19:42,229 INFO     1000 5959 8.796538 69271.3
2025-07-09 20:20:30,320 INFO     2000 5959 8.418007 69340.6
2025-07-09 20:21:18,115 INFO     3000 5959 8.161701 69384.0
2025-07-09 20:22:05,763 INFO     4000 5959 7.996454 69262.6
2025-07-09 20:22:54,093 INFO     5000 5959 7.856040 69332.0
2025-07-09 20:23:41,372 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 20:23:51,279 INFO     Data : 2077
2025-07-09 20:23:51,279 INFO     Hit1 : 0.001444
2025-07-09 20:23:51,279 INFO     Hit3 : 0.003852
2025-07-09 20:23:51,279 INFO     Hit10: 0.013962
2025-07-09 20:23:51,279 INFO     MR   : 1508.582330
2025-07-09 20:23:51,279 INFO     MRR  : 0.009094
2025-07-09 20:23:51,280 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 20:24:02,457 INFO     Data : 2342
2025-07-09 20:24:02,457 INFO     Hit1 : 0.001281
2025-07-09 20:24:02,457 INFO     Hit3 : 0.008540
2025-07-09 20:24:02,457 INFO     Hit10: 0.017506
2025-07-09 20:24:02,457 INFO     MR   : 1398.753202
2025-07-09 20:24:02,457 INFO     MRR  : 0.010604
2025-07-09 20:24:02,457 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 20:26:20,912 INFO     1000 5959
2025-07-09 20:28:37,535 INFO     2000 5959
2025-07-09 20:30:53,441 INFO     3000 5959
2025-07-09 20:33:09,046 INFO     4000 5959
2025-07-09 20:35:25,441 INFO     5000 5959
2025-07-09 20:37:38,034 INFO     >>>>> Generator: Training
2025-07-09 20:37:41,774 INFO     -------------------------
2025-07-09 20:37:41,774 INFO     | EM Iteration: 5/5
2025-07-09 20:37:41,774 INFO     -------------------------
2025-07-09 20:37:41,774 INFO     >>>>> Using Generator's sample rule
2025-07-09 20:37:41,774 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 20:37:41,907 INFO     Predictor: read 1971 rules from list.
2025-07-09 20:37:41,908 INFO     Preprocess training set
2025-07-09 20:37:41,908 INFO     >>>>> Predictor: Training
2025-07-09 20:38:30,101 INFO     1000 5959 8.830131 69332.0
2025-07-09 20:39:18,319 INFO     2000 5959 8.509905 69349.3
2025-07-09 20:40:06,660 INFO     3000 5959 8.318419 69340.6
2025-07-09 20:40:55,193 INFO     4000 5959 8.184798 69297.3
2025-07-09 20:41:43,656 INFO     5000 5959 8.066697 69219.2
2025-07-09 20:42:30,290 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 20:42:40,919 INFO     Data : 2077
2025-07-09 20:42:40,919 INFO     Hit1 : 0.013481
2025-07-09 20:42:40,919 INFO     Hit3 : 0.021184
2025-07-09 20:42:40,919 INFO     Hit10: 0.036110
2025-07-09 20:42:40,919 INFO     MR   : 1533.359172
2025-07-09 20:42:40,919 INFO     MRR  : 0.023976
2025-07-09 20:42:40,919 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 20:42:52,601 INFO     Data : 2342
2025-07-09 20:42:52,601 INFO     Hit1 : 0.010248
2025-07-09 20:42:52,601 INFO     Hit3 : 0.018787
2025-07-09 20:42:52,601 INFO     Hit10: 0.031597
2025-07-09 20:42:52,601 INFO     MR   : 1410.235909
2025-07-09 20:42:52,601 INFO     MRR  : 0.021129
2025-07-09 20:42:52,601 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 20:45:13,194 INFO     1000 5959
2025-07-09 20:47:33,947 INFO     2000 5959
2025-07-09 20:49:53,387 INFO     3000 5959
2025-07-09 20:52:11,799 INFO     4000 5959
2025-07-09 20:54:30,519 INFO     5000 5959
2025-07-09 20:56:44,867 INFO     >>>>> Generator: Training
2025-07-09 20:56:48,651 INFO     -------------------------
2025-07-09 20:56:48,652 INFO     | Post-train Generator
2025-07-09 20:56:48,652 INFO     -------------------------
2025-07-09 20:56:49,439 INFO     >>>>> Generator: Training
2025-07-09 20:57:27,781 INFO     [E01000] Total 3.150867 | Main 3.121549 | RelClus 1.867052 | EntType 3.038797
2025-07-09 20:57:27,781 INFO     -------------------------
2025-07-09 20:57:27,782 INFO     | Beam Search Best Rules
2025-07-09 20:57:27,782 INFO     -------------------------
2025-07-09 20:57:27,782 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 20:57:28,470 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 20:57:33,366 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 20:58:36,735 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 20:59:29,353 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 21:00:05,425 INFO     -------------------------
2025-07-09 21:00:05,425 INFO     | Train Final Predictor+
2025-07-09 21:00:05,425 INFO     -------------------------
2025-07-09 21:00:05,429 INFO     Predictor+: read 18420 rules from list.
2025-07-09 21:00:05,563 INFO     Preprocess training set
2025-07-09 21:00:05,564 INFO     -------------------------
2025-07-09 21:00:05,564 INFO     | Iteration: 1/5
2025-07-09 21:00:05,564 INFO     -------------------------
2025-07-09 21:00:05,564 INFO     >>>>> Predictor: Training
2025-07-09 21:04:19,862 INFO     1000 5959 4.897132 69271.3
2025-07-09 21:08:33,804 INFO     2000 5959 4.725806 69332.0
2025-07-09 21:12:48,311 INFO     3000 5959 4.709243 69375.3
2025-07-09 21:17:02,707 INFO     4000 5959 4.711282 69279.9
2025-07-09 21:21:17,631 INFO     5000 5959 4.680176 69349.3
2025-07-09 21:25:23,666 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 21:26:28,204 INFO     Data : 2077
2025-07-09 21:26:28,204 INFO     Hit1 : 0.102070
2025-07-09 21:26:28,204 INFO     Hit3 : 0.184882
2025-07-09 21:26:28,204 INFO     Hit10: 0.316322
2025-07-09 21:26:28,204 INFO     MR   : 982.781416
2025-07-09 21:26:28,204 INFO     MRR  : 0.169530
2025-07-09 21:26:28,205 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 21:27:41,301 INFO     Data : 2342
2025-07-09 21:27:41,301 INFO     Hit1 : 0.128096
2025-07-09 21:27:41,301 INFO     Hit3 : 0.207515
2025-07-09 21:27:41,301 INFO     Hit10: 0.318104
2025-07-09 21:27:41,301 INFO     MR   : 920.228010
2025-07-09 21:27:41,301 INFO     MRR  : 0.191001
2025-07-09 21:27:41,301 INFO     Save checkpoint to results/semmeddb/10_times_each/cluster_k/4_20250709_164742/predictor.pt
2025-07-09 21:27:41,308 INFO     -------------------------
2025-07-09 21:27:41,308 INFO     | Iteration: 2/5
2025-07-09 21:27:41,308 INFO     -------------------------
2025-07-09 21:27:41,308 INFO     >>>>> Predictor: Training
2025-07-09 21:32:01,691 INFO     1000 5959 4.603882 69366.7
2025-07-09 21:36:17,861 INFO     2000 5959 4.654502 69375.3
2025-07-09 21:40:33,682 INFO     3000 5959 4.641066 69219.2
2025-07-09 21:44:48,236 INFO     4000 5959 4.653393 69305.9
2025-07-09 21:49:03,515 INFO     5000 5959 4.617147 69288.6
2025-07-09 21:53:07,500 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 21:54:10,668 INFO     Data : 2077
2025-07-09 21:54:10,668 INFO     Hit1 : 0.097737
2025-07-09 21:54:10,668 INFO     Hit3 : 0.181030
2025-07-09 21:54:10,668 INFO     Hit10: 0.315840
2025-07-09 21:54:10,668 INFO     MR   : 945.399374
2025-07-09 21:54:10,668 INFO     MRR  : 0.166421
2025-07-09 21:54:10,669 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 21:55:21,931 INFO     Data : 2342
2025-07-09 21:55:21,931 INFO     Hit1 : 0.127242
2025-07-09 21:55:21,931 INFO     Hit3 : 0.209223
2025-07-09 21:55:21,931 INFO     Hit10: 0.318104
2025-07-09 21:55:21,931 INFO     MR   : 881.186593
2025-07-09 21:55:21,931 INFO     MRR  : 0.190258
2025-07-09 21:55:21,932 INFO     -------------------------
2025-07-09 21:55:21,932 INFO     | Iteration: 3/5
2025-07-09 21:55:21,932 INFO     -------------------------
2025-07-09 21:55:21,932 INFO     >>>>> Predictor: Training
2025-07-09 21:59:37,674 INFO     1000 5959 4.615412 69288.6
2025-07-09 22:03:49,033 INFO     2000 5959 4.616914 69288.6
2025-07-09 22:08:02,892 INFO     3000 5959 4.608450 69340.6
2025-07-09 22:12:17,920 INFO     4000 5959 4.617821 69271.3
2025-07-09 22:16:33,505 INFO     5000 5959 4.637433 69219.2
2025-07-09 22:20:38,587 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 22:21:42,120 INFO     Data : 2077
2025-07-09 22:21:42,120 INFO     Hit1 : 0.089552
2025-07-09 22:21:42,120 INFO     Hit3 : 0.173327
2025-07-09 22:21:42,120 INFO     Hit10: 0.299470
2025-07-09 22:21:42,120 INFO     MR   : 935.790082
2025-07-09 22:21:42,120 INFO     MRR  : 0.157924
2025-07-09 22:21:42,120 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 22:22:53,815 INFO     Data : 2342
2025-07-09 22:22:53,815 INFO     Hit1 : 0.115286
2025-07-09 22:22:53,815 INFO     Hit3 : 0.196840
2025-07-09 22:22:53,815 INFO     Hit10: 0.311272
2025-07-09 22:22:53,815 INFO     MR   : 864.340307
2025-07-09 22:22:53,815 INFO     MRR  : 0.179962
2025-07-09 22:22:53,815 INFO     -------------------------
2025-07-09 22:22:53,815 INFO     | Iteration: 4/5
2025-07-09 22:22:53,815 INFO     -------------------------
2025-07-09 22:22:53,815 INFO     >>>>> Predictor: Training
2025-07-09 22:27:10,152 INFO     1000 5959 4.594635 69340.6
2025-07-09 22:31:25,741 INFO     2000 5959 4.563074 69184.5
2025-07-09 22:35:40,507 INFO     3000 5959 4.625594 69253.9
2025-07-09 22:39:53,443 INFO     4000 5959 4.599785 69340.6
2025-07-09 22:44:04,833 INFO     5000 5959 4.599954 69384.0
2025-07-09 22:48:06,015 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 22:49:08,498 INFO     Data : 2077
2025-07-09 22:49:08,498 INFO     Hit1 : 0.097256
2025-07-09 22:49:08,498 INFO     Hit3 : 0.181993
2025-07-09 22:49:08,498 INFO     Hit10: 0.313433
2025-07-09 22:49:08,498 INFO     MR   : 928.032980
2025-07-09 22:49:08,498 INFO     MRR  : 0.165214
2025-07-09 22:49:08,498 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 22:50:18,870 INFO     Data : 2342
2025-07-09 22:50:18,870 INFO     Hit1 : 0.126815
2025-07-09 22:50:18,870 INFO     Hit3 : 0.210504
2025-07-09 22:50:18,870 INFO     Hit10: 0.318104
2025-07-09 22:50:18,870 INFO     MR   : 859.315542
2025-07-09 22:50:18,871 INFO     MRR  : 0.190913
2025-07-09 22:50:18,871 INFO     -------------------------
2025-07-09 22:50:18,871 INFO     | Iteration: 5/5
2025-07-09 22:50:18,871 INFO     -------------------------
2025-07-09 22:50:18,871 INFO     >>>>> Predictor: Training
2025-07-09 22:54:29,985 INFO     1000 5959 4.604241 69323.3
2025-07-09 22:58:41,374 INFO     2000 5959 4.580956 69332.0
2025-07-09 23:02:53,638 INFO     3000 5959 4.615072 69219.2
2025-07-09 23:07:05,829 INFO     4000 5959 4.607958 69297.3
2025-07-09 23:11:17,452 INFO     5000 5959 4.574071 69332.0
2025-07-09 23:15:21,838 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 23:16:25,470 INFO     Data : 2077
2025-07-09 23:16:25,471 INFO     Hit1 : 0.095330
2025-07-09 23:16:25,471 INFO     Hit3 : 0.186326
2025-07-09 23:16:25,471 INFO     Hit10: 0.316322
2025-07-09 23:16:25,471 INFO     MR   : 918.490611
2025-07-09 23:16:25,471 INFO     MRR  : 0.166483
2025-07-09 23:16:25,471 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 23:17:37,111 INFO     Data : 2342
2025-07-09 23:17:37,112 INFO     Hit1 : 0.131085
2025-07-09 23:17:37,112 INFO     Hit3 : 0.213066
2025-07-09 23:17:37,112 INFO     Hit10: 0.318531
2025-07-09 23:17:37,112 INFO     MR   : 852.920154
2025-07-09 23:17:37,112 INFO     MRR  : 0.193705
2025-07-09 23:17:37,112 INFO     -------------------------
2025-07-09 23:17:37,112 INFO     | Final Test MRR: 0.191001
2025-07-09 23:17:37,112 INFO     -------------------------
entity size:  8673
relation size:  20
