2025-07-03 16:29:00 INFO     is_soft_label: False
2025-07-03 16:29:00 INFO     is_scheduled_sampling: False
2025-07-03 16:29:00 INFO     is_test_mode: False
2025-07-03 16:29:00 INFO     Data loading | DONE!
2025-07-03 16:29:00 INFO     Using full datasets for training, validation, and testing.
2025-07-03 16:29:00 INFO     -------------------------
2025-07-03 16:29:00 INFO     | EM Iteration: 1/5
2025-07-03 16:29:00 INFO     -------------------------
2025-07-03 16:29:00 INFO     >>>>> Using miner's rule
2025-07-03 16:29:00 INFO     Predictor: read 13661 rules from list.
2025-07-03 16:29:01 INFO     Preprocess training set
2025-07-03 16:29:01 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 16:31:02 INFO     Data : 2077
2025-07-03 16:31:02 INFO     Hit1 : 0.065479
2025-07-03 16:31:02 INFO     Hit3 : 0.127106
2025-07-03 16:31:02 INFO     Hit10: 0.199326
2025-07-03 16:31:02 INFO     MR   : 1120.902022
2025-07-03 16:31:02 INFO     MRR  : 0.114382
2025-07-03 16:31:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 16:33:21 INFO     Data : 2342
2025-07-03 16:33:21 INFO     Hit1 : 0.078992
2025-07-03 16:33:21 INFO     Hit3 : 0.124253
2025-07-03 16:33:21 INFO     Hit10: 0.208796
2025-07-03 16:33:21 INFO     MR   : 1044.269001
2025-07-03 16:33:21 INFO     MRR  : 0.122250
2025-07-03 16:33:21 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 17:04:18 INFO     1000 5959
2025-07-03 17:35:36 INFO     2000 5959
2025-07-03 18:06:29 INFO     3000 5959
2025-07-03 18:37:46 INFO     4000 5959
2025-07-03 19:08:21 INFO     5000 5959
2025-07-03 19:40:17 INFO     >>>>> Generator: Training
2025-07-03 19:40:22 INFO     -------------------------
2025-07-03 19:40:22 INFO     | EM Iteration: 2/5
2025-07-03 19:40:22 INFO     -------------------------
2025-07-03 19:40:22 INFO     >>>>> Using Generator's sample rule
2025-07-03 19:40:22 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 19:40:22 INFO     Predictor: read 1864 rules from list.
2025-07-03 19:40:22 INFO     Preprocess training set
2025-07-03 19:40:22 INFO     >>>>> Predictor: Training
2025-07-03 19:41:14 INFO     1000 5959 8.796416 69314.6
2025-07-03 19:42:04 INFO     2000 5959 8.412296 69271.3
2025-07-03 19:42:55 INFO     3000 5959 8.188824 69245.2
2025-07-03 19:43:46 INFO     4000 5959 7.994949 69340.6
2025-07-03 19:44:36 INFO     5000 5959 7.862558 69340.6
2025-07-03 19:45:25 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 19:45:36 INFO     Data : 2077
2025-07-03 19:45:36 INFO     Hit1 : 0.012518
2025-07-03 19:45:36 INFO     Hit3 : 0.022147
2025-07-03 19:45:36 INFO     Hit10: 0.041406
2025-07-03 19:45:36 INFO     MR   : 1465.227251
2025-07-03 19:45:36 INFO     MRR  : 0.024836
2025-07-03 19:45:36 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 19:45:48 INFO     Data : 2342
2025-07-03 19:45:48 INFO     Hit1 : 0.010248
2025-07-03 19:45:48 INFO     Hit3 : 0.020068
2025-07-03 19:45:48 INFO     Hit10: 0.039710
2025-07-03 19:45:48 INFO     MR   : 1353.982921
2025-07-03 19:45:48 INFO     MRR  : 0.022537
2025-07-03 19:45:48 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 19:48:12 INFO     1000 5959
2025-07-03 19:50:36 INFO     2000 5959
2025-07-03 19:53:02 INFO     3000 5959
2025-07-03 19:55:28 INFO     4000 5959
2025-07-03 19:57:53 INFO     5000 5959
2025-07-03 20:00:15 INFO     >>>>> Generator: Training
2025-07-03 20:00:19 INFO     -------------------------
2025-07-03 20:00:19 INFO     | EM Iteration: 3/5
2025-07-03 20:00:19 INFO     -------------------------
2025-07-03 20:00:19 INFO     >>>>> Using Generator's sample rule
2025-07-03 20:00:19 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 20:00:20 INFO     Predictor: read 1817 rules from list.
2025-07-03 20:00:20 INFO     Preprocess training set
2025-07-03 20:00:20 INFO     >>>>> Predictor: Training
2025-07-03 20:01:09 INFO     1000 5959 8.773656 69332.0
2025-07-03 20:01:59 INFO     2000 5959 8.367289 69349.3
2025-07-03 20:02:47 INFO     3000 5959 8.080296 69184.5
2025-07-03 20:03:36 INFO     4000 5959 7.865471 69253.9
2025-07-03 20:04:25 INFO     5000 5959 7.710628 69332.0
2025-07-03 20:05:12 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 20:05:22 INFO     Data : 2077
2025-07-03 20:05:22 INFO     Hit1 : 0.011555
2025-07-03 20:05:22 INFO     Hit3 : 0.026962
2025-07-03 20:05:22 INFO     Hit10: 0.061627
2025-07-03 20:05:22 INFO     MR   : 1452.999519
2025-07-03 20:05:22 INFO     MRR  : 0.029792
2025-07-03 20:05:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 20:05:33 INFO     Data : 2342
2025-07-03 20:05:33 INFO     Hit1 : 0.012383
2025-07-03 20:05:33 INFO     Hit3 : 0.026900
2025-07-03 20:05:33 INFO     Hit10: 0.057643
2025-07-03 20:05:33 INFO     MR   : 1346.452391
2025-07-03 20:05:33 INFO     MRR  : 0.029244
2025-07-03 20:05:33 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 20:07:54 INFO     1000 5959
2025-07-03 20:10:15 INFO     2000 5959
2025-07-03 20:12:37 INFO     3000 5959
2025-07-03 20:14:59 INFO     4000 5959
2025-07-03 20:17:21 INFO     5000 5959
2025-07-03 20:19:40 INFO     >>>>> Generator: Training
2025-07-03 20:19:44 INFO     -------------------------
2025-07-03 20:19:44 INFO     | EM Iteration: 4/5
2025-07-03 20:19:44 INFO     -------------------------
2025-07-03 20:19:44 INFO     >>>>> Using Generator's sample rule
2025-07-03 20:19:44 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 20:19:45 INFO     Predictor: read 1717 rules from list.
2025-07-03 20:19:45 INFO     Preprocess training set
2025-07-03 20:19:45 INFO     >>>>> Predictor: Training
2025-07-03 20:20:31 INFO     1000 5959 8.763424 69271.3
2025-07-03 20:21:19 INFO     2000 5959 8.326884 69340.6
2025-07-03 20:22:06 INFO     3000 5959 7.991351 69384.0
2025-07-03 20:22:52 INFO     4000 5959 7.768584 69262.6
2025-07-03 20:23:39 INFO     5000 5959 7.563734 69332.0
2025-07-03 20:24:25 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 20:24:34 INFO     Data : 2077
2025-07-03 20:24:34 INFO     Hit1 : 0.006740
2025-07-03 20:24:34 INFO     Hit3 : 0.016370
2025-07-03 20:24:34 INFO     Hit10: 0.032258
2025-07-03 20:24:34 INFO     MR   : 1488.120607
2025-07-03 20:24:34 INFO     MRR  : 0.018634
2025-07-03 20:24:34 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 20:24:44 INFO     Data : 2342
2025-07-03 20:24:44 INFO     Hit1 : 0.004697
2025-07-03 20:24:44 INFO     Hit3 : 0.013237
2025-07-03 20:24:44 INFO     Hit10: 0.029035
2025-07-03 20:24:44 INFO     MR   : 1377.193424
2025-07-03 20:24:44 INFO     MRR  : 0.015970
2025-07-03 20:24:44 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 20:27:02 INFO     1000 5959
2025-07-03 20:29:22 INFO     2000 5959
2025-07-03 20:31:40 INFO     3000 5959
2025-07-03 20:33:59 INFO     4000 5959
2025-07-03 20:36:17 INFO     5000 5959
2025-07-03 20:38:33 INFO     >>>>> Generator: Training
2025-07-03 20:38:37 INFO     -------------------------
2025-07-03 20:38:37 INFO     | EM Iteration: 5/5
2025-07-03 20:38:37 INFO     -------------------------
2025-07-03 20:38:37 INFO     >>>>> Using Generator's sample rule
2025-07-03 20:38:37 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 20:38:38 INFO     Predictor: read 1663 rules from list.
2025-07-03 20:38:38 INFO     Preprocess training set
2025-07-03 20:38:38 INFO     >>>>> Predictor: Training
2025-07-03 20:39:22 INFO     1000 5959 8.792215 69332.0
2025-07-03 20:40:07 INFO     2000 5959 8.404330 69349.3
2025-07-03 20:40:57 INFO     3000 5959 8.129629 69340.6
2025-07-03 20:41:48 INFO     4000 5959 7.942952 69297.3
2025-07-03 20:42:38 INFO     5000 5959 7.757991 69219.2
2025-07-03 20:43:24 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 20:43:34 INFO     Data : 2077
2025-07-03 20:43:34 INFO     Hit1 : 0.035147
2025-07-03 20:43:34 INFO     Hit3 : 0.067405
2025-07-03 20:43:34 INFO     Hit10: 0.092441
2025-07-03 20:43:34 INFO     MR   : 1434.310303
2025-07-03 20:43:34 INFO     MRR  : 0.059108
2025-07-03 20:43:34 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 20:43:45 INFO     Data : 2342
2025-07-03 20:43:45 INFO     Hit1 : 0.036294
2025-07-03 20:43:45 INFO     Hit3 : 0.066610
2025-07-03 20:43:45 INFO     Hit10: 0.092229
2025-07-03 20:43:45 INFO     MR   : 1334.314048
2025-07-03 20:43:45 INFO     MRR  : 0.059940
2025-07-03 20:43:45 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 20:46:07 INFO     1000 5959
2025-07-03 20:48:24 INFO     2000 5959
2025-07-03 20:50:51 INFO     3000 5959
2025-07-03 20:53:01 INFO     4000 5959
2025-07-03 20:55:12 INFO     5000 5959
2025-07-03 20:57:18 INFO     >>>>> Generator: Training
2025-07-03 20:57:23 INFO     -------------------------
2025-07-03 20:57:23 INFO     | Post-train Generator
2025-07-03 20:57:23 INFO     -------------------------
2025-07-03 20:57:24 INFO     >>>>> Generator: Training
2025-07-03 20:58:09 INFO     [E01000] Total 2.043571 | Main 2.466785 | RelClus 1.027493 | 
2025-07-03 20:58:09 INFO     -------------------------
2025-07-03 20:58:09 INFO     | Beam Search Best Rules
2025-07-03 20:58:09 INFO     -------------------------
2025-07-03 20:58:09 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 20:58:11 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 20:58:35 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:05:59 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:12:23 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:16:47 INFO     -------------------------
2025-07-03 21:16:47 INFO     | Train Final Predictor+
2025-07-03 21:16:47 INFO     -------------------------
2025-07-03 21:16:48 INFO     Predictor+: read 18420 rules from list.
2025-07-03 21:16:48 INFO     Preprocess training set
2025-07-03 21:16:48 INFO     -------------------------
2025-07-03 21:16:48 INFO     | Iteration: 1/5
2025-07-03 21:16:48 INFO     -------------------------
2025-07-03 21:16:48 INFO     >>>>> Predictor: Training
2025-07-03 21:21:44 INFO     1000 5959 5.032878 69271.3
2025-07-03 21:26:42 INFO     2000 5959 4.828217 69332.0
2025-07-03 21:31:39 INFO     3000 5959 4.804782 69375.3
2025-07-03 21:36:33 INFO     4000 5959 4.808660 69279.9
2025-07-03 21:41:31 INFO     5000 5959 4.769057 69349.3
2025-07-03 21:46:15 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 21:47:27 INFO     Data : 2077
2025-07-03 21:47:27 INFO     Hit1 : 0.097737
2025-07-03 21:47:27 INFO     Hit3 : 0.178623
2025-07-03 21:47:27 INFO     Hit10: 0.306692
2025-07-03 21:47:27 INFO     MR   : 1018.243380
2025-07-03 21:47:27 INFO     MRR  : 0.164820
2025-07-03 21:47:27 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 21:48:46 INFO     Data : 2342
2025-07-03 21:48:46 INFO     Hit1 : 0.124680
2025-07-03 21:48:46 INFO     Hit3 : 0.207088
2025-07-03 21:48:46 INFO     Hit10: 0.312553
2025-07-03 21:48:46 INFO     MR   : 949.983561
2025-07-03 21:48:46 INFO     MRR  : 0.186249
2025-07-03 21:48:46 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/Aux1_multitask_hard_sharing_adaptive_matrix_3_type_20250703_162859/predictor.pt
2025-07-03 21:48:46 INFO     -------------------------
2025-07-03 21:48:46 INFO     | Iteration: 2/5
2025-07-03 21:48:46 INFO     -------------------------
2025-07-03 21:48:46 INFO     >>>>> Predictor: Training
2025-07-03 21:53:42 INFO     1000 5959 4.706885 69366.7
2025-07-03 21:58:40 INFO     2000 5959 4.738835 69375.3
2025-07-03 22:03:33 INFO     3000 5959 4.723405 69219.2
2025-07-03 22:08:30 INFO     4000 5959 4.747686 69305.9
2025-07-03 22:13:27 INFO     5000 5959 4.721123 69288.6
2025-07-03 22:18:10 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 22:19:22 INFO     Data : 2077
2025-07-03 22:19:22 INFO     Hit1 : 0.093885
2025-07-03 22:19:22 INFO     Hit3 : 0.184401
2025-07-03 22:19:22 INFO     Hit10: 0.303322
2025-07-03 22:19:22 INFO     MR   : 981.494463
2025-07-03 22:19:22 INFO     MRR  : 0.162970
2025-07-03 22:19:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 22:20:42 INFO     Data : 2342
2025-07-03 22:20:42 INFO     Hit1 : 0.130658
2025-07-03 22:20:42 INFO     Hit3 : 0.206661
2025-07-03 22:20:42 INFO     Hit10: 0.310418
2025-07-03 22:20:42 INFO     MR   : 913.809991
2025-07-03 22:20:42 INFO     MRR  : 0.189720
2025-07-03 22:20:42 INFO     -------------------------
2025-07-03 22:20:42 INFO     | Iteration: 3/5
2025-07-03 22:20:42 INFO     -------------------------
2025-07-03 22:20:42 INFO     >>>>> Predictor: Training
2025-07-03 22:25:39 INFO     1000 5959 4.708135 69288.6
2025-07-03 22:30:35 INFO     2000 5959 4.710175 69288.6
2025-07-03 22:35:33 INFO     3000 5959 4.704561 69340.6
2025-07-03 22:40:31 INFO     4000 5959 4.700614 69271.3
2025-07-03 22:45:29 INFO     5000 5959 4.732456 69219.2
2025-07-03 22:50:14 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 22:51:24 INFO     Data : 2077
2025-07-03 22:51:24 INFO     Hit1 : 0.086182
2025-07-03 22:51:24 INFO     Hit3 : 0.170920
2025-07-03 22:51:24 INFO     Hit10: 0.292248
2025-07-03 22:51:24 INFO     MR   : 973.382041
2025-07-03 22:51:24 INFO     MRR  : 0.154591
2025-07-03 22:51:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 22:52:44 INFO     Data : 2342
2025-07-03 22:52:44 INFO     Hit1 : 0.113578
2025-07-03 22:52:44 INFO     Hit3 : 0.192143
2025-07-03 22:52:44 INFO     Hit10: 0.308711
2025-07-03 22:52:44 INFO     MR   : 898.780316
2025-07-03 22:52:44 INFO     MRR  : 0.175621
2025-07-03 22:52:44 INFO     -------------------------
2025-07-03 22:52:44 INFO     | Iteration: 4/5
2025-07-03 22:52:44 INFO     -------------------------
2025-07-03 22:52:44 INFO     >>>>> Predictor: Training
2025-07-03 22:57:40 INFO     1000 5959 4.683848 69340.6
2025-07-03 23:02:36 INFO     2000 5959 4.660902 69184.5
2025-07-03 23:07:26 INFO     3000 5959 4.728563 69253.9
2025-07-03 23:12:18 INFO     4000 5959 4.693470 69340.6
2025-07-03 23:17:10 INFO     5000 5959 4.689697 69384.0
2025-07-03 23:21:52 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 23:23:02 INFO     Data : 2077
2025-07-03 23:23:02 INFO     Hit1 : 0.090034
2025-07-03 23:23:02 INFO     Hit3 : 0.176697
2025-07-03 23:23:02 INFO     Hit10: 0.302359
2025-07-03 23:23:02 INFO     MR   : 980.263361
2025-07-03 23:23:02 INFO     MRR  : 0.158735
2025-07-03 23:23:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 23:24:21 INFO     Data : 2342
2025-07-03 23:24:21 INFO     Hit1 : 0.122118
2025-07-03 23:24:21 INFO     Hit3 : 0.201110
2025-07-03 23:24:21 INFO     Hit10: 0.314261
2025-07-03 23:24:21 INFO     MR   : 909.257899
2025-07-03 23:24:21 INFO     MRR  : 0.183767
2025-07-03 23:24:21 INFO     -------------------------
2025-07-03 23:24:21 INFO     | Iteration: 5/5
2025-07-03 23:24:21 INFO     -------------------------
2025-07-03 23:24:21 INFO     >>>>> Predictor: Training
2025-07-03 23:29:10 INFO     1000 5959 4.694516 69323.3
2025-07-03 23:34:01 INFO     2000 5959 4.677808 69332.0
2025-07-03 23:38:53 INFO     3000 5959 4.717162 69219.2
2025-07-03 23:43:48 INFO     4000 5959 4.695113 69297.3
2025-07-03 23:48:41 INFO     5000 5959 4.673080 69332.0
2025-07-03 23:53:21 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 23:54:32 INFO     Data : 2077
2025-07-03 23:54:32 INFO     Hit1 : 0.088589
2025-07-03 23:54:32 INFO     Hit3 : 0.175734
2025-07-03 23:54:32 INFO     Hit10: 0.307174
2025-07-03 23:54:32 INFO     MR   : 963.428743
2025-07-03 23:54:32 INFO     MRR  : 0.159679
2025-07-03 23:54:32 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 23:55:51 INFO     Data : 2342
2025-07-03 23:55:51 INFO     Hit1 : 0.122545
2025-07-03 23:55:51 INFO     Hit3 : 0.204099
2025-07-03 23:55:51 INFO     Hit10: 0.311272
2025-07-03 23:55:51 INFO     MR   : 891.137489
2025-07-03 23:55:51 INFO     MRR  : 0.185477
2025-07-03 23:55:51 INFO     -------------------------
2025-07-03 23:55:51 INFO     | Final Test MRR: 0.186249
2025-07-03 23:55:51 INFO     -------------------------
