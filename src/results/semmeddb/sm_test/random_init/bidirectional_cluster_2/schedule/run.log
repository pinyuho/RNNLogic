2025-06-10 03:10:08 INFO     Data loading | DONE!
2025-06-10 03:10:08 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 03:10:08 INFO     Subset ratio: 0.1
2025-06-10 03:10:08 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 03:10:08 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 03:10:08 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 03:10:08 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 03:10:08 INFO     -------------------------
2025-06-10 03:10:08 INFO     | Pre-train Generator
2025-06-10 03:10:08 INFO     -------------------------
2025-06-10 03:10:08 INFO     >>>>> Generator: Training
2025-06-10 03:10:28 INFO     [E1000] Total: 1.001208 | Main: 1.022317 | Aux: 0.664816
2025-06-10 03:10:47 INFO     [E2000] Total: 0.915781 | Main: 0.915781 | Aux: 0.665128
2025-06-10 03:11:06 INFO     [E3000] Total: 0.913670 | Main: 0.913670 | Aux: 0.665343
2025-06-10 03:11:25 INFO     [E4000] Total: 0.908187 | Main: 0.908187 | Aux: 0.665411
2025-06-10 03:11:44 INFO     [E5000] Total: 0.907037 | Main: 0.907037 | Aux: 0.665491
2025-06-10 03:12:03 INFO     [E6000] Total: 0.905065 | Main: 0.905065 | Aux: 0.665431
2025-06-10 03:12:22 INFO     [E7000] Total: 0.908279 | Main: 0.908279 | Aux: 0.665558
2025-06-10 03:12:40 INFO     [E8000] Total: 0.904514 | Main: 0.904514 | Aux: 0.666102
2025-06-10 03:12:59 INFO     [E9000] Total: 0.907049 | Main: 0.907049 | Aux: 0.666444
2025-06-10 03:13:18 INFO     [E10000] Total: 0.905775 | Main: 0.905775 | Aux: 0.667058
2025-06-10 03:13:18 INFO     -------------------------
2025-06-10 03:13:18 INFO     | EM Iteration: 1/5
2025-06-10 03:13:18 INFO     -------------------------
2025-06-10 03:13:18 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 03:13:19 INFO     Predictor: read 816 rules from list.
2025-06-10 03:13:19 INFO     Preprocess training set
2025-06-10 03:13:19 INFO     >>>>> Predictor: Training
2025-06-10 03:15:33 INFO     1000 1231 8.595041 69297.3
2025-06-10 03:16:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:16:08 INFO     Data : 376
2025-06-10 03:16:08 INFO     Hit1 : 0.013298
2025-06-10 03:16:08 INFO     Hit3 : 0.045213
2025-06-10 03:16:08 INFO     Hit10: 0.103723
2025-06-10 03:16:08 INFO     MR   : 1274.190160
2025-06-10 03:16:08 INFO     MRR  : 0.045377
2025-06-10 03:16:08 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:16:12 INFO     Data : 440
2025-06-10 03:16:12 INFO     Hit1 : 0.038636
2025-06-10 03:16:12 INFO     Hit3 : 0.065909
2025-06-10 03:16:12 INFO     Hit10: 0.129545
2025-06-10 03:16:12 INFO     MR   : 1275.920455
2025-06-10 03:16:12 INFO     MRR  : 0.069319
2025-06-10 03:16:12 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 03:18:53 INFO     1000 1231
2025-06-10 03:19:29 INFO     >>>>> Generator: Training
2025-06-10 03:19:31 INFO     -------------------------
2025-06-10 03:19:31 INFO     | EM Iteration: 2/5
2025-06-10 03:19:31 INFO     -------------------------
2025-06-10 03:19:31 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 03:19:31 INFO     Predictor: read 859 rules from list.
2025-06-10 03:19:31 INFO     Preprocess training set
2025-06-10 03:19:31 INFO     >>>>> Predictor: Training
2025-06-10 03:21:51 INFO     1000 1231 8.625051 69384.0
2025-06-10 03:22:22 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:22:25 INFO     Data : 376
2025-06-10 03:22:25 INFO     Hit1 : 0.026596
2025-06-10 03:22:25 INFO     Hit3 : 0.055851
2025-06-10 03:22:25 INFO     Hit10: 0.114362
2025-06-10 03:22:25 INFO     MR   : 1224.835106
2025-06-10 03:22:25 INFO     MRR  : 0.055930
2025-06-10 03:22:25 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:22:30 INFO     Data : 440
2025-06-10 03:22:30 INFO     Hit1 : 0.050000
2025-06-10 03:22:30 INFO     Hit3 : 0.084091
2025-06-10 03:22:30 INFO     Hit10: 0.143182
2025-06-10 03:22:30 INFO     MR   : 1250.076136
2025-06-10 03:22:30 INFO     MRR  : 0.082756
2025-06-10 03:22:30 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 03:25:16 INFO     1000 1231
2025-06-10 03:25:54 INFO     >>>>> Generator: Training
2025-06-10 03:25:56 INFO     -------------------------
2025-06-10 03:25:56 INFO     | EM Iteration: 3/5
2025-06-10 03:25:56 INFO     -------------------------
2025-06-10 03:25:56 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 03:25:56 INFO     Predictor: read 927 rules from list.
2025-06-10 03:25:56 INFO     Preprocess training set
2025-06-10 03:25:56 INFO     >>>>> Predictor: Training
2025-06-10 03:28:23 INFO     1000 1231 8.601634 69340.6
2025-06-10 03:28:57 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:29:01 INFO     Data : 376
2025-06-10 03:29:01 INFO     Hit1 : 0.023936
2025-06-10 03:29:01 INFO     Hit3 : 0.047872
2025-06-10 03:29:01 INFO     Hit10: 0.127660
2025-06-10 03:29:01 INFO     MR   : 1134.000000
2025-06-10 03:29:01 INFO     MRR  : 0.057669
2025-06-10 03:29:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:29:07 INFO     Data : 440
2025-06-10 03:29:07 INFO     Hit1 : 0.054545
2025-06-10 03:29:07 INFO     Hit3 : 0.100000
2025-06-10 03:29:07 INFO     Hit10: 0.165909
2025-06-10 03:29:07 INFO     MR   : 1175.451136
2025-06-10 03:29:07 INFO     MRR  : 0.091721
2025-06-10 03:29:07 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 03:32:04 INFO     1000 1231
2025-06-10 03:32:44 INFO     >>>>> Generator: Training
2025-06-10 03:32:46 INFO     -------------------------
2025-06-10 03:32:46 INFO     | EM Iteration: 4/5
2025-06-10 03:32:46 INFO     -------------------------
2025-06-10 03:32:46 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 03:32:46 INFO     Predictor: read 974 rules from list.
2025-06-10 03:32:46 INFO     Preprocess training set
2025-06-10 03:32:46 INFO     >>>>> Predictor: Training
2025-06-10 03:35:17 INFO     1000 1231 8.602623 69366.7
2025-06-10 03:35:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:35:58 INFO     Data : 376
2025-06-10 03:35:58 INFO     Hit1 : 0.026596
2025-06-10 03:35:58 INFO     Hit3 : 0.055851
2025-06-10 03:35:58 INFO     Hit10: 0.109043
2025-06-10 03:35:58 INFO     MR   : 1276.257979
2025-06-10 03:35:58 INFO     MRR  : 0.058212
2025-06-10 03:35:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:36:05 INFO     Data : 440
2025-06-10 03:36:05 INFO     Hit1 : 0.047727
2025-06-10 03:36:05 INFO     Hit3 : 0.081818
2025-06-10 03:36:05 INFO     Hit10: 0.143182
2025-06-10 03:36:05 INFO     MR   : 1237.046591
2025-06-10 03:36:05 INFO     MRR  : 0.081740
2025-06-10 03:36:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 03:39:03 INFO     1000 1231
2025-06-10 03:39:46 INFO     >>>>> Generator: Training
2025-06-10 03:39:47 INFO     -------------------------
2025-06-10 03:39:47 INFO     | EM Iteration: 5/5
2025-06-10 03:39:47 INFO     -------------------------
2025-06-10 03:39:47 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 03:39:48 INFO     Predictor: read 991 rules from list.
2025-06-10 03:39:48 INFO     Preprocess training set
2025-06-10 03:39:48 INFO     >>>>> Predictor: Training
2025-06-10 03:42:20 INFO     1000 1231 8.609058 69384.0
2025-06-10 03:42:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:43:01 INFO     Data : 376
2025-06-10 03:43:01 INFO     Hit1 : 0.031915
2025-06-10 03:43:01 INFO     Hit3 : 0.077128
2025-06-10 03:43:01 INFO     Hit10: 0.132979
2025-06-10 03:43:01 INFO     MR   : 1239.367021
2025-06-10 03:43:01 INFO     MRR  : 0.069036
2025-06-10 03:43:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:43:08 INFO     Data : 440
2025-06-10 03:43:08 INFO     Hit1 : 0.052273
2025-06-10 03:43:08 INFO     Hit3 : 0.088636
2025-06-10 03:43:08 INFO     Hit10: 0.159091
2025-06-10 03:43:08 INFO     MR   : 1175.110227
2025-06-10 03:43:08 INFO     MRR  : 0.089222
2025-06-10 03:43:08 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 03:46:12 INFO     1000 1231
2025-06-10 03:46:54 INFO     >>>>> Generator: Training
2025-06-10 03:46:56 INFO     -------------------------
2025-06-10 03:46:56 INFO     | Post-train Generator
2025-06-10 03:46:56 INFO     -------------------------
2025-06-10 03:46:56 INFO     >>>>> Generator: Training
2025-06-10 03:47:15 INFO     [E1000] Total: 1.239264 | Main: 1.246160 | Aux: 0.619298
2025-06-10 03:47:15 INFO     -------------------------
2025-06-10 03:47:15 INFO     | Beam Search Best Rules
2025-06-10 03:47:15 INFO     -------------------------
2025-06-10 03:47:15 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 03:47:16 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 03:47:21 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 03:48:03 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 03:48:31 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 03:48:52 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 03:48:52 INFO     Subset ratio: 0.1
2025-06-10 03:48:52 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 03:48:52 INFO     -------------------------
2025-06-10 03:48:52 INFO     | Train Final Predictor+
2025-06-10 03:48:52 INFO     -------------------------
2025-06-10 03:48:52 INFO     Predictor+: read 1842 rules from list.
2025-06-10 03:48:52 INFO     Preprocess training set
2025-06-10 03:48:52 INFO     -------------------------
2025-06-10 03:48:52 INFO     | Iteration: 1/5
2025-06-10 03:48:52 INFO     -------------------------
2025-06-10 03:48:52 INFO     >>>>> Predictor: Training
2025-06-10 03:52:13 INFO     1000 1231 7.248367 69305.9
2025-06-10 03:53:00 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:53:08 INFO     Data : 376
2025-06-10 03:53:08 INFO     Hit1 : 0.023936
2025-06-10 03:53:08 INFO     Hit3 : 0.050532
2025-06-10 03:53:08 INFO     Hit10: 0.138298
2025-06-10 03:53:08 INFO     MR   : 1257.748670
2025-06-10 03:53:08 INFO     MRR  : 0.059351
2025-06-10 03:53:08 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:53:18 INFO     Data : 440
2025-06-10 03:53:18 INFO     Hit1 : 0.027273
2025-06-10 03:53:18 INFO     Hit3 : 0.056818
2025-06-10 03:53:18 INFO     Hit10: 0.122727
2025-06-10 03:53:18 INFO     MR   : 1256.277273
2025-06-10 03:53:18 INFO     MRR  : 0.061169
2025-06-10 03:53:18 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/schedule/predictor.pt
2025-06-10 03:53:18 INFO     -------------------------
2025-06-10 03:53:18 INFO     | Iteration: 2/5
2025-06-10 03:53:18 INFO     -------------------------
2025-06-10 03:53:18 INFO     >>>>> Predictor: Training
2025-06-10 03:56:40 INFO     1000 1231 6.949720 69366.7
2025-06-10 03:57:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:57:34 INFO     Data : 376
2025-06-10 03:57:34 INFO     Hit1 : 0.021277
2025-06-10 03:57:34 INFO     Hit3 : 0.045213
2025-06-10 03:57:34 INFO     Hit10: 0.127660
2025-06-10 03:57:34 INFO     MR   : 1165.055851
2025-06-10 03:57:34 INFO     MRR  : 0.056398
2025-06-10 03:57:34 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:57:44 INFO     Data : 440
2025-06-10 03:57:44 INFO     Hit1 : 0.038636
2025-06-10 03:57:44 INFO     Hit3 : 0.054545
2025-06-10 03:57:44 INFO     Hit10: 0.109091
2025-06-10 03:57:44 INFO     MR   : 1148.671591
2025-06-10 03:57:44 INFO     MRR  : 0.062652
2025-06-10 03:57:44 INFO     -------------------------
2025-06-10 03:57:44 INFO     | Iteration: 3/5
2025-06-10 03:57:44 INFO     -------------------------
2025-06-10 03:57:44 INFO     >>>>> Predictor: Training
2025-06-10 04:01:08 INFO     1000 1231 6.878513 69384.0
2025-06-10 04:01:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 04:02:03 INFO     Data : 376
2025-06-10 04:02:03 INFO     Hit1 : 0.034574
2025-06-10 04:02:03 INFO     Hit3 : 0.050532
2025-06-10 04:02:03 INFO     Hit10: 0.138298
2025-06-10 04:02:03 INFO     MR   : 1150.481383
2025-06-10 04:02:03 INFO     MRR  : 0.065139
2025-06-10 04:02:03 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 04:02:13 INFO     Data : 440
2025-06-10 04:02:13 INFO     Hit1 : 0.031818
2025-06-10 04:02:13 INFO     Hit3 : 0.054545
2025-06-10 04:02:13 INFO     Hit10: 0.125000
2025-06-10 04:02:13 INFO     MR   : 1141.067045
2025-06-10 04:02:13 INFO     MRR  : 0.063737
2025-06-10 04:02:13 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/schedule/predictor.pt
2025-06-10 04:02:13 INFO     -------------------------
2025-06-10 04:02:13 INFO     | Iteration: 4/5
2025-06-10 04:02:13 INFO     -------------------------
2025-06-10 04:02:13 INFO     >>>>> Predictor: Training
2025-06-10 04:05:37 INFO     1000 1231 6.825669 69340.6
2025-06-10 04:06:23 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 04:06:32 INFO     Data : 376
2025-06-10 04:06:32 INFO     Hit1 : 0.021277
2025-06-10 04:06:32 INFO     Hit3 : 0.050532
2025-06-10 04:06:32 INFO     Hit10: 0.127660
2025-06-10 04:06:32 INFO     MR   : 1133.827128
2025-06-10 04:06:32 INFO     MRR  : 0.056338
2025-06-10 04:06:32 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 04:06:41 INFO     Data : 440
2025-06-10 04:06:41 INFO     Hit1 : 0.025000
2025-06-10 04:06:41 INFO     Hit3 : 0.054545
2025-06-10 04:06:41 INFO     Hit10: 0.106818
2025-06-10 04:06:41 INFO     MR   : 1099.330682
2025-06-10 04:06:41 INFO     MRR  : 0.055910
2025-06-10 04:06:41 INFO     -------------------------
2025-06-10 04:06:41 INFO     | Iteration: 5/5
2025-06-10 04:06:41 INFO     -------------------------
2025-06-10 04:06:41 INFO     >>>>> Predictor: Training
2025-06-10 04:10:04 INFO     1000 1231 6.887919 69340.6
2025-06-10 04:10:51 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 04:10:59 INFO     Data : 376
2025-06-10 04:10:59 INFO     Hit1 : 0.018617
2025-06-10 04:10:59 INFO     Hit3 : 0.050532
2025-06-10 04:10:59 INFO     Hit10: 0.143617
2025-06-10 04:10:59 INFO     MR   : 1119.018617
2025-06-10 04:10:59 INFO     MRR  : 0.057055
2025-06-10 04:10:59 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 04:11:09 INFO     Data : 440
2025-06-10 04:11:09 INFO     Hit1 : 0.031818
2025-06-10 04:11:09 INFO     Hit3 : 0.054545
2025-06-10 04:11:09 INFO     Hit10: 0.104545
2025-06-10 04:11:09 INFO     MR   : 1099.114773
2025-06-10 04:11:09 INFO     MRR  : 0.058836
2025-06-10 04:11:09 INFO     -------------------------
2025-06-10 04:11:09 INFO     | Final Test MRR: 0.063737
2025-06-10 04:11:09 INFO     -------------------------
