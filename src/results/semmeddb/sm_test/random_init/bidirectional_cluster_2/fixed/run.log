2025-06-10 01:08:44 INFO     Data loading | DONE!
2025-06-10 01:08:45 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 01:08:45 INFO     Subset ratio: 0.1
2025-06-10 01:08:45 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 01:08:45 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 01:08:45 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 01:08:45 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 01:08:45 INFO     -------------------------
2025-06-10 01:08:45 INFO     | Pre-train Generator
2025-06-10 01:08:45 INFO     -------------------------
2025-06-10 01:08:45 INFO     >>>>> Generator: Training
2025-06-10 01:09:04 INFO     [E1000] Total: 0.915077 | Main: 1.017204 | Aux: 0.506568
2025-06-10 01:09:23 INFO     [E2000] Total: 0.827251 | Main: 0.915226 | Aux: 0.475349
2025-06-10 01:09:41 INFO     [E3000] Total: 0.825334 | Main: 0.913349 | Aux: 0.473273
2025-06-10 01:10:00 INFO     [E4000] Total: 0.820813 | Main: 0.907936 | Aux: 0.472319
2025-06-10 01:10:19 INFO     [E5000] Total: 0.819824 | Main: 0.906846 | Aux: 0.471737
2025-06-10 01:10:38 INFO     [E6000] Total: 0.818156 | Main: 0.904903 | Aux: 0.471167
2025-06-10 01:10:56 INFO     [E7000] Total: 0.820637 | Main: 0.908111 | Aux: 0.470741
2025-06-10 01:11:15 INFO     [E8000] Total: 0.817600 | Main: 0.904406 | Aux: 0.470378
2025-06-10 01:11:34 INFO     [E9000] Total: 0.819640 | Main: 0.907022 | Aux: 0.470110
2025-06-10 01:11:53 INFO     [E10000] Total: 0.818533 | Main: 0.905657 | Aux: 0.470036
2025-06-10 01:11:53 INFO     -------------------------
2025-06-10 01:11:53 INFO     | EM Iteration: 1/5
2025-06-10 01:11:53 INFO     -------------------------
2025-06-10 01:11:53 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:11:53 INFO     Predictor: read 844 rules from list.
2025-06-10 01:11:53 INFO     Preprocess training set
2025-06-10 01:11:53 INFO     >>>>> Predictor: Training
2025-06-10 01:14:08 INFO     1000 1231 8.591231 69297.3
2025-06-10 01:14:39 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:14:43 INFO     Data : 376
2025-06-10 01:14:43 INFO     Hit1 : 0.013298
2025-06-10 01:14:43 INFO     Hit3 : 0.045213
2025-06-10 01:14:43 INFO     Hit10: 0.101064
2025-06-10 01:14:43 INFO     MR   : 1274.998670
2025-06-10 01:14:43 INFO     MRR  : 0.045193
2025-06-10 01:14:43 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:14:47 INFO     Data : 440
2025-06-10 01:14:47 INFO     Hit1 : 0.036364
2025-06-10 01:14:47 INFO     Hit3 : 0.063636
2025-06-10 01:14:47 INFO     Hit10: 0.129545
2025-06-10 01:14:47 INFO     MR   : 1276.577273
2025-06-10 01:14:47 INFO     MRR  : 0.067499
2025-06-10 01:14:47 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:17:26 INFO     1000 1231
2025-06-10 01:18:02 INFO     >>>>> Generator: Training
2025-06-10 01:18:04 INFO     -------------------------
2025-06-10 01:18:04 INFO     | EM Iteration: 2/5
2025-06-10 01:18:04 INFO     -------------------------
2025-06-10 01:18:04 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:18:04 INFO     Predictor: read 871 rules from list.
2025-06-10 01:18:04 INFO     Preprocess training set
2025-06-10 01:18:04 INFO     >>>>> Predictor: Training
2025-06-10 01:20:21 INFO     1000 1231 8.625179 69384.0
2025-06-10 01:20:51 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:20:55 INFO     Data : 376
2025-06-10 01:20:55 INFO     Hit1 : 0.026596
2025-06-10 01:20:55 INFO     Hit3 : 0.055851
2025-06-10 01:20:55 INFO     Hit10: 0.117021
2025-06-10 01:20:55 INFO     MR   : 1237.412234
2025-06-10 01:20:55 INFO     MRR  : 0.056725
2025-06-10 01:20:55 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:20:59 INFO     Data : 440
2025-06-10 01:20:59 INFO     Hit1 : 0.045455
2025-06-10 01:20:59 INFO     Hit3 : 0.081818
2025-06-10 01:20:59 INFO     Hit10: 0.147727
2025-06-10 01:20:59 INFO     MR   : 1240.238636
2025-06-10 01:20:59 INFO     MRR  : 0.080040
2025-06-10 01:20:59 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:23:41 INFO     1000 1231
2025-06-10 01:24:17 INFO     >>>>> Generator: Training
2025-06-10 01:24:19 INFO     -------------------------
2025-06-10 01:24:19 INFO     | EM Iteration: 3/5
2025-06-10 01:24:19 INFO     -------------------------
2025-06-10 01:24:19 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:24:19 INFO     Predictor: read 935 rules from list.
2025-06-10 01:24:19 INFO     Preprocess training set
2025-06-10 01:24:19 INFO     >>>>> Predictor: Training
2025-06-10 01:26:48 INFO     1000 1231 8.602055 69340.6
2025-06-10 01:27:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:27:25 INFO     Data : 376
2025-06-10 01:27:25 INFO     Hit1 : 0.021277
2025-06-10 01:27:25 INFO     Hit3 : 0.055851
2025-06-10 01:27:25 INFO     Hit10: 0.130319
2025-06-10 01:27:25 INFO     MR   : 1136.585106
2025-06-10 01:27:25 INFO     MRR  : 0.057037
2025-06-10 01:27:25 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:27:30 INFO     Data : 440
2025-06-10 01:27:30 INFO     Hit1 : 0.056818
2025-06-10 01:27:30 INFO     Hit3 : 0.100000
2025-06-10 01:27:30 INFO     Hit10: 0.163636
2025-06-10 01:27:30 INFO     MR   : 1174.578409
2025-06-10 01:27:30 INFO     MRR  : 0.092870
2025-06-10 01:27:30 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:30:27 INFO     1000 1231
2025-06-10 01:31:07 INFO     >>>>> Generator: Training
2025-06-10 01:31:09 INFO     -------------------------
2025-06-10 01:31:09 INFO     | EM Iteration: 4/5
2025-06-10 01:31:09 INFO     -------------------------
2025-06-10 01:31:09 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:31:09 INFO     Predictor: read 985 rules from list.
2025-06-10 01:31:09 INFO     Preprocess training set
2025-06-10 01:31:09 INFO     >>>>> Predictor: Training
2025-06-10 01:33:38 INFO     1000 1231 8.602392 69366.7
2025-06-10 01:34:13 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:34:19 INFO     Data : 376
2025-06-10 01:34:19 INFO     Hit1 : 0.026596
2025-06-10 01:34:19 INFO     Hit3 : 0.045213
2025-06-10 01:34:19 INFO     Hit10: 0.106383
2025-06-10 01:34:19 INFO     MR   : 1293.910904
2025-06-10 01:34:19 INFO     MRR  : 0.054370
2025-06-10 01:34:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:34:26 INFO     Data : 440
2025-06-10 01:34:26 INFO     Hit1 : 0.043182
2025-06-10 01:34:26 INFO     Hit3 : 0.079545
2025-06-10 01:34:26 INFO     Hit10: 0.138636
2025-06-10 01:34:26 INFO     MR   : 1262.655682
2025-06-10 01:34:26 INFO     MRR  : 0.078053
2025-06-10 01:34:26 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:37:25 INFO     1000 1231
2025-06-10 01:38:07 INFO     >>>>> Generator: Training
2025-06-10 01:38:09 INFO     -------------------------
2025-06-10 01:38:09 INFO     | EM Iteration: 5/5
2025-06-10 01:38:09 INFO     -------------------------
2025-06-10 01:38:09 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 01:38:09 INFO     Predictor: read 1000 rules from list.
2025-06-10 01:38:09 INFO     Preprocess training set
2025-06-10 01:38:09 INFO     >>>>> Predictor: Training
2025-06-10 01:40:41 INFO     1000 1231 8.609097 69384.0
2025-06-10 01:41:16 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:41:22 INFO     Data : 376
2025-06-10 01:41:22 INFO     Hit1 : 0.031915
2025-06-10 01:41:22 INFO     Hit3 : 0.077128
2025-06-10 01:41:22 INFO     Hit10: 0.132979
2025-06-10 01:41:22 INFO     MR   : 1239.509309
2025-06-10 01:41:22 INFO     MRR  : 0.068982
2025-06-10 01:41:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:41:29 INFO     Data : 440
2025-06-10 01:41:29 INFO     Hit1 : 0.052273
2025-06-10 01:41:29 INFO     Hit3 : 0.090909
2025-06-10 01:41:29 INFO     Hit10: 0.159091
2025-06-10 01:41:29 INFO     MR   : 1174.951136
2025-06-10 01:41:29 INFO     MRR  : 0.089524
2025-06-10 01:41:29 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 01:44:30 INFO     1000 1231
2025-06-10 01:45:12 INFO     >>>>> Generator: Training
2025-06-10 01:45:14 INFO     -------------------------
2025-06-10 01:45:14 INFO     | Post-train Generator
2025-06-10 01:45:14 INFO     -------------------------
2025-06-10 01:45:14 INFO     >>>>> Generator: Training
2025-06-10 01:45:33 INFO     [E1000] Total: 1.121909 | Main: 1.277988 | Aux: 0.497590
2025-06-10 01:45:33 INFO     -------------------------
2025-06-10 01:45:33 INFO     | Beam Search Best Rules
2025-06-10 01:45:33 INFO     -------------------------
2025-06-10 01:45:33 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:45:34 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:45:39 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:46:19 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:46:47 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 01:47:08 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 01:47:08 INFO     Subset ratio: 0.1
2025-06-10 01:47:08 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 01:47:08 INFO     -------------------------
2025-06-10 01:47:08 INFO     | Train Final Predictor+
2025-06-10 01:47:08 INFO     -------------------------
2025-06-10 01:47:08 INFO     Predictor+: read 1842 rules from list.
2025-06-10 01:47:08 INFO     Preprocess training set
2025-06-10 01:47:08 INFO     -------------------------
2025-06-10 01:47:08 INFO     | Iteration: 1/5
2025-06-10 01:47:08 INFO     -------------------------
2025-06-10 01:47:08 INFO     >>>>> Predictor: Training
2025-06-10 01:50:20 INFO     1000 1231 6.145111 69305.9
2025-06-10 01:51:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:51:15 INFO     Data : 376
2025-06-10 01:51:15 INFO     Hit1 : 0.034574
2025-06-10 01:51:15 INFO     Hit3 : 0.071809
2025-06-10 01:51:15 INFO     Hit10: 0.148936
2025-06-10 01:51:15 INFO     MR   : 1643.930851
2025-06-10 01:51:15 INFO     MRR  : 0.071900
2025-06-10 01:51:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:51:24 INFO     Data : 440
2025-06-10 01:51:24 INFO     Hit1 : 0.043182
2025-06-10 01:51:24 INFO     Hit3 : 0.072727
2025-06-10 01:51:24 INFO     Hit10: 0.145455
2025-06-10 01:51:24 INFO     MR   : 1585.385227
2025-06-10 01:51:24 INFO     MRR  : 0.076230
2025-06-10 01:51:24 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 01:51:24 INFO     -------------------------
2025-06-10 01:51:24 INFO     | Iteration: 2/5
2025-06-10 01:51:24 INFO     -------------------------
2025-06-10 01:51:24 INFO     >>>>> Predictor: Training
2025-06-10 01:54:46 INFO     1000 1231 5.930874 69366.7
2025-06-10 01:55:32 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 01:55:40 INFO     Data : 376
2025-06-10 01:55:40 INFO     Hit1 : 0.031915
2025-06-10 01:55:40 INFO     Hit3 : 0.090426
2025-06-10 01:55:40 INFO     Hit10: 0.170213
2025-06-10 01:55:40 INFO     MR   : 1518.765957
2025-06-10 01:55:40 INFO     MRR  : 0.077256
2025-06-10 01:55:40 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 01:55:50 INFO     Data : 440
2025-06-10 01:55:50 INFO     Hit1 : 0.047727
2025-06-10 01:55:50 INFO     Hit3 : 0.077273
2025-06-10 01:55:50 INFO     Hit10: 0.145455
2025-06-10 01:55:50 INFO     MR   : 1476.281818
2025-06-10 01:55:50 INFO     MRR  : 0.079748
2025-06-10 01:55:50 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 01:55:50 INFO     -------------------------
2025-06-10 01:55:50 INFO     | Iteration: 3/5
2025-06-10 01:55:50 INFO     -------------------------
2025-06-10 01:55:50 INFO     >>>>> Predictor: Training
2025-06-10 01:59:12 INFO     1000 1231 5.838607 69384.0
2025-06-10 01:59:59 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:00:07 INFO     Data : 376
2025-06-10 02:00:07 INFO     Hit1 : 0.042553
2025-06-10 02:00:07 INFO     Hit3 : 0.082447
2025-06-10 02:00:07 INFO     Hit10: 0.154255
2025-06-10 02:00:07 INFO     MR   : 1481.058511
2025-06-10 02:00:07 INFO     MRR  : 0.081142
2025-06-10 02:00:07 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:00:17 INFO     Data : 440
2025-06-10 02:00:17 INFO     Hit1 : 0.050000
2025-06-10 02:00:17 INFO     Hit3 : 0.088636
2025-06-10 02:00:17 INFO     Hit10: 0.150000
2025-06-10 02:00:17 INFO     MR   : 1459.114773
2025-06-10 02:00:17 INFO     MRR  : 0.084461
2025-06-10 02:00:17 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 02:00:17 INFO     -------------------------
2025-06-10 02:00:17 INFO     | Iteration: 4/5
2025-06-10 02:00:17 INFO     -------------------------
2025-06-10 02:00:17 INFO     >>>>> Predictor: Training
2025-06-10 02:03:39 INFO     1000 1231 5.849686 69340.6
2025-06-10 02:04:25 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:04:33 INFO     Data : 376
2025-06-10 02:04:33 INFO     Hit1 : 0.047872
2025-06-10 02:04:33 INFO     Hit3 : 0.087766
2025-06-10 02:04:33 INFO     Hit10: 0.170213
2025-06-10 02:04:33 INFO     MR   : 1448.289894
2025-06-10 02:04:33 INFO     MRR  : 0.085613
2025-06-10 02:04:33 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:04:43 INFO     Data : 440
2025-06-10 02:04:43 INFO     Hit1 : 0.043182
2025-06-10 02:04:43 INFO     Hit3 : 0.090909
2025-06-10 02:04:43 INFO     Hit10: 0.147727
2025-06-10 02:04:43 INFO     MR   : 1371.406818
2025-06-10 02:04:43 INFO     MRR  : 0.081985
2025-06-10 02:04:43 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/fixed/predictor.pt
2025-06-10 02:04:43 INFO     -------------------------
2025-06-10 02:04:43 INFO     | Iteration: 5/5
2025-06-10 02:04:43 INFO     -------------------------
2025-06-10 02:04:43 INFO     >>>>> Predictor: Training
2025-06-10 02:08:04 INFO     1000 1231 5.847723 69340.6
2025-06-10 02:08:50 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:08:58 INFO     Data : 376
2025-06-10 02:08:58 INFO     Hit1 : 0.039894
2025-06-10 02:08:58 INFO     Hit3 : 0.071809
2025-06-10 02:08:58 INFO     Hit10: 0.170213
2025-06-10 02:08:58 INFO     MR   : 1452.513298
2025-06-10 02:08:58 INFO     MRR  : 0.077646
2025-06-10 02:08:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:09:08 INFO     Data : 440
2025-06-10 02:09:08 INFO     Hit1 : 0.036364
2025-06-10 02:09:08 INFO     Hit3 : 0.084091
2025-06-10 02:09:08 INFO     Hit10: 0.150000
2025-06-10 02:09:08 INFO     MR   : 1385.234091
2025-06-10 02:09:08 INFO     MRR  : 0.075558
2025-06-10 02:09:08 INFO     -------------------------
2025-06-10 02:09:08 INFO     | Final Test MRR: 0.081985
2025-06-10 02:09:08 INFO     -------------------------
