2025-06-10 02:09:11 INFO     Data loading | DONE!
2025-06-10 02:09:11 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 02:09:11 INFO     Subset ratio: 0.1
2025-06-10 02:09:11 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 02:09:11 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 02:09:11 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 02:09:11 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 02:09:11 INFO     -------------------------
2025-06-10 02:09:11 INFO     | Pre-train Generator
2025-06-10 02:09:11 INFO     -------------------------
2025-06-10 02:09:11 INFO     >>>>> Generator: Training
2025-06-10 02:09:31 INFO     [E1000] Total: 0.995491 | Main: 1.018759 | Aux: 0.533948
2025-06-10 02:09:50 INFO     [E2000] Total: 0.893682 | Main: 0.915467 | Aux: 0.479779
2025-06-10 02:10:09 INFO     [E3000] Total: 0.891524 | Main: 0.913434 | Aux: 0.475229
2025-06-10 02:10:28 INFO     [E4000] Total: 0.886313 | Main: 0.908032 | Aux: 0.473652
2025-06-10 02:10:47 INFO     [E5000] Total: 0.885233 | Main: 0.906933 | Aux: 0.472938
2025-06-10 02:11:06 INFO     [E6000] Total: 0.883323 | Main: 0.904973 | Aux: 0.471985
2025-06-10 02:11:25 INFO     [E7000] Total: 0.886345 | Main: 0.908176 | Aux: 0.471555
2025-06-10 02:11:44 INFO     [E8000] Total: 0.882768 | Main: 0.904438 | Aux: 0.471049
2025-06-10 02:12:03 INFO     [E9000] Total: 0.885201 | Main: 0.907017 | Aux: 0.470699
2025-06-10 02:12:22 INFO     [E10000] Total: 0.884058 | Main: 0.905807 | Aux: 0.470826
2025-06-10 02:12:22 INFO     -------------------------
2025-06-10 02:12:22 INFO     | EM Iteration: 1/5
2025-06-10 02:12:22 INFO     -------------------------
2025-06-10 02:12:22 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:12:22 INFO     Predictor: read 823 rules from list.
2025-06-10 02:12:22 INFO     Preprocess training set
2025-06-10 02:12:22 INFO     >>>>> Predictor: Training
2025-06-10 02:14:37 INFO     1000 1231 8.591445 69297.3
2025-06-10 02:15:08 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:15:12 INFO     Data : 376
2025-06-10 02:15:12 INFO     Hit1 : 0.013298
2025-06-10 02:15:12 INFO     Hit3 : 0.045213
2025-06-10 02:15:12 INFO     Hit10: 0.101064
2025-06-10 02:15:12 INFO     MR   : 1275.869681
2025-06-10 02:15:12 INFO     MRR  : 0.045301
2025-06-10 02:15:12 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:15:16 INFO     Data : 440
2025-06-10 02:15:16 INFO     Hit1 : 0.036364
2025-06-10 02:15:16 INFO     Hit3 : 0.061364
2025-06-10 02:15:16 INFO     Hit10: 0.129545
2025-06-10 02:15:16 INFO     MR   : 1275.894318
2025-06-10 02:15:16 INFO     MRR  : 0.066486
2025-06-10 02:15:16 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:17:58 INFO     1000 1231
2025-06-10 02:18:35 INFO     >>>>> Generator: Training
2025-06-10 02:18:37 INFO     -------------------------
2025-06-10 02:18:37 INFO     | EM Iteration: 2/5
2025-06-10 02:18:37 INFO     -------------------------
2025-06-10 02:18:37 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:18:37 INFO     Predictor: read 858 rules from list.
2025-06-10 02:18:37 INFO     Preprocess training set
2025-06-10 02:18:37 INFO     >>>>> Predictor: Training
2025-06-10 02:20:56 INFO     1000 1231 8.625896 69384.0
2025-06-10 02:21:27 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:21:30 INFO     Data : 376
2025-06-10 02:21:30 INFO     Hit1 : 0.026596
2025-06-10 02:21:30 INFO     Hit3 : 0.055851
2025-06-10 02:21:30 INFO     Hit10: 0.117021
2025-06-10 02:21:30 INFO     MR   : 1237.291223
2025-06-10 02:21:30 INFO     MRR  : 0.056734
2025-06-10 02:21:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:21:34 INFO     Data : 440
2025-06-10 02:21:34 INFO     Hit1 : 0.045455
2025-06-10 02:21:34 INFO     Hit3 : 0.081818
2025-06-10 02:21:34 INFO     Hit10: 0.147727
2025-06-10 02:21:34 INFO     MR   : 1240.137500
2025-06-10 02:21:34 INFO     MRR  : 0.080032
2025-06-10 02:21:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:24:20 INFO     1000 1231
2025-06-10 02:24:57 INFO     >>>>> Generator: Training
2025-06-10 02:24:59 INFO     -------------------------
2025-06-10 02:24:59 INFO     | EM Iteration: 3/5
2025-06-10 02:24:59 INFO     -------------------------
2025-06-10 02:24:59 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:24:59 INFO     Predictor: read 921 rules from list.
2025-06-10 02:24:59 INFO     Preprocess training set
2025-06-10 02:24:59 INFO     >>>>> Predictor: Training
2025-06-10 02:27:26 INFO     1000 1231 8.602935 69340.6
2025-06-10 02:27:59 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:28:04 INFO     Data : 376
2025-06-10 02:28:04 INFO     Hit1 : 0.021277
2025-06-10 02:28:04 INFO     Hit3 : 0.047872
2025-06-10 02:28:04 INFO     Hit10: 0.125000
2025-06-10 02:28:04 INFO     MR   : 1136.736702
2025-06-10 02:28:04 INFO     MRR  : 0.055049
2025-06-10 02:28:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:28:09 INFO     Data : 440
2025-06-10 02:28:09 INFO     Hit1 : 0.054545
2025-06-10 02:28:09 INFO     Hit3 : 0.102273
2025-06-10 02:28:09 INFO     Hit10: 0.161364
2025-06-10 02:28:09 INFO     MR   : 1179.405682
2025-06-10 02:28:09 INFO     MRR  : 0.093328
2025-06-10 02:28:09 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:31:06 INFO     1000 1231
2025-06-10 02:31:46 INFO     >>>>> Generator: Training
2025-06-10 02:31:48 INFO     -------------------------
2025-06-10 02:31:48 INFO     | EM Iteration: 4/5
2025-06-10 02:31:48 INFO     -------------------------
2025-06-10 02:31:48 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:31:48 INFO     Predictor: read 970 rules from list.
2025-06-10 02:31:48 INFO     Preprocess training set
2025-06-10 02:31:48 INFO     >>>>> Predictor: Training
2025-06-10 02:34:17 INFO     1000 1231 8.604509 69366.7
2025-06-10 02:34:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:34:58 INFO     Data : 376
2025-06-10 02:34:58 INFO     Hit1 : 0.026596
2025-06-10 02:34:58 INFO     Hit3 : 0.047872
2025-06-10 02:34:58 INFO     Hit10: 0.103723
2025-06-10 02:34:58 INFO     MR   : 1292.917553
2025-06-10 02:34:58 INFO     MRR  : 0.054692
2025-06-10 02:34:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:35:05 INFO     Data : 440
2025-06-10 02:35:05 INFO     Hit1 : 0.043182
2025-06-10 02:35:05 INFO     Hit3 : 0.081818
2025-06-10 02:35:05 INFO     Hit10: 0.147727
2025-06-10 02:35:05 INFO     MR   : 1262.440909
2025-06-10 02:35:05 INFO     MRR  : 0.078509
2025-06-10 02:35:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:38:04 INFO     1000 1231
2025-06-10 02:38:47 INFO     >>>>> Generator: Training
2025-06-10 02:38:49 INFO     -------------------------
2025-06-10 02:38:49 INFO     | EM Iteration: 5/5
2025-06-10 02:38:49 INFO     -------------------------
2025-06-10 02:38:49 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 02:38:49 INFO     Predictor: read 996 rules from list.
2025-06-10 02:38:49 INFO     Preprocess training set
2025-06-10 02:38:49 INFO     >>>>> Predictor: Training
2025-06-10 02:41:22 INFO     1000 1231 8.607464 69384.0
2025-06-10 02:41:58 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:42:04 INFO     Data : 376
2025-06-10 02:42:04 INFO     Hit1 : 0.029255
2025-06-10 02:42:04 INFO     Hit3 : 0.071809
2025-06-10 02:42:04 INFO     Hit10: 0.130319
2025-06-10 02:42:04 INFO     MR   : 1244.299202
2025-06-10 02:42:04 INFO     MRR  : 0.065687
2025-06-10 02:42:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:42:11 INFO     Data : 440
2025-06-10 02:42:11 INFO     Hit1 : 0.063636
2025-06-10 02:42:11 INFO     Hit3 : 0.100000
2025-06-10 02:42:11 INFO     Hit10: 0.154545
2025-06-10 02:42:11 INFO     MR   : 1177.635227
2025-06-10 02:42:11 INFO     MRR  : 0.096559
2025-06-10 02:42:11 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 02:45:15 INFO     1000 1231
2025-06-10 02:45:58 INFO     >>>>> Generator: Training
2025-06-10 02:46:00 INFO     -------------------------
2025-06-10 02:46:00 INFO     | Post-train Generator
2025-06-10 02:46:00 INFO     -------------------------
2025-06-10 02:46:00 INFO     >>>>> Generator: Training
2025-06-10 02:46:19 INFO     [E1000] Total: 1.220601 | Main: 1.257558 | Aux: 0.509977
2025-06-10 02:46:19 INFO     -------------------------
2025-06-10 02:46:19 INFO     | Beam Search Best Rules
2025-06-10 02:46:19 INFO     -------------------------
2025-06-10 02:46:19 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:46:20 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:46:25 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:05 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:34 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 02:47:53 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 02:47:53 INFO     Subset ratio: 0.1
2025-06-10 02:47:53 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 02:47:53 INFO     -------------------------
2025-06-10 02:47:53 INFO     | Train Final Predictor+
2025-06-10 02:47:53 INFO     -------------------------
2025-06-10 02:47:53 INFO     Predictor+: read 1842 rules from list.
2025-06-10 02:47:53 INFO     Preprocess training set
2025-06-10 02:47:53 INFO     -------------------------
2025-06-10 02:47:53 INFO     | Iteration: 1/5
2025-06-10 02:47:53 INFO     -------------------------
2025-06-10 02:47:53 INFO     >>>>> Predictor: Training
2025-06-10 02:51:15 INFO     1000 1231 6.323329 69305.9
2025-06-10 02:52:01 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:52:09 INFO     Data : 376
2025-06-10 02:52:09 INFO     Hit1 : 0.045213
2025-06-10 02:52:09 INFO     Hit3 : 0.093085
2025-06-10 02:52:09 INFO     Hit10: 0.175532
2025-06-10 02:52:09 INFO     MR   : 1371.390957
2025-06-10 02:52:09 INFO     MRR  : 0.089931
2025-06-10 02:52:09 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:52:19 INFO     Data : 440
2025-06-10 02:52:19 INFO     Hit1 : 0.040909
2025-06-10 02:52:19 INFO     Hit3 : 0.079545
2025-06-10 02:52:19 INFO     Hit10: 0.145455
2025-06-10 02:52:19 INFO     MR   : 1394.893182
2025-06-10 02:52:19 INFO     MRR  : 0.075324
2025-06-10 02:52:19 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/bidirectional_cluster_2/warmup/predictor.pt
2025-06-10 02:52:19 INFO     -------------------------
2025-06-10 02:52:19 INFO     | Iteration: 2/5
2025-06-10 02:52:19 INFO     -------------------------
2025-06-10 02:52:19 INFO     >>>>> Predictor: Training
2025-06-10 02:55:40 INFO     1000 1231 6.130407 69366.7
2025-06-10 02:56:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 02:56:34 INFO     Data : 376
2025-06-10 02:56:34 INFO     Hit1 : 0.031915
2025-06-10 02:56:34 INFO     Hit3 : 0.093085
2025-06-10 02:56:34 INFO     Hit10: 0.183511
2025-06-10 02:56:34 INFO     MR   : 1243.402926
2025-06-10 02:56:34 INFO     MRR  : 0.081293
2025-06-10 02:56:34 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 02:56:44 INFO     Data : 440
2025-06-10 02:56:44 INFO     Hit1 : 0.045455
2025-06-10 02:56:44 INFO     Hit3 : 0.088636
2025-06-10 02:56:44 INFO     Hit10: 0.161364
2025-06-10 02:56:44 INFO     MR   : 1249.904545
2025-06-10 02:56:44 INFO     MRR  : 0.082111
2025-06-10 02:56:44 INFO     -------------------------
2025-06-10 02:56:44 INFO     | Iteration: 3/5
2025-06-10 02:56:44 INFO     -------------------------
2025-06-10 02:56:44 INFO     >>>>> Predictor: Training
2025-06-10 03:00:08 INFO     1000 1231 6.044687 69384.0
2025-06-10 03:00:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:01:03 INFO     Data : 376
2025-06-10 03:01:03 INFO     Hit1 : 0.042553
2025-06-10 03:01:03 INFO     Hit3 : 0.090426
2025-06-10 03:01:03 INFO     Hit10: 0.180851
2025-06-10 03:01:03 INFO     MR   : 1232.053191
2025-06-10 03:01:03 INFO     MRR  : 0.086707
2025-06-10 03:01:03 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:01:12 INFO     Data : 440
2025-06-10 03:01:12 INFO     Hit1 : 0.043182
2025-06-10 03:01:12 INFO     Hit3 : 0.088636
2025-06-10 03:01:12 INFO     Hit10: 0.145455
2025-06-10 03:01:12 INFO     MR   : 1213.347727
2025-06-10 03:01:12 INFO     MRR  : 0.079436
2025-06-10 03:01:12 INFO     -------------------------
2025-06-10 03:01:12 INFO     | Iteration: 4/5
2025-06-10 03:01:12 INFO     -------------------------
2025-06-10 03:01:12 INFO     >>>>> Predictor: Training
2025-06-10 03:04:35 INFO     1000 1231 6.023838 69340.6
2025-06-10 03:05:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:05:29 INFO     Data : 376
2025-06-10 03:05:29 INFO     Hit1 : 0.037234
2025-06-10 03:05:29 INFO     Hit3 : 0.087766
2025-06-10 03:05:29 INFO     Hit10: 0.180851
2025-06-10 03:05:29 INFO     MR   : 1197.160904
2025-06-10 03:05:29 INFO     MRR  : 0.082610
2025-06-10 03:05:29 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:05:39 INFO     Data : 440
2025-06-10 03:05:39 INFO     Hit1 : 0.043182
2025-06-10 03:05:39 INFO     Hit3 : 0.084091
2025-06-10 03:05:39 INFO     Hit10: 0.152273
2025-06-10 03:05:39 INFO     MR   : 1161.448864
2025-06-10 03:05:39 INFO     MRR  : 0.078840
2025-06-10 03:05:39 INFO     -------------------------
2025-06-10 03:05:39 INFO     | Iteration: 5/5
2025-06-10 03:05:39 INFO     -------------------------
2025-06-10 03:05:39 INFO     >>>>> Predictor: Training
2025-06-10 03:09:01 INFO     1000 1231 6.088246 69340.6
2025-06-10 03:09:48 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 03:09:56 INFO     Data : 376
2025-06-10 03:09:56 INFO     Hit1 : 0.037234
2025-06-10 03:09:56 INFO     Hit3 : 0.074468
2025-06-10 03:09:56 INFO     Hit10: 0.167553
2025-06-10 03:09:56 INFO     MR   : 1169.553191
2025-06-10 03:09:56 INFO     MRR  : 0.079288
2025-06-10 03:09:56 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 03:10:05 INFO     Data : 440
2025-06-10 03:10:05 INFO     Hit1 : 0.034091
2025-06-10 03:10:05 INFO     Hit3 : 0.086364
2025-06-10 03:10:05 INFO     Hit10: 0.147727
2025-06-10 03:10:05 INFO     MR   : 1162.893182
2025-06-10 03:10:05 INFO     MRR  : 0.075674
2025-06-10 03:10:05 INFO     -------------------------
2025-06-10 03:10:05 INFO     | Final Test MRR: 0.075324
2025-06-10 03:10:05 INFO     -------------------------
