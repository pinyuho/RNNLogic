2025-06-09 23:20:17 INFO     Data loading | DONE!
2025-06-09 23:20:17 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 23:20:17 INFO     Subset ratio: 0.1
2025-06-09 23:20:17 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 23:20:17 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 23:20:17 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 23:20:17 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 23:20:17 INFO     -------------------------
2025-06-09 23:20:17 INFO     | Pre-train Generator
2025-06-09 23:20:17 INFO     -------------------------
2025-06-09 23:20:17 INFO     >>>>> Generator: Training
2025-06-09 23:20:41 INFO     [E1000] Total: 0.905708 | Main: 1.021854 | Aux: 0.729584
2025-06-09 23:21:04 INFO     [E2000] Total: 0.821170 | Main: 0.916363 | Aux: 0.683855
2025-06-09 23:21:26 INFO     [E3000] Total: 0.818361 | Main: 0.913259 | Aux: 0.681274
2025-06-09 23:21:49 INFO     [E4000] Total: 0.815881 | Main: 0.910056 | Aux: 0.680212
2025-06-09 23:22:11 INFO     [E5000] Total: 0.814540 | Main: 0.908243 | Aux: 0.679396
2025-06-09 23:22:34 INFO     [E6000] Total: 0.813871 | Main: 0.907728 | Aux: 0.678499
2025-06-09 23:22:56 INFO     [E7000] Total: 0.813895 | Main: 0.907958 | Aux: 0.678241
2025-06-09 23:23:19 INFO     [E8000] Total: 0.813112 | Main: 0.907285 | Aux: 0.677801
2025-06-09 23:23:42 INFO     [E9000] Total: 0.812095 | Main: 0.905257 | Aux: 0.677591
2025-06-09 23:24:04 INFO     [E10000] Total: 0.811708 | Main: 0.905420 | Aux: 0.677345
2025-06-09 23:24:04 INFO     -------------------------
2025-06-09 23:24:04 INFO     | EM Iteration: 1/5
2025-06-09 23:24:04 INFO     -------------------------
2025-06-09 23:24:04 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 23:24:05 INFO     Predictor: read 820 rules from list.
2025-06-09 23:24:05 INFO     Preprocess training set
2025-06-09 23:24:05 INFO     >>>>> Predictor: Training
2025-06-09 23:26:24 INFO     1000 1231 8.596195 69297.3
2025-06-09 23:26:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:26:59 INFO     Data : 376
2025-06-09 23:26:59 INFO     Hit1 : 0.015957
2025-06-09 23:26:59 INFO     Hit3 : 0.045213
2025-06-09 23:26:59 INFO     Hit10: 0.093085
2025-06-09 23:26:59 INFO     MR   : 1269.497340
2025-06-09 23:26:59 INFO     MRR  : 0.046458
2025-06-09 23:26:59 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:27:04 INFO     Data : 440
2025-06-09 23:27:04 INFO     Hit1 : 0.036364
2025-06-09 23:27:04 INFO     Hit3 : 0.068182
2025-06-09 23:27:04 INFO     Hit10: 0.129545
2025-06-09 23:27:04 INFO     MR   : 1275.369318
2025-06-09 23:27:04 INFO     MRR  : 0.068721
2025-06-09 23:27:04 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 23:29:48 INFO     1000 1231
2025-06-09 23:30:25 INFO     >>>>> Generator: Training
2025-06-09 23:30:27 INFO     -------------------------
2025-06-09 23:30:27 INFO     | EM Iteration: 2/5
2025-06-09 23:30:27 INFO     -------------------------
2025-06-09 23:30:27 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 23:30:27 INFO     Predictor: read 873 rules from list.
2025-06-09 23:30:27 INFO     Preprocess training set
2025-06-09 23:30:27 INFO     >>>>> Predictor: Training
2025-06-09 23:32:52 INFO     1000 1231 8.623881 69384.0
2025-06-09 23:33:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:33:29 INFO     Data : 376
2025-06-09 23:33:29 INFO     Hit1 : 0.026596
2025-06-09 23:33:29 INFO     Hit3 : 0.053191
2025-06-09 23:33:29 INFO     Hit10: 0.114362
2025-06-09 23:33:29 INFO     MR   : 1243.413564
2025-06-09 23:33:29 INFO     MRR  : 0.056413
2025-06-09 23:33:29 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:33:34 INFO     Data : 440
2025-06-09 23:33:34 INFO     Hit1 : 0.045455
2025-06-09 23:33:34 INFO     Hit3 : 0.081818
2025-06-09 23:33:34 INFO     Hit10: 0.147727
2025-06-09 23:33:34 INFO     MR   : 1240.715909
2025-06-09 23:33:34 INFO     MRR  : 0.080411
2025-06-09 23:33:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 23:36:26 INFO     1000 1231
2025-06-09 23:37:05 INFO     >>>>> Generator: Training
2025-06-09 23:37:07 INFO     -------------------------
2025-06-09 23:37:07 INFO     | EM Iteration: 3/5
2025-06-09 23:37:07 INFO     -------------------------
2025-06-09 23:37:07 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 23:37:08 INFO     Predictor: read 927 rules from list.
2025-06-09 23:37:08 INFO     Preprocess training set
2025-06-09 23:37:08 INFO     >>>>> Predictor: Training
2025-06-09 23:39:40 INFO     1000 1231 8.602063 69340.6
2025-06-09 23:40:15 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:40:19 INFO     Data : 376
2025-06-09 23:40:19 INFO     Hit1 : 0.023936
2025-06-09 23:40:19 INFO     Hit3 : 0.047872
2025-06-09 23:40:19 INFO     Hit10: 0.125000
2025-06-09 23:40:19 INFO     MR   : 1134.228723
2025-06-09 23:40:19 INFO     MRR  : 0.057666
2025-06-09 23:40:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:40:25 INFO     Data : 440
2025-06-09 23:40:25 INFO     Hit1 : 0.054545
2025-06-09 23:40:25 INFO     Hit3 : 0.102273
2025-06-09 23:40:25 INFO     Hit10: 0.163636
2025-06-09 23:40:25 INFO     MR   : 1174.348864
2025-06-09 23:40:25 INFO     MRR  : 0.092404
2025-06-09 23:40:25 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 23:43:22 INFO     1000 1231
2025-06-09 23:44:01 INFO     >>>>> Generator: Training
2025-06-09 23:44:03 INFO     -------------------------
2025-06-09 23:44:03 INFO     | EM Iteration: 4/5
2025-06-09 23:44:03 INFO     -------------------------
2025-06-09 23:44:03 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 23:44:03 INFO     Predictor: read 978 rules from list.
2025-06-09 23:44:03 INFO     Preprocess training set
2025-06-09 23:44:03 INFO     >>>>> Predictor: Training
2025-06-09 23:46:32 INFO     1000 1231 8.601092 69366.7
2025-06-09 23:47:07 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:47:13 INFO     Data : 376
2025-06-09 23:47:13 INFO     Hit1 : 0.023936
2025-06-09 23:47:13 INFO     Hit3 : 0.050532
2025-06-09 23:47:13 INFO     Hit10: 0.117021
2025-06-09 23:47:13 INFO     MR   : 1286.703457
2025-06-09 23:47:13 INFO     MRR  : 0.055356
2025-06-09 23:47:13 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:47:20 INFO     Data : 440
2025-06-09 23:47:20 INFO     Hit1 : 0.043182
2025-06-09 23:47:20 INFO     Hit3 : 0.084091
2025-06-09 23:47:20 INFO     Hit10: 0.143182
2025-06-09 23:47:20 INFO     MR   : 1250.661364
2025-06-09 23:47:20 INFO     MRR  : 0.078683
2025-06-09 23:47:20 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 23:50:17 INFO     1000 1231
2025-06-09 23:51:00 INFO     >>>>> Generator: Training
2025-06-09 23:51:02 INFO     -------------------------
2025-06-09 23:51:02 INFO     | EM Iteration: 5/5
2025-06-09 23:51:02 INFO     -------------------------
2025-06-09 23:51:02 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 23:51:02 INFO     Predictor: read 994 rules from list.
2025-06-09 23:51:02 INFO     Preprocess training set
2025-06-09 23:51:02 INFO     >>>>> Predictor: Training
2025-06-09 23:53:34 INFO     1000 1231 8.607623 69384.0
2025-06-09 23:54:09 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:54:15 INFO     Data : 376
2025-06-09 23:54:15 INFO     Hit1 : 0.031915
2025-06-09 23:54:15 INFO     Hit3 : 0.074468
2025-06-09 23:54:15 INFO     Hit10: 0.138298
2025-06-09 23:54:15 INFO     MR   : 1242.703457
2025-06-09 23:54:15 INFO     MRR  : 0.069235
2025-06-09 23:54:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:54:22 INFO     Data : 440
2025-06-09 23:54:22 INFO     Hit1 : 0.054545
2025-06-09 23:54:22 INFO     Hit3 : 0.095455
2025-06-09 23:54:22 INFO     Hit10: 0.163636
2025-06-09 23:54:22 INFO     MR   : 1179.048864
2025-06-09 23:54:22 INFO     MRR  : 0.090619
2025-06-09 23:54:22 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 23:57:25 INFO     1000 1231
2025-06-09 23:58:10 INFO     >>>>> Generator: Training
2025-06-09 23:58:12 INFO     -------------------------
2025-06-09 23:58:12 INFO     | Post-train Generator
2025-06-09 23:58:12 INFO     -------------------------
2025-06-09 23:58:12 INFO     >>>>> Generator: Training
2025-06-09 23:58:36 INFO     [E1000] Total: 1.057109 | Main: 1.256186 | Aux: 0.699023
2025-06-09 23:58:36 INFO     -------------------------
2025-06-09 23:58:36 INFO     | Beam Search Best Rules
2025-06-09 23:58:36 INFO     -------------------------
2025-06-09 23:58:36 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 23:58:37 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 23:58:43 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 23:59:33 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 00:00:08 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 00:00:33 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 00:00:33 INFO     Subset ratio: 0.1
2025-06-10 00:00:33 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 00:00:33 INFO     -------------------------
2025-06-10 00:00:33 INFO     | Train Final Predictor+
2025-06-10 00:00:33 INFO     -------------------------
2025-06-10 00:00:33 INFO     Predictor+: read 1842 rules from list.
2025-06-10 00:00:33 INFO     Preprocess training set
2025-06-10 00:00:33 INFO     -------------------------
2025-06-10 00:00:33 INFO     | Iteration: 1/5
2025-06-10 00:00:33 INFO     -------------------------
2025-06-10 00:00:33 INFO     >>>>> Predictor: Training
2025-06-10 00:04:22 INFO     1000 1231 6.764737 69305.9
2025-06-10 00:05:15 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 00:05:24 INFO     Data : 376
2025-06-10 00:05:24 INFO     Hit1 : 0.023936
2025-06-10 00:05:24 INFO     Hit3 : 0.055851
2025-06-10 00:05:24 INFO     Hit10: 0.101064
2025-06-10 00:05:24 INFO     MR   : 1369.739362
2025-06-10 00:05:24 INFO     MRR  : 0.050975
2025-06-10 00:05:24 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 00:05:36 INFO     Data : 440
2025-06-10 00:05:36 INFO     Hit1 : 0.015909
2025-06-10 00:05:36 INFO     Hit3 : 0.043182
2025-06-10 00:05:36 INFO     Hit10: 0.095455
2025-06-10 00:05:36 INFO     MR   : 1388.671591
2025-06-10 00:05:36 INFO     MRR  : 0.042918
2025-06-10 00:05:36 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/adaptive/predictor.pt
2025-06-10 00:05:36 INFO     -------------------------
2025-06-10 00:05:36 INFO     | Iteration: 2/5
2025-06-10 00:05:36 INFO     -------------------------
2025-06-10 00:05:36 INFO     >>>>> Predictor: Training
2025-06-10 00:09:27 INFO     1000 1231 6.552119 69366.7
2025-06-10 00:10:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 00:10:30 INFO     Data : 376
2025-06-10 00:10:30 INFO     Hit1 : 0.023936
2025-06-10 00:10:30 INFO     Hit3 : 0.053191
2025-06-10 00:10:30 INFO     Hit10: 0.101064
2025-06-10 00:10:30 INFO     MR   : 1268.071809
2025-06-10 00:10:30 INFO     MRR  : 0.054385
2025-06-10 00:10:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 00:10:41 INFO     Data : 440
2025-06-10 00:10:41 INFO     Hit1 : 0.027273
2025-06-10 00:10:41 INFO     Hit3 : 0.047727
2025-06-10 00:10:41 INFO     Hit10: 0.104545
2025-06-10 00:10:41 INFO     MR   : 1271.388636
2025-06-10 00:10:41 INFO     MRR  : 0.053253
2025-06-10 00:10:41 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/adaptive/predictor.pt
2025-06-10 00:10:41 INFO     -------------------------
2025-06-10 00:10:41 INFO     | Iteration: 3/5
2025-06-10 00:10:41 INFO     -------------------------
2025-06-10 00:10:41 INFO     >>>>> Predictor: Training
2025-06-10 00:14:35 INFO     1000 1231 6.442021 69384.0
2025-06-10 00:15:28 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 00:15:36 INFO     Data : 376
2025-06-10 00:15:36 INFO     Hit1 : 0.021277
2025-06-10 00:15:36 INFO     Hit3 : 0.047872
2025-06-10 00:15:36 INFO     Hit10: 0.111702
2025-06-10 00:15:36 INFO     MR   : 1238.812500
2025-06-10 00:15:36 INFO     MRR  : 0.051190
2025-06-10 00:15:36 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 00:15:48 INFO     Data : 440
2025-06-10 00:15:48 INFO     Hit1 : 0.020455
2025-06-10 00:15:48 INFO     Hit3 : 0.040909
2025-06-10 00:15:48 INFO     Hit10: 0.095455
2025-06-10 00:15:48 INFO     MR   : 1232.522727
2025-06-10 00:15:48 INFO     MRR  : 0.047592
2025-06-10 00:15:48 INFO     -------------------------
2025-06-10 00:15:48 INFO     | Iteration: 4/5
2025-06-10 00:15:48 INFO     -------------------------
2025-06-10 00:15:48 INFO     >>>>> Predictor: Training
2025-06-10 00:19:40 INFO     1000 1231 6.477095 69340.6
2025-06-10 00:20:37 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 00:20:47 INFO     Data : 376
2025-06-10 00:20:47 INFO     Hit1 : 0.023936
2025-06-10 00:20:47 INFO     Hit3 : 0.055851
2025-06-10 00:20:47 INFO     Hit10: 0.114362
2025-06-10 00:20:47 INFO     MR   : 1205.977394
2025-06-10 00:20:47 INFO     MRR  : 0.055817
2025-06-10 00:20:47 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 00:20:58 INFO     Data : 440
2025-06-10 00:20:58 INFO     Hit1 : 0.029545
2025-06-10 00:20:58 INFO     Hit3 : 0.047727
2025-06-10 00:20:58 INFO     Hit10: 0.102273
2025-06-10 00:20:58 INFO     MR   : 1195.587500
2025-06-10 00:20:58 INFO     MRR  : 0.054835
2025-06-10 00:20:58 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/adaptive/predictor.pt
2025-06-10 00:20:58 INFO     -------------------------
2025-06-10 00:20:58 INFO     | Iteration: 5/5
2025-06-10 00:20:58 INFO     -------------------------
2025-06-10 00:20:58 INFO     >>>>> Predictor: Training
2025-06-10 00:24:51 INFO     1000 1231 6.444618 69340.6
2025-06-10 00:25:41 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 00:25:50 INFO     Data : 376
2025-06-10 00:25:50 INFO     Hit1 : 0.013298
2025-06-10 00:25:50 INFO     Hit3 : 0.047872
2025-06-10 00:25:50 INFO     Hit10: 0.127660
2025-06-10 00:25:50 INFO     MR   : 1194.488032
2025-06-10 00:25:50 INFO     MRR  : 0.048795
2025-06-10 00:25:50 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 00:26:00 INFO     Data : 440
2025-06-10 00:26:00 INFO     Hit1 : 0.025000
2025-06-10 00:26:00 INFO     Hit3 : 0.054545
2025-06-10 00:26:00 INFO     Hit10: 0.109091
2025-06-10 00:26:00 INFO     MR   : 1189.628409
2025-06-10 00:26:00 INFO     MRR  : 0.053295
2025-06-10 00:26:00 INFO     -------------------------
2025-06-10 00:26:00 INFO     | Final Test MRR: 0.054835
2025-06-10 00:26:00 INFO     -------------------------
