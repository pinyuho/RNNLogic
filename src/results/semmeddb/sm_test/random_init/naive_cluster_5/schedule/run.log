2025-06-09 22:19:23 INFO     Data loading | DONE!
2025-06-09 22:19:23 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 22:19:23 INFO     Subset ratio: 0.1
2025-06-09 22:19:23 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 22:19:23 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 22:19:23 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 22:19:23 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 22:19:23 INFO     -------------------------
2025-06-09 22:19:23 INFO     | Pre-train Generator
2025-06-09 22:19:23 INFO     -------------------------
2025-06-09 22:19:23 INFO     >>>>> Generator: Training
2025-06-09 22:19:43 INFO     [E1000] Total: 1.009577 | Main: 1.025715 | Aux: 0.992460
2025-06-09 22:20:02 INFO     [E2000] Total: 0.914458 | Main: 0.914458 | Aux: 0.991855
2025-06-09 22:20:21 INFO     [E3000] Total: 0.911746 | Main: 0.911746 | Aux: 0.998612
2025-06-09 22:20:40 INFO     [E4000] Total: 0.908796 | Main: 0.908796 | Aux: 1.006946
2025-06-09 22:20:59 INFO     [E5000] Total: 0.907169 | Main: 0.907169 | Aux: 1.015310
2025-06-09 22:21:18 INFO     [E6000] Total: 0.906618 | Main: 0.906618 | Aux: 1.024010
2025-06-09 22:21:36 INFO     [E7000] Total: 0.906961 | Main: 0.906961 | Aux: 1.032173
2025-06-09 22:21:55 INFO     [E8000] Total: 0.906320 | Main: 0.906320 | Aux: 1.040383
2025-06-09 22:22:14 INFO     [E9000] Total: 0.904300 | Main: 0.904300 | Aux: 1.047824
2025-06-09 22:22:34 INFO     [E10000] Total: 0.904501 | Main: 0.904501 | Aux: 1.057059
2025-06-09 22:22:34 INFO     -------------------------
2025-06-09 22:22:34 INFO     | EM Iteration: 1/5
2025-06-09 22:22:34 INFO     -------------------------
2025-06-09 22:22:34 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 22:22:35 INFO     Predictor: read 809 rules from list.
2025-06-09 22:22:35 INFO     Preprocess training set
2025-06-09 22:22:35 INFO     >>>>> Predictor: Training
2025-06-09 22:24:54 INFO     1000 1231 8.595324 69297.3
2025-06-09 22:25:23 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:25:27 INFO     Data : 376
2025-06-09 22:25:27 INFO     Hit1 : 0.013298
2025-06-09 22:25:27 INFO     Hit3 : 0.045213
2025-06-09 22:25:27 INFO     Hit10: 0.093085
2025-06-09 22:25:27 INFO     MR   : 1277.994681
2025-06-09 22:25:27 INFO     MRR  : 0.045095
2025-06-09 22:25:27 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:25:31 INFO     Data : 440
2025-06-09 22:25:31 INFO     Hit1 : 0.036364
2025-06-09 22:25:31 INFO     Hit3 : 0.065909
2025-06-09 22:25:31 INFO     Hit10: 0.131818
2025-06-09 22:25:31 INFO     MR   : 1274.942045
2025-06-09 22:25:31 INFO     MRR  : 0.068024
2025-06-09 22:25:31 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 22:28:07 INFO     1000 1231
2025-06-09 22:28:42 INFO     >>>>> Generator: Training
2025-06-09 22:28:44 INFO     -------------------------
2025-06-09 22:28:44 INFO     | EM Iteration: 2/5
2025-06-09 22:28:44 INFO     -------------------------
2025-06-09 22:28:44 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 22:28:45 INFO     Predictor: read 843 rules from list.
2025-06-09 22:28:45 INFO     Preprocess training set
2025-06-09 22:28:45 INFO     >>>>> Predictor: Training
2025-06-09 22:31:06 INFO     1000 1231 8.634158 69384.0
2025-06-09 22:31:37 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:31:40 INFO     Data : 376
2025-06-09 22:31:40 INFO     Hit1 : 0.026596
2025-06-09 22:31:40 INFO     Hit3 : 0.055851
2025-06-09 22:31:40 INFO     Hit10: 0.117021
2025-06-09 22:31:40 INFO     MR   : 1235.872340
2025-06-09 22:31:40 INFO     MRR  : 0.056695
2025-06-09 22:31:40 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:31:44 INFO     Data : 440
2025-06-09 22:31:44 INFO     Hit1 : 0.045455
2025-06-09 22:31:44 INFO     Hit3 : 0.081818
2025-06-09 22:31:44 INFO     Hit10: 0.147727
2025-06-09 22:31:44 INFO     MR   : 1238.638636
2025-06-09 22:31:44 INFO     MRR  : 0.079716
2025-06-09 22:31:44 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 22:34:25 INFO     1000 1231
2025-06-09 22:35:01 INFO     >>>>> Generator: Training
2025-06-09 22:35:03 INFO     -------------------------
2025-06-09 22:35:03 INFO     | EM Iteration: 3/5
2025-06-09 22:35:03 INFO     -------------------------
2025-06-09 22:35:03 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 22:35:03 INFO     Predictor: read 900 rules from list.
2025-06-09 22:35:03 INFO     Preprocess training set
2025-06-09 22:35:03 INFO     >>>>> Predictor: Training
2025-06-09 22:37:32 INFO     1000 1231 8.600627 69340.6
2025-06-09 22:38:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:38:08 INFO     Data : 376
2025-06-09 22:38:08 INFO     Hit1 : 0.021277
2025-06-09 22:38:08 INFO     Hit3 : 0.050532
2025-06-09 22:38:08 INFO     Hit10: 0.111702
2025-06-09 22:38:08 INFO     MR   : 1161.566489
2025-06-09 22:38:08 INFO     MRR  : 0.052934
2025-06-09 22:38:08 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:38:13 INFO     Data : 440
2025-06-09 22:38:13 INFO     Hit1 : 0.050000
2025-06-09 22:38:13 INFO     Hit3 : 0.097727
2025-06-09 22:38:13 INFO     Hit10: 0.147727
2025-06-09 22:38:13 INFO     MR   : 1188.952273
2025-06-09 22:38:13 INFO     MRR  : 0.086780
2025-06-09 22:38:13 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 22:41:03 INFO     1000 1231
2025-06-09 22:41:41 INFO     >>>>> Generator: Training
2025-06-09 22:41:43 INFO     -------------------------
2025-06-09 22:41:43 INFO     | EM Iteration: 4/5
2025-06-09 22:41:43 INFO     -------------------------
2025-06-09 22:41:43 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 22:41:43 INFO     Predictor: read 962 rules from list.
2025-06-09 22:41:43 INFO     Preprocess training set
2025-06-09 22:41:43 INFO     >>>>> Predictor: Training
2025-06-09 22:44:10 INFO     1000 1231 8.598917 69366.7
2025-06-09 22:44:45 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:44:50 INFO     Data : 376
2025-06-09 22:44:50 INFO     Hit1 : 0.021277
2025-06-09 22:44:50 INFO     Hit3 : 0.050532
2025-06-09 22:44:50 INFO     Hit10: 0.103723
2025-06-09 22:44:50 INFO     MR   : 1295.236702
2025-06-09 22:44:50 INFO     MRR  : 0.052773
2025-06-09 22:44:50 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:44:56 INFO     Data : 440
2025-06-09 22:44:56 INFO     Hit1 : 0.047727
2025-06-09 22:44:56 INFO     Hit3 : 0.079545
2025-06-09 22:44:56 INFO     Hit10: 0.127273
2025-06-09 22:44:56 INFO     MR   : 1264.338636
2025-06-09 22:44:56 INFO     MRR  : 0.077661
2025-06-09 22:44:56 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 22:47:52 INFO     1000 1231
2025-06-09 22:48:33 INFO     >>>>> Generator: Training
2025-06-09 22:48:35 INFO     -------------------------
2025-06-09 22:48:35 INFO     | EM Iteration: 5/5
2025-06-09 22:48:35 INFO     -------------------------
2025-06-09 22:48:35 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 22:48:35 INFO     Predictor: read 985 rules from list.
2025-06-09 22:48:35 INFO     Preprocess training set
2025-06-09 22:48:35 INFO     >>>>> Predictor: Training
2025-06-09 22:51:07 INFO     1000 1231 8.605932 69384.0
2025-06-09 22:51:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:51:48 INFO     Data : 376
2025-06-09 22:51:48 INFO     Hit1 : 0.026596
2025-06-09 22:51:48 INFO     Hit3 : 0.071809
2025-06-09 22:51:48 INFO     Hit10: 0.125000
2025-06-09 22:51:48 INFO     MR   : 1251.932181
2025-06-09 22:51:48 INFO     MRR  : 0.063815
2025-06-09 22:51:48 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:51:54 INFO     Data : 440
2025-06-09 22:51:54 INFO     Hit1 : 0.065909
2025-06-09 22:51:54 INFO     Hit3 : 0.093182
2025-06-09 22:51:54 INFO     Hit10: 0.150000
2025-06-09 22:51:54 INFO     MR   : 1185.118182
2025-06-09 22:51:54 INFO     MRR  : 0.096014
2025-06-09 22:51:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 22:55:01 INFO     1000 1231
2025-06-09 22:55:47 INFO     >>>>> Generator: Training
2025-06-09 22:55:49 INFO     -------------------------
2025-06-09 22:55:49 INFO     | Post-train Generator
2025-06-09 22:55:49 INFO     -------------------------
2025-06-09 22:55:49 INFO     >>>>> Generator: Training
2025-06-09 22:56:09 INFO     [E1000] Total: 1.241814 | Main: 1.245268 | Aux: 0.946227
2025-06-09 22:56:09 INFO     -------------------------
2025-06-09 22:56:09 INFO     | Beam Search Best Rules
2025-06-09 22:56:09 INFO     -------------------------
2025-06-09 22:56:09 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 22:56:10 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 22:56:16 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 22:57:01 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 22:57:29 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 22:57:49 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 22:57:49 INFO     Subset ratio: 0.1
2025-06-09 22:57:49 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 22:57:49 INFO     -------------------------
2025-06-09 22:57:49 INFO     | Train Final Predictor+
2025-06-09 22:57:49 INFO     -------------------------
2025-06-09 22:57:49 INFO     Predictor+: read 1842 rules from list.
2025-06-09 22:57:49 INFO     Preprocess training set
2025-06-09 22:57:49 INFO     -------------------------
2025-06-09 22:57:49 INFO     | Iteration: 1/5
2025-06-09 22:57:49 INFO     -------------------------
2025-06-09 22:57:49 INFO     >>>>> Predictor: Training
2025-06-09 23:01:08 INFO     1000 1231 7.273425 69305.9
2025-06-09 23:01:54 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:02:03 INFO     Data : 376
2025-06-09 23:02:03 INFO     Hit1 : 0.002660
2025-06-09 23:02:03 INFO     Hit3 : 0.039894
2025-06-09 23:02:03 INFO     Hit10: 0.098404
2025-06-09 23:02:03 INFO     MR   : 1360.595745
2025-06-09 23:02:03 INFO     MRR  : 0.037512
2025-06-09 23:02:03 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:02:12 INFO     Data : 440
2025-06-09 23:02:12 INFO     Hit1 : 0.025000
2025-06-09 23:02:12 INFO     Hit3 : 0.065909
2025-06-09 23:02:12 INFO     Hit10: 0.104545
2025-06-09 23:02:12 INFO     MR   : 1362.445455
2025-06-09 23:02:12 INFO     MRR  : 0.056925
2025-06-09 23:02:12 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/schedule/predictor.pt
2025-06-09 23:02:12 INFO     -------------------------
2025-06-09 23:02:12 INFO     | Iteration: 2/5
2025-06-09 23:02:12 INFO     -------------------------
2025-06-09 23:02:12 INFO     >>>>> Predictor: Training
2025-06-09 23:05:30 INFO     1000 1231 6.965267 69366.7
2025-06-09 23:06:15 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:06:23 INFO     Data : 376
2025-06-09 23:06:23 INFO     Hit1 : 0.013298
2025-06-09 23:06:23 INFO     Hit3 : 0.039894
2025-06-09 23:06:23 INFO     Hit10: 0.098404
2025-06-09 23:06:23 INFO     MR   : 1267.918883
2025-06-09 23:06:23 INFO     MRR  : 0.042670
2025-06-09 23:06:23 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:06:32 INFO     Data : 440
2025-06-09 23:06:32 INFO     Hit1 : 0.018182
2025-06-09 23:06:32 INFO     Hit3 : 0.050000
2025-06-09 23:06:32 INFO     Hit10: 0.111364
2025-06-09 23:06:32 INFO     MR   : 1267.480682
2025-06-09 23:06:32 INFO     MRR  : 0.050575
2025-06-09 23:06:32 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/schedule/predictor.pt
2025-06-09 23:06:32 INFO     -------------------------
2025-06-09 23:06:32 INFO     | Iteration: 3/5
2025-06-09 23:06:32 INFO     -------------------------
2025-06-09 23:06:32 INFO     >>>>> Predictor: Training
2025-06-09 23:09:52 INFO     1000 1231 6.897940 69384.0
2025-06-09 23:10:38 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:10:47 INFO     Data : 376
2025-06-09 23:10:47 INFO     Hit1 : 0.005319
2025-06-09 23:10:47 INFO     Hit3 : 0.031915
2025-06-09 23:10:47 INFO     Hit10: 0.093085
2025-06-09 23:10:47 INFO     MR   : 1239.632979
2025-06-09 23:10:47 INFO     MRR  : 0.037102
2025-06-09 23:10:47 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:10:57 INFO     Data : 440
2025-06-09 23:10:57 INFO     Hit1 : 0.015909
2025-06-09 23:10:57 INFO     Hit3 : 0.056818
2025-06-09 23:10:57 INFO     Hit10: 0.113636
2025-06-09 23:10:57 INFO     MR   : 1251.153409
2025-06-09 23:10:57 INFO     MRR  : 0.052554
2025-06-09 23:10:57 INFO     -------------------------
2025-06-09 23:10:57 INFO     | Iteration: 4/5
2025-06-09 23:10:57 INFO     -------------------------
2025-06-09 23:10:57 INFO     >>>>> Predictor: Training
2025-06-09 23:14:23 INFO     1000 1231 6.858054 69340.6
2025-06-09 23:15:13 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:15:21 INFO     Data : 376
2025-06-09 23:15:21 INFO     Hit1 : 0.010638
2025-06-09 23:15:21 INFO     Hit3 : 0.023936
2025-06-09 23:15:21 INFO     Hit10: 0.103723
2025-06-09 23:15:21 INFO     MR   : 1212.444149
2025-06-09 23:15:21 INFO     MRR  : 0.039077
2025-06-09 23:15:21 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:15:31 INFO     Data : 440
2025-06-09 23:15:31 INFO     Hit1 : 0.015909
2025-06-09 23:15:31 INFO     Hit3 : 0.052273
2025-06-09 23:15:31 INFO     Hit10: 0.106818
2025-06-09 23:15:31 INFO     MR   : 1209.144318
2025-06-09 23:15:31 INFO     MRR  : 0.048241
2025-06-09 23:15:31 INFO     -------------------------
2025-06-09 23:15:31 INFO     | Iteration: 5/5
2025-06-09 23:15:31 INFO     -------------------------
2025-06-09 23:15:31 INFO     >>>>> Predictor: Training
2025-06-09 23:19:06 INFO     1000 1231 6.901642 69340.6
2025-06-09 23:19:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 23:20:04 INFO     Data : 376
2025-06-09 23:20:04 INFO     Hit1 : 0.010638
2025-06-09 23:20:04 INFO     Hit3 : 0.029255
2025-06-09 23:20:04 INFO     Hit10: 0.082447
2025-06-09 23:20:04 INFO     MR   : 1199.394947
2025-06-09 23:20:04 INFO     MRR  : 0.037679
2025-06-09 23:20:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 23:20:14 INFO     Data : 440
2025-06-09 23:20:14 INFO     Hit1 : 0.018182
2025-06-09 23:20:14 INFO     Hit3 : 0.054545
2025-06-09 23:20:14 INFO     Hit10: 0.109091
2025-06-09 23:20:14 INFO     MR   : 1205.736364
2025-06-09 23:20:14 INFO     MRR  : 0.050429
2025-06-09 23:20:14 INFO     -------------------------
2025-06-09 23:20:14 INFO     | Final Test MRR: 0.050575
2025-06-09 23:20:14 INFO     -------------------------
