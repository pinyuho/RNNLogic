2025-06-09 21:19:46 INFO     Data loading | DONE!
2025-06-09 21:19:46 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 21:19:46 INFO     Subset ratio: 0.1
2025-06-09 21:19:46 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 21:19:46 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 21:19:46 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 21:19:46 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 21:19:46 INFO     -------------------------
2025-06-09 21:19:46 INFO     | Pre-train Generator
2025-06-09 21:19:46 INFO     -------------------------
2025-06-09 21:19:46 INFO     >>>>> Generator: Training
2025-06-09 21:20:06 INFO     [E1000] Total: 1.005541 | Main: 1.016605 | Aux: 0.785300
2025-06-09 21:20:25 INFO     [E2000] Total: 0.903601 | Main: 0.914766 | Aux: 0.691458
2025-06-09 21:20:44 INFO     [E3000] Total: 0.900576 | Main: 0.911974 | Aux: 0.684019
2025-06-09 21:21:03 INFO     [E4000] Total: 0.897541 | Main: 0.908887 | Aux: 0.681959
2025-06-09 21:21:22 INFO     [E5000] Total: 0.895909 | Main: 0.907233 | Aux: 0.680743
2025-06-09 21:21:40 INFO     [E6000] Total: 0.895333 | Main: 0.906681 | Aux: 0.679721
2025-06-09 21:21:59 INFO     [E7000] Total: 0.895598 | Main: 0.906966 | Aux: 0.679609
2025-06-09 21:22:18 INFO     [E8000] Total: 0.894966 | Main: 0.906337 | Aux: 0.678912
2025-06-09 21:22:37 INFO     [E9000] Total: 0.892947 | Main: 0.904239 | Aux: 0.678392
2025-06-09 21:22:56 INFO     [E10000] Total: 0.893214 | Main: 0.904526 | Aux: 0.678300
2025-06-09 21:22:56 INFO     -------------------------
2025-06-09 21:22:56 INFO     | EM Iteration: 1/5
2025-06-09 21:22:56 INFO     -------------------------
2025-06-09 21:22:56 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 21:22:56 INFO     Predictor: read 820 rules from list.
2025-06-09 21:22:56 INFO     Preprocess training set
2025-06-09 21:22:56 INFO     >>>>> Predictor: Training
2025-06-09 21:25:08 INFO     1000 1231 8.592258 69297.3
2025-06-09 21:25:38 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:25:42 INFO     Data : 376
2025-06-09 21:25:42 INFO     Hit1 : 0.013298
2025-06-09 21:25:42 INFO     Hit3 : 0.045213
2025-06-09 21:25:42 INFO     Hit10: 0.093085
2025-06-09 21:25:42 INFO     MR   : 1278.118351
2025-06-09 21:25:42 INFO     MRR  : 0.045110
2025-06-09 21:25:42 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:25:46 INFO     Data : 440
2025-06-09 21:25:46 INFO     Hit1 : 0.036364
2025-06-09 21:25:46 INFO     Hit3 : 0.065909
2025-06-09 21:25:46 INFO     Hit10: 0.131818
2025-06-09 21:25:46 INFO     MR   : 1275.059091
2025-06-09 21:25:46 INFO     MRR  : 0.068039
2025-06-09 21:25:46 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 21:28:20 INFO     1000 1231
2025-06-09 21:28:54 INFO     >>>>> Generator: Training
2025-06-09 21:28:56 INFO     -------------------------
2025-06-09 21:28:56 INFO     | EM Iteration: 2/5
2025-06-09 21:28:56 INFO     -------------------------
2025-06-09 21:28:56 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 21:28:57 INFO     Predictor: read 845 rules from list.
2025-06-09 21:28:57 INFO     Preprocess training set
2025-06-09 21:28:57 INFO     >>>>> Predictor: Training
2025-06-09 21:31:11 INFO     1000 1231 8.626713 69384.0
2025-06-09 21:31:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:31:45 INFO     Data : 376
2025-06-09 21:31:45 INFO     Hit1 : 0.026596
2025-06-09 21:31:45 INFO     Hit3 : 0.055851
2025-06-09 21:31:45 INFO     Hit10: 0.117021
2025-06-09 21:31:45 INFO     MR   : 1237.045213
2025-06-09 21:31:45 INFO     MRR  : 0.057193
2025-06-09 21:31:45 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:31:48 INFO     Data : 440
2025-06-09 21:31:48 INFO     Hit1 : 0.045455
2025-06-09 21:31:48 INFO     Hit3 : 0.081818
2025-06-09 21:31:48 INFO     Hit10: 0.145455
2025-06-09 21:31:48 INFO     MR   : 1239.819318
2025-06-09 21:31:48 INFO     MRR  : 0.079972
2025-06-09 21:31:48 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 21:34:28 INFO     1000 1231
2025-06-09 21:35:04 INFO     >>>>> Generator: Training
2025-06-09 21:35:05 INFO     -------------------------
2025-06-09 21:35:05 INFO     | EM Iteration: 3/5
2025-06-09 21:35:05 INFO     -------------------------
2025-06-09 21:35:05 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 21:35:06 INFO     Predictor: read 916 rules from list.
2025-06-09 21:35:06 INFO     Preprocess training set
2025-06-09 21:35:06 INFO     >>>>> Predictor: Training
2025-06-09 21:37:27 INFO     1000 1231 8.602884 69340.6
2025-06-09 21:37:59 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:38:04 INFO     Data : 376
2025-06-09 21:38:04 INFO     Hit1 : 0.021277
2025-06-09 21:38:04 INFO     Hit3 : 0.042553
2025-06-09 21:38:04 INFO     Hit10: 0.117021
2025-06-09 21:38:04 INFO     MR   : 1155.058511
2025-06-09 21:38:04 INFO     MRR  : 0.051939
2025-06-09 21:38:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:38:08 INFO     Data : 440
2025-06-09 21:38:09 INFO     Hit1 : 0.050000
2025-06-09 21:38:09 INFO     Hit3 : 0.093182
2025-06-09 21:38:09 INFO     Hit10: 0.150000
2025-06-09 21:38:09 INFO     MR   : 1185.073864
2025-06-09 21:38:09 INFO     MRR  : 0.085578
2025-06-09 21:38:09 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 21:40:56 INFO     1000 1231
2025-06-09 21:41:34 INFO     >>>>> Generator: Training
2025-06-09 21:41:36 INFO     -------------------------
2025-06-09 21:41:36 INFO     | EM Iteration: 4/5
2025-06-09 21:41:36 INFO     -------------------------
2025-06-09 21:41:36 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 21:41:36 INFO     Predictor: read 966 rules from list.
2025-06-09 21:41:36 INFO     Preprocess training set
2025-06-09 21:41:36 INFO     >>>>> Predictor: Training
2025-06-09 21:44:12 INFO     1000 1231 8.598906 69366.7
2025-06-09 21:44:46 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:44:52 INFO     Data : 376
2025-06-09 21:44:52 INFO     Hit1 : 0.026596
2025-06-09 21:44:52 INFO     Hit3 : 0.050532
2025-06-09 21:44:52 INFO     Hit10: 0.103723
2025-06-09 21:44:52 INFO     MR   : 1297.787234
2025-06-09 21:44:52 INFO     MRR  : 0.055624
2025-06-09 21:44:52 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:44:58 INFO     Data : 440
2025-06-09 21:44:58 INFO     Hit1 : 0.040909
2025-06-09 21:44:58 INFO     Hit3 : 0.084091
2025-06-09 21:44:58 INFO     Hit10: 0.134091
2025-06-09 21:44:58 INFO     MR   : 1266.461364
2025-06-09 21:44:58 INFO     MRR  : 0.076778
2025-06-09 21:44:58 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 21:47:54 INFO     1000 1231
2025-06-09 21:48:36 INFO     >>>>> Generator: Training
2025-06-09 21:48:38 INFO     -------------------------
2025-06-09 21:48:38 INFO     | EM Iteration: 5/5
2025-06-09 21:48:38 INFO     -------------------------
2025-06-09 21:48:38 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 21:48:39 INFO     Predictor: read 984 rules from list.
2025-06-09 21:48:39 INFO     Preprocess training set
2025-06-09 21:48:39 INFO     >>>>> Predictor: Training
2025-06-09 21:51:08 INFO     1000 1231 8.607422 69384.0
2025-06-09 21:51:43 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:51:48 INFO     Data : 376
2025-06-09 21:51:48 INFO     Hit1 : 0.034574
2025-06-09 21:51:48 INFO     Hit3 : 0.074468
2025-06-09 21:51:48 INFO     Hit10: 0.132979
2025-06-09 21:51:48 INFO     MR   : 1251.706117
2025-06-09 21:51:48 INFO     MRR  : 0.070531
2025-06-09 21:51:48 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:51:54 INFO     Data : 440
2025-06-09 21:51:54 INFO     Hit1 : 0.047727
2025-06-09 21:51:54 INFO     Hit3 : 0.090909
2025-06-09 21:51:54 INFO     Hit10: 0.156818
2025-06-09 21:51:54 INFO     MR   : 1188.122727
2025-06-09 21:51:54 INFO     MRR  : 0.085886
2025-06-09 21:51:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 21:54:53 INFO     1000 1231
2025-06-09 21:55:34 INFO     >>>>> Generator: Training
2025-06-09 21:55:36 INFO     -------------------------
2025-06-09 21:55:36 INFO     | Post-train Generator
2025-06-09 21:55:36 INFO     -------------------------
2025-06-09 21:55:36 INFO     >>>>> Generator: Training
2025-06-09 21:55:55 INFO     [E1000] Total: 1.219990 | Main: 1.245516 | Aux: 0.729036
2025-06-09 21:55:55 INFO     -------------------------
2025-06-09 21:55:55 INFO     | Beam Search Best Rules
2025-06-09 21:55:55 INFO     -------------------------
2025-06-09 21:55:55 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 21:55:56 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 21:56:01 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 21:56:42 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 21:57:11 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 21:57:31 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 21:57:31 INFO     Subset ratio: 0.1
2025-06-09 21:57:31 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 21:57:31 INFO     -------------------------
2025-06-09 21:57:31 INFO     | Train Final Predictor+
2025-06-09 21:57:31 INFO     -------------------------
2025-06-09 21:57:31 INFO     Predictor+: read 1842 rules from list.
2025-06-09 21:57:31 INFO     Preprocess training set
2025-06-09 21:57:31 INFO     -------------------------
2025-06-09 21:57:31 INFO     | Iteration: 1/5
2025-06-09 21:57:31 INFO     -------------------------
2025-06-09 21:57:31 INFO     >>>>> Predictor: Training
2025-06-09 22:00:47 INFO     1000 1231 6.794785 69305.9
2025-06-09 22:01:33 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:01:41 INFO     Data : 376
2025-06-09 22:01:41 INFO     Hit1 : 0.058511
2025-06-09 22:01:41 INFO     Hit3 : 0.111702
2025-06-09 22:01:41 INFO     Hit10: 0.199468
2025-06-09 22:01:41 INFO     MR   : 1215.965426
2025-06-09 22:01:41 INFO     MRR  : 0.106527
2025-06-09 22:01:41 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:01:50 INFO     Data : 440
2025-06-09 22:01:50 INFO     Hit1 : 0.063636
2025-06-09 22:01:50 INFO     Hit3 : 0.125000
2025-06-09 22:01:50 INFO     Hit10: 0.177273
2025-06-09 22:01:50 INFO     MR   : 1131.981818
2025-06-09 22:01:50 INFO     MRR  : 0.108432
2025-06-09 22:01:50 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/warmup/predictor.pt
2025-06-09 22:01:50 INFO     -------------------------
2025-06-09 22:01:50 INFO     | Iteration: 2/5
2025-06-09 22:01:50 INFO     -------------------------
2025-06-09 22:01:50 INFO     >>>>> Predictor: Training
2025-06-09 22:05:07 INFO     1000 1231 6.484639 69366.7
2025-06-09 22:05:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:06:00 INFO     Data : 376
2025-06-09 22:06:00 INFO     Hit1 : 0.042553
2025-06-09 22:06:00 INFO     Hit3 : 0.082447
2025-06-09 22:06:00 INFO     Hit10: 0.199468
2025-06-09 22:06:00 INFO     MR   : 1114.940160
2025-06-09 22:06:00 INFO     MRR  : 0.089775
2025-06-09 22:06:00 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:06:10 INFO     Data : 440
2025-06-09 22:06:10 INFO     Hit1 : 0.050000
2025-06-09 22:06:10 INFO     Hit3 : 0.097727
2025-06-09 22:06:10 INFO     Hit10: 0.179545
2025-06-09 22:06:10 INFO     MR   : 1056.364773
2025-06-09 22:06:10 INFO     MRR  : 0.092420
2025-06-09 22:06:10 INFO     -------------------------
2025-06-09 22:06:10 INFO     | Iteration: 3/5
2025-06-09 22:06:10 INFO     -------------------------
2025-06-09 22:06:10 INFO     >>>>> Predictor: Training
2025-06-09 22:09:29 INFO     1000 1231 6.422803 69384.0
2025-06-09 22:10:15 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:10:23 INFO     Data : 376
2025-06-09 22:10:23 INFO     Hit1 : 0.050532
2025-06-09 22:10:23 INFO     Hit3 : 0.101064
2025-06-09 22:10:23 INFO     Hit10: 0.191489
2025-06-09 22:10:23 INFO     MR   : 1086.396277
2025-06-09 22:10:23 INFO     MRR  : 0.096970
2025-06-09 22:10:23 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:10:32 INFO     Data : 440
2025-06-09 22:10:32 INFO     Hit1 : 0.061364
2025-06-09 22:10:32 INFO     Hit3 : 0.111364
2025-06-09 22:10:32 INFO     Hit10: 0.172727
2025-06-09 22:10:32 INFO     MR   : 1039.584091
2025-06-09 22:10:32 INFO     MRR  : 0.103770
2025-06-09 22:10:32 INFO     -------------------------
2025-06-09 22:10:32 INFO     | Iteration: 4/5
2025-06-09 22:10:32 INFO     -------------------------
2025-06-09 22:10:32 INFO     >>>>> Predictor: Training
2025-06-09 22:13:52 INFO     1000 1231 6.437492 69340.6
2025-06-09 22:14:38 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:14:46 INFO     Data : 376
2025-06-09 22:14:46 INFO     Hit1 : 0.039894
2025-06-09 22:14:46 INFO     Hit3 : 0.095745
2025-06-09 22:14:46 INFO     Hit10: 0.202128
2025-06-09 22:14:46 INFO     MR   : 1065.704787
2025-06-09 22:14:46 INFO     MRR  : 0.092478
2025-06-09 22:14:46 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:14:55 INFO     Data : 440
2025-06-09 22:14:55 INFO     Hit1 : 0.052273
2025-06-09 22:14:55 INFO     Hit3 : 0.100000
2025-06-09 22:14:55 INFO     Hit10: 0.193182
2025-06-09 22:14:55 INFO     MR   : 1005.461364
2025-06-09 22:14:55 INFO     MRR  : 0.095218
2025-06-09 22:14:55 INFO     -------------------------
2025-06-09 22:14:55 INFO     | Iteration: 5/5
2025-06-09 22:14:55 INFO     -------------------------
2025-06-09 22:14:55 INFO     >>>>> Predictor: Training
2025-06-09 22:18:17 INFO     1000 1231 6.389941 69340.6
2025-06-09 22:19:03 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 22:19:11 INFO     Data : 376
2025-06-09 22:19:11 INFO     Hit1 : 0.050532
2025-06-09 22:19:11 INFO     Hit3 : 0.114362
2025-06-09 22:19:11 INFO     Hit10: 0.196809
2025-06-09 22:19:11 INFO     MR   : 1044.613032
2025-06-09 22:19:11 INFO     MRR  : 0.102953
2025-06-09 22:19:11 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 22:19:20 INFO     Data : 440
2025-06-09 22:19:20 INFO     Hit1 : 0.052273
2025-06-09 22:19:20 INFO     Hit3 : 0.104545
2025-06-09 22:19:20 INFO     Hit10: 0.188636
2025-06-09 22:19:20 INFO     MR   : 989.419318
2025-06-09 22:19:20 INFO     MRR  : 0.096697
2025-06-09 22:19:20 INFO     -------------------------
2025-06-09 22:19:20 INFO     | Final Test MRR: 0.108432
2025-06-09 22:19:20 INFO     -------------------------
