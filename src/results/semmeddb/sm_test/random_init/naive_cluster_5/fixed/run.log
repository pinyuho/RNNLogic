2025-06-09 20:19:54 INFO     Data loading | DONE!
2025-06-09 20:19:55 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 20:19:55 INFO     Subset ratio: 0.1
2025-06-09 20:19:55 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 20:19:55 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 20:19:55 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 20:19:55 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 20:19:55 INFO     -------------------------
2025-06-09 20:19:55 INFO     | Pre-train Generator
2025-06-09 20:19:55 INFO     -------------------------
2025-06-09 20:19:55 INFO     >>>>> Generator: Training
2025-06-09 20:20:14 INFO     [E1000] Total: 0.960394 | Main: 1.016529 | Aux: 0.735856
2025-06-09 20:20:33 INFO     [E2000] Total: 0.868666 | Main: 0.914833 | Aux: 0.683995
2025-06-09 20:20:52 INFO     [E3000] Total: 0.865886 | Main: 0.912059 | Aux: 0.681196
2025-06-09 20:21:10 INFO     [E4000] Total: 0.863227 | Main: 0.908994 | Aux: 0.680160
2025-06-09 20:21:29 INFO     [E5000] Total: 0.861757 | Main: 0.907347 | Aux: 0.679397
2025-06-09 20:21:47 INFO     [E6000] Total: 0.861137 | Main: 0.906783 | Aux: 0.678553
2025-06-09 20:22:06 INFO     [E7000] Total: 0.861314 | Main: 0.907045 | Aux: 0.678386
2025-06-09 20:22:25 INFO     [E8000] Total: 0.860787 | Main: 0.906495 | Aux: 0.677955
2025-06-09 20:22:43 INFO     [E9000] Total: 0.858983 | Main: 0.904338 | Aux: 0.677565
2025-06-09 20:23:02 INFO     [E10000] Total: 0.859217 | Main: 0.904665 | Aux: 0.677425
2025-06-09 20:23:02 INFO     -------------------------
2025-06-09 20:23:02 INFO     | EM Iteration: 1/5
2025-06-09 20:23:02 INFO     -------------------------
2025-06-09 20:23:02 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 20:23:02 INFO     Predictor: read 793 rules from list.
2025-06-09 20:23:02 INFO     Preprocess training set
2025-06-09 20:23:02 INFO     >>>>> Predictor: Training
2025-06-09 20:25:11 INFO     1000 1231 8.582380 69297.3
2025-06-09 20:25:40 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 20:25:43 INFO     Data : 376
2025-06-09 20:25:43 INFO     Hit1 : 0.013298
2025-06-09 20:25:43 INFO     Hit3 : 0.045213
2025-06-09 20:25:43 INFO     Hit10: 0.093085
2025-06-09 20:25:43 INFO     MR   : 1274.812500
2025-06-09 20:25:43 INFO     MRR  : 0.045107
2025-06-09 20:25:43 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 20:25:47 INFO     Data : 440
2025-06-09 20:25:47 INFO     Hit1 : 0.036364
2025-06-09 20:25:47 INFO     Hit3 : 0.065909
2025-06-09 20:25:47 INFO     Hit10: 0.131818
2025-06-09 20:25:47 INFO     MR   : 1269.600000
2025-06-09 20:25:47 INFO     MRR  : 0.068299
2025-06-09 20:25:47 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 20:28:20 INFO     1000 1231
2025-06-09 20:28:55 INFO     >>>>> Generator: Training
2025-06-09 20:28:56 INFO     -------------------------
2025-06-09 20:28:56 INFO     | EM Iteration: 2/5
2025-06-09 20:28:56 INFO     -------------------------
2025-06-09 20:28:56 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 20:28:57 INFO     Predictor: read 841 rules from list.
2025-06-09 20:28:57 INFO     Preprocess training set
2025-06-09 20:28:57 INFO     >>>>> Predictor: Training
2025-06-09 20:31:11 INFO     1000 1231 8.625314 69384.0
2025-06-09 20:31:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 20:31:45 INFO     Data : 376
2025-06-09 20:31:45 INFO     Hit1 : 0.029255
2025-06-09 20:31:45 INFO     Hit3 : 0.055851
2025-06-09 20:31:45 INFO     Hit10: 0.111702
2025-06-09 20:31:45 INFO     MR   : 1240.275266
2025-06-09 20:31:45 INFO     MRR  : 0.058029
2025-06-09 20:31:45 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 20:31:49 INFO     Data : 440
2025-06-09 20:31:49 INFO     Hit1 : 0.047727
2025-06-09 20:31:49 INFO     Hit3 : 0.084091
2025-06-09 20:31:49 INFO     Hit10: 0.147727
2025-06-09 20:31:49 INFO     MR   : 1247.412500
2025-06-09 20:31:49 INFO     MRR  : 0.081992
2025-06-09 20:31:49 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 20:34:29 INFO     1000 1231
2025-06-09 20:35:05 INFO     >>>>> Generator: Training
2025-06-09 20:35:07 INFO     -------------------------
2025-06-09 20:35:07 INFO     | EM Iteration: 3/5
2025-06-09 20:35:07 INFO     -------------------------
2025-06-09 20:35:07 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 20:35:07 INFO     Predictor: read 896 rules from list.
2025-06-09 20:35:07 INFO     Preprocess training set
2025-06-09 20:35:07 INFO     >>>>> Predictor: Training
2025-06-09 20:37:29 INFO     1000 1231 8.600980 69340.6
2025-06-09 20:38:01 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 20:38:05 INFO     Data : 376
2025-06-09 20:38:05 INFO     Hit1 : 0.023936
2025-06-09 20:38:05 INFO     Hit3 : 0.050532
2025-06-09 20:38:05 INFO     Hit10: 0.130319
2025-06-09 20:38:05 INFO     MR   : 1133.712766
2025-06-09 20:38:05 INFO     MRR  : 0.058151
2025-06-09 20:38:05 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 20:38:09 INFO     Data : 440
2025-06-09 20:38:09 INFO     Hit1 : 0.054545
2025-06-09 20:38:09 INFO     Hit3 : 0.102273
2025-06-09 20:38:09 INFO     Hit10: 0.163636
2025-06-09 20:38:09 INFO     MR   : 1174.503409
2025-06-09 20:38:09 INFO     MRR  : 0.092381
2025-06-09 20:38:09 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 20:41:00 INFO     1000 1231
2025-06-09 20:41:39 INFO     >>>>> Generator: Training
2025-06-09 20:41:41 INFO     -------------------------
2025-06-09 20:41:41 INFO     | EM Iteration: 4/5
2025-06-09 20:41:41 INFO     -------------------------
2025-06-09 20:41:41 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 20:41:41 INFO     Predictor: read 953 rules from list.
2025-06-09 20:41:41 INFO     Preprocess training set
2025-06-09 20:41:41 INFO     >>>>> Predictor: Training
2025-06-09 20:44:07 INFO     1000 1231 8.602256 69366.7
2025-06-09 20:44:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 20:44:48 INFO     Data : 376
2025-06-09 20:44:48 INFO     Hit1 : 0.023936
2025-06-09 20:44:48 INFO     Hit3 : 0.053191
2025-06-09 20:44:48 INFO     Hit10: 0.111702
2025-06-09 20:44:48 INFO     MR   : 1284.820479
2025-06-09 20:44:48 INFO     MRR  : 0.055854
2025-06-09 20:44:48 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 20:44:54 INFO     Data : 440
2025-06-09 20:44:54 INFO     Hit1 : 0.043182
2025-06-09 20:44:54 INFO     Hit3 : 0.077273
2025-06-09 20:44:54 INFO     Hit10: 0.136364
2025-06-09 20:44:54 INFO     MR   : 1253.151136
2025-06-09 20:44:54 INFO     MRR  : 0.076678
2025-06-09 20:44:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 20:47:49 INFO     1000 1231
2025-06-09 20:48:30 INFO     >>>>> Generator: Training
2025-06-09 20:48:32 INFO     -------------------------
2025-06-09 20:48:32 INFO     | EM Iteration: 5/5
2025-06-09 20:48:32 INFO     -------------------------
2025-06-09 20:48:32 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 20:48:33 INFO     Predictor: read 977 rules from list.
2025-06-09 20:48:33 INFO     Preprocess training set
2025-06-09 20:48:33 INFO     >>>>> Predictor: Training
2025-06-09 20:51:05 INFO     1000 1231 8.606163 69384.0
2025-06-09 20:51:41 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 20:51:47 INFO     Data : 376
2025-06-09 20:51:47 INFO     Hit1 : 0.034574
2025-06-09 20:51:47 INFO     Hit3 : 0.074468
2025-06-09 20:51:47 INFO     Hit10: 0.138298
2025-06-09 20:51:47 INFO     MR   : 1241.597074
2025-06-09 20:51:47 INFO     MRR  : 0.070853
2025-06-09 20:51:47 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 20:51:53 INFO     Data : 440
2025-06-09 20:51:53 INFO     Hit1 : 0.052273
2025-06-09 20:51:53 INFO     Hit3 : 0.095455
2025-06-09 20:51:53 INFO     Hit10: 0.163636
2025-06-09 20:51:53 INFO     MR   : 1181.868182
2025-06-09 20:51:53 INFO     MRR  : 0.089825
2025-06-09 20:51:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 20:54:56 INFO     1000 1231
2025-06-09 20:55:39 INFO     >>>>> Generator: Training
2025-06-09 20:55:41 INFO     -------------------------
2025-06-09 20:55:41 INFO     | Post-train Generator
2025-06-09 20:55:41 INFO     -------------------------
2025-06-09 20:55:41 INFO     >>>>> Generator: Training
2025-06-09 20:56:00 INFO     [E1000] Total: 1.131531 | Main: 1.241337 | Aux: 0.692309
2025-06-09 20:56:00 INFO     -------------------------
2025-06-09 20:56:00 INFO     | Beam Search Best Rules
2025-06-09 20:56:00 INFO     -------------------------
2025-06-09 20:56:00 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 20:56:01 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 20:56:06 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 20:56:46 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 20:57:14 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 20:57:34 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 20:57:34 INFO     Subset ratio: 0.1
2025-06-09 20:57:34 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 20:57:34 INFO     -------------------------
2025-06-09 20:57:34 INFO     | Train Final Predictor+
2025-06-09 20:57:34 INFO     -------------------------
2025-06-09 20:57:34 INFO     Predictor+: read 1842 rules from list.
2025-06-09 20:57:34 INFO     Preprocess training set
2025-06-09 20:57:34 INFO     -------------------------
2025-06-09 20:57:34 INFO     | Iteration: 1/5
2025-06-09 20:57:34 INFO     -------------------------
2025-06-09 20:57:34 INFO     >>>>> Predictor: Training
2025-06-09 21:00:54 INFO     1000 1231 6.959956 69305.9
2025-06-09 21:01:40 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:01:49 INFO     Data : 376
2025-06-09 21:01:49 INFO     Hit1 : 0.045213
2025-06-09 21:01:49 INFO     Hit3 : 0.093085
2025-06-09 21:01:49 INFO     Hit10: 0.164894
2025-06-09 21:01:49 INFO     MR   : 1336.542553
2025-06-09 21:01:49 INFO     MRR  : 0.087463
2025-06-09 21:01:49 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:01:58 INFO     Data : 440
2025-06-09 21:01:58 INFO     Hit1 : 0.038636
2025-06-09 21:01:58 INFO     Hit3 : 0.065909
2025-06-09 21:01:58 INFO     Hit10: 0.134091
2025-06-09 21:01:58 INFO     MR   : 1257.653409
2025-06-09 21:01:58 INFO     MRR  : 0.071734
2025-06-09 21:01:58 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/naive_cluster_5/fixed/predictor.pt
2025-06-09 21:01:58 INFO     -------------------------
2025-06-09 21:01:58 INFO     | Iteration: 2/5
2025-06-09 21:01:58 INFO     -------------------------
2025-06-09 21:01:58 INFO     >>>>> Predictor: Training
2025-06-09 21:05:20 INFO     1000 1231 6.732114 69366.7
2025-06-09 21:06:07 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:06:15 INFO     Data : 376
2025-06-09 21:06:15 INFO     Hit1 : 0.050532
2025-06-09 21:06:15 INFO     Hit3 : 0.077128
2025-06-09 21:06:15 INFO     Hit10: 0.154255
2025-06-09 21:06:15 INFO     MR   : 1235.131649
2025-06-09 21:06:15 INFO     MRR  : 0.084975
2025-06-09 21:06:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:06:24 INFO     Data : 440
2025-06-09 21:06:24 INFO     Hit1 : 0.029545
2025-06-09 21:06:24 INFO     Hit3 : 0.068182
2025-06-09 21:06:24 INFO     Hit10: 0.143182
2025-06-09 21:06:24 INFO     MR   : 1155.392045
2025-06-09 21:06:24 INFO     MRR  : 0.068886
2025-06-09 21:06:24 INFO     -------------------------
2025-06-09 21:06:24 INFO     | Iteration: 3/5
2025-06-09 21:06:24 INFO     -------------------------
2025-06-09 21:06:24 INFO     >>>>> Predictor: Training
2025-06-09 21:09:47 INFO     1000 1231 6.594728 69384.0
2025-06-09 21:10:34 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:10:42 INFO     Data : 376
2025-06-09 21:10:42 INFO     Hit1 : 0.039894
2025-06-09 21:10:42 INFO     Hit3 : 0.079787
2025-06-09 21:10:42 INFO     Hit10: 0.159574
2025-06-09 21:10:42 INFO     MR   : 1203.589096
2025-06-09 21:10:42 INFO     MRR  : 0.081368
2025-06-09 21:10:42 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:10:52 INFO     Data : 440
2025-06-09 21:10:52 INFO     Hit1 : 0.034091
2025-06-09 21:10:52 INFO     Hit3 : 0.063636
2025-06-09 21:10:52 INFO     Hit10: 0.159091
2025-06-09 21:10:52 INFO     MR   : 1116.389773
2025-06-09 21:10:52 INFO     MRR  : 0.072856
2025-06-09 21:10:52 INFO     -------------------------
2025-06-09 21:10:52 INFO     | Iteration: 4/5
2025-06-09 21:10:52 INFO     -------------------------
2025-06-09 21:10:52 INFO     >>>>> Predictor: Training
2025-06-09 21:14:14 INFO     1000 1231 6.607744 69340.6
2025-06-09 21:15:00 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:15:08 INFO     Data : 376
2025-06-09 21:15:08 INFO     Hit1 : 0.031915
2025-06-09 21:15:08 INFO     Hit3 : 0.077128
2025-06-09 21:15:08 INFO     Hit10: 0.154255
2025-06-09 21:15:08 INFO     MR   : 1183.373670
2025-06-09 21:15:08 INFO     MRR  : 0.075039
2025-06-09 21:15:08 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:15:18 INFO     Data : 440
2025-06-09 21:15:18 INFO     Hit1 : 0.029545
2025-06-09 21:15:18 INFO     Hit3 : 0.065909
2025-06-09 21:15:18 INFO     Hit10: 0.145455
2025-06-09 21:15:18 INFO     MR   : 1078.529545
2025-06-09 21:15:18 INFO     MRR  : 0.068666
2025-06-09 21:15:18 INFO     -------------------------
2025-06-09 21:15:18 INFO     | Iteration: 5/5
2025-06-09 21:15:18 INFO     -------------------------
2025-06-09 21:15:18 INFO     >>>>> Predictor: Training
2025-06-09 21:18:39 INFO     1000 1231 6.626519 69340.6
2025-06-09 21:19:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 21:19:34 INFO     Data : 376
2025-06-09 21:19:34 INFO     Hit1 : 0.037234
2025-06-09 21:19:34 INFO     Hit3 : 0.074468
2025-06-09 21:19:34 INFO     Hit10: 0.154255
2025-06-09 21:19:34 INFO     MR   : 1169.247340
2025-06-09 21:19:34 INFO     MRR  : 0.076270
2025-06-09 21:19:34 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 21:19:43 INFO     Data : 440
2025-06-09 21:19:43 INFO     Hit1 : 0.031818
2025-06-09 21:19:43 INFO     Hit3 : 0.072727
2025-06-09 21:19:43 INFO     Hit10: 0.143182
2025-06-09 21:19:43 INFO     MR   : 1066.927273
2025-06-09 21:19:43 INFO     MRR  : 0.071622
2025-06-09 21:19:43 INFO     -------------------------
2025-06-09 21:19:43 INFO     | Final Test MRR: 0.071734
2025-06-09 21:19:43 INFO     -------------------------
