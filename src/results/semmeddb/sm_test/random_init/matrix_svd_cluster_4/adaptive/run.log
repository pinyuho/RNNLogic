2025-06-10 12:42:51 INFO     Data loading | DONE!
2025-06-10 12:42:51 INFO     Using subset datasets for training, validation, and testing.
2025-06-10 12:42:51 INFO     Subset ratio: 0.1
2025-06-10 12:42:51 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-10 12:42:51 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-10 12:42:51 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-10 12:42:51 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-10 12:42:51 INFO     -------------------------
2025-06-10 12:42:51 INFO     | Pre-train Generator
2025-06-10 12:42:51 INFO     -------------------------
2025-06-10 12:42:51 INFO     >>>>> Generator: Training
2025-06-10 12:43:13 INFO     [E1000] Total: 0.899184 | Main: 1.023264 | Aux: 0.705062
2025-06-10 12:43:34 INFO     [E2000] Total: 0.812699 | Main: 0.916641 | Aux: 0.658058
2025-06-10 12:43:55 INFO     [E3000] Total: 0.807258 | Main: 0.909673 | Aux: 0.655454
2025-06-10 12:44:16 INFO     [E4000] Total: 0.806497 | Main: 0.909065 | Aux: 0.654321
2025-06-10 12:44:37 INFO     [E5000] Total: 0.804204 | Main: 0.906295 | Aux: 0.653426
2025-06-10 12:44:59 INFO     [E6000] Total: 0.805997 | Main: 0.908682 | Aux: 0.652922
2025-06-10 12:45:20 INFO     [E7000] Total: 0.804478 | Main: 0.906700 | Aux: 0.652685
2025-06-10 12:45:41 INFO     [E8000] Total: 0.800734 | Main: 0.901851 | Aux: 0.652153
2025-06-10 12:46:02 INFO     [E9000] Total: 0.805403 | Main: 0.907983 | Aux: 0.652211
2025-06-10 12:46:23 INFO     [E10000] Total: 0.803960 | Main: 0.906351 | Aux: 0.651675
2025-06-10 12:46:23 INFO     -------------------------
2025-06-10 12:46:23 INFO     | EM Iteration: 1/5
2025-06-10 12:46:23 INFO     -------------------------
2025-06-10 12:46:23 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 12:46:23 INFO     Predictor: read 819 rules from list.
2025-06-10 12:46:23 INFO     Preprocess training set
2025-06-10 12:46:23 INFO     >>>>> Predictor: Training
2025-06-10 12:48:39 INFO     1000 1231 8.601709 69297.3
2025-06-10 12:49:10 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 12:49:14 INFO     Data : 376
2025-06-10 12:49:14 INFO     Hit1 : 0.021277
2025-06-10 12:49:14 INFO     Hit3 : 0.055851
2025-06-10 12:49:14 INFO     Hit10: 0.106383
2025-06-10 12:49:14 INFO     MR   : 1272.030585
2025-06-10 12:49:14 INFO     MRR  : 0.055132
2025-06-10 12:49:14 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 12:49:19 INFO     Data : 440
2025-06-10 12:49:19 INFO     Hit1 : 0.036364
2025-06-10 12:49:19 INFO     Hit3 : 0.068182
2025-06-10 12:49:19 INFO     Hit10: 0.125000
2025-06-10 12:49:19 INFO     MR   : 1264.979545
2025-06-10 12:49:19 INFO     MRR  : 0.068254
2025-06-10 12:49:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 12:52:01 INFO     1000 1231
2025-06-10 12:52:38 INFO     >>>>> Generator: Training
2025-06-10 12:52:40 INFO     -------------------------
2025-06-10 12:52:40 INFO     | EM Iteration: 2/5
2025-06-10 12:52:40 INFO     -------------------------
2025-06-10 12:52:40 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 12:52:40 INFO     Predictor: read 864 rules from list.
2025-06-10 12:52:40 INFO     Preprocess training set
2025-06-10 12:52:40 INFO     >>>>> Predictor: Training
2025-06-10 12:54:57 INFO     1000 1231 8.633878 69384.0
2025-06-10 12:55:28 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 12:55:33 INFO     Data : 376
2025-06-10 12:55:33 INFO     Hit1 : 0.023936
2025-06-10 12:55:33 INFO     Hit3 : 0.053191
2025-06-10 12:55:33 INFO     Hit10: 0.111702
2025-06-10 12:55:33 INFO     MR   : 1222.481383
2025-06-10 12:55:33 INFO     MRR  : 0.054296
2025-06-10 12:55:33 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 12:55:38 INFO     Data : 440
2025-06-10 12:55:38 INFO     Hit1 : 0.052273
2025-06-10 12:55:38 INFO     Hit3 : 0.084091
2025-06-10 12:55:38 INFO     Hit10: 0.140909
2025-06-10 12:55:38 INFO     MR   : 1240.001136
2025-06-10 12:55:38 INFO     MRR  : 0.083788
2025-06-10 12:55:38 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 12:58:22 INFO     1000 1231
2025-06-10 12:58:59 INFO     >>>>> Generator: Training
2025-06-10 12:59:01 INFO     -------------------------
2025-06-10 12:59:01 INFO     | EM Iteration: 3/5
2025-06-10 12:59:01 INFO     -------------------------
2025-06-10 12:59:01 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 12:59:02 INFO     Predictor: read 938 rules from list.
2025-06-10 12:59:02 INFO     Preprocess training set
2025-06-10 12:59:02 INFO     >>>>> Predictor: Training
2025-06-10 13:01:29 INFO     1000 1231 8.605285 69340.6
2025-06-10 13:02:02 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:02:07 INFO     Data : 376
2025-06-10 13:02:07 INFO     Hit1 : 0.023936
2025-06-10 13:02:07 INFO     Hit3 : 0.055851
2025-06-10 13:02:07 INFO     Hit10: 0.122340
2025-06-10 13:02:07 INFO     MR   : 1128.561170
2025-06-10 13:02:07 INFO     MRR  : 0.058535
2025-06-10 13:02:07 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:02:13 INFO     Data : 440
2025-06-10 13:02:13 INFO     Hit1 : 0.054545
2025-06-10 13:02:13 INFO     Hit3 : 0.095455
2025-06-10 13:02:13 INFO     Hit10: 0.163636
2025-06-10 13:02:13 INFO     MR   : 1170.626136
2025-06-10 13:02:13 INFO     MRR  : 0.091359
2025-06-10 13:02:13 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 13:05:09 INFO     1000 1231
2025-06-10 13:05:49 INFO     >>>>> Generator: Training
2025-06-10 13:05:51 INFO     -------------------------
2025-06-10 13:05:51 INFO     | EM Iteration: 4/5
2025-06-10 13:05:51 INFO     -------------------------
2025-06-10 13:05:51 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 13:05:52 INFO     Predictor: read 977 rules from list.
2025-06-10 13:05:52 INFO     Preprocess training set
2025-06-10 13:05:52 INFO     >>>>> Predictor: Training
2025-06-10 13:08:20 INFO     1000 1231 8.598553 69366.7
2025-06-10 13:08:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:09:01 INFO     Data : 376
2025-06-10 13:09:01 INFO     Hit1 : 0.026596
2025-06-10 13:09:01 INFO     Hit3 : 0.050532
2025-06-10 13:09:01 INFO     Hit10: 0.106383
2025-06-10 13:09:01 INFO     MR   : 1288.101064
2025-06-10 13:09:01 INFO     MRR  : 0.056724
2025-06-10 13:09:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:09:08 INFO     Data : 440
2025-06-10 13:09:08 INFO     Hit1 : 0.043182
2025-06-10 13:09:08 INFO     Hit3 : 0.079545
2025-06-10 13:09:08 INFO     Hit10: 0.131818
2025-06-10 13:09:08 INFO     MR   : 1259.812500
2025-06-10 13:09:08 INFO     MRR  : 0.076761
2025-06-10 13:09:08 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 13:12:06 INFO     1000 1231
2025-06-10 13:12:48 INFO     >>>>> Generator: Training
2025-06-10 13:12:50 INFO     -------------------------
2025-06-10 13:12:50 INFO     | EM Iteration: 5/5
2025-06-10 13:12:50 INFO     -------------------------
2025-06-10 13:12:50 INFO     >>>>> Generator: Rule generation with sampling
2025-06-10 13:12:51 INFO     Predictor: read 1009 rules from list.
2025-06-10 13:12:51 INFO     Preprocess training set
2025-06-10 13:12:51 INFO     >>>>> Predictor: Training
2025-06-10 13:15:23 INFO     1000 1231 8.602996 69384.0
2025-06-10 13:15:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:15:54 INFO     Data : 376
2025-06-10 13:15:54 INFO     Hit1 : 0.023936
2025-06-10 13:15:54 INFO     Hit3 : 0.061170
2025-06-10 13:15:54 INFO     Hit10: 0.117021
2025-06-10 13:15:54 INFO     MR   : 1251.261968
2025-06-10 13:15:54 INFO     MRR  : 0.059475
2025-06-10 13:15:54 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:16:00 INFO     Data : 440
2025-06-10 13:16:00 INFO     Hit1 : 0.043182
2025-06-10 13:16:00 INFO     Hit3 : 0.093182
2025-06-10 13:16:00 INFO     Hit10: 0.140909
2025-06-10 13:16:00 INFO     MR   : 1182.109091
2025-06-10 13:16:00 INFO     MRR  : 0.081062
2025-06-10 13:16:00 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-10 13:18:22 INFO     1000 1231
2025-06-10 13:18:56 INFO     >>>>> Generator: Training
2025-06-10 13:18:57 INFO     -------------------------
2025-06-10 13:18:57 INFO     | Post-train Generator
2025-06-10 13:18:57 INFO     -------------------------
2025-06-10 13:18:57 INFO     >>>>> Generator: Training
2025-06-10 13:19:16 INFO     [E1000] Total: 1.046277 | Main: 1.252057 | Aux: 0.648664
2025-06-10 13:19:16 INFO     -------------------------
2025-06-10 13:19:16 INFO     | Beam Search Best Rules
2025-06-10 13:19:16 INFO     -------------------------
2025-06-10 13:19:16 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 13:19:17 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 13:19:22 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 13:20:03 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 13:20:32 INFO     >>>>> Generator: Rule generation with beam search
2025-06-10 13:20:51 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-10 13:20:51 INFO     Subset ratio: 0.1
2025-06-10 13:20:51 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-10 13:20:51 INFO     -------------------------
2025-06-10 13:20:51 INFO     | Train Final Predictor+
2025-06-10 13:20:51 INFO     -------------------------
2025-06-10 13:20:51 INFO     Predictor+: read 1842 rules from list.
2025-06-10 13:20:51 INFO     Preprocess training set
2025-06-10 13:20:51 INFO     -------------------------
2025-06-10 13:20:51 INFO     | Iteration: 1/5
2025-06-10 13:20:51 INFO     -------------------------
2025-06-10 13:20:51 INFO     >>>>> Predictor: Training
2025-06-10 13:24:05 INFO     1000 1231 6.958812 69305.9
2025-06-10 13:24:49 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:24:57 INFO     Data : 376
2025-06-10 13:24:57 INFO     Hit1 : 0.034574
2025-06-10 13:24:57 INFO     Hit3 : 0.066489
2025-06-10 13:24:57 INFO     Hit10: 0.138298
2025-06-10 13:24:57 INFO     MR   : 1234.759309
2025-06-10 13:24:57 INFO     MRR  : 0.069352
2025-06-10 13:24:57 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:25:07 INFO     Data : 440
2025-06-10 13:25:07 INFO     Hit1 : 0.036364
2025-06-10 13:25:07 INFO     Hit3 : 0.065909
2025-06-10 13:25:07 INFO     Hit10: 0.127273
2025-06-10 13:25:07 INFO     MR   : 1192.285227
2025-06-10 13:25:07 INFO     MRR  : 0.067926
2025-06-10 13:25:07 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/matrix_svd_cluster_4/adaptive/predictor.pt
2025-06-10 13:25:07 INFO     -------------------------
2025-06-10 13:25:07 INFO     | Iteration: 2/5
2025-06-10 13:25:07 INFO     -------------------------
2025-06-10 13:25:07 INFO     >>>>> Predictor: Training
2025-06-10 13:28:21 INFO     1000 1231 6.682572 69366.7
2025-06-10 13:29:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:29:14 INFO     Data : 376
2025-06-10 13:29:14 INFO     Hit1 : 0.021277
2025-06-10 13:29:14 INFO     Hit3 : 0.050532
2025-06-10 13:29:14 INFO     Hit10: 0.138298
2025-06-10 13:29:14 INFO     MR   : 1157.176862
2025-06-10 13:29:14 INFO     MRR  : 0.057655
2025-06-10 13:29:14 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:29:23 INFO     Data : 440
2025-06-10 13:29:23 INFO     Hit1 : 0.034091
2025-06-10 13:29:23 INFO     Hit3 : 0.061364
2025-06-10 13:29:23 INFO     Hit10: 0.122727
2025-06-10 13:29:23 INFO     MR   : 1123.223864
2025-06-10 13:29:23 INFO     MRR  : 0.064118
2025-06-10 13:29:23 INFO     -------------------------
2025-06-10 13:29:23 INFO     | Iteration: 3/5
2025-06-10 13:29:23 INFO     -------------------------
2025-06-10 13:29:23 INFO     >>>>> Predictor: Training
2025-06-10 13:32:39 INFO     1000 1231 6.574923 69384.0
2025-06-10 13:33:24 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:33:32 INFO     Data : 376
2025-06-10 13:33:32 INFO     Hit1 : 0.029255
2025-06-10 13:33:32 INFO     Hit3 : 0.071809
2025-06-10 13:33:32 INFO     Hit10: 0.151596
2025-06-10 13:33:32 INFO     MR   : 1126.273936
2025-06-10 13:33:32 INFO     MRR  : 0.069753
2025-06-10 13:33:32 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:33:41 INFO     Data : 440
2025-06-10 13:33:41 INFO     Hit1 : 0.036364
2025-06-10 13:33:41 INFO     Hit3 : 0.059091
2025-06-10 13:33:41 INFO     Hit10: 0.118182
2025-06-10 13:33:41 INFO     MR   : 1078.456818
2025-06-10 13:33:41 INFO     MRR  : 0.066257
2025-06-10 13:33:41 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/matrix_svd_cluster_4/adaptive/predictor.pt
2025-06-10 13:33:41 INFO     -------------------------
2025-06-10 13:33:41 INFO     | Iteration: 4/5
2025-06-10 13:33:41 INFO     -------------------------
2025-06-10 13:33:41 INFO     >>>>> Predictor: Training
2025-06-10 13:36:57 INFO     1000 1231 6.599736 69340.6
2025-06-10 13:37:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:37:50 INFO     Data : 376
2025-06-10 13:37:50 INFO     Hit1 : 0.034574
2025-06-10 13:37:50 INFO     Hit3 : 0.066489
2025-06-10 13:37:50 INFO     Hit10: 0.146277
2025-06-10 13:37:50 INFO     MR   : 1116.440160
2025-06-10 13:37:50 INFO     MRR  : 0.072393
2025-06-10 13:37:50 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:38:00 INFO     Data : 440
2025-06-10 13:38:00 INFO     Hit1 : 0.031818
2025-06-10 13:38:00 INFO     Hit3 : 0.063636
2025-06-10 13:38:00 INFO     Hit10: 0.118182
2025-06-10 13:38:00 INFO     MR   : 1038.650000
2025-06-10 13:38:00 INFO     MRR  : 0.064172
2025-06-10 13:38:00 INFO     Save checkpoint to results/semmeddb/sm_test/random_init/matrix_svd_cluster_4/adaptive/predictor.pt
2025-06-10 13:38:00 INFO     -------------------------
2025-06-10 13:38:00 INFO     | Iteration: 5/5
2025-06-10 13:38:00 INFO     -------------------------
2025-06-10 13:38:00 INFO     >>>>> Predictor: Training
2025-06-10 13:41:15 INFO     1000 1231 6.592940 69340.6
2025-06-10 13:41:59 INFO     >>>>> Predictor: Evaluating on valid
2025-06-10 13:42:07 INFO     Data : 376
2025-06-10 13:42:07 INFO     Hit1 : 0.023936
2025-06-10 13:42:07 INFO     Hit3 : 0.055851
2025-06-10 13:42:07 INFO     Hit10: 0.148936
2025-06-10 13:42:07 INFO     MR   : 1097.425532
2025-06-10 13:42:07 INFO     MRR  : 0.062512
2025-06-10 13:42:07 INFO     >>>>> Predictor: Evaluating on test
2025-06-10 13:42:17 INFO     Data : 440
2025-06-10 13:42:17 INFO     Hit1 : 0.029545
2025-06-10 13:42:17 INFO     Hit3 : 0.059091
2025-06-10 13:42:17 INFO     Hit10: 0.125000
2025-06-10 13:42:17 INFO     MR   : 1034.469318
2025-06-10 13:42:17 INFO     MRR  : 0.062642
2025-06-10 13:42:17 INFO     -------------------------
2025-06-10 13:42:17 INFO     | Final Test MRR: 0.064172
2025-06-10 13:42:17 INFO     -------------------------
