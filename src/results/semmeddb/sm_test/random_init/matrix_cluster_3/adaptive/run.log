2025-06-09 18:51:18 INFO     Data loading | DONE!
2025-06-09 18:51:18 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 18:51:18 INFO     Subset ratio: 0.1
2025-06-09 18:51:18 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 18:51:18 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 18:51:18 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 18:51:18 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 18:51:18 INFO     -------------------------
2025-06-09 18:51:18 INFO     | Pre-train Generator
2025-06-09 18:51:18 INFO     -------------------------
2025-06-09 18:51:18 INFO     >>>>> Generator: Training
2025-06-09 18:51:25 INFO     [E1000] Total: 0.847743 | Main: 1.019200 | Aux: 0.442493
2025-06-09 18:51:31 INFO     [E2000] Total: 0.758433 | Main: 0.912417 | Aux: 0.382263
2025-06-09 18:51:37 INFO     [E3000] Total: 0.755624 | Main: 0.909131 | Aux: 0.379189
2025-06-09 18:51:43 INFO     [E4000] Total: 0.755037 | Main: 0.908316 | Aux: 0.377580
2025-06-09 18:51:49 INFO     [E5000] Total: 0.754104 | Main: 0.907355 | Aux: 0.377043
2025-06-09 18:51:55 INFO     [E6000] Total: 0.752338 | Main: 0.905141 | Aux: 0.376065
2025-06-09 18:52:01 INFO     [E7000] Total: 0.752397 | Main: 0.905255 | Aux: 0.376024
2025-06-09 18:52:06 INFO     [E8000] Total: 0.752822 | Main: 0.905559 | Aux: 0.376020
2025-06-09 18:52:12 INFO     [E9000] Total: 0.753466 | Main: 0.906340 | Aux: 0.375614
2025-06-09 18:52:18 INFO     [E10000] Total: 0.751133 | Main: 0.903563 | Aux: 0.374947
2025-06-09 18:52:18 INFO     -------------------------
2025-06-09 18:52:18 INFO     | EM Iteration: 1/5
2025-06-09 18:52:18 INFO     -------------------------
2025-06-09 18:52:18 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:52:19 INFO     Predictor: read 823 rules from list.
2025-06-09 18:52:19 INFO     Preprocess training set
2025-06-09 18:52:19 INFO     >>>>> Predictor: Training
2025-06-09 18:52:50 INFO     1000 1231 8.597370 69297.3
2025-06-09 18:52:57 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:52:58 INFO     Data : 376
2025-06-09 18:52:58 INFO     Hit1 : 0.023936
2025-06-09 18:52:58 INFO     Hit3 : 0.053191
2025-06-09 18:52:58 INFO     Hit10: 0.114362
2025-06-09 18:52:58 INFO     MR   : 1273.208777
2025-06-09 18:52:58 INFO     MRR  : 0.055917
2025-06-09 18:52:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:52:59 INFO     Data : 440
2025-06-09 18:52:59 INFO     Hit1 : 0.038636
2025-06-09 18:52:59 INFO     Hit3 : 0.068182
2025-06-09 18:52:59 INFO     Hit10: 0.125000
2025-06-09 18:52:59 INFO     MR   : 1273.670455
2025-06-09 18:52:59 INFO     MRR  : 0.070573
2025-06-09 18:52:59 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:53:33 INFO     1000 1231
2025-06-09 18:53:41 INFO     >>>>> Generator: Training
2025-06-09 18:53:41 INFO     -------------------------
2025-06-09 18:53:41 INFO     | EM Iteration: 2/5
2025-06-09 18:53:41 INFO     -------------------------
2025-06-09 18:53:41 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:53:41 INFO     Predictor: read 880 rules from list.
2025-06-09 18:53:41 INFO     Preprocess training set
2025-06-09 18:53:41 INFO     >>>>> Predictor: Training
2025-06-09 18:54:13 INFO     1000 1231 8.623261 69384.0
2025-06-09 18:54:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:54:21 INFO     Data : 376
2025-06-09 18:54:21 INFO     Hit1 : 0.023936
2025-06-09 18:54:21 INFO     Hit3 : 0.055851
2025-06-09 18:54:21 INFO     Hit10: 0.111702
2025-06-09 18:54:21 INFO     MR   : 1223.255319
2025-06-09 18:54:21 INFO     MRR  : 0.054706
2025-06-09 18:54:21 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:54:22 INFO     Data : 440
2025-06-09 18:54:22 INFO     Hit1 : 0.050000
2025-06-09 18:54:22 INFO     Hit3 : 0.081818
2025-06-09 18:54:22 INFO     Hit10: 0.138636
2025-06-09 18:54:22 INFO     MR   : 1241.410227
2025-06-09 18:54:22 INFO     MRR  : 0.082003
2025-06-09 18:54:22 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:54:57 INFO     1000 1231
2025-06-09 18:55:05 INFO     >>>>> Generator: Training
2025-06-09 18:55:06 INFO     -------------------------
2025-06-09 18:55:06 INFO     | EM Iteration: 3/5
2025-06-09 18:55:06 INFO     -------------------------
2025-06-09 18:55:06 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:55:06 INFO     Predictor: read 938 rules from list.
2025-06-09 18:55:06 INFO     Preprocess training set
2025-06-09 18:55:06 INFO     >>>>> Predictor: Training
2025-06-09 18:55:40 INFO     1000 1231 8.608943 69340.6
2025-06-09 18:55:47 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:55:49 INFO     Data : 376
2025-06-09 18:55:49 INFO     Hit1 : 0.021277
2025-06-09 18:55:49 INFO     Hit3 : 0.053191
2025-06-09 18:55:49 INFO     Hit10: 0.132979
2025-06-09 18:55:49 INFO     MR   : 1136.353723
2025-06-09 18:55:49 INFO     MRR  : 0.056699
2025-06-09 18:55:49 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:55:50 INFO     Data : 440
2025-06-09 18:55:50 INFO     Hit1 : 0.056818
2025-06-09 18:55:50 INFO     Hit3 : 0.097727
2025-06-09 18:55:50 INFO     Hit10: 0.161364
2025-06-09 18:55:50 INFO     MR   : 1173.878409
2025-06-09 18:55:50 INFO     MRR  : 0.092638
2025-06-09 18:55:50 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:56:28 INFO     1000 1231
2025-06-09 18:56:37 INFO     >>>>> Generator: Training
2025-06-09 18:56:37 INFO     -------------------------
2025-06-09 18:56:37 INFO     | EM Iteration: 4/5
2025-06-09 18:56:37 INFO     -------------------------
2025-06-09 18:56:37 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:56:37 INFO     Predictor: read 961 rules from list.
2025-06-09 18:56:37 INFO     Preprocess training set
2025-06-09 18:56:37 INFO     >>>>> Predictor: Training
2025-06-09 18:57:12 INFO     1000 1231 8.606020 69366.7
2025-06-09 18:57:20 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:57:21 INFO     Data : 376
2025-06-09 18:57:21 INFO     Hit1 : 0.026596
2025-06-09 18:57:21 INFO     Hit3 : 0.053191
2025-06-09 18:57:21 INFO     Hit10: 0.117021
2025-06-09 18:57:21 INFO     MR   : 1294.466755
2025-06-09 18:57:21 INFO     MRR  : 0.058035
2025-06-09 18:57:21 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:57:23 INFO     Data : 440
2025-06-09 18:57:23 INFO     Hit1 : 0.040909
2025-06-09 18:57:23 INFO     Hit3 : 0.081818
2025-06-09 18:57:23 INFO     Hit10: 0.138636
2025-06-09 18:57:23 INFO     MR   : 1264.165909
2025-06-09 18:57:23 INFO     MRR  : 0.076948
2025-06-09 18:57:23 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:58:01 INFO     1000 1231
2025-06-09 18:58:10 INFO     >>>>> Generator: Training
2025-06-09 18:58:10 INFO     -------------------------
2025-06-09 18:58:10 INFO     | EM Iteration: 5/5
2025-06-09 18:58:10 INFO     -------------------------
2025-06-09 18:58:10 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:58:11 INFO     Predictor: read 1013 rules from list.
2025-06-09 18:58:11 INFO     Preprocess training set
2025-06-09 18:58:11 INFO     >>>>> Predictor: Training
2025-06-09 18:58:47 INFO     1000 1231 8.608093 69384.0
2025-06-09 18:58:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:58:56 INFO     Data : 376
2025-06-09 18:58:56 INFO     Hit1 : 0.034574
2025-06-09 18:58:56 INFO     Hit3 : 0.079787
2025-06-09 18:58:56 INFO     Hit10: 0.135638
2025-06-09 18:58:56 INFO     MR   : 1241.695479
2025-06-09 18:58:56 INFO     MRR  : 0.071458
2025-06-09 18:58:56 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:58:58 INFO     Data : 440
2025-06-09 18:58:58 INFO     Hit1 : 0.054545
2025-06-09 18:58:58 INFO     Hit3 : 0.093182
2025-06-09 18:58:58 INFO     Hit10: 0.159091
2025-06-09 18:58:58 INFO     MR   : 1179.200000
2025-06-09 18:58:58 INFO     MRR  : 0.090919
2025-06-09 18:58:58 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:59:37 INFO     1000 1231
2025-06-09 18:59:46 INFO     >>>>> Generator: Training
2025-06-09 18:59:46 INFO     -------------------------
2025-06-09 18:59:46 INFO     | Post-train Generator
2025-06-09 18:59:46 INFO     -------------------------
2025-06-09 18:59:46 INFO     >>>>> Generator: Training
2025-06-09 18:59:52 INFO     [E1000] Total: 1.045166 | Main: 1.260117 | Aux: 0.519386
2025-06-09 18:59:52 INFO     -------------------------
2025-06-09 18:59:52 INFO     | Beam Search Best Rules
2025-06-09 18:59:52 INFO     -------------------------
2025-06-09 18:59:52 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:59:53 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:59:54 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:00:04 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:00:11 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:00:15 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 19:00:15 INFO     Subset ratio: 0.1
2025-06-09 19:00:15 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 19:00:15 INFO     -------------------------
2025-06-09 19:00:15 INFO     | Train Final Predictor+
2025-06-09 19:00:15 INFO     -------------------------
2025-06-09 19:00:15 INFO     Predictor+: read 1842 rules from list.
2025-06-09 19:00:15 INFO     Preprocess training set
2025-06-09 19:00:15 INFO     -------------------------
2025-06-09 19:00:15 INFO     | Iteration: 1/5
2025-06-09 19:00:15 INFO     -------------------------
2025-06-09 19:00:15 INFO     >>>>> Predictor: Training
2025-06-09 19:01:05 INFO     1000 1231 6.923698 69305.9
2025-06-09 19:01:17 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:01:19 INFO     Data : 376
2025-06-09 19:01:19 INFO     Hit1 : 0.031915
2025-06-09 19:01:19 INFO     Hit3 : 0.090426
2025-06-09 19:01:19 INFO     Hit10: 0.180851
2025-06-09 19:01:19 INFO     MR   : 1159.341755
2025-06-09 19:01:19 INFO     MRR  : 0.083192
2025-06-09 19:01:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:01:21 INFO     Data : 440
2025-06-09 19:01:21 INFO     Hit1 : 0.045455
2025-06-09 19:01:21 INFO     Hit3 : 0.093182
2025-06-09 19:01:21 INFO     Hit10: 0.165909
2025-06-09 19:01:21 INFO     MR   : 1134.680682
2025-06-09 19:01:21 INFO     MRR  : 0.089679
2025-06-09 19:01:21 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/adaptive/predictor.pt
2025-06-09 19:01:21 INFO     -------------------------
2025-06-09 19:01:21 INFO     | Iteration: 2/5
2025-06-09 19:01:21 INFO     -------------------------
2025-06-09 19:01:21 INFO     >>>>> Predictor: Training
2025-06-09 19:02:13 INFO     1000 1231 6.710911 69366.7
2025-06-09 19:02:25 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:02:27 INFO     Data : 376
2025-06-09 19:02:27 INFO     Hit1 : 0.026596
2025-06-09 19:02:27 INFO     Hit3 : 0.082447
2025-06-09 19:02:27 INFO     Hit10: 0.178191
2025-06-09 19:02:27 INFO     MR   : 1090.505319
2025-06-09 19:02:27 INFO     MRR  : 0.075133
2025-06-09 19:02:27 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:02:29 INFO     Data : 440
2025-06-09 19:02:29 INFO     Hit1 : 0.045455
2025-06-09 19:02:29 INFO     Hit3 : 0.093182
2025-06-09 19:02:29 INFO     Hit10: 0.181818
2025-06-09 19:02:29 INFO     MR   : 1054.546591
2025-06-09 19:02:29 INFO     MRR  : 0.090698
2025-06-09 19:02:29 INFO     -------------------------
2025-06-09 19:02:29 INFO     | Iteration: 3/5
2025-06-09 19:02:29 INFO     -------------------------
2025-06-09 19:02:29 INFO     >>>>> Predictor: Training
2025-06-09 19:03:20 INFO     1000 1231 6.590101 69384.0
2025-06-09 19:03:32 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:03:34 INFO     Data : 376
2025-06-09 19:03:34 INFO     Hit1 : 0.031915
2025-06-09 19:03:34 INFO     Hit3 : 0.074468
2025-06-09 19:03:34 INFO     Hit10: 0.172872
2025-06-09 19:03:34 INFO     MR   : 1063.428191
2025-06-09 19:03:34 INFO     MRR  : 0.076956
2025-06-09 19:03:34 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:03:36 INFO     Data : 440
2025-06-09 19:03:36 INFO     Hit1 : 0.043182
2025-06-09 19:03:36 INFO     Hit3 : 0.090909
2025-06-09 19:03:36 INFO     Hit10: 0.177273
2025-06-09 19:03:36 INFO     MR   : 1033.657955
2025-06-09 19:03:36 INFO     MRR  : 0.087356
2025-06-09 19:03:36 INFO     -------------------------
2025-06-09 19:03:36 INFO     | Iteration: 4/5
2025-06-09 19:03:36 INFO     -------------------------
2025-06-09 19:03:36 INFO     >>>>> Predictor: Training
2025-06-09 19:04:26 INFO     1000 1231 6.584430 69340.6
2025-06-09 19:04:38 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:04:40 INFO     Data : 376
2025-06-09 19:04:40 INFO     Hit1 : 0.023936
2025-06-09 19:04:40 INFO     Hit3 : 0.071809
2025-06-09 19:04:40 INFO     Hit10: 0.191489
2025-06-09 19:04:40 INFO     MR   : 1060.386968
2025-06-09 19:04:40 INFO     MRR  : 0.076139
2025-06-09 19:04:40 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:04:42 INFO     Data : 440
2025-06-09 19:04:42 INFO     Hit1 : 0.038636
2025-06-09 19:04:42 INFO     Hit3 : 0.084091
2025-06-09 19:04:42 INFO     Hit10: 0.177273
2025-06-09 19:04:42 INFO     MR   : 988.195455
2025-06-09 19:04:42 INFO     MRR  : 0.083740
2025-06-09 19:04:42 INFO     -------------------------
2025-06-09 19:04:42 INFO     | Iteration: 5/5
2025-06-09 19:04:42 INFO     -------------------------
2025-06-09 19:04:42 INFO     >>>>> Predictor: Training
2025-06-09 19:05:32 INFO     1000 1231 6.583382 69340.6
2025-06-09 19:05:43 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:05:45 INFO     Data : 376
2025-06-09 19:05:45 INFO     Hit1 : 0.034574
2025-06-09 19:05:45 INFO     Hit3 : 0.077128
2025-06-09 19:05:45 INFO     Hit10: 0.175532
2025-06-09 19:05:45 INFO     MR   : 1057.914894
2025-06-09 19:05:45 INFO     MRR  : 0.081200
2025-06-09 19:05:45 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:05:47 INFO     Data : 440
2025-06-09 19:05:47 INFO     Hit1 : 0.036364
2025-06-09 19:05:47 INFO     Hit3 : 0.090909
2025-06-09 19:05:47 INFO     Hit10: 0.179545
2025-06-09 19:05:47 INFO     MR   : 993.540909
2025-06-09 19:05:47 INFO     MRR  : 0.083456
2025-06-09 19:05:47 INFO     -------------------------
2025-06-09 19:05:47 INFO     | Final Test MRR: 0.089679
2025-06-09 19:05:47 INFO     -------------------------
