2025-06-09 18:36:44 INFO     Data loading | DONE!
2025-06-09 18:36:44 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 18:36:44 INFO     Subset ratio: 0.1
2025-06-09 18:36:44 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 18:36:44 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 18:36:44 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 18:36:44 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 18:36:44 INFO     -------------------------
2025-06-09 18:36:44 INFO     | Pre-train Generator
2025-06-09 18:36:44 INFO     -------------------------
2025-06-09 18:36:44 INFO     >>>>> Generator: Training
2025-06-09 18:36:51 INFO     [E1000] Total: 1.003059 | Main: 1.023637 | Aux: 0.675639
2025-06-09 18:36:57 INFO     [E2000] Total: 0.911831 | Main: 0.911831 | Aux: 0.714072
2025-06-09 18:37:02 INFO     [E3000] Total: 0.908692 | Main: 0.908692 | Aux: 0.729168
2025-06-09 18:37:08 INFO     [E4000] Total: 0.907996 | Main: 0.907996 | Aux: 0.742520
2025-06-09 18:37:14 INFO     [E5000] Total: 0.907115 | Main: 0.907115 | Aux: 0.755855
2025-06-09 18:37:20 INFO     [E6000] Total: 0.904859 | Main: 0.904859 | Aux: 0.767386
2025-06-09 18:37:26 INFO     [E7000] Total: 0.905032 | Main: 0.905032 | Aux: 0.778681
2025-06-09 18:37:31 INFO     [E8000] Total: 0.905199 | Main: 0.905199 | Aux: 0.789463
2025-06-09 18:37:37 INFO     [E9000] Total: 0.906018 | Main: 0.906018 | Aux: 0.799176
2025-06-09 18:37:43 INFO     [E10000] Total: 0.903238 | Main: 0.903238 | Aux: 0.809085
2025-06-09 18:37:43 INFO     -------------------------
2025-06-09 18:37:43 INFO     | EM Iteration: 1/5
2025-06-09 18:37:43 INFO     -------------------------
2025-06-09 18:37:43 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:37:43 INFO     Predictor: read 830 rules from list.
2025-06-09 18:37:43 INFO     Preprocess training set
2025-06-09 18:37:43 INFO     >>>>> Predictor: Training
2025-06-09 18:38:15 INFO     1000 1231 8.593005 69297.3
2025-06-09 18:38:22 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:38:23 INFO     Data : 376
2025-06-09 18:38:23 INFO     Hit1 : 0.023936
2025-06-09 18:38:23 INFO     Hit3 : 0.055851
2025-06-09 18:38:23 INFO     Hit10: 0.111702
2025-06-09 18:38:23 INFO     MR   : 1274.812500
2025-06-09 18:38:23 INFO     MRR  : 0.055946
2025-06-09 18:38:23 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:38:24 INFO     Data : 440
2025-06-09 18:38:24 INFO     Hit1 : 0.036364
2025-06-09 18:38:24 INFO     Hit3 : 0.065909
2025-06-09 18:38:24 INFO     Hit10: 0.125000
2025-06-09 18:38:24 INFO     MR   : 1269.377273
2025-06-09 18:38:24 INFO     MRR  : 0.068635
2025-06-09 18:38:24 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:39:00 INFO     1000 1231
2025-06-09 18:39:07 INFO     >>>>> Generator: Training
2025-06-09 18:39:08 INFO     -------------------------
2025-06-09 18:39:08 INFO     | EM Iteration: 2/5
2025-06-09 18:39:08 INFO     -------------------------
2025-06-09 18:39:08 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:39:08 INFO     Predictor: read 876 rules from list.
2025-06-09 18:39:08 INFO     Preprocess training set
2025-06-09 18:39:08 INFO     >>>>> Predictor: Training
2025-06-09 18:39:40 INFO     1000 1231 8.623144 69384.0
2025-06-09 18:39:47 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:39:48 INFO     Data : 376
2025-06-09 18:39:48 INFO     Hit1 : 0.023936
2025-06-09 18:39:48 INFO     Hit3 : 0.055851
2025-06-09 18:39:48 INFO     Hit10: 0.111702
2025-06-09 18:39:48 INFO     MR   : 1223.276596
2025-06-09 18:39:48 INFO     MRR  : 0.054662
2025-06-09 18:39:48 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:39:49 INFO     Data : 440
2025-06-09 18:39:49 INFO     Hit1 : 0.050000
2025-06-09 18:39:49 INFO     Hit3 : 0.081818
2025-06-09 18:39:49 INFO     Hit10: 0.138636
2025-06-09 18:39:49 INFO     MR   : 1241.436364
2025-06-09 18:39:49 INFO     MRR  : 0.082007
2025-06-09 18:39:49 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:40:26 INFO     1000 1231
2025-06-09 18:40:34 INFO     >>>>> Generator: Training
2025-06-09 18:40:34 INFO     -------------------------
2025-06-09 18:40:34 INFO     | EM Iteration: 3/5
2025-06-09 18:40:34 INFO     -------------------------
2025-06-09 18:40:34 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:40:34 INFO     Predictor: read 910 rules from list.
2025-06-09 18:40:34 INFO     Preprocess training set
2025-06-09 18:40:34 INFO     >>>>> Predictor: Training
2025-06-09 18:41:09 INFO     1000 1231 8.603231 69340.6
2025-06-09 18:41:16 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:41:17 INFO     Data : 376
2025-06-09 18:41:17 INFO     Hit1 : 0.021277
2025-06-09 18:41:17 INFO     Hit3 : 0.039894
2025-06-09 18:41:17 INFO     Hit10: 0.114362
2025-06-09 18:41:17 INFO     MR   : 1155.324468
2025-06-09 18:41:17 INFO     MRR  : 0.051474
2025-06-09 18:41:17 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:41:19 INFO     Data : 440
2025-06-09 18:41:19 INFO     Hit1 : 0.050000
2025-06-09 18:41:19 INFO     Hit3 : 0.088636
2025-06-09 18:41:19 INFO     Hit10: 0.150000
2025-06-09 18:41:19 INFO     MR   : 1185.461364
2025-06-09 18:41:19 INFO     MRR  : 0.084786
2025-06-09 18:41:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:41:56 INFO     1000 1231
2025-06-09 18:42:04 INFO     >>>>> Generator: Training
2025-06-09 18:42:05 INFO     -------------------------
2025-06-09 18:42:05 INFO     | EM Iteration: 4/5
2025-06-09 18:42:05 INFO     -------------------------
2025-06-09 18:42:05 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:42:05 INFO     Predictor: read 959 rules from list.
2025-06-09 18:42:05 INFO     Preprocess training set
2025-06-09 18:42:05 INFO     >>>>> Predictor: Training
2025-06-09 18:42:40 INFO     1000 1231 8.601420 69366.7
2025-06-09 18:42:48 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:42:49 INFO     Data : 376
2025-06-09 18:42:49 INFO     Hit1 : 0.023936
2025-06-09 18:42:49 INFO     Hit3 : 0.047872
2025-06-09 18:42:49 INFO     Hit10: 0.111702
2025-06-09 18:42:49 INFO     MR   : 1288.454787
2025-06-09 18:42:49 INFO     MRR  : 0.055296
2025-06-09 18:42:49 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:42:51 INFO     Data : 440
2025-06-09 18:42:51 INFO     Hit1 : 0.043182
2025-06-09 18:42:51 INFO     Hit3 : 0.077273
2025-06-09 18:42:51 INFO     Hit10: 0.131818
2025-06-09 18:42:51 INFO     MR   : 1259.852273
2025-06-09 18:42:51 INFO     MRR  : 0.075720
2025-06-09 18:42:51 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:43:30 INFO     1000 1231
2025-06-09 18:43:39 INFO     >>>>> Generator: Training
2025-06-09 18:43:39 INFO     -------------------------
2025-06-09 18:43:39 INFO     | EM Iteration: 5/5
2025-06-09 18:43:39 INFO     -------------------------
2025-06-09 18:43:39 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 18:43:39 INFO     Predictor: read 1002 rules from list.
2025-06-09 18:43:39 INFO     Preprocess training set
2025-06-09 18:43:39 INFO     >>>>> Predictor: Training
2025-06-09 18:44:15 INFO     1000 1231 8.605041 69384.0
2025-06-09 18:44:23 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:44:24 INFO     Data : 376
2025-06-09 18:44:24 INFO     Hit1 : 0.031915
2025-06-09 18:44:24 INFO     Hit3 : 0.077128
2025-06-09 18:44:24 INFO     Hit10: 0.135638
2025-06-09 18:44:24 INFO     MR   : 1241.623670
2025-06-09 18:44:24 INFO     MRR  : 0.069356
2025-06-09 18:44:24 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:44:26 INFO     Data : 440
2025-06-09 18:44:26 INFO     Hit1 : 0.054545
2025-06-09 18:44:26 INFO     Hit3 : 0.093182
2025-06-09 18:44:26 INFO     Hit10: 0.159091
2025-06-09 18:44:26 INFO     MR   : 1179.104545
2025-06-09 18:44:26 INFO     MRR  : 0.090528
2025-06-09 18:44:26 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 18:45:06 INFO     1000 1231
2025-06-09 18:45:15 INFO     >>>>> Generator: Training
2025-06-09 18:45:16 INFO     -------------------------
2025-06-09 18:45:16 INFO     | Post-train Generator
2025-06-09 18:45:16 INFO     -------------------------
2025-06-09 18:45:16 INFO     >>>>> Generator: Training
2025-06-09 18:45:22 INFO     [E1000] Total: 1.239837 | Main: 1.246409 | Aux: 0.647798
2025-06-09 18:45:22 INFO     -------------------------
2025-06-09 18:45:22 INFO     | Beam Search Best Rules
2025-06-09 18:45:22 INFO     -------------------------
2025-06-09 18:45:22 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:45:22 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:45:23 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:45:33 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:45:41 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 18:45:45 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 18:45:45 INFO     Subset ratio: 0.1
2025-06-09 18:45:45 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 18:45:45 INFO     -------------------------
2025-06-09 18:45:45 INFO     | Train Final Predictor+
2025-06-09 18:45:45 INFO     -------------------------
2025-06-09 18:45:45 INFO     Predictor+: read 1842 rules from list.
2025-06-09 18:45:45 INFO     Preprocess training set
2025-06-09 18:45:45 INFO     -------------------------
2025-06-09 18:45:45 INFO     | Iteration: 1/5
2025-06-09 18:45:45 INFO     -------------------------
2025-06-09 18:45:45 INFO     >>>>> Predictor: Training
2025-06-09 18:46:35 INFO     1000 1231 6.804013 69305.9
2025-06-09 18:46:46 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:46:48 INFO     Data : 376
2025-06-09 18:46:48 INFO     Hit1 : 0.018617
2025-06-09 18:46:48 INFO     Hit3 : 0.037234
2025-06-09 18:46:48 INFO     Hit10: 0.114362
2025-06-09 18:46:48 INFO     MR   : 1346.118351
2025-06-09 18:46:48 INFO     MRR  : 0.051315
2025-06-09 18:46:48 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:46:51 INFO     Data : 440
2025-06-09 18:46:51 INFO     Hit1 : 0.038636
2025-06-09 18:46:51 INFO     Hit3 : 0.075000
2025-06-09 18:46:51 INFO     Hit10: 0.143182
2025-06-09 18:46:51 INFO     MR   : 1216.244318
2025-06-09 18:46:51 INFO     MRR  : 0.072457
2025-06-09 18:46:51 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/schedule/predictor.pt
2025-06-09 18:46:51 INFO     -------------------------
2025-06-09 18:46:51 INFO     | Iteration: 2/5
2025-06-09 18:46:51 INFO     -------------------------
2025-06-09 18:46:51 INFO     >>>>> Predictor: Training
2025-06-09 18:47:40 INFO     1000 1231 6.574035 69366.7
2025-06-09 18:47:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:47:54 INFO     Data : 376
2025-06-09 18:47:54 INFO     Hit1 : 0.018617
2025-06-09 18:47:54 INFO     Hit3 : 0.042553
2025-06-09 18:47:54 INFO     Hit10: 0.098404
2025-06-09 18:47:54 INFO     MR   : 1234.859043
2025-06-09 18:47:54 INFO     MRR  : 0.047882
2025-06-09 18:47:54 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:47:56 INFO     Data : 440
2025-06-09 18:47:56 INFO     Hit1 : 0.036364
2025-06-09 18:47:56 INFO     Hit3 : 0.059091
2025-06-09 18:47:56 INFO     Hit10: 0.122727
2025-06-09 18:47:56 INFO     MR   : 1117.730682
2025-06-09 18:47:56 INFO     MRR  : 0.066623
2025-06-09 18:47:56 INFO     -------------------------
2025-06-09 18:47:56 INFO     | Iteration: 3/5
2025-06-09 18:47:56 INFO     -------------------------
2025-06-09 18:47:56 INFO     >>>>> Predictor: Training
2025-06-09 18:48:46 INFO     1000 1231 6.490423 69384.0
2025-06-09 18:48:58 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:49:00 INFO     Data : 376
2025-06-09 18:49:00 INFO     Hit1 : 0.018617
2025-06-09 18:49:00 INFO     Hit3 : 0.037234
2025-06-09 18:49:00 INFO     Hit10: 0.117021
2025-06-09 18:49:00 INFO     MR   : 1207.385638
2025-06-09 18:49:00 INFO     MRR  : 0.049696
2025-06-09 18:49:00 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:49:02 INFO     Data : 440
2025-06-09 18:49:02 INFO     Hit1 : 0.034091
2025-06-09 18:49:02 INFO     Hit3 : 0.065909
2025-06-09 18:49:02 INFO     Hit10: 0.118182
2025-06-09 18:49:02 INFO     MR   : 1092.373864
2025-06-09 18:49:02 INFO     MRR  : 0.065675
2025-06-09 18:49:02 INFO     -------------------------
2025-06-09 18:49:02 INFO     | Iteration: 4/5
2025-06-09 18:49:02 INFO     -------------------------
2025-06-09 18:49:02 INFO     >>>>> Predictor: Training
2025-06-09 18:49:52 INFO     1000 1231 6.472215 69340.6
2025-06-09 18:50:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:50:06 INFO     Data : 376
2025-06-09 18:50:06 INFO     Hit1 : 0.018617
2025-06-09 18:50:06 INFO     Hit3 : 0.042553
2025-06-09 18:50:06 INFO     Hit10: 0.125000
2025-06-09 18:50:06 INFO     MR   : 1179.817819
2025-06-09 18:50:06 INFO     MRR  : 0.051421
2025-06-09 18:50:06 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:50:08 INFO     Data : 440
2025-06-09 18:50:08 INFO     Hit1 : 0.036364
2025-06-09 18:50:08 INFO     Hit3 : 0.072727
2025-06-09 18:50:08 INFO     Hit10: 0.118182
2025-06-09 18:50:08 INFO     MR   : 1025.779545
2025-06-09 18:50:08 INFO     MRR  : 0.069020
2025-06-09 18:50:08 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/schedule/predictor.pt
2025-06-09 18:50:08 INFO     -------------------------
2025-06-09 18:50:08 INFO     | Iteration: 5/5
2025-06-09 18:50:08 INFO     -------------------------
2025-06-09 18:50:08 INFO     >>>>> Predictor: Training
2025-06-09 18:50:59 INFO     1000 1231 6.484077 69340.6
2025-06-09 18:51:11 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 18:51:13 INFO     Data : 376
2025-06-09 18:51:13 INFO     Hit1 : 0.018617
2025-06-09 18:51:13 INFO     Hit3 : 0.042553
2025-06-09 18:51:13 INFO     Hit10: 0.103723
2025-06-09 18:51:13 INFO     MR   : 1169.400266
2025-06-09 18:51:13 INFO     MRR  : 0.048946
2025-06-09 18:51:13 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 18:51:16 INFO     Data : 440
2025-06-09 18:51:16 INFO     Hit1 : 0.031818
2025-06-09 18:51:16 INFO     Hit3 : 0.056818
2025-06-09 18:51:16 INFO     Hit10: 0.106818
2025-06-09 18:51:16 INFO     MR   : 1016.672727
2025-06-09 18:51:16 INFO     MRR  : 0.061269
2025-06-09 18:51:16 INFO     -------------------------
2025-06-09 18:51:16 INFO     | Final Test MRR: 0.069020
2025-06-09 18:51:16 INFO     -------------------------
