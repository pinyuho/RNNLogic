2025-06-09 19:20:56 INFO     Data loading | DONE!
2025-06-09 19:20:56 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 19:20:56 INFO     Subset ratio: 0.1
2025-06-09 19:20:56 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 19:20:56 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 19:20:56 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 19:20:56 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 19:20:56 INFO     -------------------------
2025-06-09 19:20:56 INFO     | Pre-train Generator
2025-06-09 19:20:56 INFO     -------------------------
2025-06-09 19:20:56 INFO     >>>>> Generator: Training
2025-06-09 19:21:02 INFO     [E1000] Total: 0.894541 | Main: 1.018847 | Aux: 0.397315
2025-06-09 19:21:08 INFO     [E2000] Total: 0.800984 | Main: 0.911823 | Aux: 0.357629
2025-06-09 19:21:14 INFO     [E3000] Total: 0.798072 | Main: 0.908645 | Aux: 0.355781
2025-06-09 19:21:20 INFO     [E4000] Total: 0.797339 | Main: 0.907964 | Aux: 0.354840
2025-06-09 19:21:25 INFO     [E5000] Total: 0.796490 | Main: 0.907018 | Aux: 0.354380
2025-06-09 19:21:31 INFO     [E6000] Total: 0.794649 | Main: 0.904819 | Aux: 0.353971
2025-06-09 19:21:37 INFO     [E7000] Total: 0.794673 | Main: 0.904931 | Aux: 0.353639
2025-06-09 19:21:43 INFO     [E8000] Total: 0.794766 | Main: 0.905106 | Aux: 0.353404
2025-06-09 19:21:48 INFO     [E9000] Total: 0.795345 | Main: 0.905906 | Aux: 0.353100
2025-06-09 19:21:54 INFO     [E10000] Total: 0.793055 | Main: 0.903124 | Aux: 0.352778
2025-06-09 19:21:54 INFO     -------------------------
2025-06-09 19:21:54 INFO     | EM Iteration: 1/5
2025-06-09 19:21:54 INFO     -------------------------
2025-06-09 19:21:54 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:21:54 INFO     Predictor: read 824 rules from list.
2025-06-09 19:21:54 INFO     Preprocess training set
2025-06-09 19:21:54 INFO     >>>>> Predictor: Training
2025-06-09 19:22:27 INFO     1000 1231 8.592826 69297.3
2025-06-09 19:22:34 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:22:35 INFO     Data : 376
2025-06-09 19:22:35 INFO     Hit1 : 0.023936
2025-06-09 19:22:35 INFO     Hit3 : 0.055851
2025-06-09 19:22:35 INFO     Hit10: 0.111702
2025-06-09 19:22:35 INFO     MR   : 1274.555851
2025-06-09 19:22:35 INFO     MRR  : 0.055933
2025-06-09 19:22:35 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:22:36 INFO     Data : 440
2025-06-09 19:22:36 INFO     Hit1 : 0.036364
2025-06-09 19:22:36 INFO     Hit3 : 0.065909
2025-06-09 19:22:36 INFO     Hit10: 0.125000
2025-06-09 19:22:36 INFO     MR   : 1269.575000
2025-06-09 19:22:36 INFO     MRR  : 0.068637
2025-06-09 19:22:36 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:23:11 INFO     1000 1231
2025-06-09 19:23:19 INFO     >>>>> Generator: Training
2025-06-09 19:23:20 INFO     -------------------------
2025-06-09 19:23:20 INFO     | EM Iteration: 2/5
2025-06-09 19:23:20 INFO     -------------------------
2025-06-09 19:23:20 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:23:20 INFO     Predictor: read 868 rules from list.
2025-06-09 19:23:20 INFO     Preprocess training set
2025-06-09 19:23:20 INFO     >>>>> Predictor: Training
2025-06-09 19:23:53 INFO     1000 1231 8.624239 69384.0
2025-06-09 19:24:00 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:24:01 INFO     Data : 376
2025-06-09 19:24:01 INFO     Hit1 : 0.023936
2025-06-09 19:24:01 INFO     Hit3 : 0.055851
2025-06-09 19:24:01 INFO     Hit10: 0.111702
2025-06-09 19:24:01 INFO     MR   : 1223.413564
2025-06-09 19:24:01 INFO     MRR  : 0.054701
2025-06-09 19:24:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:24:02 INFO     Data : 440
2025-06-09 19:24:02 INFO     Hit1 : 0.050000
2025-06-09 19:24:02 INFO     Hit3 : 0.081818
2025-06-09 19:24:02 INFO     Hit10: 0.138636
2025-06-09 19:24:02 INFO     MR   : 1241.610227
2025-06-09 19:24:02 INFO     MRR  : 0.082004
2025-06-09 19:24:02 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:24:38 INFO     1000 1231
2025-06-09 19:24:46 INFO     >>>>> Generator: Training
2025-06-09 19:24:47 INFO     -------------------------
2025-06-09 19:24:47 INFO     | EM Iteration: 3/5
2025-06-09 19:24:47 INFO     -------------------------
2025-06-09 19:24:47 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:24:47 INFO     Predictor: read 924 rules from list.
2025-06-09 19:24:47 INFO     Preprocess training set
2025-06-09 19:24:47 INFO     >>>>> Predictor: Training
2025-06-09 19:25:21 INFO     1000 1231 8.604956 69340.6
2025-06-09 19:25:29 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:25:30 INFO     Data : 376
2025-06-09 19:25:30 INFO     Hit1 : 0.023936
2025-06-09 19:25:30 INFO     Hit3 : 0.047872
2025-06-09 19:25:30 INFO     Hit10: 0.127660
2025-06-09 19:25:30 INFO     MR   : 1134.731383
2025-06-09 19:25:30 INFO     MRR  : 0.057546
2025-06-09 19:25:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:25:32 INFO     Data : 440
2025-06-09 19:25:32 INFO     Hit1 : 0.054545
2025-06-09 19:25:32 INFO     Hit3 : 0.100000
2025-06-09 19:25:32 INFO     Hit10: 0.163636
2025-06-09 19:25:32 INFO     MR   : 1175.044318
2025-06-09 19:25:32 INFO     MRR  : 0.091869
2025-06-09 19:25:32 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:26:09 INFO     1000 1231
2025-06-09 19:26:18 INFO     >>>>> Generator: Training
2025-06-09 19:26:18 INFO     -------------------------
2025-06-09 19:26:18 INFO     | EM Iteration: 4/5
2025-06-09 19:26:18 INFO     -------------------------
2025-06-09 19:26:18 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:26:18 INFO     Predictor: read 965 rules from list.
2025-06-09 19:26:18 INFO     Preprocess training set
2025-06-09 19:26:18 INFO     >>>>> Predictor: Training
2025-06-09 19:26:54 INFO     1000 1231 8.605579 69366.7
2025-06-09 19:27:02 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:27:04 INFO     Data : 376
2025-06-09 19:27:04 INFO     Hit1 : 0.026596
2025-06-09 19:27:04 INFO     Hit3 : 0.047872
2025-06-09 19:27:04 INFO     Hit10: 0.106383
2025-06-09 19:27:04 INFO     MR   : 1288.992021
2025-06-09 19:27:04 INFO     MRR  : 0.056120
2025-06-09 19:27:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:27:05 INFO     Data : 440
2025-06-09 19:27:05 INFO     Hit1 : 0.040909
2025-06-09 19:27:05 INFO     Hit3 : 0.079545
2025-06-09 19:27:05 INFO     Hit10: 0.134091
2025-06-09 19:27:05 INFO     MR   : 1260.111364
2025-06-09 19:27:05 INFO     MRR  : 0.075592
2025-06-09 19:27:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:27:44 INFO     1000 1231
2025-06-09 19:27:53 INFO     >>>>> Generator: Training
2025-06-09 19:27:54 INFO     -------------------------
2025-06-09 19:27:54 INFO     | EM Iteration: 5/5
2025-06-09 19:27:54 INFO     -------------------------
2025-06-09 19:27:54 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:27:54 INFO     Predictor: read 1006 rules from list.
2025-06-09 19:27:54 INFO     Preprocess training set
2025-06-09 19:27:54 INFO     >>>>> Predictor: Training
2025-06-09 19:28:30 INFO     1000 1231 8.612195 69384.0
2025-06-09 19:28:38 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:28:40 INFO     Data : 376
2025-06-09 19:28:40 INFO     Hit1 : 0.034574
2025-06-09 19:28:40 INFO     Hit3 : 0.079787
2025-06-09 19:28:40 INFO     Hit10: 0.132979
2025-06-09 19:28:40 INFO     MR   : 1241.394947
2025-06-09 19:28:40 INFO     MRR  : 0.071320
2025-06-09 19:28:40 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:28:41 INFO     Data : 440
2025-06-09 19:28:41 INFO     Hit1 : 0.054545
2025-06-09 19:28:41 INFO     Hit3 : 0.095455
2025-06-09 19:28:41 INFO     Hit10: 0.159091
2025-06-09 19:28:41 INFO     MR   : 1180.231818
2025-06-09 19:28:41 INFO     MRR  : 0.090755
2025-06-09 19:28:41 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:29:21 INFO     1000 1231
2025-06-09 19:29:30 INFO     >>>>> Generator: Training
2025-06-09 19:29:30 INFO     -------------------------
2025-06-09 19:29:30 INFO     | Post-train Generator
2025-06-09 19:29:30 INFO     -------------------------
2025-06-09 19:29:30 INFO     >>>>> Generator: Training
2025-06-09 19:29:36 INFO     [E1000] Total: 1.053003 | Main: 1.237803 | Aux: 0.313807
2025-06-09 19:29:36 INFO     -------------------------
2025-06-09 19:29:36 INFO     | Beam Search Best Rules
2025-06-09 19:29:36 INFO     -------------------------
2025-06-09 19:29:36 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:29:36 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:29:38 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:29:48 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:29:55 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:29:59 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 19:29:59 INFO     Subset ratio: 0.1
2025-06-09 19:29:59 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 19:29:59 INFO     -------------------------
2025-06-09 19:29:59 INFO     | Train Final Predictor+
2025-06-09 19:29:59 INFO     -------------------------
2025-06-09 19:29:59 INFO     Predictor+: read 1842 rules from list.
2025-06-09 19:29:59 INFO     Preprocess training set
2025-06-09 19:29:59 INFO     -------------------------
2025-06-09 19:29:59 INFO     | Iteration: 1/5
2025-06-09 19:29:59 INFO     -------------------------
2025-06-09 19:29:59 INFO     >>>>> Predictor: Training
2025-06-09 19:30:49 INFO     1000 1231 6.504388 69305.9
2025-06-09 19:31:01 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:31:03 INFO     Data : 376
2025-06-09 19:31:03 INFO     Hit1 : 0.015957
2025-06-09 19:31:03 INFO     Hit3 : 0.039894
2025-06-09 19:31:03 INFO     Hit10: 0.093085
2025-06-09 19:31:03 INFO     MR   : 1595.002660
2025-06-09 19:31:03 INFO     MRR  : 0.043232
2025-06-09 19:31:03 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:31:06 INFO     Data : 440
2025-06-09 19:31:06 INFO     Hit1 : 0.029545
2025-06-09 19:31:06 INFO     Hit3 : 0.043182
2025-06-09 19:31:06 INFO     Hit10: 0.077273
2025-06-09 19:31:06 INFO     MR   : 1552.571591
2025-06-09 19:31:06 INFO     MRR  : 0.047249
2025-06-09 19:31:06 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/fixed/predictor.pt
2025-06-09 19:31:06 INFO     -------------------------
2025-06-09 19:31:06 INFO     | Iteration: 2/5
2025-06-09 19:31:06 INFO     -------------------------
2025-06-09 19:31:06 INFO     >>>>> Predictor: Training
2025-06-09 19:31:56 INFO     1000 1231 6.243333 69366.7
2025-06-09 19:32:07 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:32:09 INFO     Data : 376
2025-06-09 19:32:09 INFO     Hit1 : 0.021277
2025-06-09 19:32:09 INFO     Hit3 : 0.045213
2025-06-09 19:32:09 INFO     Hit10: 0.111702
2025-06-09 19:32:09 INFO     MR   : 1436.445479
2025-06-09 19:32:09 INFO     MRR  : 0.050922
2025-06-09 19:32:09 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:32:12 INFO     Data : 440
2025-06-09 19:32:12 INFO     Hit1 : 0.029545
2025-06-09 19:32:12 INFO     Hit3 : 0.047727
2025-06-09 19:32:12 INFO     Hit10: 0.084091
2025-06-09 19:32:12 INFO     MR   : 1426.898864
2025-06-09 19:32:12 INFO     MRR  : 0.050241
2025-06-09 19:32:12 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/fixed/predictor.pt
2025-06-09 19:32:12 INFO     -------------------------
2025-06-09 19:32:12 INFO     | Iteration: 3/5
2025-06-09 19:32:12 INFO     -------------------------
2025-06-09 19:32:12 INFO     >>>>> Predictor: Training
2025-06-09 19:33:02 INFO     1000 1231 6.222065 69384.0
2025-06-09 19:33:13 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:33:15 INFO     Data : 376
2025-06-09 19:33:15 INFO     Hit1 : 0.023936
2025-06-09 19:33:15 INFO     Hit3 : 0.042553
2025-06-09 19:33:15 INFO     Hit10: 0.114362
2025-06-09 19:33:15 INFO     MR   : 1403.139628
2025-06-09 19:33:15 INFO     MRR  : 0.052042
2025-06-09 19:33:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:33:18 INFO     Data : 440
2025-06-09 19:33:18 INFO     Hit1 : 0.031818
2025-06-09 19:33:18 INFO     Hit3 : 0.052273
2025-06-09 19:33:18 INFO     Hit10: 0.088636
2025-06-09 19:33:18 INFO     MR   : 1390.818182
2025-06-09 19:33:18 INFO     MRR  : 0.052631
2025-06-09 19:33:18 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/fixed/predictor.pt
2025-06-09 19:33:18 INFO     -------------------------
2025-06-09 19:33:18 INFO     | Iteration: 4/5
2025-06-09 19:33:18 INFO     -------------------------
2025-06-09 19:33:18 INFO     >>>>> Predictor: Training
2025-06-09 19:34:08 INFO     1000 1231 6.178672 69340.6
2025-06-09 19:34:20 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:34:22 INFO     Data : 376
2025-06-09 19:34:22 INFO     Hit1 : 0.015957
2025-06-09 19:34:22 INFO     Hit3 : 0.053191
2025-06-09 19:34:22 INFO     Hit10: 0.135638
2025-06-09 19:34:22 INFO     MR   : 1354.509309
2025-06-09 19:34:22 INFO     MRR  : 0.052813
2025-06-09 19:34:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:34:24 INFO     Data : 440
2025-06-09 19:34:24 INFO     Hit1 : 0.025000
2025-06-09 19:34:24 INFO     Hit3 : 0.043182
2025-06-09 19:34:24 INFO     Hit10: 0.090909
2025-06-09 19:34:24 INFO     MR   : 1328.413636
2025-06-09 19:34:24 INFO     MRR  : 0.046101
2025-06-09 19:34:24 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/fixed/predictor.pt
2025-06-09 19:34:24 INFO     -------------------------
2025-06-09 19:34:24 INFO     | Iteration: 5/5
2025-06-09 19:34:24 INFO     -------------------------
2025-06-09 19:34:24 INFO     >>>>> Predictor: Training
2025-06-09 19:35:16 INFO     1000 1231 6.208869 69340.6
2025-06-09 19:35:28 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:35:30 INFO     Data : 376
2025-06-09 19:35:30 INFO     Hit1 : 0.023936
2025-06-09 19:35:30 INFO     Hit3 : 0.055851
2025-06-09 19:35:30 INFO     Hit10: 0.122340
2025-06-09 19:35:30 INFO     MR   : 1345.900266
2025-06-09 19:35:30 INFO     MRR  : 0.054635
2025-06-09 19:35:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:35:32 INFO     Data : 440
2025-06-09 19:35:32 INFO     Hit1 : 0.025000
2025-06-09 19:35:32 INFO     Hit3 : 0.045455
2025-06-09 19:35:32 INFO     Hit10: 0.088636
2025-06-09 19:35:32 INFO     MR   : 1302.195455
2025-06-09 19:35:32 INFO     MRR  : 0.048713
2025-06-09 19:35:32 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/fixed/predictor.pt
2025-06-09 19:35:32 INFO     -------------------------
2025-06-09 19:35:32 INFO     | Final Test MRR: 0.048713
2025-06-09 19:35:32 INFO     -------------------------
