2025-06-09 19:05:50 INFO     Data loading | DONE!
2025-06-09 19:05:50 INFO     Using subset datasets for training, validation, and testing.
2025-06-09 19:05:50 INFO     Subset ratio: 0.1
2025-06-09 19:05:50 INFO     [Subset] TrainDataset: 1231/12313 samples (10%)
2025-06-09 19:05:50 INFO     [Subset] ValidDataset: 47/478 samples (10%)
2025-06-09 19:05:50 INFO     [Subset] TestDataset: 55/551 samples (10%)
2025-06-09 19:05:50 INFO     [Subset] RuleDataset: 1366/13661 samples (10%)
2025-06-09 19:05:50 INFO     -------------------------
2025-06-09 19:05:50 INFO     | Pre-train Generator
2025-06-09 19:05:50 INFO     -------------------------
2025-06-09 19:05:50 INFO     >>>>> Generator: Training
2025-06-09 19:05:57 INFO     [E1000] Total: 0.988853 | Main: 1.017590 | Aux: 0.427011
2025-06-09 19:06:04 INFO     [E2000] Total: 0.884303 | Main: 0.911848 | Aux: 0.360939
2025-06-09 19:06:10 INFO     [E3000] Total: 0.881068 | Main: 0.908640 | Aux: 0.357211
2025-06-09 19:06:16 INFO     [E4000] Total: 0.880306 | Main: 0.907916 | Aux: 0.355721
2025-06-09 19:06:22 INFO     [E5000] Total: 0.879409 | Main: 0.907005 | Aux: 0.355082
2025-06-09 19:06:28 INFO     [E6000] Total: 0.877272 | Main: 0.904794 | Aux: 0.354370
2025-06-09 19:06:34 INFO     [E7000] Total: 0.877399 | Main: 0.904942 | Aux: 0.354070
2025-06-09 19:06:40 INFO     [E8000] Total: 0.877515 | Main: 0.905081 | Aux: 0.353770
2025-06-09 19:06:46 INFO     [E9000] Total: 0.878330 | Main: 0.905955 | Aux: 0.353454
2025-06-09 19:06:52 INFO     [E10000] Total: 0.875596 | Main: 0.903099 | Aux: 0.353044
2025-06-09 19:06:52 INFO     -------------------------
2025-06-09 19:06:52 INFO     | EM Iteration: 1/5
2025-06-09 19:06:52 INFO     -------------------------
2025-06-09 19:06:52 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:06:52 INFO     Predictor: read 826 rules from list.
2025-06-09 19:06:52 INFO     Preprocess training set
2025-06-09 19:06:52 INFO     >>>>> Predictor: Training
2025-06-09 19:07:25 INFO     1000 1231 8.594625 69297.3
2025-06-09 19:07:32 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:07:33 INFO     Data : 376
2025-06-09 19:07:33 INFO     Hit1 : 0.023936
2025-06-09 19:07:33 INFO     Hit3 : 0.055851
2025-06-09 19:07:33 INFO     Hit10: 0.111702
2025-06-09 19:07:33 INFO     MR   : 1273.924202
2025-06-09 19:07:33 INFO     MRR  : 0.055947
2025-06-09 19:07:33 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:07:34 INFO     Data : 440
2025-06-09 19:07:34 INFO     Hit1 : 0.036364
2025-06-09 19:07:34 INFO     Hit3 : 0.065909
2025-06-09 19:07:34 INFO     Hit10: 0.125000
2025-06-09 19:07:34 INFO     MR   : 1269.293182
2025-06-09 19:07:34 INFO     MRR  : 0.068720
2025-06-09 19:07:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:08:10 INFO     1000 1231
2025-06-09 19:08:21 INFO     >>>>> Generator: Training
2025-06-09 19:08:21 INFO     -------------------------
2025-06-09 19:08:21 INFO     | EM Iteration: 2/5
2025-06-09 19:08:21 INFO     -------------------------
2025-06-09 19:08:21 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:08:21 INFO     Predictor: read 860 rules from list.
2025-06-09 19:08:21 INFO     Preprocess training set
2025-06-09 19:08:21 INFO     >>>>> Predictor: Training
2025-06-09 19:08:55 INFO     1000 1231 8.623290 69384.0
2025-06-09 19:09:02 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:09:03 INFO     Data : 376
2025-06-09 19:09:03 INFO     Hit1 : 0.023936
2025-06-09 19:09:03 INFO     Hit3 : 0.055851
2025-06-09 19:09:03 INFO     Hit10: 0.111702
2025-06-09 19:09:03 INFO     MR   : 1223.529255
2025-06-09 19:09:03 INFO     MRR  : 0.054690
2025-06-09 19:09:03 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:09:04 INFO     Data : 440
2025-06-09 19:09:04 INFO     Hit1 : 0.050000
2025-06-09 19:09:04 INFO     Hit3 : 0.081818
2025-06-09 19:09:04 INFO     Hit10: 0.138636
2025-06-09 19:09:04 INFO     MR   : 1241.735227
2025-06-09 19:09:04 INFO     MRR  : 0.082005
2025-06-09 19:09:04 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:09:40 INFO     1000 1231
2025-06-09 19:09:48 INFO     >>>>> Generator: Training
2025-06-09 19:09:49 INFO     -------------------------
2025-06-09 19:09:49 INFO     | EM Iteration: 3/5
2025-06-09 19:09:49 INFO     -------------------------
2025-06-09 19:09:49 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:09:49 INFO     Predictor: read 917 rules from list.
2025-06-09 19:09:49 INFO     Preprocess training set
2025-06-09 19:09:49 INFO     >>>>> Predictor: Training
2025-06-09 19:10:25 INFO     1000 1231 8.603534 69340.6
2025-06-09 19:10:32 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:10:33 INFO     Data : 376
2025-06-09 19:10:33 INFO     Hit1 : 0.023936
2025-06-09 19:10:33 INFO     Hit3 : 0.047872
2025-06-09 19:10:33 INFO     Hit10: 0.125000
2025-06-09 19:10:33 INFO     MR   : 1134.402926
2025-06-09 19:10:33 INFO     MRR  : 0.057924
2025-06-09 19:10:33 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:10:35 INFO     Data : 440
2025-06-09 19:10:35 INFO     Hit1 : 0.054545
2025-06-09 19:10:35 INFO     Hit3 : 0.102273
2025-06-09 19:10:35 INFO     Hit10: 0.163636
2025-06-09 19:10:35 INFO     MR   : 1174.471591
2025-06-09 19:10:35 INFO     MRR  : 0.091978
2025-06-09 19:10:35 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:11:13 INFO     1000 1231
2025-06-09 19:11:21 INFO     >>>>> Generator: Training
2025-06-09 19:11:22 INFO     -------------------------
2025-06-09 19:11:22 INFO     | EM Iteration: 4/5
2025-06-09 19:11:22 INFO     -------------------------
2025-06-09 19:11:22 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:11:22 INFO     Predictor: read 976 rules from list.
2025-06-09 19:11:22 INFO     Preprocess training set
2025-06-09 19:11:22 INFO     >>>>> Predictor: Training
2025-06-09 19:11:57 INFO     1000 1231 8.600094 69366.7
2025-06-09 19:12:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:12:08 INFO     Data : 376
2025-06-09 19:12:08 INFO     Hit1 : 0.023936
2025-06-09 19:12:08 INFO     Hit3 : 0.053191
2025-06-09 19:12:08 INFO     Hit10: 0.117021
2025-06-09 19:12:08 INFO     MR   : 1285.102394
2025-06-09 19:12:08 INFO     MRR  : 0.056154
2025-06-09 19:12:08 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:12:09 INFO     Data : 440
2025-06-09 19:12:09 INFO     Hit1 : 0.045455
2025-06-09 19:12:09 INFO     Hit3 : 0.077273
2025-06-09 19:12:09 INFO     Hit10: 0.136364
2025-06-09 19:12:09 INFO     MR   : 1250.745455
2025-06-09 19:12:09 INFO     MRR  : 0.077525
2025-06-09 19:12:09 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:12:48 INFO     1000 1231
2025-06-09 19:12:58 INFO     >>>>> Generator: Training
2025-06-09 19:12:58 INFO     -------------------------
2025-06-09 19:12:58 INFO     | EM Iteration: 5/5
2025-06-09 19:12:58 INFO     -------------------------
2025-06-09 19:12:58 INFO     >>>>> Generator: Rule generation with sampling
2025-06-09 19:12:58 INFO     Predictor: read 996 rules from list.
2025-06-09 19:12:58 INFO     Preprocess training set
2025-06-09 19:12:58 INFO     >>>>> Predictor: Training
2025-06-09 19:13:34 INFO     1000 1231 8.605782 69384.0
2025-06-09 19:13:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:13:43 INFO     Data : 376
2025-06-09 19:13:43 INFO     Hit1 : 0.031915
2025-06-09 19:13:43 INFO     Hit3 : 0.074468
2025-06-09 19:13:43 INFO     Hit10: 0.132979
2025-06-09 19:13:43 INFO     MR   : 1241.651596
2025-06-09 19:13:43 INFO     MRR  : 0.069028
2025-06-09 19:13:43 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:13:45 INFO     Data : 440
2025-06-09 19:13:45 INFO     Hit1 : 0.054545
2025-06-09 19:13:45 INFO     Hit3 : 0.095455
2025-06-09 19:13:45 INFO     Hit10: 0.159091
2025-06-09 19:13:45 INFO     MR   : 1180.146591
2025-06-09 19:13:45 INFO     MRR  : 0.091020
2025-06-09 19:13:45 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-09 19:14:24 INFO     1000 1231
2025-06-09 19:14:34 INFO     >>>>> Generator: Training
2025-06-09 19:14:34 INFO     -------------------------
2025-06-09 19:14:34 INFO     | Post-train Generator
2025-06-09 19:14:34 INFO     -------------------------
2025-06-09 19:14:34 INFO     >>>>> Generator: Training
2025-06-09 19:14:40 INFO     [E1000] Total: 1.188762 | Main: 1.233554 | Aux: 0.327422
2025-06-09 19:14:40 INFO     -------------------------
2025-06-09 19:14:40 INFO     | Beam Search Best Rules
2025-06-09 19:14:40 INFO     -------------------------
2025-06-09 19:14:40 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:14:40 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:14:42 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:14:52 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:14:58 INFO     >>>>> Generator: Rule generation with beam search
2025-06-09 19:15:03 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-06-09 19:15:03 INFO     Subset ratio: 0.1
2025-06-09 19:15:03 INFO     Subset sizes: train=1231, valid=47, test=55, rule dataset=1842
2025-06-09 19:15:03 INFO     -------------------------
2025-06-09 19:15:03 INFO     | Train Final Predictor+
2025-06-09 19:15:03 INFO     -------------------------
2025-06-09 19:15:03 INFO     Predictor+: read 1842 rules from list.
2025-06-09 19:15:03 INFO     Preprocess training set
2025-06-09 19:15:03 INFO     -------------------------
2025-06-09 19:15:03 INFO     | Iteration: 1/5
2025-06-09 19:15:03 INFO     -------------------------
2025-06-09 19:15:03 INFO     >>>>> Predictor: Training
2025-06-09 19:15:52 INFO     1000 1231 6.341694 69305.9
2025-06-09 19:16:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:16:06 INFO     Data : 376
2025-06-09 19:16:06 INFO     Hit1 : 0.031915
2025-06-09 19:16:06 INFO     Hit3 : 0.093085
2025-06-09 19:16:06 INFO     Hit10: 0.167553
2025-06-09 19:16:06 INFO     MR   : 1442.469415
2025-06-09 19:16:06 INFO     MRR  : 0.077788
2025-06-09 19:16:06 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:16:09 INFO     Data : 440
2025-06-09 19:16:09 INFO     Hit1 : 0.040909
2025-06-09 19:16:09 INFO     Hit3 : 0.084091
2025-06-09 19:16:09 INFO     Hit10: 0.159091
2025-06-09 19:16:09 INFO     MR   : 1347.395455
2025-06-09 19:16:09 INFO     MRR  : 0.080285
2025-06-09 19:16:09 INFO     Save checkpoint to results/semmeddb/multitask/matrix_encode_relation/cluster_3/random_init/sm_test/warmup/predictor.pt
2025-06-09 19:16:09 INFO     -------------------------
2025-06-09 19:16:09 INFO     | Iteration: 2/5
2025-06-09 19:16:09 INFO     -------------------------
2025-06-09 19:16:09 INFO     >>>>> Predictor: Training
2025-06-09 19:17:03 INFO     1000 1231 6.186808 69366.7
2025-06-09 19:17:16 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:17:19 INFO     Data : 376
2025-06-09 19:17:19 INFO     Hit1 : 0.023936
2025-06-09 19:17:19 INFO     Hit3 : 0.077128
2025-06-09 19:17:19 INFO     Hit10: 0.175532
2025-06-09 19:17:19 INFO     MR   : 1316.889628
2025-06-09 19:17:19 INFO     MRR  : 0.070231
2025-06-09 19:17:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:17:21 INFO     Data : 440
2025-06-09 19:17:21 INFO     Hit1 : 0.050000
2025-06-09 19:17:21 INFO     Hit3 : 0.081818
2025-06-09 19:17:21 INFO     Hit10: 0.161364
2025-06-09 19:17:21 INFO     MR   : 1220.903409
2025-06-09 19:17:21 INFO     MRR  : 0.084124
2025-06-09 19:17:21 INFO     -------------------------
2025-06-09 19:17:21 INFO     | Iteration: 3/5
2025-06-09 19:17:21 INFO     -------------------------
2025-06-09 19:17:21 INFO     >>>>> Predictor: Training
2025-06-09 19:18:21 INFO     1000 1231 6.092339 69384.0
2025-06-09 19:18:35 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:18:37 INFO     Data : 376
2025-06-09 19:18:37 INFO     Hit1 : 0.031915
2025-06-09 19:18:37 INFO     Hit3 : 0.090426
2025-06-09 19:18:37 INFO     Hit10: 0.175532
2025-06-09 19:18:37 INFO     MR   : 1298.478723
2025-06-09 19:18:37 INFO     MRR  : 0.077468
2025-06-09 19:18:37 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:18:39 INFO     Data : 440
2025-06-09 19:18:39 INFO     Hit1 : 0.052273
2025-06-09 19:18:39 INFO     Hit3 : 0.090909
2025-06-09 19:18:39 INFO     Hit10: 0.165909
2025-06-09 19:18:39 INFO     MR   : 1196.403409
2025-06-09 19:18:39 INFO     MRR  : 0.088832
2025-06-09 19:18:39 INFO     -------------------------
2025-06-09 19:18:39 INFO     | Iteration: 4/5
2025-06-09 19:18:39 INFO     -------------------------
2025-06-09 19:18:39 INFO     >>>>> Predictor: Training
2025-06-09 19:19:30 INFO     1000 1231 6.086161 69340.6
2025-06-09 19:19:41 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:19:43 INFO     Data : 376
2025-06-09 19:19:43 INFO     Hit1 : 0.029255
2025-06-09 19:19:43 INFO     Hit3 : 0.087766
2025-06-09 19:19:43 INFO     Hit10: 0.167553
2025-06-09 19:19:43 INFO     MR   : 1261.848404
2025-06-09 19:19:43 INFO     MRR  : 0.076786
2025-06-09 19:19:43 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:19:46 INFO     Data : 440
2025-06-09 19:19:46 INFO     Hit1 : 0.045455
2025-06-09 19:19:46 INFO     Hit3 : 0.088636
2025-06-09 19:19:46 INFO     Hit10: 0.177273
2025-06-09 19:19:46 INFO     MR   : 1159.934091
2025-06-09 19:19:46 INFO     MRR  : 0.085510
2025-06-09 19:19:46 INFO     -------------------------
2025-06-09 19:19:46 INFO     | Iteration: 5/5
2025-06-09 19:19:46 INFO     -------------------------
2025-06-09 19:19:46 INFO     >>>>> Predictor: Training
2025-06-09 19:20:37 INFO     1000 1231 6.077296 69340.6
2025-06-09 19:20:49 INFO     >>>>> Predictor: Evaluating on valid
2025-06-09 19:20:51 INFO     Data : 376
2025-06-09 19:20:51 INFO     Hit1 : 0.026596
2025-06-09 19:20:51 INFO     Hit3 : 0.082447
2025-06-09 19:20:51 INFO     Hit10: 0.178191
2025-06-09 19:20:51 INFO     MR   : 1250.473404
2025-06-09 19:20:51 INFO     MRR  : 0.076064
2025-06-09 19:20:51 INFO     >>>>> Predictor: Evaluating on test
2025-06-09 19:20:53 INFO     Data : 440
2025-06-09 19:20:53 INFO     Hit1 : 0.047727
2025-06-09 19:20:53 INFO     Hit3 : 0.102273
2025-06-09 19:20:53 INFO     Hit10: 0.168182
2025-06-09 19:20:53 INFO     MR   : 1158.836364
2025-06-09 19:20:53 INFO     MRR  : 0.089522
2025-06-09 19:20:53 INFO     -------------------------
2025-06-09 19:20:53 INFO     | Final Test MRR: 0.080285
2025-06-09 19:20:53 INFO     -------------------------
