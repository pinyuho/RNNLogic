2025-07-01 21:55:00 INFO     Data loading | DONE!
2025-07-01 21:55:00 INFO     Using subset datasets for training, validation, and testing.
2025-07-01 21:55:00 INFO     Subset ratio: 0.01
2025-07-01 21:55:00 INFO     [Subset] TrainDataset: 59/5959 samples (1%)
2025-07-01 21:55:00 INFO     [Subset] ValidDataset: 2/260 samples (1%)
2025-07-01 21:55:00 INFO     [Subset] TestDataset: 2/293 samples (1%)
2025-07-01 21:55:00 INFO     [Subset] RuleDataset: 136/13661 samples (1%)
2025-07-01 21:55:00 INFO     -------------------------
2025-07-01 21:55:00 INFO     | EM Iteration: 1/2
2025-07-01 21:55:00 INFO     -------------------------
2025-07-01 21:55:00 INFO     >>>>> Using miner's rule
2025-07-01 21:55:00 INFO     Predictor: read 10 rules from list.
2025-07-01 21:55:01 INFO     Preprocess training set
2025-07-01 21:55:01 INFO     >>>>> Predictor: Training
2025-07-01 21:55:01 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 21:55:01 INFO     Data : 16
2025-07-01 21:55:01 INFO     Hit1 : 0.000000
2025-07-01 21:55:01 INFO     Hit3 : 0.000000
2025-07-01 21:55:01 INFO     Hit10: 0.062500
2025-07-01 21:55:01 INFO     MR   : 2373.875000
2025-07-01 21:55:01 INFO     MRR  : 0.008906
2025-07-01 21:55:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 21:55:01 INFO     Data : 16
2025-07-01 21:55:01 INFO     Hit1 : 0.000000
2025-07-01 21:55:01 INFO     Hit3 : 0.000000
2025-07-01 21:55:01 INFO     Hit10: 0.000000
2025-07-01 21:55:01 INFO     MR   : 2367.812500
2025-07-01 21:55:01 INFO     MRR  : 0.004095
2025-07-01 21:55:01 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 21:55:01 INFO     >>>>> Generator: Training
2025-07-01 21:55:01 INFO     [E00001] Total 2.549977 | Main 3.069973 | RelClus 1.104033 | EntType 0.000000
2025-07-01 21:55:01 INFO     [E00002] Total 2.548634 | Main 3.068386 | RelClus 1.103788 | EntType 0.000000
2025-07-01 21:55:01 INFO     [E00003] Total 2.546294 | Main 3.065775 | RelClus 1.104948 | EntType 0.000000
2025-07-01 21:55:01 INFO     [E00004] Total 2.547540 | Main 3.067125 | RelClus 1.103898 | EntType 0.000000
2025-07-01 21:55:01 INFO     [E00005] Total 2.546141 | Main 3.065498 | RelClus 1.103896 | EntType 0.000000
2025-07-01 21:55:01 INFO     [E00006] Total 2.545912 | Main 3.065301 | RelClus 1.104632 | EntType 0.000000
2025-07-01 21:55:02 INFO     [E00007] Total 2.544487 | Main 3.063707 | RelClus 1.105312 | EntType 0.000000
2025-07-01 21:55:02 INFO     [E00008] Total 2.544099 | Main 3.063027 | RelClus 1.102880 | EntType 0.000000
2025-07-01 21:55:02 INFO     [E00009] Total 2.543819 | Main 3.062830 | RelClus 1.104246 | EntType 0.000000
2025-07-01 21:55:02 INFO     [E00010] Total 2.542347 | Main 3.061084 | RelClus 1.103885 | EntType 0.000000
2025-07-01 21:55:02 INFO     -------------------------
2025-07-01 21:55:02 INFO     | EM Iteration: 2/2
2025-07-01 21:55:02 INFO     -------------------------
2025-07-01 21:55:02 INFO     >>>>> Using Generator's sample rule
2025-07-01 21:55:02 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 21:55:02 INFO     Predictor: read 199 rules from list.
2025-07-01 21:55:02 INFO     Preprocess training set
2025-07-01 21:55:02 INFO     >>>>> Predictor: Training
2025-07-01 21:55:02 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 21:55:02 INFO     Data : 16
2025-07-01 21:55:02 INFO     Hit1 : 0.000000
2025-07-01 21:55:02 INFO     Hit3 : 0.000000
2025-07-01 21:55:02 INFO     Hit10: 0.000000
2025-07-01 21:55:02 INFO     MR   : 2107.156250
2025-07-01 21:55:02 INFO     MRR  : 0.004785
2025-07-01 21:55:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 21:55:02 INFO     Data : 16
2025-07-01 21:55:02 INFO     Hit1 : 0.000000
2025-07-01 21:55:02 INFO     Hit3 : 0.000000
2025-07-01 21:55:02 INFO     Hit10: 0.000000
2025-07-01 21:55:02 INFO     MR   : 2347.312500
2025-07-01 21:55:02 INFO     MRR  : 0.008179
2025-07-01 21:55:02 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 21:55:03 INFO     >>>>> Generator: Training
2025-07-01 21:55:03 INFO     [E00001] Total 2.527196 | Main 3.043577 | RelClus 1.105378 | EntType 0.000000
2025-07-01 21:55:03 INFO     [E00002] Total 2.526998 | Main 3.043341 | RelClus 1.105317 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00003] Total 2.526611 | Main 3.042919 | RelClus 1.105643 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00004] Total 2.526517 | Main 3.042807 | RelClus 1.105609 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00005] Total 2.526074 | Main 3.042314 | RelClus 1.105873 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00006] Total 2.526089 | Main 3.042337 | RelClus 1.105945 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00007] Total 2.525869 | Main 3.042092 | RelClus 1.106065 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00008] Total 2.525465 | Main 3.041652 | RelClus 1.106428 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00009] Total 2.525534 | Main 3.041725 | RelClus 1.106342 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00010] Total 2.525393 | Main 3.041595 | RelClus 1.106715 | EntType 0.000000
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     | Post-train Generator
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     >>>>> Generator: Training
2025-07-01 21:55:04 INFO     [E00001] Total 2.524969 | Main 3.041071 | RelClus 1.106400 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00002] Total 2.524678 | Main 3.040729 | RelClus 1.106366 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00003] Total 2.524738 | Main 3.040847 | RelClus 1.106906 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00004] Total 2.524266 | Main 3.040297 | RelClus 1.106912 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00005] Total 2.524122 | Main 3.040124 | RelClus 1.106853 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00006] Total 2.523938 | Main 3.039927 | RelClus 1.107066 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00007] Total 2.523946 | Main 3.039939 | RelClus 1.107084 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00008] Total 2.523590 | Main 3.039550 | RelClus 1.107397 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00009] Total 2.523186 | Main 3.039096 | RelClus 1.107582 | EntType 0.000000
2025-07-01 21:55:04 INFO     [E00010] Total 2.523094 | Main 3.039016 | RelClus 1.107902 | EntType 0.000000
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     | Beam Search Best Rules
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 21:55:04 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-07-01 21:55:04 INFO     Subset ratio: 0.01
2025-07-01 21:55:04 INFO     Subset sizes: train=59, valid=2, test=2, rule dataset=4
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     | Train Final Predictor+
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     Predictor+: read 4 rules from list.
2025-07-01 21:55:04 INFO     Preprocess training set
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     | Iteration: 1/1
2025-07-01 21:55:04 INFO     -------------------------
2025-07-01 21:55:04 INFO     >>>>> Predictor: Training
2025-07-01 21:55:05 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 21:55:05 INFO     Data : 16
2025-07-01 21:55:05 INFO     Hit1 : 0.000000
2025-07-01 21:55:05 INFO     Hit3 : 0.000000
2025-07-01 21:55:05 INFO     Hit10: 0.000000
2025-07-01 21:55:05 INFO     MR   : 2816.562500
2025-07-01 21:55:05 INFO     MRR  : 0.004631
2025-07-01 21:55:05 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 21:55:05 INFO     Data : 16
2025-07-01 21:55:05 INFO     Hit1 : 0.000000
2025-07-01 21:55:05 INFO     Hit3 : 0.000000
2025-07-01 21:55:05 INFO     Hit10: 0.000000
2025-07-01 21:55:05 INFO     MR   : 1056.125000
2025-07-01 21:55:05 INFO     MRR  : 0.003892
2025-07-01 21:55:05 INFO     Save checkpoint to results/semmeddb/sm_test/multitask_mmoe_adaptive_matrix_3_20250701_215458/predictor.pt
2025-07-01 21:55:05 INFO     -------------------------
2025-07-01 21:55:05 INFO     | Final Test MRR: 0.003892
2025-07-01 21:55:05 INFO     -------------------------
