2025-07-01 11:57:58 INFO     Data loading | DONE!
2025-07-01 11:57:58 INFO     Using subset datasets for training, validation, and testing.
2025-07-01 11:57:58 INFO     Subset ratio: 0.01
2025-07-01 11:57:58 INFO     [Subset] TrainDataset: 59/5959 samples (1%)
2025-07-01 11:57:58 INFO     [Subset] ValidDataset: 2/260 samples (1%)
2025-07-01 11:57:58 INFO     [Subset] TestDataset: 2/293 samples (1%)
2025-07-01 11:57:58 INFO     [Subset] RuleDataset: 136/13661 samples (1%)
2025-07-01 11:57:58 INFO     -------------------------
2025-07-01 11:57:58 INFO     | EM Iteration: 1/2
2025-07-01 11:57:58 INFO     -------------------------
2025-07-01 11:57:58 INFO     >>>>> Using miner's rule
2025-07-01 11:57:58 INFO     Predictor: read 10 rules from list.
2025-07-01 11:57:59 INFO     Preprocess training set
2025-07-01 11:57:59 INFO     >>>>> Predictor: Training
2025-07-01 11:57:59 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 11:57:59 INFO     Data : 16
2025-07-01 11:57:59 INFO     Hit1 : 0.000000
2025-07-01 11:57:59 INFO     Hit3 : 0.000000
2025-07-01 11:57:59 INFO     Hit10: 0.062500
2025-07-01 11:57:59 INFO     MR   : 2373.875000
2025-07-01 11:57:59 INFO     MRR  : 0.008906
2025-07-01 11:57:59 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 11:57:59 INFO     Data : 16
2025-07-01 11:57:59 INFO     Hit1 : 0.000000
2025-07-01 11:57:59 INFO     Hit3 : 0.000000
2025-07-01 11:57:59 INFO     Hit10: 0.000000
2025-07-01 11:57:59 INFO     MR   : 2367.812500
2025-07-01 11:57:59 INFO     MRR  : 0.004095
2025-07-01 11:57:59 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 11:57:59 INFO     >>>>> Generator: Training
2025-07-01 11:57:59 INFO     [E00001] Total 90.195663 | Main 3.072752 | RelClus 1.079627 | EntType 94.064491
2025-07-01 11:57:59 INFO     [E00002] Total 90.179840 | Main 3.072224 | RelClus 1.079246 | EntType 94.047829
2025-07-01 11:57:59 INFO     [E00003] Total 90.173851 | Main 3.074023 | RelClus 1.078125 | EntType 94.042343
2025-07-01 11:57:59 INFO     [E00004] Total 90.155373 | Main 3.072701 | RelClus 1.079129 | EntType 94.023590
2025-07-01 11:57:59 INFO     [E00005] Total 90.157150 | Main 3.074556 | RelClus 1.079073 | EntType 94.026917
2025-07-01 11:57:59 INFO     [E00006] Total 90.131660 | Main 3.074361 | RelClus 1.079689 | EntType 94.001740
2025-07-01 11:57:59 INFO     [E00007] Total 90.118301 | Main 3.074627 | RelClus 1.080878 | EntType 93.989639
2025-07-01 11:57:59 INFO     [E00008] Total 90.108582 | Main 3.073830 | RelClus 1.078923 | EntType 93.977448
2025-07-01 11:57:59 INFO     [E00009] Total 90.091408 | Main 3.073632 | RelClus 1.078402 | EntType 93.959579
2025-07-01 11:58:00 INFO     [E00010] Total 90.085274 | Main 3.074920 | RelClus 1.080012 | EntType 93.955986
2025-07-01 11:58:00 INFO     -------------------------
2025-07-01 11:58:00 INFO     | EM Iteration: 2/2
2025-07-01 11:58:00 INFO     -------------------------
2025-07-01 11:58:00 INFO     >>>>> Using Generator's sample rule
2025-07-01 11:58:00 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 11:58:00 INFO     Predictor: read 196 rules from list.
2025-07-01 11:58:00 INFO     Preprocess training set
2025-07-01 11:58:00 INFO     >>>>> Predictor: Training
2025-07-01 11:58:00 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 11:58:00 INFO     Data : 16
2025-07-01 11:58:00 INFO     Hit1 : 0.000000
2025-07-01 11:58:00 INFO     Hit3 : 0.000000
2025-07-01 11:58:00 INFO     Hit10: 0.000000
2025-07-01 11:58:00 INFO     MR   : 2105.062500
2025-07-01 11:58:00 INFO     MRR  : 0.004881
2025-07-01 11:58:00 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 11:58:00 INFO     Data : 16
2025-07-01 11:58:00 INFO     Hit1 : 0.000000
2025-07-01 11:58:00 INFO     Hit3 : 0.000000
2025-07-01 11:58:00 INFO     Hit10: 0.000000
2025-07-01 11:58:00 INFO     MR   : 2343.750000
2025-07-01 11:58:00 INFO     MRR  : 0.008185
2025-07-01 11:58:00 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 11:58:01 INFO     >>>>> Generator: Training
2025-07-01 11:58:01 INFO     [E00001] Total 90.174866 | Main 3.036682 | RelClus 1.084405 | EntType 94.016945
2025-07-01 11:58:01 INFO     [E00002] Total 90.165344 | Main 3.036934 | RelClus 1.084608 | EntType 94.007805
2025-07-01 11:58:01 INFO     [E00003] Total 90.158150 | Main 3.036693 | RelClus 1.084693 | EntType 94.000450
2025-07-01 11:58:01 INFO     [E00004] Total 90.149513 | Main 3.036501 | RelClus 1.084813 | EntType 93.991737
2025-07-01 11:58:01 INFO     [E00005] Total 90.138123 | Main 3.036955 | RelClus 1.084735 | EntType 93.980629
2025-07-01 11:58:01 INFO     [E00006] Total 90.130623 | Main 3.036843 | RelClus 1.084654 | EntType 93.972946
2025-07-01 11:58:01 INFO     [E00007] Total 90.122185 | Main 3.037247 | RelClus 1.084767 | EntType 93.964943
2025-07-01 11:58:01 INFO     [E00008] Total 90.114174 | Main 3.036631 | RelClus 1.085161 | EntType 93.956718
2025-07-01 11:58:02 INFO     [E00009] Total 90.104431 | Main 3.037159 | RelClus 1.084891 | EntType 93.947166
2025-07-01 11:58:02 INFO     [E00010] Total 90.095055 | Main 3.036671 | RelClus 1.085011 | EntType 93.937447
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     | Post-train Generator
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     >>>>> Generator: Training
2025-07-01 11:58:02 INFO     [E00001] Total 90.083977 | Main 3.037116 | RelClus 1.084699 | EntType 93.926445
2025-07-01 11:58:02 INFO     [E00002] Total 90.074532 | Main 3.036872 | RelClus 1.084759 | EntType 93.916817
2025-07-01 11:58:02 INFO     [E00003] Total 90.065231 | Main 3.037385 | RelClus 1.084848 | EntType 93.908005
2025-07-01 11:58:02 INFO     [E00004] Total 90.056725 | Main 3.036905 | RelClus 1.085039 | EntType 93.899231
2025-07-01 11:58:02 INFO     [E00005] Total 90.047440 | Main 3.037154 | RelClus 1.085242 | EntType 93.890320
2025-07-01 11:58:02 INFO     [E00006] Total 90.039032 | Main 3.036893 | RelClus 1.084780 | EntType 93.881241
2025-07-01 11:58:02 INFO     [E00007] Total 90.030121 | Main 3.037249 | RelClus 1.085122 | EntType 93.872917
2025-07-01 11:58:02 INFO     [E00008] Total 90.020470 | Main 3.037202 | RelClus 1.084861 | EntType 93.862968
2025-07-01 11:58:02 INFO     [E00009] Total 90.012268 | Main 3.037286 | RelClus 1.085482 | EntType 93.855377
2025-07-01 11:58:02 INFO     [E00010] Total 90.004105 | Main 3.037024 | RelClus 1.085346 | EntType 93.846848
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     | Beam Search Best Rules
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 11:58:02 INFO     Using subset datasets for final predictor+ training, validation, and testing.
2025-07-01 11:58:02 INFO     Subset ratio: 0.01
2025-07-01 11:58:02 INFO     Subset sizes: train=59, valid=2, test=2, rule dataset=4
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     | Train Final Predictor+
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     Predictor+: read 4 rules from list.
2025-07-01 11:58:02 INFO     Preprocess training set
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     | Iteration: 1/1
2025-07-01 11:58:02 INFO     -------------------------
2025-07-01 11:58:02 INFO     >>>>> Predictor: Training
2025-07-01 11:58:03 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 11:58:03 INFO     Data : 16
2025-07-01 11:58:03 INFO     Hit1 : 0.000000
2025-07-01 11:58:03 INFO     Hit3 : 0.000000
2025-07-01 11:58:03 INFO     Hit10: 0.000000
2025-07-01 11:58:03 INFO     MR   : 2818.093750
2025-07-01 11:58:03 INFO     MRR  : 0.004631
2025-07-01 11:58:03 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 11:58:03 INFO     Data : 16
2025-07-01 11:58:03 INFO     Hit1 : 0.000000
2025-07-01 11:58:03 INFO     Hit3 : 0.000000
2025-07-01 11:58:03 INFO     Hit10: 0.000000
2025-07-01 11:58:03 INFO     MR   : 1056.343750
2025-07-01 11:58:03 INFO     MRR  : 0.003892
2025-07-01 11:58:03 INFO     Save checkpoint to results/semmeddb/sm_test/semmeddb_multitask_mmoe_3/predictor.pt
2025-07-01 11:58:03 INFO     -------------------------
2025-07-01 11:58:03 INFO     | Final Test MRR: 0.003892
2025-07-01 11:58:03 INFO     -------------------------
