2025-06-26 05:42:03 INFO     Data loading | DONE!
2025-06-26 05:42:03 INFO     Using full datasets for training, validation, and testing.
2025-06-26 05:42:03 INFO     -------------------------
2025-06-26 05:42:03 INFO     | EM Iteration: 1/5
2025-06-26 05:42:03 INFO     -------------------------
2025-06-26 05:42:03 INFO     >>>>> Using miner's rule
2025-06-26 05:42:03 INFO     Predictor: read 10 rules from list.
2025-06-26 05:42:04 INFO     Preprocess training set
2025-06-26 05:42:04 INFO     >>>>> Predictor: Training
2025-06-26 05:42:06 INFO     1000 5959 8.840337 69314.6
2025-06-26 05:42:08 INFO     2000 5959 8.544598 69271.3
2025-06-26 05:42:11 INFO     3000 5959 8.400789 69245.2
2025-06-26 05:42:13 INFO     4000 5959 8.293292 69340.6
2025-06-26 05:42:15 INFO     5000 5959 8.199750 69340.6
2025-06-26 05:42:17 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 05:42:18 INFO     Data : 2077
2025-06-26 05:42:18 INFO     Hit1 : 0.000963
2025-06-26 05:42:18 INFO     Hit3 : 0.004333
2025-06-26 05:42:18 INFO     Hit10: 0.009629
2025-06-26 05:42:18 INFO     MR   : 1483.702455
2025-06-26 05:42:18 INFO     MRR  : 0.008204
2025-06-26 05:42:18 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 05:42:19 INFO     Data : 2342
2025-06-26 05:42:19 INFO     Hit1 : 0.000854
2025-06-26 05:42:19 INFO     Hit3 : 0.004697
2025-06-26 05:42:19 INFO     Hit10: 0.008540
2025-06-26 05:42:19 INFO     MR   : 1385.623612
2025-06-26 05:42:19 INFO     MRR  : 0.007828
2025-06-26 05:42:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 05:42:19 INFO     1000 5959
2025-06-26 05:42:20 INFO     2000 5959
2025-06-26 05:42:20 INFO     3000 5959
2025-06-26 05:42:21 INFO     4000 5959
2025-06-26 05:42:21 INFO     5000 5959
2025-06-26 05:42:22 INFO     >>>>> Generator: Training
2025-06-26 05:42:23 INFO     -------------------------
2025-06-26 05:42:23 INFO     | EM Iteration: 2/5
2025-06-26 05:42:23 INFO     -------------------------
2025-06-26 05:42:23 INFO     >>>>> Using Generator's sample rule
2025-06-26 05:42:23 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 05:42:24 INFO     Predictor: read 1906 rules from list.
2025-06-26 05:42:24 INFO     Preprocess training set
2025-06-26 05:42:24 INFO     >>>>> Predictor: Training
2025-06-26 05:43:11 INFO     1000 5959 8.823723 69332.0
2025-06-26 05:43:58 INFO     2000 5959 8.496782 69349.3
2025-06-26 05:44:45 INFO     3000 5959 8.298909 69184.5
2025-06-26 05:45:31 INFO     4000 5959 8.144583 69253.9
2025-06-26 05:46:17 INFO     5000 5959 8.050370 69332.0
2025-06-26 05:47:01 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 05:47:11 INFO     Data : 2077
2025-06-26 05:47:11 INFO     Hit1 : 0.024073
2025-06-26 05:47:11 INFO     Hit3 : 0.051998
2025-06-26 05:47:11 INFO     Hit10: 0.086663
2025-06-26 05:47:11 INFO     MR   : 1401.304766
2025-06-26 05:47:11 INFO     MRR  : 0.047258
2025-06-26 05:47:11 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 05:47:22 INFO     Data : 2342
2025-06-26 05:47:22 INFO     Hit1 : 0.028608
2025-06-26 05:47:22 INFO     Hit3 : 0.053373
2025-06-26 05:47:22 INFO     Hit10: 0.090094
2025-06-26 05:47:22 INFO     MR   : 1295.649658
2025-06-26 05:47:22 INFO     MRR  : 0.051704
2025-06-26 05:47:22 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 05:49:33 INFO     1000 5959
2025-06-26 05:51:43 INFO     2000 5959
2025-06-26 05:53:54 INFO     3000 5959
2025-06-26 05:56:05 INFO     4000 5959
2025-06-26 05:58:16 INFO     5000 5959
2025-06-26 06:00:25 INFO     >>>>> Generator: Training
2025-06-26 06:00:28 INFO     -------------------------
2025-06-26 06:00:28 INFO     | EM Iteration: 3/5
2025-06-26 06:00:28 INFO     -------------------------
2025-06-26 06:00:28 INFO     >>>>> Using Generator's sample rule
2025-06-26 06:00:28 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 06:00:28 INFO     Predictor: read 1883 rules from list.
2025-06-26 06:00:28 INFO     Preprocess training set
2025-06-26 06:00:28 INFO     >>>>> Predictor: Training
2025-06-26 06:01:15 INFO     1000 5959 8.818299 69271.3
2025-06-26 06:02:02 INFO     2000 5959 8.487688 69340.6
2025-06-26 06:02:50 INFO     3000 5959 8.280518 69384.0
2025-06-26 06:03:37 INFO     4000 5959 8.151398 69262.6
2025-06-26 06:04:24 INFO     5000 5959 8.050952 69332.0
2025-06-26 06:05:10 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 06:05:19 INFO     Data : 2077
2025-06-26 06:05:19 INFO     Hit1 : 0.008185
2025-06-26 06:05:19 INFO     Hit3 : 0.015888
2025-06-26 06:05:19 INFO     Hit10: 0.033221
2025-06-26 06:05:19 INFO     MR   : 1482.251083
2025-06-26 06:05:19 INFO     MRR  : 0.019945
2025-06-26 06:05:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 06:05:30 INFO     Data : 2342
2025-06-26 06:05:30 INFO     Hit1 : 0.006832
2025-06-26 06:05:30 INFO     Hit3 : 0.017506
2025-06-26 06:05:30 INFO     Hit10: 0.036294
2025-06-26 06:05:30 INFO     MR   : 1383.228864
2025-06-26 06:05:30 INFO     MRR  : 0.020116
2025-06-26 06:05:30 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 06:07:42 INFO     1000 5959
2025-06-26 06:09:55 INFO     2000 5959
2025-06-26 06:12:07 INFO     3000 5959
2025-06-26 06:14:21 INFO     4000 5959
2025-06-26 06:16:34 INFO     5000 5959
2025-06-26 06:18:44 INFO     >>>>> Generator: Training
2025-06-26 06:18:46 INFO     -------------------------
2025-06-26 06:18:46 INFO     | EM Iteration: 4/5
2025-06-26 06:18:46 INFO     -------------------------
2025-06-26 06:18:46 INFO     >>>>> Using Generator's sample rule
2025-06-26 06:18:46 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 06:18:46 INFO     Predictor: read 1852 rules from list.
2025-06-26 06:18:46 INFO     Preprocess training set
2025-06-26 06:18:46 INFO     >>>>> Predictor: Training
2025-06-26 06:19:31 INFO     1000 5959 8.798094 69332.0
2025-06-26 06:20:16 INFO     2000 5959 8.414488 69349.3
2025-06-26 06:21:00 INFO     3000 5959 8.169824 69340.6
2025-06-26 06:21:45 INFO     4000 5959 7.975129 69297.3
2025-06-26 06:22:30 INFO     5000 5959 7.806617 69219.2
2025-06-26 06:23:13 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 06:23:23 INFO     Data : 2077
2025-06-26 06:23:23 INFO     Hit1 : 0.011074
2025-06-26 06:23:23 INFO     Hit3 : 0.021184
2025-06-26 06:23:23 INFO     Hit10: 0.040924
2025-06-26 06:23:23 INFO     MR   : 1505.930910
2025-06-26 06:23:23 INFO     MRR  : 0.024212
2025-06-26 06:23:23 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 06:23:34 INFO     Data : 2342
2025-06-26 06:23:34 INFO     Hit1 : 0.009821
2025-06-26 06:23:34 INFO     Hit3 : 0.024765
2025-06-26 06:23:34 INFO     Hit10: 0.037575
2025-06-26 06:23:34 INFO     MR   : 1379.414176
2025-06-26 06:23:34 INFO     MRR  : 0.024024
2025-06-26 06:23:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 06:25:44 INFO     1000 5959
2025-06-26 06:27:55 INFO     2000 5959
2025-06-26 06:30:06 INFO     3000 5959
2025-06-26 06:32:16 INFO     4000 5959
2025-06-26 06:34:27 INFO     5000 5959
2025-06-26 06:36:35 INFO     >>>>> Generator: Training
2025-06-26 06:36:37 INFO     -------------------------
2025-06-26 06:36:37 INFO     | EM Iteration: 5/5
2025-06-26 06:36:37 INFO     -------------------------
2025-06-26 06:36:37 INFO     >>>>> Using Generator's sample rule
2025-06-26 06:36:37 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 06:36:37 INFO     Predictor: read 1737 rules from list.
2025-06-26 06:36:37 INFO     Preprocess training set
2025-06-26 06:36:37 INFO     >>>>> Predictor: Training
2025-06-26 06:37:18 INFO     1000 5959 8.782733 69271.3
2025-06-26 06:38:00 INFO     2000 5959 8.393102 69332.0
2025-06-26 06:38:41 INFO     3000 5959 8.121977 69375.3
2025-06-26 06:39:22 INFO     4000 5959 7.923452 69279.9
2025-06-26 06:40:03 INFO     5000 5959 7.750570 69349.3
2025-06-26 06:40:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 06:40:51 INFO     Data : 2077
2025-06-26 06:40:51 INFO     Hit1 : 0.038036
2025-06-26 06:40:51 INFO     Hit3 : 0.065479
2025-06-26 06:40:51 INFO     Hit10: 0.105441
2025-06-26 06:40:51 INFO     MR   : 1393.380597
2025-06-26 06:40:51 INFO     MRR  : 0.062308
2025-06-26 06:40:51 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 06:41:00 INFO     Data : 2342
2025-06-26 06:41:00 INFO     Hit1 : 0.043980
2025-06-26 06:41:00 INFO     Hit3 : 0.068745
2025-06-26 06:41:00 INFO     Hit10: 0.102904
2025-06-26 06:41:00 INFO     MR   : 1297.951110
2025-06-26 06:41:00 INFO     MRR  : 0.066235
2025-06-26 06:41:00 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 06:43:06 INFO     1000 5959
2025-06-26 06:45:11 INFO     2000 5959
2025-06-26 06:47:17 INFO     3000 5959
2025-06-26 06:49:22 INFO     4000 5959
2025-06-26 06:51:30 INFO     5000 5959
2025-06-26 06:53:35 INFO     >>>>> Generator: Training
2025-06-26 06:53:37 INFO     -------------------------
2025-06-26 06:53:37 INFO     | Post-train Generator
2025-06-26 06:53:37 INFO     -------------------------
2025-06-26 06:53:38 INFO     >>>>> Generator: Training
2025-06-26 06:54:05 INFO     [E01000] Total 2.468207 | main 2.587401 | aux_rel_cluster 0.450656 | aux_ent_type 3.532207
2025-06-26 06:54:05 INFO     -------------------------
2025-06-26 06:54:05 INFO     | Beam Search Best Rules
2025-06-26 06:54:05 INFO     -------------------------
2025-06-26 06:54:05 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 06:54:06 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 06:54:10 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 06:55:06 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 06:55:53 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 06:56:25 INFO     -------------------------
2025-06-26 06:56:25 INFO     | Train Final Predictor+
2025-06-26 06:56:25 INFO     -------------------------
2025-06-26 06:56:25 INFO     Predictor+: read 18420 rules from list.
2025-06-26 06:56:25 INFO     Preprocess training set
2025-06-26 06:56:25 INFO     -------------------------
2025-06-26 06:56:25 INFO     | Iteration: 1/5
2025-06-26 06:56:25 INFO     -------------------------
2025-06-26 06:56:25 INFO     >>>>> Predictor: Training
2025-06-26 07:00:55 INFO     1000 5959 4.902462 69366.7
2025-06-26 07:05:24 INFO     2000 5959 4.741202 69375.3
2025-06-26 07:09:54 INFO     3000 5959 4.709599 69219.2
2025-06-26 07:14:24 INFO     4000 5959 4.700930 69305.9
2025-06-26 07:18:53 INFO     5000 5959 4.664202 69288.6
2025-06-26 07:23:12 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 07:24:18 INFO     Data : 2077
2025-06-26 07:24:18 INFO     Hit1 : 0.100626
2025-06-26 07:24:18 INFO     Hit3 : 0.183919
2025-06-26 07:24:18 INFO     Hit10: 0.319210
2025-06-26 07:24:18 INFO     MR   : 971.540443
2025-06-26 07:24:18 INFO     MRR  : 0.169277
2025-06-26 07:24:18 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 07:25:34 INFO     Data : 2342
2025-06-26 07:25:34 INFO     Hit1 : 0.124253
2025-06-26 07:25:34 INFO     Hit3 : 0.209223
2025-06-26 07:25:34 INFO     Hit10: 0.318958
2025-06-26 07:25:34 INFO     MR   : 888.845645
2025-06-26 07:25:34 INFO     MRR  : 0.189920
2025-06-26 07:25:34 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3/predictor.pt
2025-06-26 07:25:34 INFO     -------------------------
2025-06-26 07:25:34 INFO     | Iteration: 2/5
2025-06-26 07:25:34 INFO     -------------------------
2025-06-26 07:25:34 INFO     >>>>> Predictor: Training
2025-06-26 07:30:04 INFO     1000 5959 4.628514 69288.6
2025-06-26 07:34:34 INFO     2000 5959 4.629980 69288.6
2025-06-26 07:39:04 INFO     3000 5959 4.612077 69340.6
2025-06-26 07:43:35 INFO     4000 5959 4.623724 69271.3
2025-06-26 07:48:05 INFO     5000 5959 4.639024 69219.2
2025-06-26 07:52:23 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 07:53:30 INFO     Data : 2077
2025-06-26 07:53:30 INFO     Hit1 : 0.093404
2025-06-26 07:53:30 INFO     Hit3 : 0.181030
2025-06-26 07:53:30 INFO     Hit10: 0.310544
2025-06-26 07:53:30 INFO     MR   : 948.402022
2025-06-26 07:53:30 INFO     MRR  : 0.164325
2025-06-26 07:53:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 07:54:45 INFO     Data : 2342
2025-06-26 07:54:45 INFO     Hit1 : 0.122972
2025-06-26 07:54:45 INFO     Hit3 : 0.199829
2025-06-26 07:54:45 INFO     Hit10: 0.323655
2025-06-26 07:54:45 INFO     MR   : 864.704313
2025-06-26 07:54:45 INFO     MRR  : 0.185641
2025-06-26 07:54:45 INFO     -------------------------
2025-06-26 07:54:45 INFO     | Iteration: 3/5
2025-06-26 07:54:45 INFO     -------------------------
2025-06-26 07:54:45 INFO     >>>>> Predictor: Training
2025-06-26 07:59:23 INFO     1000 5959 4.593860 69340.6
2025-06-26 08:04:01 INFO     2000 5959 4.561468 69184.5
2025-06-26 08:08:36 INFO     3000 5959 4.623377 69253.9
2025-06-26 08:13:14 INFO     4000 5959 4.596844 69340.6
2025-06-26 08:17:48 INFO     5000 5959 4.598128 69384.0
2025-06-26 08:22:11 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 08:23:19 INFO     Data : 2077
2025-06-26 08:23:19 INFO     Hit1 : 0.097737
2025-06-26 08:23:19 INFO     Hit3 : 0.190178
2025-06-26 08:23:19 INFO     Hit10: 0.321618
2025-06-26 08:23:19 INFO     MR   : 934.445835
2025-06-26 08:23:19 INFO     MRR  : 0.168683
2025-06-26 08:23:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 08:24:35 INFO     Data : 2342
2025-06-26 08:24:35 INFO     Hit1 : 0.122972
2025-06-26 08:24:35 INFO     Hit3 : 0.214774
2025-06-26 08:24:35 INFO     Hit10: 0.319385
2025-06-26 08:24:35 INFO     MR   : 854.530529
2025-06-26 08:24:35 INFO     MRR  : 0.190020
2025-06-26 08:24:35 INFO     -------------------------
2025-06-26 08:24:35 INFO     | Iteration: 4/5
2025-06-26 08:24:35 INFO     -------------------------
2025-06-26 08:24:35 INFO     >>>>> Predictor: Training
2025-06-26 08:29:07 INFO     1000 5959 4.600705 69323.3
2025-06-26 08:33:41 INFO     2000 5959 4.574778 69332.0
2025-06-26 08:38:20 INFO     3000 5959 4.608271 69219.2
2025-06-26 08:42:51 INFO     4000 5959 4.603632 69297.3
2025-06-26 08:47:21 INFO     5000 5959 4.566758 69332.0
2025-06-26 08:51:41 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 08:52:47 INFO     Data : 2077
2025-06-26 08:52:47 INFO     Hit1 : 0.097256
2025-06-26 08:52:47 INFO     Hit3 : 0.182956
2025-06-26 08:52:47 INFO     Hit10: 0.316803
2025-06-26 08:52:47 INFO     MR   : 921.391189
2025-06-26 08:52:47 INFO     MRR  : 0.167565
2025-06-26 08:52:47 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 08:54:02 INFO     Data : 2342
2025-06-26 08:54:02 INFO     Hit1 : 0.119129
2025-06-26 08:54:02 INFO     Hit3 : 0.203672
2025-06-26 08:54:02 INFO     Hit10: 0.318531
2025-06-26 08:54:02 INFO     MR   : 844.843083
2025-06-26 08:54:02 INFO     MRR  : 0.185781
2025-06-26 08:54:02 INFO     -------------------------
2025-06-26 08:54:02 INFO     | Iteration: 5/5
2025-06-26 08:54:02 INFO     -------------------------
2025-06-26 08:54:02 INFO     >>>>> Predictor: Training
2025-06-26 08:58:33 INFO     1000 5959 4.535182 69245.2
2025-06-26 09:03:06 INFO     2000 5959 4.533843 69262.6
2025-06-26 09:07:40 INFO     3000 5959 4.591894 69332.0
2025-06-26 09:12:13 INFO     4000 5959 4.596901 69366.7
2025-06-26 09:16:47 INFO     5000 5959 4.604292 69262.6
2025-06-26 09:21:09 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 09:22:16 INFO     Data : 2077
2025-06-26 09:22:16 INFO     Hit1 : 0.099663
2025-06-26 09:22:16 INFO     Hit3 : 0.191141
2025-06-26 09:22:16 INFO     Hit10: 0.311026
2025-06-26 09:22:16 INFO     MR   : 922.358209
2025-06-26 09:22:16 INFO     MRR  : 0.169871
2025-06-26 09:22:16 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 09:23:33 INFO     Data : 2342
2025-06-26 09:23:33 INFO     Hit1 : 0.126815
2025-06-26 09:23:33 INFO     Hit3 : 0.204099
2025-06-26 09:23:33 INFO     Hit10: 0.319812
2025-06-26 09:23:33 INFO     MR   : 845.706447
2025-06-26 09:23:33 INFO     MRR  : 0.190056
2025-06-26 09:23:33 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3/predictor.pt
2025-06-26 09:23:33 INFO     -------------------------
2025-06-26 09:23:33 INFO     | Final Test MRR: 0.190056
2025-06-26 09:23:33 INFO     -------------------------
