2025-07-01 11:59:41 INFO     Data loading | DONE!
2025-07-01 11:59:41 INFO     Using full datasets for training, validation, and testing.
2025-07-01 11:59:41 INFO     -------------------------
2025-07-01 11:59:41 INFO     | EM Iteration: 1/5
2025-07-01 11:59:41 INFO     -------------------------
2025-07-01 11:59:41 INFO     >>>>> Using miner's rule
2025-07-01 11:59:41 INFO     Predictor: read 13661 rules from list.
2025-07-01 11:59:42 INFO     Preprocess training set
2025-07-01 11:59:42 INFO     >>>>> Predictor: Training
2025-07-01 12:08:04 INFO     1000 5959 8.299284 69314.6
2025-07-01 12:16:21 INFO     2000 5959 7.689227 69271.3
2025-07-01 12:24:22 INFO     3000 5959 7.425850 69245.2
2025-07-01 12:32:28 INFO     4000 5959 7.285955 69340.6
2025-07-01 12:40:35 INFO     5000 5959 7.136692 69340.6
2025-07-01 12:48:23 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 12:50:23 INFO     Data : 2077
2025-07-01 12:50:23 INFO     Hit1 : 0.065479
2025-07-01 12:50:23 INFO     Hit3 : 0.127106
2025-07-01 12:50:23 INFO     Hit10: 0.199326
2025-07-01 12:50:23 INFO     MR   : 1120.920077
2025-07-01 12:50:23 INFO     MRR  : 0.114382
2025-07-01 12:50:23 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 12:52:39 INFO     Data : 2342
2025-07-01 12:52:39 INFO     Hit1 : 0.078992
2025-07-01 12:52:39 INFO     Hit3 : 0.124253
2025-07-01 12:52:39 INFO     Hit10: 0.208796
2025-07-01 12:52:39 INFO     MR   : 1044.279889
2025-07-01 12:52:39 INFO     MRR  : 0.122250
2025-07-01 12:52:39 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 13:24:05 INFO     1000 5959
2025-07-01 13:55:20 INFO     2000 5959
2025-07-01 14:25:32 INFO     3000 5959
2025-07-01 14:56:07 INFO     4000 5959
2025-07-01 15:26:16 INFO     5000 5959
2025-07-01 15:56:07 INFO     >>>>> Generator: Training
2025-07-01 15:56:16 INFO     -------------------------
2025-07-01 15:56:16 INFO     | EM Iteration: 2/5
2025-07-01 15:56:16 INFO     -------------------------
2025-07-01 15:56:16 INFO     >>>>> Using Generator's sample rule
2025-07-01 15:56:16 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 15:56:16 INFO     Predictor: read 1904 rules from list.
2025-07-01 15:56:16 INFO     Preprocess training set
2025-07-01 15:56:16 INFO     >>>>> Predictor: Training
2025-07-01 15:57:04 INFO     1000 5959 8.787247 69332.0
2025-07-01 15:57:53 INFO     2000 5959 8.397625 69349.3
2025-07-01 15:58:41 INFO     3000 5959 8.125213 69184.5
2025-07-01 15:59:30 INFO     4000 5959 7.934529 69253.9
2025-07-01 16:00:18 INFO     5000 5959 7.802324 69332.0
2025-07-01 16:01:04 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 16:01:15 INFO     Data : 2077
2025-07-01 16:01:15 INFO     Hit1 : 0.017814
2025-07-01 16:01:15 INFO     Hit3 : 0.032740
2025-07-01 16:01:15 INFO     Hit10: 0.060664
2025-07-01 16:01:15 INFO     MR   : 1452.111940
2025-07-01 16:01:15 INFO     MRR  : 0.034058
2025-07-01 16:01:15 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 16:01:26 INFO     Data : 2342
2025-07-01 16:01:26 INFO     Hit1 : 0.017933
2025-07-01 16:01:26 INFO     Hit3 : 0.035867
2025-07-01 16:01:26 INFO     Hit10: 0.064048
2025-07-01 16:01:26 INFO     MR   : 1340.330700
2025-07-01 16:01:26 INFO     MRR  : 0.035672
2025-07-01 16:01:26 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 16:03:46 INFO     1000 5959
2025-07-01 16:06:08 INFO     2000 5959
2025-07-01 16:08:30 INFO     3000 5959
2025-07-01 16:10:56 INFO     4000 5959
2025-07-01 16:13:19 INFO     5000 5959
2025-07-01 16:15:38 INFO     >>>>> Generator: Training
2025-07-01 16:15:47 INFO     -------------------------
2025-07-01 16:15:47 INFO     | EM Iteration: 3/5
2025-07-01 16:15:47 INFO     -------------------------
2025-07-01 16:15:47 INFO     >>>>> Using Generator's sample rule
2025-07-01 16:15:47 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 16:15:48 INFO     Predictor: read 1886 rules from list.
2025-07-01 16:15:48 INFO     Preprocess training set
2025-07-01 16:15:48 INFO     >>>>> Predictor: Training
2025-07-01 16:16:37 INFO     1000 5959 8.805266 69271.3
2025-07-01 16:17:25 INFO     2000 5959 8.430659 69340.6
2025-07-01 16:18:13 INFO     3000 5959 8.187983 69384.0
2025-07-01 16:19:01 INFO     4000 5959 8.021001 69262.6
2025-07-01 16:19:50 INFO     5000 5959 7.896681 69332.0
2025-07-01 16:20:37 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 16:20:47 INFO     Data : 2077
2025-07-01 16:20:47 INFO     Hit1 : 0.013962
2025-07-01 16:20:47 INFO     Hit3 : 0.020703
2025-07-01 16:20:47 INFO     Hit10: 0.036591
2025-07-01 16:20:47 INFO     MR   : 1498.637939
2025-07-01 16:20:47 INFO     MRR  : 0.024649
2025-07-01 16:20:47 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 16:20:58 INFO     Data : 2342
2025-07-01 16:20:58 INFO     Hit1 : 0.013237
2025-07-01 16:20:58 INFO     Hit3 : 0.021776
2025-07-01 16:20:58 INFO     Hit10: 0.033305
2025-07-01 16:20:58 INFO     MR   : 1390.536507
2025-07-01 16:20:58 INFO     MRR  : 0.023757
2025-07-01 16:20:58 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 16:23:15 INFO     1000 5959
2025-07-01 16:25:34 INFO     2000 5959
2025-07-01 16:27:52 INFO     3000 5959
2025-07-01 16:30:10 INFO     4000 5959
2025-07-01 16:32:31 INFO     5000 5959
2025-07-01 16:34:48 INFO     >>>>> Generator: Training
2025-07-01 16:34:58 INFO     -------------------------
2025-07-01 16:34:58 INFO     | EM Iteration: 4/5
2025-07-01 16:34:58 INFO     -------------------------
2025-07-01 16:34:58 INFO     >>>>> Using Generator's sample rule
2025-07-01 16:34:58 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 16:34:58 INFO     Predictor: read 1868 rules from list.
2025-07-01 16:34:58 INFO     Preprocess training set
2025-07-01 16:34:58 INFO     >>>>> Predictor: Training
2025-07-01 16:35:46 INFO     1000 5959 8.797650 69332.0
2025-07-01 16:36:34 INFO     2000 5959 8.413761 69349.3
2025-07-01 16:37:21 INFO     3000 5959 8.138882 69340.6
2025-07-01 16:38:10 INFO     4000 5959 7.945543 69297.3
2025-07-01 16:38:57 INFO     5000 5959 7.765101 69219.2
2025-07-01 16:39:42 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 16:39:53 INFO     Data : 2077
2025-07-01 16:39:53 INFO     Hit1 : 0.027925
2025-07-01 16:39:53 INFO     Hit3 : 0.044295
2025-07-01 16:39:53 INFO     Hit10: 0.066442
2025-07-01 16:39:53 INFO     MR   : 1472.727251
2025-07-01 16:39:53 INFO     MRR  : 0.044113
2025-07-01 16:39:53 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 16:40:04 INFO     Data : 2342
2025-07-01 16:40:04 INFO     Hit1 : 0.018360
2025-07-01 16:40:04 INFO     Hit3 : 0.040137
2025-07-01 16:40:04 INFO     Hit10: 0.065756
2025-07-01 16:40:04 INFO     MR   : 1360.370410
2025-07-01 16:40:04 INFO     MRR  : 0.038014
2025-07-01 16:40:04 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 16:42:21 INFO     1000 5959
2025-07-01 16:44:39 INFO     2000 5959
2025-07-01 16:46:56 INFO     3000 5959
2025-07-01 16:49:15 INFO     4000 5959
2025-07-01 16:51:35 INFO     5000 5959
2025-07-01 16:53:49 INFO     >>>>> Generator: Training
2025-07-01 16:53:59 INFO     -------------------------
2025-07-01 16:53:59 INFO     | EM Iteration: 5/5
2025-07-01 16:53:59 INFO     -------------------------
2025-07-01 16:53:59 INFO     >>>>> Using Generator's sample rule
2025-07-01 16:53:59 INFO     >>>>> Generator: Rule generation with sampling
2025-07-01 16:53:59 INFO     Predictor: read 1787 rules from list.
2025-07-01 16:53:59 INFO     Preprocess training set
2025-07-01 16:53:59 INFO     >>>>> Predictor: Training
2025-07-01 16:54:45 INFO     1000 5959 8.798506 69271.3
2025-07-01 16:55:33 INFO     2000 5959 8.424366 69332.0
2025-07-01 16:56:19 INFO     3000 5959 8.178865 69375.3
2025-07-01 16:57:06 INFO     4000 5959 7.991779 69279.9
2025-07-01 16:57:52 INFO     5000 5959 7.871092 69349.3
2025-07-01 16:58:35 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 16:58:45 INFO     Data : 2077
2025-07-01 16:58:45 INFO     Hit1 : 0.025036
2025-07-01 16:58:45 INFO     Hit3 : 0.049109
2025-07-01 16:58:45 INFO     Hit10: 0.091478
2025-07-01 16:58:45 INFO     MR   : 1378.780693
2025-07-01 16:58:45 INFO     MRR  : 0.049847
2025-07-01 16:58:45 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 16:58:55 INFO     Data : 2342
2025-07-01 16:58:55 INFO     Hit1 : 0.026046
2025-07-01 16:58:55 INFO     Hit3 : 0.047395
2025-07-01 16:58:55 INFO     Hit10: 0.087105
2025-07-01 16:58:55 INFO     MR   : 1275.722246
2025-07-01 16:58:55 INFO     MRR  : 0.049381
2025-07-01 16:58:55 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 17:01:11 INFO     1000 5959
2025-07-01 17:03:28 INFO     2000 5959
2025-07-01 17:05:44 INFO     3000 5959
2025-07-01 17:08:03 INFO     4000 5959
2025-07-01 17:10:24 INFO     5000 5959
2025-07-01 17:12:42 INFO     >>>>> Generator: Training
2025-07-01 17:12:51 INFO     -------------------------
2025-07-01 17:12:51 INFO     | Post-train Generator
2025-07-01 17:12:51 INFO     -------------------------
2025-07-01 17:12:53 INFO     >>>>> Generator: Training
2025-07-01 17:14:36 INFO     [E01000] Total 2.798652 | Main 2.458145 | RelClus 1.383210 | EntType 3.524515
2025-07-01 17:14:36 INFO     -------------------------
2025-07-01 17:14:36 INFO     | Beam Search Best Rules
2025-07-01 17:14:36 INFO     -------------------------
2025-07-01 17:14:36 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 17:14:39 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 17:14:59 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 17:20:19 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 17:24:46 INFO     >>>>> Generator: Rule generation with beam search
2025-07-01 17:27:52 INFO     -------------------------
2025-07-01 17:27:52 INFO     | Train Final Predictor+
2025-07-01 17:27:52 INFO     -------------------------
2025-07-01 17:27:52 INFO     Predictor+: read 18420 rules from list.
2025-07-01 17:27:52 INFO     Preprocess training set
2025-07-01 17:27:52 INFO     -------------------------
2025-07-01 17:27:52 INFO     | Iteration: 1/5
2025-07-01 17:27:52 INFO     -------------------------
2025-07-01 17:27:52 INFO     >>>>> Predictor: Training
2025-07-01 17:32:48 INFO     1000 5959 5.276659 69366.7
2025-07-01 17:37:42 INFO     2000 5959 5.078768 69375.3
2025-07-01 17:42:38 INFO     3000 5959 5.047606 69219.2
2025-07-01 17:47:32 INFO     4000 5959 5.050521 69305.9
2025-07-01 17:52:28 INFO     5000 5959 5.010917 69288.6
2025-07-01 17:57:12 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 17:58:25 INFO     Data : 2077
2025-07-01 17:58:25 INFO     Hit1 : 0.077034
2025-07-01 17:58:25 INFO     Hit3 : 0.155994
2025-07-01 17:58:25 INFO     Hit10: 0.258546
2025-07-01 17:58:25 INFO     MR   : 1106.244584
2025-07-01 17:58:25 INFO     MRR  : 0.136279
2025-07-01 17:58:25 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 17:59:48 INFO     Data : 2342
2025-07-01 17:59:48 INFO     Hit1 : 0.105465
2025-07-01 17:59:48 INFO     Hit3 : 0.174637
2025-07-01 17:59:48 INFO     Hit10: 0.251494
2025-07-01 17:59:48 INFO     MR   : 1028.139624
2025-07-01 17:59:48 INFO     MRR  : 0.156525
2025-07-01 17:59:48 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/multitask_mmoe_adaptive_matrix_3_softlabelTrue_schdsamplingFalse_20250701_115940/predictor.pt
2025-07-01 17:59:48 INFO     -------------------------
2025-07-01 17:59:48 INFO     | Iteration: 2/5
2025-07-01 17:59:48 INFO     -------------------------
2025-07-01 17:59:48 INFO     >>>>> Predictor: Training
2025-07-01 18:04:43 INFO     1000 5959 4.982363 69288.6
2025-07-01 18:09:36 INFO     2000 5959 4.992029 69288.6
2025-07-01 18:14:27 INFO     3000 5959 4.967353 69340.6
2025-07-01 18:19:18 INFO     4000 5959 4.969807 69271.3
2025-07-01 18:24:11 INFO     5000 5959 5.002529 69219.2
2025-07-01 18:28:52 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 18:30:04 INFO     Data : 2077
2025-07-01 18:30:04 INFO     Hit1 : 0.085701
2025-07-01 18:30:04 INFO     Hit3 : 0.153105
2025-07-01 18:30:04 INFO     Hit10: 0.248435
2025-07-01 18:30:04 INFO     MR   : 1080.414781
2025-07-01 18:30:04 INFO     MRR  : 0.140236
2025-07-01 18:30:04 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 18:31:23 INFO     Data : 2342
2025-07-01 18:31:23 INFO     Hit1 : 0.097780
2025-07-01 18:31:23 INFO     Hit3 : 0.166097
2025-07-01 18:31:23 INFO     Hit10: 0.257899
2025-07-01 18:31:23 INFO     MR   : 1001.502989
2025-07-01 18:31:23 INFO     MRR  : 0.151143
2025-07-01 18:31:23 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/multitask_mmoe_adaptive_matrix_3_softlabelTrue_schdsamplingFalse_20250701_115940/predictor.pt
2025-07-01 18:31:23 INFO     -------------------------
2025-07-01 18:31:23 INFO     | Iteration: 3/5
2025-07-01 18:31:23 INFO     -------------------------
2025-07-01 18:31:23 INFO     >>>>> Predictor: Training
2025-07-01 18:36:18 INFO     1000 5959 4.936911 69340.6
2025-07-01 18:41:14 INFO     2000 5959 4.923923 69184.5
2025-07-01 18:46:08 INFO     3000 5959 5.007928 69253.9
2025-07-01 18:51:02 INFO     4000 5959 4.968825 69340.6
2025-07-01 18:55:57 INFO     5000 5959 4.954650 69384.0
2025-07-01 19:00:40 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 19:01:52 INFO     Data : 2077
2025-07-01 19:01:52 INFO     Hit1 : 0.074627
2025-07-01 19:01:52 INFO     Hit3 : 0.152624
2025-07-01 19:01:52 INFO     Hit10: 0.248435
2025-07-01 19:01:52 INFO     MR   : 1075.931151
2025-07-01 19:01:52 INFO     MRR  : 0.133040
2025-07-01 19:01:52 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 19:03:12 INFO     Data : 2342
2025-07-01 19:03:12 INFO     Hit1 : 0.101623
2025-07-01 19:03:12 INFO     Hit3 : 0.172075
2025-07-01 19:03:12 INFO     Hit10: 0.261315
2025-07-01 19:03:12 INFO     MR   : 998.679761
2025-07-01 19:03:12 INFO     MRR  : 0.155000
2025-07-01 19:03:12 INFO     -------------------------
2025-07-01 19:03:12 INFO     | Iteration: 4/5
2025-07-01 19:03:12 INFO     -------------------------
2025-07-01 19:03:12 INFO     >>>>> Predictor: Training
2025-07-01 19:08:07 INFO     1000 5959 4.955507 69323.3
2025-07-01 19:13:04 INFO     2000 5959 4.957504 69332.0
2025-07-01 19:17:56 INFO     3000 5959 4.980289 69219.2
2025-07-01 19:22:50 INFO     4000 5959 4.943683 69297.3
2025-07-01 19:27:46 INFO     5000 5959 4.927093 69332.0
2025-07-01 19:32:29 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 19:33:40 INFO     Data : 2077
2025-07-01 19:33:40 INFO     Hit1 : 0.074627
2025-07-01 19:33:40 INFO     Hit3 : 0.148291
2025-07-01 19:33:40 INFO     Hit10: 0.252287
2025-07-01 19:33:40 INFO     MR   : 1057.272027
2025-07-01 19:33:40 INFO     MRR  : 0.132221
2025-07-01 19:33:40 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 19:35:01 INFO     Data : 2342
2025-07-01 19:35:01 INFO     Hit1 : 0.102477
2025-07-01 19:35:01 INFO     Hit3 : 0.167378
2025-07-01 19:35:01 INFO     Hit10: 0.260034
2025-07-01 19:35:01 INFO     MR   : 986.453672
2025-07-01 19:35:01 INFO     MRR  : 0.154188
2025-07-01 19:35:01 INFO     -------------------------
2025-07-01 19:35:01 INFO     | Iteration: 5/5
2025-07-01 19:35:01 INFO     -------------------------
2025-07-01 19:35:01 INFO     >>>>> Predictor: Training
2025-07-01 19:39:58 INFO     1000 5959 4.889819 69245.2
2025-07-01 19:44:53 INFO     2000 5959 4.906405 69262.6
2025-07-01 19:49:45 INFO     3000 5959 4.963901 69332.0
2025-07-01 19:54:39 INFO     4000 5959 4.967538 69366.7
2025-07-01 19:59:32 INFO     5000 5959 4.968113 69262.6
2025-07-01 20:04:14 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 20:05:24 INFO     Data : 2077
2025-07-01 20:05:24 INFO     Hit1 : 0.077034
2025-07-01 20:05:24 INFO     Hit3 : 0.147328
2025-07-01 20:05:24 INFO     Hit10: 0.256620
2025-07-01 20:05:24 INFO     MR   : 1059.064275
2025-07-01 20:05:24 INFO     MRR  : 0.134367
2025-07-01 20:05:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 20:06:46 INFO     Data : 2342
2025-07-01 20:06:46 INFO     Hit1 : 0.106746
2025-07-01 20:06:46 INFO     Hit3 : 0.174210
2025-07-01 20:06:46 INFO     Hit10: 0.262169
2025-07-01 20:06:46 INFO     MR   : 986.455380
2025-07-01 20:06:46 INFO     MRR  : 0.158517
2025-07-01 20:06:46 INFO     -------------------------
2025-07-01 20:06:46 INFO     | Final Test MRR: 0.151143
2025-07-01 20:06:46 INFO     -------------------------
