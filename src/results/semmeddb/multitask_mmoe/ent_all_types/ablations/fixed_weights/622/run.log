2025-07-04 04:11:29 INFO     is_soft_label: False
2025-07-04 04:11:29 INFO     is_scheduled_sampling: False
2025-07-04 04:11:29 INFO     is_test_mode: False
2025-07-04 04:11:30 INFO     Data loading | DONE!
2025-07-04 04:11:30 INFO     Using full datasets for training, validation, and testing.
2025-07-04 04:11:30 INFO     -------------------------
2025-07-04 04:11:30 INFO     | EM Iteration: 1/5
2025-07-04 04:11:30 INFO     -------------------------
2025-07-04 04:11:30 INFO     >>>>> Using miner's rule
2025-07-04 04:11:30 INFO     Predictor: read 13661 rules from list.
2025-07-04 04:11:30 INFO     Preprocess training set
2025-07-04 04:11:30 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 04:13:28 INFO     Data : 2077
2025-07-04 04:13:28 INFO     Hit1 : 0.065479
2025-07-04 04:13:28 INFO     Hit3 : 0.127106
2025-07-04 04:13:28 INFO     Hit10: 0.199326
2025-07-04 04:13:28 INFO     MR   : 1120.902022
2025-07-04 04:13:28 INFO     MRR  : 0.114382
2025-07-04 04:13:28 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 04:15:40 INFO     Data : 2342
2025-07-04 04:15:40 INFO     Hit1 : 0.078992
2025-07-04 04:15:40 INFO     Hit3 : 0.124253
2025-07-04 04:15:40 INFO     Hit10: 0.208796
2025-07-04 04:15:40 INFO     MR   : 1044.269001
2025-07-04 04:15:40 INFO     MRR  : 0.122250
2025-07-04 04:15:40 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 04:52:27 INFO     1000 5959
2025-07-04 05:21:53 INFO     2000 5959
2025-07-04 05:50:46 INFO     3000 5959
2025-07-04 06:19:46 INFO     4000 5959
2025-07-04 06:48:38 INFO     5000 5959
2025-07-04 07:17:37 INFO     >>>>> Generator: Training
2025-07-04 07:17:41 INFO     -------------------------
2025-07-04 07:17:41 INFO     | EM Iteration: 2/5
2025-07-04 07:17:41 INFO     -------------------------
2025-07-04 07:17:41 INFO     >>>>> Using Generator's sample rule
2025-07-04 07:17:41 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 07:17:41 INFO     Predictor: read 1903 rules from list.
2025-07-04 07:17:41 INFO     Preprocess training set
2025-07-04 07:17:41 INFO     >>>>> Predictor: Training
2025-07-04 07:18:28 INFO     1000 5959 8.782210 69314.6
2025-07-04 07:19:14 INFO     2000 5959 8.409706 69271.3
2025-07-04 07:20:00 INFO     3000 5959 8.218299 69245.2
2025-07-04 07:20:47 INFO     4000 5959 8.064764 69340.6
2025-07-04 07:21:32 INFO     5000 5959 7.938838 69340.6
2025-07-04 07:22:17 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 07:22:26 INFO     Data : 2077
2025-07-04 07:22:26 INFO     Hit1 : 0.025036
2025-07-04 07:22:26 INFO     Hit3 : 0.040924
2025-07-04 07:22:26 INFO     Hit10: 0.064035
2025-07-04 07:22:26 INFO     MR   : 1411.181753
2025-07-04 07:22:26 INFO     MRR  : 0.041152
2025-07-04 07:22:26 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 07:22:37 INFO     Data : 2342
2025-07-04 07:22:37 INFO     Hit1 : 0.019641
2025-07-04 07:22:37 INFO     Hit3 : 0.030743
2025-07-04 07:22:37 INFO     Hit10: 0.056362
2025-07-04 07:22:37 INFO     MR   : 1319.817037
2025-07-04 07:22:37 INFO     MRR  : 0.034758
2025-07-04 07:22:37 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 07:24:50 INFO     1000 5959
2025-07-04 07:27:03 INFO     2000 5959
2025-07-04 07:29:16 INFO     3000 5959
2025-07-04 07:31:28 INFO     4000 5959
2025-07-04 07:33:41 INFO     5000 5959
2025-07-04 07:35:50 INFO     >>>>> Generator: Training
2025-07-04 07:35:53 INFO     -------------------------
2025-07-04 07:35:53 INFO     | EM Iteration: 3/5
2025-07-04 07:35:53 INFO     -------------------------
2025-07-04 07:35:53 INFO     >>>>> Using Generator's sample rule
2025-07-04 07:35:53 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 07:35:53 INFO     Predictor: read 1878 rules from list.
2025-07-04 07:35:53 INFO     Preprocess training set
2025-07-04 07:35:53 INFO     >>>>> Predictor: Training
2025-07-04 07:36:38 INFO     1000 5959 8.809555 69332.0
2025-07-04 07:37:24 INFO     2000 5959 8.468312 69349.3
2025-07-04 07:38:11 INFO     3000 5959 8.252925 69184.5
2025-07-04 07:38:57 INFO     4000 5959 8.079304 69253.9
2025-07-04 07:39:42 INFO     5000 5959 7.982614 69332.0
2025-07-04 07:40:26 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 07:40:35 INFO     Data : 2077
2025-07-04 07:40:35 INFO     Hit1 : 0.010592
2025-07-04 07:40:35 INFO     Hit3 : 0.025999
2025-07-04 07:40:35 INFO     Hit10: 0.051035
2025-07-04 07:40:35 INFO     MR   : 1449.370005
2025-07-04 07:40:35 INFO     MRR  : 0.026789
2025-07-04 07:40:35 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 07:40:46 INFO     Data : 2342
2025-07-04 07:40:46 INFO     Hit1 : 0.014091
2025-07-04 07:40:46 INFO     Hit3 : 0.024765
2025-07-04 07:40:46 INFO     Hit10: 0.047395
2025-07-04 07:40:46 INFO     MR   : 1339.205167
2025-07-04 07:40:46 INFO     MRR  : 0.027998
2025-07-04 07:40:46 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 07:42:58 INFO     1000 5959
2025-07-04 07:45:09 INFO     2000 5959
2025-07-04 07:47:22 INFO     3000 5959
2025-07-04 07:49:36 INFO     4000 5959
2025-07-04 07:51:50 INFO     5000 5959
2025-07-04 07:54:00 INFO     >>>>> Generator: Training
2025-07-04 07:54:04 INFO     -------------------------
2025-07-04 07:54:04 INFO     | EM Iteration: 4/5
2025-07-04 07:54:04 INFO     -------------------------
2025-07-04 07:54:04 INFO     >>>>> Using Generator's sample rule
2025-07-04 07:54:04 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 07:54:04 INFO     Predictor: read 1842 rules from list.
2025-07-04 07:54:04 INFO     Preprocess training set
2025-07-04 07:54:04 INFO     >>>>> Predictor: Training
2025-07-04 07:54:48 INFO     1000 5959 8.791231 69271.3
2025-07-04 07:55:33 INFO     2000 5959 8.405759 69340.6
2025-07-04 07:56:17 INFO     3000 5959 8.141125 69384.0
2025-07-04 07:57:01 INFO     4000 5959 7.967495 69262.6
2025-07-04 07:57:45 INFO     5000 5959 7.824348 69332.0
2025-07-04 07:58:28 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 07:58:37 INFO     Data : 2077
2025-07-04 07:58:37 INFO     Hit1 : 0.006259
2025-07-04 07:58:37 INFO     Hit3 : 0.018296
2025-07-04 07:58:37 INFO     Hit10: 0.036110
2025-07-04 07:58:37 INFO     MR   : 1484.686326
2025-07-04 07:58:37 INFO     MRR  : 0.019674
2025-07-04 07:58:37 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 07:58:47 INFO     Data : 2342
2025-07-04 07:58:47 INFO     Hit1 : 0.008540
2025-07-04 07:58:47 INFO     Hit3 : 0.018787
2025-07-04 07:58:47 INFO     Hit10: 0.035440
2025-07-04 07:58:47 INFO     MR   : 1370.870410
2025-07-04 07:58:47 INFO     MRR  : 0.020698
2025-07-04 07:58:47 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 08:00:56 INFO     1000 5959
2025-07-04 08:03:05 INFO     2000 5959
2025-07-04 08:05:14 INFO     3000 5959
2025-07-04 08:07:23 INFO     4000 5959
2025-07-04 08:09:32 INFO     5000 5959
2025-07-04 08:11:39 INFO     >>>>> Generator: Training
2025-07-04 08:11:43 INFO     -------------------------
2025-07-04 08:11:43 INFO     | EM Iteration: 5/5
2025-07-04 08:11:43 INFO     -------------------------
2025-07-04 08:11:43 INFO     >>>>> Using Generator's sample rule
2025-07-04 08:11:43 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 08:11:43 INFO     Predictor: read 1663 rules from list.
2025-07-04 08:11:43 INFO     Preprocess training set
2025-07-04 08:11:43 INFO     >>>>> Predictor: Training
2025-07-04 08:12:22 INFO     1000 5959 8.752371 69332.0
2025-07-04 08:13:01 INFO     2000 5959 8.276331 69349.3
2025-07-04 08:13:40 INFO     3000 5959 7.918487 69340.6
2025-07-04 08:14:19 INFO     4000 5959 7.653452 69297.3
2025-07-04 08:14:58 INFO     5000 5959 7.406085 69219.2
2025-07-04 08:15:35 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 08:15:43 INFO     Data : 2077
2025-07-04 08:15:43 INFO     Hit1 : 0.034184
2025-07-04 08:15:43 INFO     Hit3 : 0.060664
2025-07-04 08:15:43 INFO     Hit10: 0.101589
2025-07-04 08:15:43 INFO     MR   : 1411.722195
2025-07-04 08:15:43 INFO     MRR  : 0.059071
2025-07-04 08:15:43 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 08:15:53 INFO     Data : 2342
2025-07-04 08:15:53 INFO     Hit1 : 0.034586
2025-07-04 08:15:53 INFO     Hit3 : 0.058924
2025-07-04 08:15:53 INFO     Hit10: 0.098207
2025-07-04 08:15:53 INFO     MR   : 1312.273698
2025-07-04 08:15:53 INFO     MRR  : 0.058527
2025-07-04 08:15:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 08:17:49 INFO     1000 5959
2025-07-04 08:19:46 INFO     2000 5959
2025-07-04 08:21:45 INFO     3000 5959
2025-07-04 08:23:43 INFO     4000 5959
2025-07-04 08:25:42 INFO     5000 5959
2025-07-04 08:27:40 INFO     >>>>> Generator: Training
2025-07-04 08:27:43 INFO     -------------------------
2025-07-04 08:27:43 INFO     | Post-train Generator
2025-07-04 08:27:43 INFO     -------------------------
2025-07-04 08:27:44 INFO     >>>>> Generator: Training
2025-07-04 08:28:22 INFO     [E01000] Total 2.362577 | Main 2.545499 | RelClus 0.872888 | 
2025-07-04 08:28:22 INFO     -------------------------
2025-07-04 08:28:22 INFO     | Beam Search Best Rules
2025-07-04 08:28:22 INFO     -------------------------
2025-07-04 08:28:22 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 08:28:23 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 08:28:28 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 08:29:31 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 08:30:22 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 08:30:58 INFO     -------------------------
2025-07-04 08:30:58 INFO     | Train Final Predictor+
2025-07-04 08:30:58 INFO     -------------------------
2025-07-04 08:30:58 INFO     Predictor+: read 18420 rules from list.
2025-07-04 08:30:58 INFO     Preprocess training set
2025-07-04 08:30:58 INFO     -------------------------
2025-07-04 08:30:58 INFO     | Iteration: 1/5
2025-07-04 08:30:58 INFO     -------------------------
2025-07-04 08:30:58 INFO     >>>>> Predictor: Training
2025-07-04 08:35:24 INFO     1000 5959 5.002959 69271.3
2025-07-04 08:39:50 INFO     2000 5959 4.798700 69332.0
2025-07-04 08:44:16 INFO     3000 5959 4.782155 69375.3
2025-07-04 08:48:43 INFO     4000 5959 4.773068 69279.9
2025-07-04 08:53:10 INFO     5000 5959 4.741598 69349.3
2025-07-04 08:57:26 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 08:58:32 INFO     Data : 2077
2025-07-04 08:58:32 INFO     Hit1 : 0.099663
2025-07-04 08:58:32 INFO     Hit3 : 0.191623
2025-07-04 08:58:32 INFO     Hit10: 0.316322
2025-07-04 08:58:32 INFO     MR   : 992.093885
2025-07-04 08:58:32 INFO     MRR  : 0.169926
2025-07-04 08:58:32 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 08:59:46 INFO     Data : 2342
2025-07-04 08:59:46 INFO     Hit1 : 0.129804
2025-07-04 08:59:46 INFO     Hit3 : 0.210077
2025-07-04 08:59:46 INFO     Hit10: 0.314688
2025-07-04 08:59:46 INFO     MR   : 919.626815
2025-07-04 08:59:46 INFO     MRR  : 0.191543
2025-07-04 08:59:46 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/622_multitask_mmoe_fixed_matrix_3_type_20250704_041128/predictor.pt
2025-07-04 08:59:46 INFO     -------------------------
2025-07-04 08:59:46 INFO     | Iteration: 2/5
2025-07-04 08:59:46 INFO     -------------------------
2025-07-04 08:59:46 INFO     >>>>> Predictor: Training
2025-07-04 09:04:14 INFO     1000 5959 4.672037 69366.7
2025-07-04 09:08:47 INFO     2000 5959 4.709830 69375.3
2025-07-04 09:13:20 INFO     3000 5959 4.685338 69219.2
2025-07-04 09:17:52 INFO     4000 5959 4.713927 69305.9
2025-07-04 09:22:23 INFO     5000 5959 4.694661 69288.6
2025-07-04 09:26:47 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 09:27:54 INFO     Data : 2077
2025-07-04 09:27:54 INFO     Hit1 : 0.097256
2025-07-04 09:27:54 INFO     Hit3 : 0.193067
2025-07-04 09:27:54 INFO     Hit10: 0.313433
2025-07-04 09:27:54 INFO     MR   : 957.333654
2025-07-04 09:27:54 INFO     MRR  : 0.168642
2025-07-04 09:27:54 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 09:29:11 INFO     Data : 2342
2025-07-04 09:29:11 INFO     Hit1 : 0.124253
2025-07-04 09:29:11 INFO     Hit3 : 0.212639
2025-07-04 09:29:11 INFO     Hit10: 0.322374
2025-07-04 09:29:11 INFO     MR   : 888.254697
2025-07-04 09:29:11 INFO     MRR  : 0.190255
2025-07-04 09:29:11 INFO     -------------------------
2025-07-04 09:29:11 INFO     | Iteration: 3/5
2025-07-04 09:29:11 INFO     -------------------------
2025-07-04 09:29:11 INFO     >>>>> Predictor: Training
2025-07-04 09:33:45 INFO     1000 5959 4.674924 69288.6
2025-07-04 09:38:17 INFO     2000 5959 4.683298 69288.6
2025-07-04 09:42:48 INFO     3000 5959 4.673406 69340.6
2025-07-04 09:47:20 INFO     4000 5959 4.670574 69271.3
2025-07-04 09:51:57 INFO     5000 5959 4.708977 69219.2
2025-07-04 09:56:18 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 09:57:24 INFO     Data : 2077
2025-07-04 09:57:24 INFO     Hit1 : 0.084738
2025-07-04 09:57:24 INFO     Hit3 : 0.172845
2025-07-04 09:57:24 INFO     Hit10: 0.302841
2025-07-04 09:57:24 INFO     MR   : 952.930669
2025-07-04 09:57:24 INFO     MRR  : 0.155022
2025-07-04 09:57:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 09:58:39 INFO     Data : 2342
2025-07-04 09:58:39 INFO     Hit1 : 0.114432
2025-07-04 09:58:39 INFO     Hit3 : 0.190863
2025-07-04 09:58:39 INFO     Hit10: 0.313407
2025-07-04 09:58:39 INFO     MR   : 874.363792
2025-07-04 09:58:39 INFO     MRR  : 0.177438
2025-07-04 09:58:39 INFO     -------------------------
2025-07-04 09:58:39 INFO     | Iteration: 4/5
2025-07-04 09:58:39 INFO     -------------------------
2025-07-04 09:58:39 INFO     >>>>> Predictor: Training
2025-07-04 10:03:12 INFO     1000 5959 4.646088 69340.6
2025-07-04 10:07:44 INFO     2000 5959 4.621563 69184.5
2025-07-04 10:12:15 INFO     3000 5959 4.699522 69253.9
2025-07-04 10:16:46 INFO     4000 5959 4.667551 69340.6
2025-07-04 10:21:16 INFO     5000 5959 4.660270 69384.0
2025-07-04 10:25:36 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 10:26:42 INFO     Data : 2077
2025-07-04 10:26:42 INFO     Hit1 : 0.095811
2025-07-04 10:26:42 INFO     Hit3 : 0.183438
2025-07-04 10:26:42 INFO     Hit10: 0.310544
2025-07-04 10:26:42 INFO     MR   : 943.856524
2025-07-04 10:26:42 INFO     MRR  : 0.164806
2025-07-04 10:26:42 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 10:27:57 INFO     Data : 2342
2025-07-04 10:27:57 INFO     Hit1 : 0.121264
2025-07-04 10:27:57 INFO     Hit3 : 0.208369
2025-07-04 10:27:57 INFO     Hit10: 0.324509
2025-07-04 10:27:57 INFO     MR   : 869.306576
2025-07-04 10:27:57 INFO     MRR  : 0.188560
2025-07-04 10:27:57 INFO     -------------------------
2025-07-04 10:27:57 INFO     | Iteration: 5/5
2025-07-04 10:27:57 INFO     -------------------------
2025-07-04 10:27:57 INFO     >>>>> Predictor: Training
2025-07-04 10:32:27 INFO     1000 5959 4.659354 69323.3
2025-07-04 10:36:59 INFO     2000 5959 4.648583 69332.0
2025-07-04 10:41:31 INFO     3000 5959 4.687688 69219.2
2025-07-04 10:46:03 INFO     4000 5959 4.656487 69297.3
2025-07-04 10:50:37 INFO     5000 5959 4.641484 69332.0
2025-07-04 10:54:59 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 10:56:06 INFO     Data : 2077
2025-07-04 10:56:06 INFO     Hit1 : 0.087626
2025-07-04 10:56:06 INFO     Hit3 : 0.181512
2025-07-04 10:56:06 INFO     Hit10: 0.309100
2025-07-04 10:56:06 INFO     MR   : 938.081608
2025-07-04 10:56:06 INFO     MRR  : 0.159259
2025-07-04 10:56:06 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 10:57:21 INFO     Data : 2342
2025-07-04 10:57:21 INFO     Hit1 : 0.117848
2025-07-04 10:57:21 INFO     Hit3 : 0.205380
2025-07-04 10:57:21 INFO     Hit10: 0.320239
2025-07-04 10:57:21 INFO     MR   : 861.456234
2025-07-04 10:57:21 INFO     MRR  : 0.184402
2025-07-04 10:57:21 INFO     -------------------------
2025-07-04 10:57:21 INFO     | Final Test MRR: 0.191543
2025-07-04 10:57:21 INFO     -------------------------
