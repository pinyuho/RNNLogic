2025-07-04 13:38:11 INFO     is_soft_label: False
2025-07-04 13:38:11 INFO     is_scheduled_sampling: False
2025-07-04 13:38:11 INFO     is_test_mode: False
2025-07-04 13:38:11 INFO     Data loading | DONE!
2025-07-04 13:38:11 INFO     Using full datasets for training, validation, and testing.
2025-07-04 13:38:11 INFO     -------------------------
2025-07-04 13:38:11 INFO     | EM Iteration: 1/5
2025-07-04 13:38:11 INFO     -------------------------
2025-07-04 13:38:11 INFO     >>>>> Using miner's rule
2025-07-04 13:38:12 INFO     Predictor: read 13661 rules from list.
2025-07-04 13:38:12 INFO     Preprocess training set
2025-07-04 13:38:12 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 13:40:06 INFO     Data : 2077
2025-07-04 13:40:06 INFO     Hit1 : 0.065479
2025-07-04 13:40:06 INFO     Hit3 : 0.127106
2025-07-04 13:40:06 INFO     Hit10: 0.199326
2025-07-04 13:40:06 INFO     MR   : 1120.902022
2025-07-04 13:40:06 INFO     MRR  : 0.114382
2025-07-04 13:40:06 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 13:42:15 INFO     Data : 2342
2025-07-04 13:42:15 INFO     Hit1 : 0.078992
2025-07-04 13:42:15 INFO     Hit3 : 0.124253
2025-07-04 13:42:15 INFO     Hit10: 0.208796
2025-07-04 13:42:15 INFO     MR   : 1044.269001
2025-07-04 13:42:15 INFO     MRR  : 0.122250
2025-07-04 13:42:15 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 14:11:19 INFO     1000 5959
2025-07-04 14:43:26 INFO     2000 5959
2025-07-04 15:16:45 INFO     3000 5959
2025-07-04 15:50:27 INFO     4000 5959
2025-07-04 16:24:46 INFO     5000 5959
2025-07-04 17:03:40 INFO     >>>>> Generator: Training
2025-07-04 17:03:45 INFO     -------------------------
2025-07-04 17:03:45 INFO     | EM Iteration: 2/5
2025-07-04 17:03:45 INFO     -------------------------
2025-07-04 17:03:45 INFO     >>>>> Using Generator's sample rule
2025-07-04 17:03:45 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 17:03:45 INFO     Predictor: read 1903 rules from list.
2025-07-04 17:03:45 INFO     Preprocess training set
2025-07-04 17:03:45 INFO     >>>>> Predictor: Training
2025-07-04 17:04:42 INFO     1000 5959 8.782210 69314.6
2025-07-04 17:05:37 INFO     2000 5959 8.409706 69271.3
2025-07-04 17:06:33 INFO     3000 5959 8.218299 69245.2
2025-07-04 17:07:28 INFO     4000 5959 8.064764 69340.6
2025-07-04 17:08:23 INFO     5000 5959 7.938838 69340.6
2025-07-04 17:09:17 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 17:09:29 INFO     Data : 2077
2025-07-04 17:09:29 INFO     Hit1 : 0.025036
2025-07-04 17:09:29 INFO     Hit3 : 0.040924
2025-07-04 17:09:29 INFO     Hit10: 0.064035
2025-07-04 17:09:29 INFO     MR   : 1411.181753
2025-07-04 17:09:29 INFO     MRR  : 0.041152
2025-07-04 17:09:29 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 17:09:41 INFO     Data : 2342
2025-07-04 17:09:41 INFO     Hit1 : 0.019641
2025-07-04 17:09:41 INFO     Hit3 : 0.030743
2025-07-04 17:09:41 INFO     Hit10: 0.056362
2025-07-04 17:09:41 INFO     MR   : 1319.817037
2025-07-04 17:09:41 INFO     MRR  : 0.034758
2025-07-04 17:09:41 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 17:12:44 INFO     1000 5959
2025-07-04 17:16:58 INFO     2000 5959
2025-07-04 17:21:14 INFO     3000 5959
2025-07-04 17:25:29 INFO     4000 5959
2025-07-04 17:28:17 INFO     5000 5959
2025-07-04 17:32:37 INFO     >>>>> Generator: Training
2025-07-04 17:32:44 INFO     -------------------------
2025-07-04 17:32:44 INFO     | EM Iteration: 3/5
2025-07-04 17:32:44 INFO     -------------------------
2025-07-04 17:32:44 INFO     >>>>> Using Generator's sample rule
2025-07-04 17:32:44 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 17:32:44 INFO     Predictor: read 1878 rules from list.
2025-07-04 17:32:44 INFO     Preprocess training set
2025-07-04 17:32:44 INFO     >>>>> Predictor: Training
2025-07-04 17:34:10 INFO     1000 5959 8.809555 69332.0
2025-07-04 17:35:38 INFO     2000 5959 8.468312 69349.3
2025-07-04 17:37:07 INFO     3000 5959 8.252925 69184.5
2025-07-04 17:38:37 INFO     4000 5959 8.079304 69253.9
2025-07-04 17:40:04 INFO     5000 5959 7.982614 69332.0
2025-07-04 17:41:30 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 17:41:48 INFO     Data : 2077
2025-07-04 17:41:48 INFO     Hit1 : 0.010592
2025-07-04 17:41:48 INFO     Hit3 : 0.025999
2025-07-04 17:41:48 INFO     Hit10: 0.051035
2025-07-04 17:41:48 INFO     MR   : 1449.370005
2025-07-04 17:41:48 INFO     MRR  : 0.026789
2025-07-04 17:41:48 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 17:42:08 INFO     Data : 2342
2025-07-04 17:42:08 INFO     Hit1 : 0.014091
2025-07-04 17:42:08 INFO     Hit3 : 0.024765
2025-07-04 17:42:08 INFO     Hit10: 0.047395
2025-07-04 17:42:08 INFO     MR   : 1339.205167
2025-07-04 17:42:08 INFO     MRR  : 0.027998
2025-07-04 17:42:08 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 17:46:19 INFO     1000 5959
2025-07-04 17:50:50 INFO     2000 5959
2025-07-04 17:55:11 INFO     3000 5959
2025-07-04 17:59:30 INFO     4000 5959
2025-07-04 18:02:46 INFO     5000 5959
2025-07-04 18:05:23 INFO     >>>>> Generator: Training
2025-07-04 18:05:28 INFO     -------------------------
2025-07-04 18:05:28 INFO     | EM Iteration: 4/5
2025-07-04 18:05:28 INFO     -------------------------
2025-07-04 18:05:28 INFO     >>>>> Using Generator's sample rule
2025-07-04 18:05:28 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 18:05:29 INFO     Predictor: read 1842 rules from list.
2025-07-04 18:05:29 INFO     Preprocess training set
2025-07-04 18:05:29 INFO     >>>>> Predictor: Training
2025-07-04 18:06:25 INFO     1000 5959 8.791231 69271.3
2025-07-04 18:07:20 INFO     2000 5959 8.405759 69340.6
2025-07-04 18:08:15 INFO     3000 5959 8.141125 69384.0
2025-07-04 18:09:41 INFO     4000 5959 7.967495 69262.6
2025-07-04 18:11:24 INFO     5000 5959 7.824348 69332.0
2025-07-04 18:12:48 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 18:13:06 INFO     Data : 2077
2025-07-04 18:13:06 INFO     Hit1 : 0.006259
2025-07-04 18:13:06 INFO     Hit3 : 0.018296
2025-07-04 18:13:06 INFO     Hit10: 0.036110
2025-07-04 18:13:06 INFO     MR   : 1484.686326
2025-07-04 18:13:06 INFO     MRR  : 0.019674
2025-07-04 18:13:06 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 18:13:26 INFO     Data : 2342
2025-07-04 18:13:26 INFO     Hit1 : 0.008540
2025-07-04 18:13:26 INFO     Hit3 : 0.018787
2025-07-04 18:13:26 INFO     Hit10: 0.035440
2025-07-04 18:13:26 INFO     MR   : 1370.870410
2025-07-04 18:13:26 INFO     MRR  : 0.020698
2025-07-04 18:13:26 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 18:17:36 INFO     1000 5959
2025-07-04 18:21:51 INFO     2000 5959
2025-07-04 18:26:04 INFO     3000 5959
2025-07-04 18:30:20 INFO     4000 5959
2025-07-04 18:33:44 INFO     5000 5959
2025-07-04 18:36:23 INFO     >>>>> Generator: Training
2025-07-04 18:36:28 INFO     -------------------------
2025-07-04 18:36:28 INFO     | EM Iteration: 5/5
2025-07-04 18:36:28 INFO     -------------------------
2025-07-04 18:36:28 INFO     >>>>> Using Generator's sample rule
2025-07-04 18:36:28 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 18:36:28 INFO     Predictor: read 1663 rules from list.
2025-07-04 18:36:28 INFO     Preprocess training set
2025-07-04 18:36:28 INFO     >>>>> Predictor: Training
2025-07-04 18:37:15 INFO     1000 5959 8.752371 69332.0
2025-07-04 18:38:04 INFO     2000 5959 8.276331 69349.3
2025-07-04 18:38:52 INFO     3000 5959 7.918487 69340.6
2025-07-04 18:39:40 INFO     4000 5959 7.653452 69297.3
2025-07-04 18:40:29 INFO     5000 5959 7.406085 69219.2
2025-07-04 18:41:15 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 18:41:25 INFO     Data : 2077
2025-07-04 18:41:25 INFO     Hit1 : 0.034184
2025-07-04 18:41:25 INFO     Hit3 : 0.060664
2025-07-04 18:41:25 INFO     Hit10: 0.101589
2025-07-04 18:41:25 INFO     MR   : 1411.722195
2025-07-04 18:41:25 INFO     MRR  : 0.059071
2025-07-04 18:41:25 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 18:41:36 INFO     Data : 2342
2025-07-04 18:41:36 INFO     Hit1 : 0.034586
2025-07-04 18:41:36 INFO     Hit3 : 0.058924
2025-07-04 18:41:36 INFO     Hit10: 0.098207
2025-07-04 18:41:36 INFO     MR   : 1312.273698
2025-07-04 18:41:36 INFO     MRR  : 0.058527
2025-07-04 18:41:36 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 18:44:00 INFO     1000 5959
2025-07-04 18:46:26 INFO     2000 5959
2025-07-04 18:48:49 INFO     3000 5959
2025-07-04 18:56:35 INFO     4000 5959
2025-07-04 19:06:30 INFO     5000 5959
2025-07-04 19:08:50 INFO     >>>>> Generator: Training
2025-07-04 19:08:55 INFO     -------------------------
2025-07-04 19:08:55 INFO     | Post-train Generator
2025-07-04 19:08:55 INFO     -------------------------
2025-07-04 19:08:56 INFO     >>>>> Generator: Training
2025-07-04 19:09:37 INFO     [E01000] Total 2.362577 | Main 2.545499 | RelClus 0.872888 | 
2025-07-04 19:09:37 INFO     -------------------------
2025-07-04 19:09:37 INFO     | Beam Search Best Rules
2025-07-04 19:09:37 INFO     -------------------------
2025-07-04 19:09:37 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:09:38 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:09:43 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:10:49 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:11:42 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:12:20 INFO     -------------------------
2025-07-04 19:12:20 INFO     | Train Final Predictor+
2025-07-04 19:12:20 INFO     -------------------------
2025-07-04 19:12:20 INFO     Predictor+: read 18420 rules from list.
2025-07-04 19:12:20 INFO     Preprocess training set
2025-07-04 19:12:20 INFO     -------------------------
2025-07-04 19:12:20 INFO     | Iteration: 1/5
2025-07-04 19:12:20 INFO     -------------------------
2025-07-04 19:12:20 INFO     >>>>> Predictor: Training
2025-07-04 19:17:44 INFO     1000 5959 5.002724 69271.3
2025-07-04 19:23:07 INFO     2000 5959 4.798958 69332.0
2025-07-04 19:28:30 INFO     3000 5959 4.782289 69375.3
2025-07-04 19:33:52 INFO     4000 5959 4.773126 69279.9
2025-07-04 19:39:15 INFO     5000 5959 4.740989 69349.3
2025-07-04 19:44:27 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 19:45:47 INFO     Data : 2077
2025-07-04 19:45:47 INFO     Hit1 : 0.098700
2025-07-04 19:45:47 INFO     Hit3 : 0.190178
2025-07-04 19:45:47 INFO     Hit10: 0.314396
2025-07-04 19:45:47 INFO     MR   : 991.999759
2025-07-04 19:45:47 INFO     MRR  : 0.168556
2025-07-04 19:45:47 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 19:47:15 INFO     Data : 2342
2025-07-04 19:47:15 INFO     Hit1 : 0.126815
2025-07-04 19:47:15 INFO     Hit3 : 0.204953
2025-07-04 19:47:15 INFO     Hit10: 0.314261
2025-07-04 19:47:15 INFO     MR   : 918.263023
2025-07-04 19:47:15 INFO     MRR  : 0.189011
2025-07-04 19:47:15 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/333_multitask_mmoe_fixed_matrix_3_type_20250704_133810/predictor.pt
2025-07-04 19:47:15 INFO     -------------------------
2025-07-04 19:47:15 INFO     | Iteration: 2/5
2025-07-04 19:47:15 INFO     -------------------------
2025-07-04 19:47:15 INFO     >>>>> Predictor: Training
2025-07-04 19:52:39 INFO     1000 5959 4.673906 69366.7
2025-07-04 19:58:07 INFO     2000 5959 4.710335 69375.3
2025-07-04 20:03:31 INFO     3000 5959 4.685618 69219.2
2025-07-04 20:08:52 INFO     4000 5959 4.712501 69305.9
2025-07-04 20:14:12 INFO     5000 5959 4.695301 69288.6
2025-07-04 20:19:21 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 20:20:39 INFO     Data : 2077
2025-07-04 20:20:39 INFO     Hit1 : 0.093885
2025-07-04 20:20:39 INFO     Hit3 : 0.189697
2025-07-04 20:20:39 INFO     Hit10: 0.312951
2025-07-04 20:20:39 INFO     MR   : 959.322340
2025-07-04 20:20:39 INFO     MRR  : 0.164848
2025-07-04 20:20:39 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 20:22:08 INFO     Data : 2342
2025-07-04 20:22:08 INFO     Hit1 : 0.123826
2025-07-04 20:22:08 INFO     Hit3 : 0.210077
2025-07-04 20:22:08 INFO     Hit10: 0.321947
2025-07-04 20:22:08 INFO     MR   : 887.450683
2025-07-04 20:22:08 INFO     MRR  : 0.189433
2025-07-04 20:22:08 INFO     -------------------------
2025-07-04 20:22:08 INFO     | Iteration: 3/5
2025-07-04 20:22:08 INFO     -------------------------
2025-07-04 20:22:08 INFO     >>>>> Predictor: Training
2025-07-04 20:27:28 INFO     1000 5959 4.675960 69288.6
2025-07-04 20:32:50 INFO     2000 5959 4.683715 69288.6
2025-07-04 20:38:15 INFO     3000 5959 4.673704 69340.6
2025-07-04 20:43:35 INFO     4000 5959 4.670155 69271.3
2025-07-04 20:48:55 INFO     5000 5959 4.707703 69219.2
2025-07-04 20:54:05 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 20:55:22 INFO     Data : 2077
2025-07-04 20:55:22 INFO     Hit1 : 0.085701
2025-07-04 20:55:22 INFO     Hit3 : 0.169475
2025-07-04 20:55:22 INFO     Hit10: 0.295619
2025-07-04 20:55:22 INFO     MR   : 952.467501
2025-07-04 20:55:22 INFO     MRR  : 0.155013
2025-07-04 20:55:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 20:56:50 INFO     Data : 2342
2025-07-04 20:56:50 INFO     Hit1 : 0.106746
2025-07-04 20:56:50 INFO     Hit3 : 0.189155
2025-07-04 20:56:50 INFO     Hit10: 0.309137
2025-07-04 20:56:50 INFO     MR   : 879.381298
2025-07-04 20:56:50 INFO     MRR  : 0.171968
2025-07-04 20:56:50 INFO     -------------------------
2025-07-04 20:56:50 INFO     | Iteration: 4/5
2025-07-04 20:56:50 INFO     -------------------------
2025-07-04 20:56:50 INFO     >>>>> Predictor: Training
2025-07-04 21:02:16 INFO     1000 5959 4.644195 69340.6
2025-07-04 21:07:40 INFO     2000 5959 4.622256 69184.5
2025-07-04 21:13:03 INFO     3000 5959 4.697751 69253.9
2025-07-04 21:19:14 INFO     4000 5959 4.666091 69340.6
2025-07-04 21:26:50 INFO     5000 5959 4.660379 69384.0
2025-07-04 21:32:43 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 21:34:02 INFO     Data : 2077
2025-07-04 21:34:02 INFO     Hit1 : 0.096293
2025-07-04 21:34:02 INFO     Hit3 : 0.178623
2025-07-04 21:34:02 INFO     Hit10: 0.304766
2025-07-04 21:34:02 INFO     MR   : 944.725566
2025-07-04 21:34:02 INFO     MRR  : 0.164081
2025-07-04 21:34:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 21:35:33 INFO     Data : 2342
2025-07-04 21:35:33 INFO     Hit1 : 0.115713
2025-07-04 21:35:33 INFO     Hit3 : 0.205807
2025-07-04 21:35:33 INFO     Hit10: 0.319385
2025-07-04 21:35:33 INFO     MR   : 876.818318
2025-07-04 21:35:33 INFO     MRR  : 0.183502
2025-07-04 21:35:33 INFO     -------------------------
2025-07-04 21:35:33 INFO     | Iteration: 5/5
2025-07-04 21:35:33 INFO     -------------------------
2025-07-04 21:35:33 INFO     >>>>> Predictor: Training
2025-07-04 21:40:59 INFO     1000 5959 4.659269 69323.3
2025-07-04 21:46:23 INFO     2000 5959 4.647067 69332.0
2025-07-04 21:51:46 INFO     3000 5959 4.686932 69219.2
2025-07-04 21:57:10 INFO     4000 5959 4.657322 69297.3
2025-07-04 22:02:34 INFO     5000 5959 4.639722 69332.0
2025-07-04 22:07:41 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 22:09:00 INFO     Data : 2077
2025-07-04 22:09:00 INFO     Hit1 : 0.091478
2025-07-04 22:09:00 INFO     Hit3 : 0.185364
2025-07-04 22:09:00 INFO     Hit10: 0.312470
2025-07-04 22:09:00 INFO     MR   : 938.364468
2025-07-04 22:09:00 INFO     MRR  : 0.163015
2025-07-04 22:09:00 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 22:10:27 INFO     Data : 2342
2025-07-04 22:10:27 INFO     Hit1 : 0.122545
2025-07-04 22:10:27 INFO     Hit3 : 0.197694
2025-07-04 22:10:27 INFO     Hit10: 0.319385
2025-07-04 22:10:27 INFO     MR   : 866.935312
2025-07-04 22:10:27 INFO     MRR  : 0.185979
2025-07-04 22:10:27 INFO     -------------------------
2025-07-04 22:10:27 INFO     | Final Test MRR: 0.189011
2025-07-04 22:10:27 INFO     -------------------------
