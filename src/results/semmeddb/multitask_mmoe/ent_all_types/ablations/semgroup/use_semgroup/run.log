2025-07-01 22:19:13 INFO     is_soft_label: False
2025-07-01 22:19:13 INFO     is_scheduled_sampling: False
2025-07-01 22:19:13 INFO     is_test_mode: False
2025-07-01 22:19:14 INFO     Data loading | DONE!
2025-07-01 22:19:14 INFO     Using full datasets for training, validation, and testing.
2025-07-01 22:19:14 INFO     -------------------------
2025-07-01 22:19:14 INFO     | EM Iteration: 1/5
2025-07-01 22:19:14 INFO     -------------------------
2025-07-01 22:19:14 INFO     >>>>> Using miner's rule
2025-07-01 22:19:14 INFO     Predictor: read 13661 rules from list.
2025-07-01 22:19:15 INFO     Preprocess training set
2025-07-01 22:19:15 INFO     >>>>> Predictor: Training
2025-07-01 22:28:20 INFO     1000 5959 8.299284 69314.6
2025-07-01 22:37:17 INFO     2000 5959 7.689227 69271.3
2025-07-01 22:45:59 INFO     3000 5959 7.425850 69245.2
2025-07-01 22:54:48 INFO     4000 5959 7.285955 69340.6
2025-07-01 23:02:31 INFO     5000 5959 7.136692 69340.6
2025-07-01 23:09:58 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 23:11:53 INFO     Data : 2077
2025-07-01 23:11:53 INFO     Hit1 : 0.065479
2025-07-01 23:11:53 INFO     Hit3 : 0.127106
2025-07-01 23:11:53 INFO     Hit10: 0.199326
2025-07-01 23:11:53 INFO     MR   : 1120.920077
2025-07-01 23:11:53 INFO     MRR  : 0.114382
2025-07-01 23:11:53 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 23:14:04 INFO     Data : 2342
2025-07-01 23:14:04 INFO     Hit1 : 0.078992
2025-07-01 23:14:04 INFO     Hit3 : 0.124253
2025-07-01 23:14:04 INFO     Hit10: 0.208796
2025-07-01 23:14:04 INFO     MR   : 1044.279889
2025-07-01 23:14:04 INFO     MRR  : 0.122250
2025-07-01 23:14:04 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 23:46:32 INFO     1000 5959
2025-07-02 00:21:08 INFO     2000 5959
2025-07-02 00:54:50 INFO     3000 5959
2025-07-02 01:28:44 INFO     4000 5959
2025-07-02 02:03:01 INFO     5000 5959
2025-07-02 02:37:44 INFO     >>>>> Generator: Training
2025-07-02 02:37:47 INFO     -------------------------
2025-07-02 02:37:47 INFO     | EM Iteration: 2/5
2025-07-02 02:37:47 INFO     -------------------------
2025-07-02 02:37:47 INFO     >>>>> Using Generator's sample rule
2025-07-02 02:37:47 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 02:37:47 INFO     Predictor: read 1912 rules from list.
2025-07-02 02:37:47 INFO     Preprocess training set
2025-07-02 02:37:47 INFO     >>>>> Predictor: Training
2025-07-02 02:38:47 INFO     1000 5959 8.789493 69332.0
2025-07-02 02:39:46 INFO     2000 5959 8.403119 69349.3
2025-07-02 02:40:42 INFO     3000 5959 8.133702 69184.5
2025-07-02 02:41:41 INFO     4000 5959 7.945402 69253.9
2025-07-02 02:42:41 INFO     5000 5959 7.814975 69332.0
2025-07-02 02:43:46 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 02:43:57 INFO     Data : 2077
2025-07-02 02:43:57 INFO     Hit1 : 0.017814
2025-07-02 02:43:57 INFO     Hit3 : 0.032740
2025-07-02 02:43:57 INFO     Hit10: 0.058739
2025-07-02 02:43:57 INFO     MR   : 1455.011796
2025-07-02 02:43:57 INFO     MRR  : 0.033676
2025-07-02 02:43:57 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 02:44:10 INFO     Data : 2342
2025-07-02 02:44:10 INFO     Hit1 : 0.015798
2025-07-02 02:44:10 INFO     Hit3 : 0.033732
2025-07-02 02:44:10 INFO     Hit10: 0.063194
2025-07-02 02:44:10 INFO     MR   : 1343.549957
2025-07-02 02:44:10 INFO     MRR  : 0.033706
2025-07-02 02:44:10 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 02:46:56 INFO     1000 5959
2025-07-02 02:49:46 INFO     2000 5959
2025-07-02 02:52:35 INFO     3000 5959
2025-07-02 02:55:22 INFO     4000 5959
2025-07-02 02:58:08 INFO     5000 5959
2025-07-02 03:00:50 INFO     >>>>> Generator: Training
2025-07-02 03:00:53 INFO     -------------------------
2025-07-02 03:00:53 INFO     | EM Iteration: 3/5
2025-07-02 03:00:53 INFO     -------------------------
2025-07-02 03:00:53 INFO     >>>>> Using Generator's sample rule
2025-07-02 03:00:53 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 03:00:53 INFO     Predictor: read 1911 rules from list.
2025-07-02 03:00:53 INFO     Preprocess training set
2025-07-02 03:00:53 INFO     >>>>> Predictor: Training
2025-07-02 03:01:53 INFO     1000 5959 8.804068 69271.3
2025-07-02 03:02:53 INFO     2000 5959 8.433301 69340.6
2025-07-02 03:03:59 INFO     3000 5959 8.186858 69384.0
2025-07-02 03:04:58 INFO     4000 5959 8.022698 69262.6
2025-07-02 03:05:58 INFO     5000 5959 7.904593 69332.0
2025-07-02 03:06:56 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 03:07:07 INFO     Data : 2077
2025-07-02 03:07:07 INFO     Hit1 : 0.013000
2025-07-02 03:07:07 INFO     Hit3 : 0.020221
2025-07-02 03:07:07 INFO     Hit10: 0.036110
2025-07-02 03:07:07 INFO     MR   : 1498.707029
2025-07-02 03:07:07 INFO     MRR  : 0.023941
2025-07-02 03:07:07 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 03:07:19 INFO     Data : 2342
2025-07-02 03:07:19 INFO     Hit1 : 0.012810
2025-07-02 03:07:19 INFO     Hit3 : 0.020495
2025-07-02 03:07:19 INFO     Hit10: 0.032451
2025-07-02 03:07:19 INFO     MR   : 1389.774125
2025-07-02 03:07:19 INFO     MRR  : 0.023179
2025-07-02 03:07:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 03:10:05 INFO     1000 5959
2025-07-02 03:12:51 INFO     2000 5959
2025-07-02 03:15:36 INFO     3000 5959
2025-07-02 03:18:21 INFO     4000 5959
2025-07-02 03:21:05 INFO     5000 5959
2025-07-02 03:23:53 INFO     >>>>> Generator: Training
2025-07-02 03:23:56 INFO     -------------------------
2025-07-02 03:23:56 INFO     | EM Iteration: 4/5
2025-07-02 03:23:56 INFO     -------------------------
2025-07-02 03:23:56 INFO     >>>>> Using Generator's sample rule
2025-07-02 03:23:56 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 03:23:56 INFO     Predictor: read 1928 rules from list.
2025-07-02 03:23:56 INFO     Preprocess training set
2025-07-02 03:23:56 INFO     >>>>> Predictor: Training
2025-07-02 03:24:57 INFO     1000 5959 8.799284 69332.0
2025-07-02 03:25:57 INFO     2000 5959 8.416645 69349.3
2025-07-02 03:26:54 INFO     3000 5959 8.145292 69340.6
2025-07-02 03:27:52 INFO     4000 5959 7.955132 69297.3
2025-07-02 03:28:53 INFO     5000 5959 7.778186 69219.2
2025-07-02 03:29:52 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 03:30:04 INFO     Data : 2077
2025-07-02 03:30:04 INFO     Hit1 : 0.012037
2025-07-02 03:30:04 INFO     Hit3 : 0.024073
2025-07-02 03:30:04 INFO     Hit10: 0.041887
2025-07-02 03:30:04 INFO     MR   : 1521.241454
2025-07-02 03:30:04 INFO     MRR  : 0.025532
2025-07-02 03:30:04 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 03:30:17 INFO     Data : 2342
2025-07-02 03:30:17 INFO     Hit1 : 0.007686
2025-07-02 03:30:17 INFO     Hit3 : 0.017079
2025-07-02 03:30:17 INFO     Hit10: 0.038856
2025-07-02 03:30:17 INFO     MR   : 1397.948335
2025-07-02 03:30:17 INFO     MRR  : 0.020371
2025-07-02 03:30:17 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 03:33:03 INFO     1000 5959
2025-07-02 03:35:52 INFO     2000 5959
2025-07-02 03:38:42 INFO     3000 5959
2025-07-02 03:41:30 INFO     4000 5959
2025-07-02 03:44:16 INFO     5000 5959
2025-07-02 03:55:51 INFO     >>>>> Generator: Training
2025-07-02 03:56:02 INFO     -------------------------
2025-07-02 03:56:02 INFO     | EM Iteration: 5/5
2025-07-02 03:56:02 INFO     -------------------------
2025-07-02 03:56:02 INFO     >>>>> Using Generator's sample rule
2025-07-02 03:56:02 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 03:56:02 INFO     Predictor: read 1925 rules from list.
2025-07-02 03:56:02 INFO     Preprocess training set
2025-07-02 03:56:02 INFO     >>>>> Predictor: Training
2025-07-02 03:59:43 INFO     1000 5959 8.804670 69271.3
2025-07-02 04:00:57 INFO     2000 5959 8.454937 69332.0
2025-07-02 04:01:54 INFO     3000 5959 8.218097 69375.3
2025-07-02 04:02:53 INFO     4000 5959 8.057099 69279.9
2025-07-02 04:03:53 INFO     5000 5959 7.919942 69349.3
2025-07-02 04:04:50 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 04:05:02 INFO     Data : 2077
2025-07-02 04:05:02 INFO     Hit1 : 0.025518
2025-07-02 04:05:02 INFO     Hit3 : 0.055368
2025-07-02 04:05:02 INFO     Hit10: 0.080886
2025-07-02 04:05:02 INFO     MR   : 1419.441743
2025-07-02 04:05:02 INFO     MRR  : 0.048077
2025-07-02 04:05:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 04:05:14 INFO     Data : 2342
2025-07-02 04:05:14 INFO     Hit1 : 0.029889
2025-07-02 04:05:14 INFO     Hit3 : 0.052946
2025-07-02 04:05:14 INFO     Hit10: 0.078138
2025-07-02 04:05:14 INFO     MR   : 1326.687233
2025-07-02 04:05:14 INFO     MRR  : 0.050026
2025-07-02 04:05:14 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 04:07:58 INFO     1000 5959
2025-07-02 04:10:41 INFO     2000 5959
2025-07-02 04:13:27 INFO     3000 5959
2025-07-02 04:16:13 INFO     4000 5959
2025-07-02 04:18:57 INFO     5000 5959
2025-07-02 04:21:36 INFO     >>>>> Generator: Training
2025-07-02 04:21:39 INFO     -------------------------
2025-07-02 04:21:39 INFO     | Post-train Generator
2025-07-02 04:21:39 INFO     -------------------------
2025-07-02 04:21:40 INFO     >>>>> Generator: Training
2025-07-02 04:22:13 INFO     [E01000] Total 1.807203 | Main 2.464981 | RelClus 0.923363 | EntType 0.926897
2025-07-02 04:22:13 INFO     -------------------------
2025-07-02 04:22:13 INFO     | Beam Search Best Rules
2025-07-02 04:22:13 INFO     -------------------------
2025-07-02 04:22:13 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:22:14 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:22:20 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:23:29 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:24:27 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:25:08 INFO     -------------------------
2025-07-02 04:25:08 INFO     | Train Final Predictor+
2025-07-02 04:25:08 INFO     -------------------------
2025-07-02 04:25:08 INFO     Predictor+: read 18420 rules from list.
2025-07-02 04:25:08 INFO     Preprocess training set
2025-07-02 04:25:08 INFO     -------------------------
2025-07-02 04:25:08 INFO     | Iteration: 1/5
2025-07-02 04:25:08 INFO     -------------------------
2025-07-02 04:25:08 INFO     >>>>> Predictor: Training
2025-07-02 04:31:03 INFO     1000 5959 5.286118 69366.7
2025-07-02 04:36:56 INFO     2000 5959 5.119677 69375.3
2025-07-02 04:42:43 INFO     3000 5959 5.106876 69219.2
2025-07-02 04:48:37 INFO     4000 5959 5.095362 69305.9
2025-07-02 04:54:35 INFO     5000 5959 5.060224 69288.6
2025-07-02 05:00:16 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 05:01:41 INFO     Data : 2077
2025-07-02 05:01:41 INFO     Hit1 : 0.067886
2025-07-02 05:01:41 INFO     Hit3 : 0.123736
2025-07-02 05:01:41 INFO     Hit10: 0.205104
2025-07-02 05:01:41 INFO     MR   : 1233.022147
2025-07-02 05:01:41 INFO     MRR  : 0.112566
2025-07-02 05:01:41 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 05:03:14 INFO     Data : 2342
2025-07-02 05:03:14 INFO     Hit1 : 0.092229
2025-07-02 05:03:14 INFO     Hit3 : 0.140905
2025-07-02 05:03:14 INFO     Hit10: 0.192570
2025-07-02 05:03:14 INFO     MR   : 1147.201964
2025-07-02 05:03:14 INFO     MRR  : 0.128512
2025-07-02 05:03:14 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_mmoe_adaptive_matrix_3_group_20250701_221912/predictor.pt
2025-07-02 05:03:14 INFO     -------------------------
2025-07-02 05:03:14 INFO     | Iteration: 2/5
2025-07-02 05:03:14 INFO     -------------------------
2025-07-02 05:03:14 INFO     >>>>> Predictor: Training
2025-07-02 05:09:09 INFO     1000 5959 5.030034 69288.6
2025-07-02 05:15:02 INFO     2000 5959 5.048477 69288.6
2025-07-02 05:20:59 INFO     3000 5959 5.022969 69340.6
2025-07-02 05:26:56 INFO     4000 5959 5.023016 69271.3
2025-07-02 05:32:54 INFO     5000 5959 5.051926 69219.2
2025-07-02 05:38:31 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 05:39:43 INFO     Data : 2077
2025-07-02 05:39:43 INFO     Hit1 : 0.070775
2025-07-02 05:39:43 INFO     Hit3 : 0.131440
2025-07-02 05:39:43 INFO     Hit10: 0.202215
2025-07-02 05:39:43 INFO     MR   : 1196.487723
2025-07-02 05:39:43 INFO     MRR  : 0.116405
2025-07-02 05:39:43 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 05:41:01 INFO     Data : 2342
2025-07-02 05:41:01 INFO     Hit1 : 0.097353
2025-07-02 05:41:01 INFO     Hit3 : 0.143467
2025-07-02 05:41:01 INFO     Hit10: 0.195986
2025-07-02 05:41:01 INFO     MR   : 1109.809991
2025-07-02 05:41:01 INFO     MRR  : 0.132377
2025-07-02 05:41:01 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_mmoe_adaptive_matrix_3_group_20250701_221912/predictor.pt
2025-07-02 05:41:01 INFO     -------------------------
2025-07-02 05:41:01 INFO     | Iteration: 3/5
2025-07-02 05:41:01 INFO     -------------------------
2025-07-02 05:41:01 INFO     >>>>> Predictor: Training
2025-07-02 05:45:57 INFO     1000 5959 5.002259 69340.6
2025-07-02 05:50:55 INFO     2000 5959 4.979216 69184.5
2025-07-02 05:55:56 INFO     3000 5959 5.061259 69253.9
2025-07-02 06:00:57 INFO     4000 5959 5.024157 69340.6
2025-07-02 06:05:54 INFO     5000 5959 5.013681 69384.0
2025-07-02 06:10:42 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 06:11:52 INFO     Data : 2077
2025-07-02 06:11:52 INFO     Hit1 : 0.064516
2025-07-02 06:11:52 INFO     Hit3 : 0.122773
2025-07-02 06:11:52 INFO     Hit10: 0.204141
2025-07-02 06:11:52 INFO     MR   : 1183.304044
2025-07-02 06:11:52 INFO     MRR  : 0.110347
2025-07-02 06:11:52 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 06:13:11 INFO     Data : 2342
2025-07-02 06:13:11 INFO     Hit1 : 0.095645
2025-07-02 06:13:11 INFO     Hit3 : 0.140478
2025-07-02 06:13:11 INFO     Hit10: 0.199402
2025-07-02 06:13:11 INFO     MR   : 1104.996584
2025-07-02 06:13:11 INFO     MRR  : 0.130019
2025-07-02 06:13:11 INFO     -------------------------
2025-07-02 06:13:11 INFO     | Iteration: 4/5
2025-07-02 06:13:11 INFO     -------------------------
2025-07-02 06:13:11 INFO     >>>>> Predictor: Training
2025-07-02 06:18:06 INFO     1000 5959 5.023597 69323.3
2025-07-02 06:22:58 INFO     2000 5959 5.016853 69332.0
2025-07-02 06:27:51 INFO     3000 5959 5.030539 69219.2
2025-07-02 06:32:49 INFO     4000 5959 4.999419 69297.3
2025-07-02 06:37:39 INFO     5000 5959 4.987068 69332.0
2025-07-02 06:42:15 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 06:43:22 INFO     Data : 2077
2025-07-02 06:43:22 INFO     Hit1 : 0.067405
2025-07-02 06:43:22 INFO     Hit3 : 0.126625
2025-07-02 06:43:22 INFO     Hit10: 0.205585
2025-07-02 06:43:22 INFO     MR   : 1167.949446
2025-07-02 06:43:22 INFO     MRR  : 0.112407
2025-07-02 06:43:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 06:44:39 INFO     Data : 2342
2025-07-02 06:44:39 INFO     Hit1 : 0.092656
2025-07-02 06:44:39 INFO     Hit3 : 0.142186
2025-07-02 06:44:39 INFO     Hit10: 0.195986
2025-07-02 06:44:39 INFO     MR   : 1085.857387
2025-07-02 06:44:39 INFO     MRR  : 0.129558
2025-07-02 06:44:39 INFO     -------------------------
2025-07-02 06:44:39 INFO     | Iteration: 5/5
2025-07-02 06:44:39 INFO     -------------------------
2025-07-02 06:44:39 INFO     >>>>> Predictor: Training
2025-07-02 06:49:27 INFO     1000 5959 4.953337 69245.2
2025-07-02 06:54:18 INFO     2000 5959 4.968142 69262.6
2025-07-02 06:59:10 INFO     3000 5959 5.037893 69332.0
2025-07-02 07:03:53 INFO     4000 5959 5.022101 69366.7
2025-07-02 07:08:40 INFO     5000 5959 5.023248 69262.6
2025-07-02 07:13:11 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 07:14:17 INFO     Data : 2077
2025-07-02 07:14:17 INFO     Hit1 : 0.065479
2025-07-02 07:14:17 INFO     Hit3 : 0.124699
2025-07-02 07:14:17 INFO     Hit10: 0.205104
2025-07-02 07:14:17 INFO     MR   : 1169.001444
2025-07-02 07:14:17 INFO     MRR  : 0.111667
2025-07-02 07:14:17 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 07:15:33 INFO     Data : 2342
2025-07-02 07:15:33 INFO     Hit1 : 0.087959
2025-07-02 07:15:33 INFO     Hit3 : 0.140051
2025-07-02 07:15:33 INFO     Hit10: 0.202391
2025-07-02 07:15:33 INFO     MR   : 1090.292485
2025-07-02 07:15:33 INFO     MRR  : 0.127026
2025-07-02 07:15:33 INFO     -------------------------
2025-07-02 07:15:33 INFO     | Final Test MRR: 0.132377
2025-07-02 07:15:33 INFO     -------------------------
