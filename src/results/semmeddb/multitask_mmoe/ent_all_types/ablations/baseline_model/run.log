2025-06-30 12:22:29 INFO     Data loading | DONE!
2025-06-30 12:22:29 INFO     Using full datasets for training, validation, and testing.
2025-06-30 12:22:29 INFO     -------------------------
2025-06-30 12:22:29 INFO     | EM Iteration: 1/5
2025-06-30 12:22:29 INFO     -------------------------
2025-06-30 12:22:29 INFO     >>>>> Using miner's rule
2025-06-30 12:22:29 INFO     Predictor: read 13661 rules from list.
2025-06-30 12:22:29 INFO     Preprocess training set
2025-06-30 12:22:29 INFO     >>>>> Predictor: Training
2025-06-30 12:33:58 INFO     1000 5959 8.299284 69314.6
2025-06-30 12:44:27 INFO     2000 5959 7.689227 69271.3
2025-06-30 12:52:11 INFO     3000 5959 7.425850 69245.2
2025-06-30 13:00:02 INFO     4000 5959 7.285955 69340.6
2025-06-30 13:07:53 INFO     5000 5959 7.136692 69340.6
2025-06-30 13:15:32 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 13:17:32 INFO     Data : 2077
2025-06-30 13:17:32 INFO     Hit1 : 0.065479
2025-06-30 13:17:32 INFO     Hit3 : 0.127106
2025-06-30 13:17:32 INFO     Hit10: 0.199326
2025-06-30 13:17:32 INFO     MR   : 1120.920077
2025-06-30 13:17:32 INFO     MRR  : 0.114382
2025-06-30 13:17:32 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 13:19:46 INFO     Data : 2342
2025-06-30 13:19:46 INFO     Hit1 : 0.078992
2025-06-30 13:19:46 INFO     Hit3 : 0.124253
2025-06-30 13:19:46 INFO     Hit10: 0.208796
2025-06-30 13:19:46 INFO     MR   : 1044.279889
2025-06-30 13:19:46 INFO     MRR  : 0.122250
2025-06-30 13:19:46 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 13:50:05 INFO     1000 5959
2025-06-30 14:19:52 INFO     2000 5959
2025-06-30 14:48:49 INFO     3000 5959
2025-06-30 15:20:47 INFO     4000 5959
2025-06-30 15:54:41 INFO     5000 5959
2025-06-30 16:25:49 INFO     >>>>> Generator: Training
2025-06-30 16:25:59 INFO     -------------------------
2025-06-30 16:25:59 INFO     | EM Iteration: 2/5
2025-06-30 16:25:59 INFO     -------------------------
2025-06-30 16:25:59 INFO     >>>>> Using Generator's sample rule
2025-06-30 16:25:59 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 16:26:00 INFO     Predictor: read 1909 rules from list.
2025-06-30 16:26:00 INFO     Preprocess training set
2025-06-30 16:26:00 INFO     >>>>> Predictor: Training
2025-06-30 16:26:52 INFO     1000 5959 8.788000 69332.0
2025-06-30 16:27:44 INFO     2000 5959 8.399275 69349.3
2025-06-30 16:28:35 INFO     3000 5959 8.127595 69184.5
2025-06-30 16:29:27 INFO     4000 5959 7.936858 69253.9
2025-06-30 16:30:18 INFO     5000 5959 7.803566 69332.0
2025-06-30 16:31:08 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 16:31:18 INFO     Data : 2077
2025-06-30 16:31:18 INFO     Hit1 : 0.017814
2025-06-30 16:31:18 INFO     Hit3 : 0.032740
2025-06-30 16:31:18 INFO     Hit10: 0.059220
2025-06-30 16:31:18 INFO     MR   : 1453.290563
2025-06-30 16:31:18 INFO     MRR  : 0.033940
2025-06-30 16:31:18 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 16:31:30 INFO     Data : 2342
2025-06-30 16:31:30 INFO     Hit1 : 0.016225
2025-06-30 16:31:30 INFO     Hit3 : 0.035013
2025-06-30 16:31:30 INFO     Hit10: 0.063194
2025-06-30 16:31:30 INFO     MR   : 1341.287148
2025-06-30 16:31:30 INFO     MRR  : 0.034347
2025-06-30 16:31:30 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 16:33:56 INFO     1000 5959
2025-06-30 16:36:22 INFO     2000 5959
2025-06-30 16:38:50 INFO     3000 5959
2025-06-30 16:41:19 INFO     4000 5959
2025-06-30 16:43:49 INFO     5000 5959
2025-06-30 16:46:13 INFO     >>>>> Generator: Training
2025-06-30 16:46:23 INFO     -------------------------
2025-06-30 16:46:23 INFO     | EM Iteration: 3/5
2025-06-30 16:46:23 INFO     -------------------------
2025-06-30 16:46:23 INFO     >>>>> Using Generator's sample rule
2025-06-30 16:46:23 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 16:46:24 INFO     Predictor: read 1905 rules from list.
2025-06-30 16:46:24 INFO     Preprocess training set
2025-06-30 16:46:24 INFO     >>>>> Predictor: Training
2025-06-30 16:47:15 INFO     1000 5959 8.807474 69271.3
2025-06-30 16:48:07 INFO     2000 5959 8.440766 69340.6
2025-06-30 16:48:59 INFO     3000 5959 8.200738 69384.0
2025-06-30 16:49:50 INFO     4000 5959 8.041153 69262.6
2025-06-30 16:50:42 INFO     5000 5959 7.919748 69332.0
2025-06-30 16:51:31 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 16:51:41 INFO     Data : 2077
2025-06-30 16:51:41 INFO     Hit1 : 0.013000
2025-06-30 16:51:41 INFO     Hit3 : 0.019740
2025-06-30 16:51:41 INFO     Hit10: 0.036110
2025-06-30 16:51:41 INFO     MR   : 1499.197882
2025-06-30 16:51:41 INFO     MRR  : 0.023821
2025-06-30 16:51:41 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 16:51:53 INFO     Data : 2342
2025-06-30 16:51:53 INFO     Hit1 : 0.012810
2025-06-30 16:51:53 INFO     Hit3 : 0.020495
2025-06-30 16:51:53 INFO     Hit10: 0.032451
2025-06-30 16:51:53 INFO     MR   : 1390.182536
2025-06-30 16:51:53 INFO     MRR  : 0.023097
2025-06-30 16:51:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 16:54:16 INFO     1000 5959
2025-06-30 16:56:40 INFO     2000 5959
2025-06-30 16:59:03 INFO     3000 5959
2025-06-30 17:01:29 INFO     4000 5959
2025-06-30 17:03:57 INFO     5000 5959
2025-06-30 17:06:20 INFO     >>>>> Generator: Training
2025-06-30 17:06:30 INFO     -------------------------
2025-06-30 17:06:30 INFO     | EM Iteration: 4/5
2025-06-30 17:06:30 INFO     -------------------------
2025-06-30 17:06:30 INFO     >>>>> Using Generator's sample rule
2025-06-30 17:06:30 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 17:06:31 INFO     Predictor: read 1934 rules from list.
2025-06-30 17:06:31 INFO     Preprocess training set
2025-06-30 17:06:31 INFO     >>>>> Predictor: Training
2025-06-30 17:07:24 INFO     1000 5959 8.800475 69332.0
2025-06-30 17:08:16 INFO     2000 5959 8.421497 69349.3
2025-06-30 17:09:09 INFO     3000 5959 8.153413 69340.6
2025-06-30 17:10:00 INFO     4000 5959 7.963184 69297.3
2025-06-30 17:10:53 INFO     5000 5959 7.786910 69219.2
2025-06-30 17:11:42 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 17:11:53 INFO     Data : 2077
2025-06-30 17:11:53 INFO     Hit1 : 0.020221
2025-06-30 17:11:53 INFO     Hit3 : 0.037073
2025-06-30 17:11:53 INFO     Hit10: 0.062109
2025-06-30 17:11:53 INFO     MR   : 1475.071257
2025-06-30 17:11:53 INFO     MRR  : 0.038091
2025-06-30 17:11:53 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 17:12:05 INFO     Data : 2342
2025-06-30 17:12:05 INFO     Hit1 : 0.019214
2025-06-30 17:12:05 INFO     Hit3 : 0.036721
2025-06-30 17:12:05 INFO     Hit10: 0.061059
2025-06-30 17:12:05 INFO     MR   : 1362.529675
2025-06-30 17:12:05 INFO     MRR  : 0.036540
2025-06-30 17:12:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 17:14:30 INFO     1000 5959
2025-06-30 17:16:56 INFO     2000 5959
2025-06-30 17:19:20 INFO     3000 5959
2025-06-30 17:21:45 INFO     4000 5959
2025-06-30 17:24:17 INFO     5000 5959
2025-06-30 17:27:26 INFO     >>>>> Generator: Training
2025-06-30 17:27:36 INFO     -------------------------
2025-06-30 17:27:36 INFO     | EM Iteration: 5/5
2025-06-30 17:27:36 INFO     -------------------------
2025-06-30 17:27:36 INFO     >>>>> Using Generator's sample rule
2025-06-30 17:27:36 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 17:27:37 INFO     Predictor: read 1968 rules from list.
2025-06-30 17:27:37 INFO     Preprocess training set
2025-06-30 17:27:37 INFO     >>>>> Predictor: Training
2025-06-30 17:28:48 INFO     1000 5959 8.820818 69271.3
2025-06-30 17:29:58 INFO     2000 5959 8.499457 69332.0
2025-06-30 17:31:09 INFO     3000 5959 8.299903 69375.3
2025-06-30 17:32:18 INFO     4000 5959 8.145278 69279.9
2025-06-30 17:33:29 INFO     5000 5959 8.024683 69349.3
2025-06-30 17:34:36 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 17:34:50 INFO     Data : 2077
2025-06-30 17:34:50 INFO     Hit1 : 0.025518
2025-06-30 17:34:50 INFO     Hit3 : 0.054887
2025-06-30 17:34:50 INFO     Hit10: 0.079923
2025-06-30 17:34:50 INFO     MR   : 1416.456428
2025-06-30 17:34:50 INFO     MRR  : 0.048301
2025-06-30 17:34:50 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 17:35:06 INFO     Data : 2342
2025-06-30 17:35:06 INFO     Hit1 : 0.031597
2025-06-30 17:35:06 INFO     Hit3 : 0.052519
2025-06-30 17:35:06 INFO     Hit10: 0.079419
2025-06-30 17:35:06 INFO     MR   : 1325.505764
2025-06-30 17:35:06 INFO     MRR  : 0.050989
2025-06-30 17:35:06 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 17:38:17 INFO     1000 5959
2025-06-30 17:40:44 INFO     2000 5959
2025-06-30 17:43:11 INFO     3000 5959
2025-06-30 17:45:38 INFO     4000 5959
2025-06-30 17:48:03 INFO     5000 5959
2025-06-30 17:50:24 INFO     >>>>> Generator: Training
2025-06-30 17:50:34 INFO     -------------------------
2025-06-30 17:50:34 INFO     | Post-train Generator
2025-06-30 17:50:34 INFO     -------------------------
2025-06-30 17:50:35 INFO     >>>>> Generator: Training
2025-06-30 17:52:20 INFO     [E01000] Total 3.254879 | Main 3.102565 | RelClus 1.634621 | EntType 3.238341
2025-06-30 17:52:20 INFO     -------------------------
2025-06-30 17:52:20 INFO     | Beam Search Best Rules
2025-06-30 17:52:20 INFO     -------------------------
2025-06-30 17:52:20 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:52:22 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:52:43 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:58:07 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 18:02:50 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 18:06:06 INFO     -------------------------
2025-06-30 18:06:06 INFO     | Train Final Predictor+
2025-06-30 18:06:06 INFO     -------------------------
2025-06-30 18:06:06 INFO     Predictor+: read 18420 rules from list.
2025-06-30 18:06:06 INFO     Preprocess training set
2025-06-30 18:06:06 INFO     -------------------------
2025-06-30 18:06:06 INFO     | Iteration: 1/5
2025-06-30 18:06:06 INFO     -------------------------
2025-06-30 18:06:06 INFO     >>>>> Predictor: Training
2025-06-30 18:10:27 INFO     1000 5959 4.876312 69366.7
2025-06-30 18:14:46 INFO     2000 5959 4.747562 69375.3
2025-06-30 18:19:07 INFO     3000 5959 4.715948 69219.2
2025-06-30 18:23:33 INFO     4000 5959 4.707148 69305.9
2025-06-30 18:27:57 INFO     5000 5959 4.666668 69288.6
2025-06-30 18:32:08 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 18:33:14 INFO     Data : 2077
2025-06-30 18:33:14 INFO     Hit1 : 0.097256
2025-06-30 18:33:14 INFO     Hit3 : 0.187771
2025-06-30 18:33:14 INFO     Hit10: 0.321618
2025-06-30 18:33:14 INFO     MR   : 974.908040
2025-06-30 18:33:14 INFO     MRR  : 0.167235
2025-06-30 18:33:14 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 18:34:29 INFO     Data : 2342
2025-06-30 18:34:29 INFO     Hit1 : 0.124680
2025-06-30 18:34:29 INFO     Hit3 : 0.207515
2025-06-30 18:34:29 INFO     Hit10: 0.320666
2025-06-30 18:34:29 INFO     MR   : 899.216482
2025-06-30 18:34:29 INFO     MRR  : 0.188998
2025-06-30 18:34:29 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_adaptive_matrix_3_20250630_122227/predictor.pt
2025-06-30 18:34:29 INFO     -------------------------
2025-06-30 18:34:29 INFO     | Iteration: 2/5
2025-06-30 18:34:29 INFO     -------------------------
2025-06-30 18:34:29 INFO     >>>>> Predictor: Training
2025-06-30 18:38:51 INFO     1000 5959 4.641879 69288.6
2025-06-30 18:43:12 INFO     2000 5959 4.644388 69288.6
2025-06-30 18:47:33 INFO     3000 5959 4.626825 69340.6
2025-06-30 18:51:54 INFO     4000 5959 4.636465 69271.3
2025-06-30 18:56:17 INFO     5000 5959 4.656537 69219.2
2025-06-30 19:00:33 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 19:01:38 INFO     Data : 2077
2025-06-30 19:01:38 INFO     Hit1 : 0.090997
2025-06-30 19:01:38 INFO     Hit3 : 0.184401
2025-06-30 19:01:38 INFO     Hit10: 0.309581
2025-06-30 19:01:38 INFO     MR   : 955.190178
2025-06-30 19:01:38 INFO     MRR  : 0.163201
2025-06-30 19:01:38 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 19:02:50 INFO     Data : 2342
2025-06-30 19:02:50 INFO     Hit1 : 0.119983
2025-06-30 19:02:50 INFO     Hit3 : 0.201110
2025-06-30 19:02:50 INFO     Hit10: 0.315969
2025-06-30 19:02:50 INFO     MR   : 881.815756
2025-06-30 19:02:50 INFO     MRR  : 0.183871
2025-06-30 19:02:50 INFO     -------------------------
2025-06-30 19:02:50 INFO     | Iteration: 3/5
2025-06-30 19:02:50 INFO     -------------------------
2025-06-30 19:02:50 INFO     >>>>> Predictor: Training
2025-06-30 19:07:11 INFO     1000 5959 4.608281 69340.6
2025-06-30 19:11:32 INFO     2000 5959 4.578062 69184.5
2025-06-30 19:15:54 INFO     3000 5959 4.639871 69253.9
2025-06-30 19:20:22 INFO     4000 5959 4.615393 69340.6
2025-06-30 19:24:44 INFO     5000 5959 4.611611 69384.0
2025-06-30 19:28:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 19:30:01 INFO     Data : 2077
2025-06-30 19:30:01 INFO     Hit1 : 0.098700
2025-06-30 19:30:01 INFO     Hit3 : 0.181030
2025-06-30 19:30:01 INFO     Hit10: 0.313914
2025-06-30 19:30:01 INFO     MR   : 934.586904
2025-06-30 19:30:01 INFO     MRR  : 0.167001
2025-06-30 19:30:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 19:31:15 INFO     Data : 2342
2025-06-30 19:31:15 INFO     Hit1 : 0.133219
2025-06-30 19:31:15 INFO     Hit3 : 0.213493
2025-06-30 19:31:15 INFO     Hit10: 0.318958
2025-06-30 19:31:15 INFO     MR   : 864.368915
2025-06-30 19:31:15 INFO     MRR  : 0.194653
2025-06-30 19:31:15 INFO     -------------------------
2025-06-30 19:31:15 INFO     | Iteration: 4/5
2025-06-30 19:31:15 INFO     -------------------------
2025-06-30 19:31:15 INFO     >>>>> Predictor: Training
2025-06-30 19:35:37 INFO     1000 5959 4.617159 69323.3
2025-06-30 19:40:01 INFO     2000 5959 4.590448 69332.0
2025-06-30 19:44:23 INFO     3000 5959 4.623117 69219.2
2025-06-30 19:48:47 INFO     4000 5959 4.617821 69297.3
2025-06-30 19:53:09 INFO     5000 5959 4.582396 69332.0
2025-06-30 19:57:24 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 19:58:30 INFO     Data : 2077
2025-06-30 19:58:30 INFO     Hit1 : 0.093404
2025-06-30 19:58:30 INFO     Hit3 : 0.180067
2025-06-30 19:58:30 INFO     Hit10: 0.319692
2025-06-30 19:58:30 INFO     MR   : 927.713048
2025-06-30 19:58:30 INFO     MRR  : 0.164413
2025-06-30 19:58:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 19:59:45 INFO     Data : 2342
2025-06-30 19:59:45 INFO     Hit1 : 0.132792
2025-06-30 19:59:45 INFO     Hit3 : 0.213920
2025-06-30 19:59:45 INFO     Hit10: 0.319812
2025-06-30 19:59:45 INFO     MR   : 856.221178
2025-06-30 19:59:45 INFO     MRR  : 0.195096
2025-06-30 19:59:45 INFO     -------------------------
2025-06-30 19:59:45 INFO     | Iteration: 5/5
2025-06-30 19:59:45 INFO     -------------------------
2025-06-30 19:59:45 INFO     >>>>> Predictor: Training
2025-06-30 20:04:06 INFO     1000 5959 4.559404 69245.2
2025-06-30 20:08:29 INFO     2000 5959 4.548175 69262.6
2025-06-30 20:12:54 INFO     3000 5959 4.604485 69332.0
2025-06-30 20:17:19 INFO     4000 5959 4.607809 69366.7
2025-06-30 20:21:42 INFO     5000 5959 4.617414 69262.6
2025-06-30 20:25:53 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 20:26:58 INFO     Data : 2077
2025-06-30 20:26:58 INFO     Hit1 : 0.098700
2025-06-30 20:26:58 INFO     Hit3 : 0.186326
2025-06-30 20:26:58 INFO     Hit10: 0.315840
2025-06-30 20:26:58 INFO     MR   : 921.238565
2025-06-30 20:26:58 INFO     MRR  : 0.169238
2025-06-30 20:26:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 20:28:12 INFO     Data : 2342
2025-06-30 20:28:12 INFO     Hit1 : 0.134073
2025-06-30 20:28:12 INFO     Hit3 : 0.214774
2025-06-30 20:28:12 INFO     Hit10: 0.321093
2025-06-30 20:28:12 INFO     MR   : 852.618702
2025-06-30 20:28:12 INFO     MRR  : 0.196451
2025-06-30 20:28:12 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_adaptive_matrix_3_20250630_122227/predictor.pt
2025-06-30 20:28:12 INFO     -------------------------
2025-06-30 20:28:12 INFO     | Final Test MRR: 0.196451
2025-06-30 20:28:12 INFO     -------------------------
