2025-07-03 13:37:19 INFO     is_soft_label: False
2025-07-03 13:37:19 INFO     is_scheduled_sampling: False
2025-07-03 13:37:19 INFO     is_test_mode: False
2025-07-03 13:37:20 INFO     Data loading | DONE!
2025-07-03 13:37:20 INFO     Using full datasets for training, validation, and testing.
2025-07-03 13:37:20 INFO     -------------------------
2025-07-03 13:37:20 INFO     | EM Iteration: 1/5
2025-07-03 13:37:20 INFO     -------------------------
2025-07-03 13:37:20 INFO     >>>>> Using miner's rule
2025-07-03 13:37:20 INFO     Predictor: read 13661 rules from list.
2025-07-03 13:37:20 INFO     Preprocess training set
2025-07-03 13:37:20 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 13:39:14 INFO     Data : 2077
2025-07-03 13:39:14 INFO     Hit1 : 0.065479
2025-07-03 13:39:14 INFO     Hit3 : 0.127106
2025-07-03 13:39:14 INFO     Hit10: 0.199326
2025-07-03 13:39:14 INFO     MR   : 1120.902022
2025-07-03 13:39:14 INFO     MRR  : 0.114382
2025-07-03 13:39:14 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 13:41:18 INFO     Data : 2342
2025-07-03 13:41:18 INFO     Hit1 : 0.078992
2025-07-03 13:41:18 INFO     Hit3 : 0.124253
2025-07-03 13:41:18 INFO     Hit10: 0.208796
2025-07-03 13:41:18 INFO     MR   : 1044.269001
2025-07-03 13:41:18 INFO     MRR  : 0.122250
2025-07-03 13:41:18 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 14:08:46 INFO     1000 5959
2025-07-03 14:36:48 INFO     2000 5959
2025-07-03 15:04:30 INFO     3000 5959
2025-07-03 15:33:07 INFO     4000 5959
2025-07-03 16:00:49 INFO     5000 5959
2025-07-03 16:32:32 INFO     >>>>> Generator: Training
2025-07-03 16:32:36 INFO     -------------------------
2025-07-03 16:32:36 INFO     | EM Iteration: 2/5
2025-07-03 16:32:36 INFO     -------------------------
2025-07-03 16:32:36 INFO     >>>>> Using Generator's sample rule
2025-07-03 16:32:36 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 16:32:36 INFO     Predictor: read 1909 rules from list.
2025-07-03 16:32:36 INFO     Preprocess training set
2025-07-03 16:32:36 INFO     >>>>> Predictor: Training
2025-07-03 16:33:35 INFO     1000 5959 8.782359 69314.6
2025-07-03 16:34:33 INFO     2000 5959 8.410202 69271.3
2025-07-03 16:35:30 INFO     3000 5959 8.219380 69245.2
2025-07-03 16:36:27 INFO     4000 5959 8.065945 69340.6
2025-07-03 16:37:25 INFO     5000 5959 7.942117 69340.6
2025-07-03 16:38:19 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 16:38:32 INFO     Data : 2077
2025-07-03 16:38:32 INFO     Hit1 : 0.025036
2025-07-03 16:38:32 INFO     Hit3 : 0.040924
2025-07-03 16:38:32 INFO     Hit10: 0.064516
2025-07-03 16:38:32 INFO     MR   : 1409.490371
2025-07-03 16:38:32 INFO     MRR  : 0.041246
2025-07-03 16:38:32 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 16:38:44 INFO     Data : 2342
2025-07-03 16:38:44 INFO     Hit1 : 0.019641
2025-07-03 16:38:44 INFO     Hit3 : 0.031170
2025-07-03 16:38:44 INFO     Hit10: 0.058497
2025-07-03 16:38:44 INFO     MR   : 1316.030316
2025-07-03 16:38:44 INFO     MRR  : 0.035233
2025-07-03 16:38:44 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 16:41:27 INFO     1000 5959
2025-07-03 16:44:13 INFO     2000 5959
2025-07-03 16:47:02 INFO     3000 5959
2025-07-03 16:49:44 INFO     4000 5959
2025-07-03 16:58:18 INFO     5000 5959
2025-07-03 17:08:48 INFO     >>>>> Generator: Training
2025-07-03 17:09:02 INFO     -------------------------
2025-07-03 17:09:02 INFO     | EM Iteration: 3/5
2025-07-03 17:09:02 INFO     -------------------------
2025-07-03 17:09:02 INFO     >>>>> Using Generator's sample rule
2025-07-03 17:09:02 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 17:09:03 INFO     Predictor: read 1891 rules from list.
2025-07-03 17:09:03 INFO     Preprocess training set
2025-07-03 17:09:03 INFO     >>>>> Predictor: Training
2025-07-03 17:12:19 INFO     1000 5959 8.811351 69332.0
2025-07-03 17:15:39 INFO     2000 5959 8.473575 69349.3
2025-07-03 17:18:55 INFO     3000 5959 8.262602 69184.5
2025-07-03 17:22:15 INFO     4000 5959 8.094345 69253.9
2025-07-03 17:25:32 INFO     5000 5959 8.001122 69332.0
2025-07-03 17:28:41 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 17:29:19 INFO     Data : 2077
2025-07-03 17:29:19 INFO     Hit1 : 0.010592
2025-07-03 17:29:19 INFO     Hit3 : 0.025518
2025-07-03 17:29:19 INFO     Hit10: 0.051517
2025-07-03 17:29:19 INFO     MR   : 1449.479297
2025-07-03 17:29:19 INFO     MRR  : 0.026726
2025-07-03 17:29:19 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 17:30:01 INFO     Data : 2342
2025-07-03 17:30:01 INFO     Hit1 : 0.014091
2025-07-03 17:30:01 INFO     Hit3 : 0.024765
2025-07-03 17:30:01 INFO     Hit10: 0.047395
2025-07-03 17:30:01 INFO     MR   : 1338.970111
2025-07-03 17:30:01 INFO     MRR  : 0.028010
2025-07-03 17:30:01 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 17:41:15 INFO     1000 5959
2025-07-03 17:52:31 INFO     2000 5959
2025-07-03 18:03:49 INFO     3000 5959
2025-07-03 18:15:05 INFO     4000 5959
2025-07-03 18:26:20 INFO     5000 5959
2025-07-03 18:36:10 INFO     >>>>> Generator: Training
2025-07-03 18:36:20 INFO     -------------------------
2025-07-03 18:36:20 INFO     | EM Iteration: 4/5
2025-07-03 18:36:20 INFO     -------------------------
2025-07-03 18:36:20 INFO     >>>>> Using Generator's sample rule
2025-07-03 18:36:20 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 18:36:20 INFO     Predictor: read 1925 rules from list.
2025-07-03 18:36:20 INFO     Preprocess training set
2025-07-03 18:36:20 INFO     >>>>> Predictor: Training
2025-07-03 18:39:08 INFO     1000 5959 8.795411 69271.3
2025-07-03 18:42:31 INFO     2000 5959 8.414998 69340.6
2025-07-03 18:45:51 INFO     3000 5959 8.156684 69384.0
2025-07-03 18:49:11 INFO     4000 5959 7.988088 69262.6
2025-07-03 18:52:31 INFO     5000 5959 7.847948 69332.0
2025-07-03 18:55:45 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 18:56:23 INFO     Data : 2077
2025-07-03 18:56:23 INFO     Hit1 : 0.001444
2025-07-03 18:56:23 INFO     Hit3 : 0.004333
2025-07-03 18:56:23 INFO     Hit10: 0.014444
2025-07-03 18:56:23 INFO     MR   : 1507.776601
2025-07-03 18:56:23 INFO     MRR  : 0.009350
2025-07-03 18:56:23 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 18:57:07 INFO     Data : 2342
2025-07-03 18:57:07 INFO     Hit1 : 0.001281
2025-07-03 18:57:07 INFO     Hit3 : 0.008540
2025-07-03 18:57:07 INFO     Hit10: 0.017933
2025-07-03 18:57:07 INFO     MR   : 1397.216482
2025-07-03 18:57:07 INFO     MRR  : 0.010721
2025-07-03 18:57:07 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 19:07:57 INFO     1000 5959
2025-07-03 19:18:51 INFO     2000 5959
2025-07-03 19:30:19 INFO     3000 5959
2025-07-03 19:45:01 INFO     4000 5959
2025-07-03 19:56:30 INFO     5000 5959
2025-07-03 20:07:35 INFO     >>>>> Generator: Training
2025-07-03 20:07:49 INFO     -------------------------
2025-07-03 20:07:49 INFO     | EM Iteration: 5/5
2025-07-03 20:07:49 INFO     -------------------------
2025-07-03 20:07:49 INFO     >>>>> Using Generator's sample rule
2025-07-03 20:07:49 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 20:07:49 INFO     Predictor: read 1962 rules from list.
2025-07-03 20:07:49 INFO     Preprocess training set
2025-07-03 20:07:49 INFO     >>>>> Predictor: Training
2025-07-03 20:11:15 INFO     1000 5959 8.829939 69332.0
2025-07-03 20:14:41 INFO     2000 5959 8.509451 69349.3
2025-07-03 20:18:07 INFO     3000 5959 8.320671 69340.6
2025-07-03 20:21:35 INFO     4000 5959 8.181525 69297.3
2025-07-03 20:25:01 INFO     5000 5959 8.064870 69219.2
2025-07-03 20:28:18 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 20:28:59 INFO     Data : 2077
2025-07-03 20:28:59 INFO     Hit1 : 0.011074
2025-07-03 20:28:59 INFO     Hit3 : 0.019740
2025-07-03 20:28:59 INFO     Hit10: 0.038036
2025-07-03 20:28:59 INFO     MR   : 1527.052480
2025-07-03 20:28:59 INFO     MRR  : 0.023447
2025-07-03 20:28:59 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 20:29:45 INFO     Data : 2342
2025-07-03 20:29:45 INFO     Hit1 : 0.012383
2025-07-03 20:29:45 INFO     Hit3 : 0.020922
2025-07-03 20:29:45 INFO     Hit10: 0.035440
2025-07-03 20:29:45 INFO     MR   : 1405.402007
2025-07-03 20:29:45 INFO     MRR  : 0.024157
2025-07-03 20:29:45 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 20:41:19 INFO     1000 5959
2025-07-03 20:51:55 INFO     2000 5959
2025-07-03 21:06:16 INFO     3000 5959
2025-07-03 21:22:07 INFO     4000 5959
2025-07-03 21:33:41 INFO     5000 5959
2025-07-03 21:44:47 INFO     >>>>> Generator: Training
2025-07-03 21:45:00 INFO     -------------------------
2025-07-03 21:45:00 INFO     | Post-train Generator
2025-07-03 21:45:00 INFO     -------------------------
2025-07-03 21:45:01 INFO     >>>>> Generator: Training
2025-07-03 21:47:21 INFO     [E01000] Total 2.978315 | Main 2.891368 | RelClus 1.706351 | 
2025-07-03 21:47:21 INFO     -------------------------
2025-07-03 21:47:21 INFO     | Beam Search Best Rules
2025-07-03 21:47:21 INFO     -------------------------
2025-07-03 21:47:21 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:47:24 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:47:46 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:53:12 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 21:57:48 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 22:00:55 INFO     -------------------------
2025-07-03 22:00:55 INFO     | Train Final Predictor+
2025-07-03 22:00:55 INFO     -------------------------
2025-07-03 22:00:55 INFO     Predictor+: read 18420 rules from list.
2025-07-03 22:00:55 INFO     Preprocess training set
2025-07-03 22:00:55 INFO     -------------------------
2025-07-03 22:00:55 INFO     | Iteration: 1/5
2025-07-03 22:00:55 INFO     -------------------------
2025-07-03 22:00:55 INFO     >>>>> Predictor: Training
2025-07-03 22:17:58 INFO     1000 5959 4.902887 69271.3
2025-07-03 22:35:01 INFO     2000 5959 4.728909 69332.0
2025-07-03 22:52:03 INFO     3000 5959 4.710759 69375.3
2025-07-03 23:06:10 INFO     4000 5959 4.713890 69279.9
2025-07-03 23:11:19 INFO     5000 5959 4.683010 69349.3
2025-07-03 23:16:16 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 23:17:32 INFO     Data : 2077
2025-07-03 23:17:32 INFO     Hit1 : 0.102552
2025-07-03 23:17:32 INFO     Hit3 : 0.184401
2025-07-03 23:17:32 INFO     Hit10: 0.319210
2025-07-03 23:17:32 INFO     MR   : 982.975445
2025-07-03 23:17:32 INFO     MRR  : 0.170903
2025-07-03 23:17:32 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 23:18:59 INFO     Data : 2342
2025-07-03 23:18:59 INFO     Hit1 : 0.127669
2025-07-03 23:18:59 INFO     Hit3 : 0.209650
2025-07-03 23:18:59 INFO     Hit10: 0.316823
2025-07-03 23:18:59 INFO     MR   : 919.810418
2025-07-03 23:18:59 INFO     MRR  : 0.190716
2025-07-03 23:18:59 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/expert_8_multitask_mmoe_adaptive_matrix_3_type_20250703_133718/predictor.pt
2025-07-03 23:18:59 INFO     -------------------------
2025-07-03 23:18:59 INFO     | Iteration: 2/5
2025-07-03 23:18:59 INFO     -------------------------
2025-07-03 23:18:59 INFO     >>>>> Predictor: Training
2025-07-03 23:24:13 INFO     1000 5959 4.604073 69366.7
2025-07-03 23:29:30 INFO     2000 5959 4.654066 69375.3
2025-07-03 23:34:43 INFO     3000 5959 4.640112 69219.2
2025-07-03 23:39:55 INFO     4000 5959 4.653690 69305.9
2025-07-03 23:45:06 INFO     5000 5959 4.617739 69288.6
2025-07-03 23:50:06 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 23:51:22 INFO     Data : 2077
2025-07-03 23:51:22 INFO     Hit1 : 0.092922
2025-07-03 23:51:22 INFO     Hit3 : 0.185845
2025-07-03 23:51:22 INFO     Hit10: 0.313914
2025-07-03 23:51:22 INFO     MR   : 952.123736
2025-07-03 23:51:22 INFO     MRR  : 0.163740
2025-07-03 23:51:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 23:52:50 INFO     Data : 2342
2025-07-03 23:52:50 INFO     Hit1 : 0.126388
2025-07-03 23:52:50 INFO     Hit3 : 0.203245
2025-07-03 23:52:50 INFO     Hit10: 0.321093
2025-07-03 23:52:50 INFO     MR   : 882.865500
2025-07-03 23:52:50 INFO     MRR  : 0.189364
2025-07-03 23:52:50 INFO     -------------------------
2025-07-03 23:52:50 INFO     | Iteration: 3/5
2025-07-03 23:52:50 INFO     -------------------------
2025-07-03 23:52:50 INFO     >>>>> Predictor: Training
2025-07-03 23:58:03 INFO     1000 5959 4.619691 69288.6
2025-07-04 00:03:10 INFO     2000 5959 4.618862 69288.6
2025-07-04 00:08:17 INFO     3000 5959 4.609147 69340.6
2025-07-04 00:13:36 INFO     4000 5959 4.617110 69271.3
2025-07-04 00:18:43 INFO     5000 5959 4.641000 69219.2
2025-07-04 00:23:38 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 00:24:55 INFO     Data : 2077
2025-07-04 00:24:55 INFO     Hit1 : 0.091960
2025-07-04 00:24:55 INFO     Hit3 : 0.181030
2025-07-04 00:24:55 INFO     Hit10: 0.303322
2025-07-04 00:24:55 INFO     MR   : 934.834617
2025-07-04 00:24:55 INFO     MRR  : 0.161501
2025-07-04 00:24:55 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 00:26:21 INFO     Data : 2342
2025-07-04 00:26:21 INFO     Hit1 : 0.118275
2025-07-04 00:26:21 INFO     Hit3 : 0.201110
2025-07-04 00:26:21 INFO     Hit10: 0.317677
2025-07-04 00:26:21 INFO     MR   : 863.794406
2025-07-04 00:26:21 INFO     MRR  : 0.182353
2025-07-04 00:26:21 INFO     -------------------------
2025-07-04 00:26:21 INFO     | Iteration: 4/5
2025-07-04 00:26:21 INFO     -------------------------
2025-07-04 00:26:21 INFO     >>>>> Predictor: Training
2025-07-04 00:31:32 INFO     1000 5959 4.596088 69340.6
2025-07-04 00:36:45 INFO     2000 5959 4.564243 69184.5
2025-07-04 00:41:55 INFO     3000 5959 4.629172 69253.9
2025-07-04 00:47:08 INFO     4000 5959 4.602535 69340.6
2025-07-04 00:52:19 INFO     5000 5959 4.600312 69384.0
2025-07-04 00:57:20 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 00:58:37 INFO     Data : 2077
2025-07-04 00:58:37 INFO     Hit1 : 0.097256
2025-07-04 00:58:37 INFO     Hit3 : 0.186326
2025-07-04 00:58:37 INFO     Hit10: 0.312470
2025-07-04 00:58:37 INFO     MR   : 938.182475
2025-07-04 00:58:37 INFO     MRR  : 0.166538
2025-07-04 00:58:37 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 01:00:04 INFO     Data : 2342
2025-07-04 01:00:04 INFO     Hit1 : 0.126388
2025-07-04 01:00:04 INFO     Hit3 : 0.212212
2025-07-04 01:00:04 INFO     Hit10: 0.322374
2025-07-04 01:00:04 INFO     MR   : 872.351196
2025-07-04 01:00:04 INFO     MRR  : 0.191494
2025-07-04 01:00:04 INFO     -------------------------
2025-07-04 01:00:04 INFO     | Iteration: 5/5
2025-07-04 01:00:04 INFO     -------------------------
2025-07-04 01:00:04 INFO     >>>>> Predictor: Training
2025-07-04 01:05:12 INFO     1000 5959 4.606615 69323.3
2025-07-04 01:10:21 INFO     2000 5959 4.584993 69332.0
2025-07-04 01:15:33 INFO     3000 5959 4.615175 69219.2
2025-07-04 01:20:46 INFO     4000 5959 4.613268 69297.3
2025-07-04 01:25:59 INFO     5000 5959 4.575975 69332.0
2025-07-04 01:31:02 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 01:34:53 INFO     Data : 2077
2025-07-04 01:34:53 INFO     Hit1 : 0.096293
2025-07-04 01:34:53 INFO     Hit3 : 0.181030
2025-07-04 01:34:53 INFO     Hit10: 0.316803
2025-07-04 01:34:53 INFO     MR   : 921.693548
2025-07-04 01:34:53 INFO     MRR  : 0.166375
2025-07-04 01:34:53 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 01:39:41 INFO     Data : 2342
2025-07-04 01:39:41 INFO     Hit1 : 0.130658
2025-07-04 01:39:41 INFO     Hit3 : 0.213920
2025-07-04 01:39:41 INFO     Hit10: 0.319385
2025-07-04 01:39:41 INFO     MR   : 853.668446
2025-07-04 01:39:41 INFO     MRR  : 0.193673
2025-07-04 01:39:41 INFO     -------------------------
2025-07-04 01:39:41 INFO     | Final Test MRR: 0.190716
2025-07-04 01:39:41 INFO     -------------------------
