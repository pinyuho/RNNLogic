2025-07-04 13:55:46 INFO     is_soft_label: False
2025-07-04 13:55:46 INFO     is_scheduled_sampling: False
2025-07-04 13:55:46 INFO     is_test_mode: False
2025-07-04 13:55:47 INFO     Data loading | DONE!
2025-07-04 13:55:47 INFO     Using full datasets for training, validation, and testing.
2025-07-04 13:55:47 INFO     -------------------------
2025-07-04 13:55:47 INFO     | EM Iteration: 1/5
2025-07-04 13:55:47 INFO     -------------------------
2025-07-04 13:55:47 INFO     >>>>> Using miner's rule
2025-07-04 13:55:47 INFO     Predictor: read 13661 rules from list.
2025-07-04 13:55:48 INFO     Preprocess training set
2025-07-04 13:55:48 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 13:58:19 INFO     Data : 2077
2025-07-04 13:58:19 INFO     Hit1 : 0.065479
2025-07-04 13:58:19 INFO     Hit3 : 0.127106
2025-07-04 13:58:19 INFO     Hit10: 0.199326
2025-07-04 13:58:19 INFO     MR   : 1120.902022
2025-07-04 13:58:19 INFO     MRR  : 0.114382
2025-07-04 13:58:19 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 14:01:06 INFO     Data : 2342
2025-07-04 14:01:06 INFO     Hit1 : 0.078992
2025-07-04 14:01:06 INFO     Hit3 : 0.124253
2025-07-04 14:01:06 INFO     Hit10: 0.208796
2025-07-04 14:01:06 INFO     MR   : 1044.269001
2025-07-04 14:01:06 INFO     MRR  : 0.122250
2025-07-04 14:01:06 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 14:33:08 INFO     1000 5959
2025-07-04 15:04:00 INFO     2000 5959
2025-07-04 15:36:24 INFO     3000 5959
2025-07-04 16:13:47 INFO     4000 5959
2025-07-04 16:53:54 INFO     5000 5959
2025-07-04 17:28:32 INFO     >>>>> Generator: Training
2025-07-04 17:28:50 INFO     -------------------------
2025-07-04 17:28:50 INFO     | EM Iteration: 2/5
2025-07-04 17:28:50 INFO     -------------------------
2025-07-04 17:28:50 INFO     >>>>> Using Generator's sample rule
2025-07-04 17:28:50 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 17:28:51 INFO     Predictor: read 1906 rules from list.
2025-07-04 17:28:51 INFO     Preprocess training set
2025-07-04 17:28:51 INFO     >>>>> Predictor: Training
2025-07-04 17:29:44 INFO     1000 5959 8.782122 69314.6
2025-07-04 17:30:37 INFO     2000 5959 8.409451 69271.3
2025-07-04 17:31:31 INFO     3000 5959 8.217893 69245.2
2025-07-04 17:32:24 INFO     4000 5959 8.064136 69340.6
2025-07-04 17:33:18 INFO     5000 5959 7.937530 69340.6
2025-07-04 17:34:09 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 17:34:20 INFO     Data : 2077
2025-07-04 17:34:20 INFO     Hit1 : 0.025036
2025-07-04 17:34:20 INFO     Hit3 : 0.040924
2025-07-04 17:34:20 INFO     Hit10: 0.064035
2025-07-04 17:34:20 INFO     MR   : 1409.239528
2025-07-04 17:34:20 INFO     MRR  : 0.041155
2025-07-04 17:34:20 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 17:34:32 INFO     Data : 2342
2025-07-04 17:34:32 INFO     Hit1 : 0.019641
2025-07-04 17:34:32 INFO     Hit3 : 0.030743
2025-07-04 17:34:32 INFO     Hit10: 0.056362
2025-07-04 17:34:32 INFO     MR   : 1318.562340
2025-07-04 17:34:32 INFO     MRR  : 0.034759
2025-07-04 17:34:32 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 17:37:03 INFO     1000 5959
2025-07-04 17:39:37 INFO     2000 5959
2025-07-04 17:42:10 INFO     3000 5959
2025-07-04 17:44:42 INFO     4000 5959
2025-07-04 17:47:12 INFO     5000 5959
2025-07-04 17:49:39 INFO     >>>>> Generator: Training
2025-07-04 17:49:57 INFO     -------------------------
2025-07-04 17:49:57 INFO     | EM Iteration: 3/5
2025-07-04 17:49:57 INFO     -------------------------
2025-07-04 17:49:57 INFO     >>>>> Using Generator's sample rule
2025-07-04 17:49:57 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 17:49:58 INFO     Predictor: read 1880 rules from list.
2025-07-04 17:49:58 INFO     Preprocess training set
2025-07-04 17:49:58 INFO     >>>>> Predictor: Training
2025-07-04 17:50:51 INFO     1000 5959 8.810034 69332.0
2025-07-04 17:51:44 INFO     2000 5959 8.469638 69349.3
2025-07-04 17:52:36 INFO     3000 5959 8.255328 69184.5
2025-07-04 17:53:29 INFO     4000 5959 8.082131 69253.9
2025-07-04 17:54:23 INFO     5000 5959 7.989079 69332.0
2025-07-04 17:55:13 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 17:55:24 INFO     Data : 2077
2025-07-04 17:55:24 INFO     Hit1 : 0.010592
2025-07-04 17:55:24 INFO     Hit3 : 0.025999
2025-07-04 17:55:24 INFO     Hit10: 0.050554
2025-07-04 17:55:24 INFO     MR   : 1452.078479
2025-07-04 17:55:24 INFO     MRR  : 0.026652
2025-07-04 17:55:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 17:55:36 INFO     Data : 2342
2025-07-04 17:55:36 INFO     Hit1 : 0.014091
2025-07-04 17:55:36 INFO     Hit3 : 0.024765
2025-07-04 17:55:36 INFO     Hit10: 0.046541
2025-07-04 17:55:36 INFO     MR   : 1342.928053
2025-07-04 17:55:36 INFO     MRR  : 0.027889
2025-07-04 17:55:36 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 17:58:07 INFO     1000 5959
2025-07-04 18:00:40 INFO     2000 5959
2025-07-04 18:03:07 INFO     3000 5959
2025-07-04 18:05:33 INFO     4000 5959
2025-07-04 18:08:01 INFO     5000 5959
2025-07-04 18:10:32 INFO     >>>>> Generator: Training
2025-07-04 18:10:50 INFO     -------------------------
2025-07-04 18:10:50 INFO     | EM Iteration: 4/5
2025-07-04 18:10:50 INFO     -------------------------
2025-07-04 18:10:50 INFO     >>>>> Using Generator's sample rule
2025-07-04 18:10:50 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 18:10:51 INFO     Predictor: read 1854 rules from list.
2025-07-04 18:10:51 INFO     Preprocess training set
2025-07-04 18:10:51 INFO     >>>>> Predictor: Training
2025-07-04 18:11:44 INFO     1000 5959 8.792357 69271.3
2025-07-04 18:12:37 INFO     2000 5959 8.407269 69340.6
2025-07-04 18:13:30 INFO     3000 5959 8.143849 69384.0
2025-07-04 18:14:22 INFO     4000 5959 7.972226 69262.6
2025-07-04 18:15:15 INFO     5000 5959 7.827738 69332.0
2025-07-04 18:16:05 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 18:16:16 INFO     Data : 2077
2025-07-04 18:16:16 INFO     Hit1 : 0.006259
2025-07-04 18:16:16 INFO     Hit3 : 0.018296
2025-07-04 18:16:16 INFO     Hit10: 0.036110
2025-07-04 18:16:16 INFO     MR   : 1485.933317
2025-07-04 18:16:16 INFO     MRR  : 0.019678
2025-07-04 18:16:16 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 18:16:28 INFO     Data : 2342
2025-07-04 18:16:28 INFO     Hit1 : 0.008540
2025-07-04 18:16:28 INFO     Hit3 : 0.018787
2025-07-04 18:16:28 INFO     Hit10: 0.035440
2025-07-04 18:16:28 INFO     MR   : 1372.044833
2025-07-04 18:16:28 INFO     MRR  : 0.020691
2025-07-04 18:16:28 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 18:18:57 INFO     1000 5959
2025-07-04 18:21:26 INFO     2000 5959
2025-07-04 18:23:55 INFO     3000 5959
2025-07-04 18:26:24 INFO     4000 5959
2025-07-04 18:28:54 INFO     5000 5959
2025-07-04 18:31:23 INFO     >>>>> Generator: Training
2025-07-04 18:31:41 INFO     -------------------------
2025-07-04 18:31:41 INFO     | EM Iteration: 5/5
2025-07-04 18:31:41 INFO     -------------------------
2025-07-04 18:31:41 INFO     >>>>> Using Generator's sample rule
2025-07-04 18:31:41 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 18:31:42 INFO     Predictor: read 1681 rules from list.
2025-07-04 18:31:42 INFO     Preprocess training set
2025-07-04 18:31:42 INFO     >>>>> Predictor: Training
2025-07-04 18:32:26 INFO     1000 5959 8.751645 69332.0
2025-07-04 18:33:10 INFO     2000 5959 8.274855 69349.3
2025-07-04 18:33:53 INFO     3000 5959 7.915068 69340.6
2025-07-04 18:34:36 INFO     4000 5959 7.649601 69297.3
2025-07-04 18:35:20 INFO     5000 5959 7.397815 69219.2
2025-07-04 18:36:01 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 18:36:11 INFO     Data : 2077
2025-07-04 18:36:11 INFO     Hit1 : 0.032740
2025-07-04 18:36:11 INFO     Hit3 : 0.062590
2025-07-04 18:36:11 INFO     Hit10: 0.100144
2025-07-04 18:36:11 INFO     MR   : 1410.980019
2025-07-04 18:36:11 INFO     MRR  : 0.058564
2025-07-04 18:36:11 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 18:36:21 INFO     Data : 2342
2025-07-04 18:36:21 INFO     Hit1 : 0.035440
2025-07-04 18:36:21 INFO     Hit3 : 0.059351
2025-07-04 18:36:21 INFO     Hit10: 0.097780
2025-07-04 18:36:21 INFO     MR   : 1311.475448
2025-07-04 18:36:21 INFO     MRR  : 0.058968
2025-07-04 18:36:21 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 18:38:35 INFO     1000 5959
2025-07-04 18:40:50 INFO     2000 5959
2025-07-04 18:43:02 INFO     3000 5959
2025-07-04 18:45:14 INFO     4000 5959
2025-07-04 18:47:27 INFO     5000 5959
2025-07-04 18:49:37 INFO     >>>>> Generator: Training
2025-07-04 18:49:51 INFO     -------------------------
2025-07-04 18:49:51 INFO     | Post-train Generator
2025-07-04 18:49:51 INFO     -------------------------
2025-07-04 18:49:52 INFO     >>>>> Generator: Training
2025-07-04 18:52:15 INFO     [E01000] Total 2.405224 | Main 2.531102 | RelClus 1.609408 | 
2025-07-04 18:52:15 INFO     -------------------------
2025-07-04 18:52:15 INFO     | Beam Search Best Rules
2025-07-04 18:52:15 INFO     -------------------------
2025-07-04 18:52:15 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 18:52:18 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 18:52:42 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 18:58:21 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:03:01 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 19:06:16 INFO     -------------------------
2025-07-04 19:06:16 INFO     | Train Final Predictor+
2025-07-04 19:06:16 INFO     -------------------------
2025-07-04 19:06:16 INFO     Predictor+: read 18420 rules from list.
2025-07-04 19:06:16 INFO     Preprocess training set
2025-07-04 19:06:16 INFO     -------------------------
2025-07-04 19:06:16 INFO     | Iteration: 1/5
2025-07-04 19:06:16 INFO     -------------------------
2025-07-04 19:06:16 INFO     >>>>> Predictor: Training
2025-07-04 19:10:58 INFO     1000 5959 4.974024 69271.3
2025-07-04 19:15:40 INFO     2000 5959 4.745936 69332.0
2025-07-04 19:20:25 INFO     3000 5959 4.735888 69375.3
2025-07-04 19:25:12 INFO     4000 5959 4.727209 69279.9
2025-07-04 19:29:59 INFO     5000 5959 4.698728 69349.3
2025-07-04 19:34:34 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 19:35:45 INFO     Data : 2077
2025-07-04 19:35:45 INFO     Hit1 : 0.102552
2025-07-04 19:35:45 INFO     Hit3 : 0.185845
2025-07-04 19:35:45 INFO     Hit10: 0.311988
2025-07-04 19:35:45 INFO     MR   : 990.056091
2025-07-04 19:35:45 INFO     MRR  : 0.171132
2025-07-04 19:35:45 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 19:37:05 INFO     Data : 2342
2025-07-04 19:37:05 INFO     Hit1 : 0.127242
2025-07-04 19:37:05 INFO     Hit3 : 0.214774
2025-07-04 19:37:05 INFO     Hit10: 0.317250
2025-07-04 19:37:05 INFO     MR   : 925.491460
2025-07-04 19:37:05 INFO     MRR  : 0.190655
2025-07-04 19:37:05 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/k7_multitask_mmoe_fixed_matrix_7_type_20250704_135545/predictor.pt
2025-07-04 19:37:05 INFO     -------------------------
2025-07-04 19:37:05 INFO     | Iteration: 2/5
2025-07-04 19:37:05 INFO     -------------------------
2025-07-04 19:37:05 INFO     >>>>> Predictor: Training
2025-07-04 19:41:51 INFO     1000 5959 4.627594 69366.7
2025-07-04 19:46:39 INFO     2000 5959 4.665050 69375.3
2025-07-04 19:51:27 INFO     3000 5959 4.656929 69219.2
2025-07-04 19:56:13 INFO     4000 5959 4.670642 69305.9
2025-07-04 20:01:00 INFO     5000 5959 4.658070 69288.6
2025-07-04 20:05:37 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 20:06:47 INFO     Data : 2077
2025-07-04 20:06:47 INFO     Hit1 : 0.092922
2025-07-04 20:06:47 INFO     Hit3 : 0.193548
2025-07-04 20:06:47 INFO     Hit10: 0.321136
2025-07-04 20:06:47 INFO     MR   : 960.809100
2025-07-04 20:06:47 INFO     MRR  : 0.166946
2025-07-04 20:06:47 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 20:08:06 INFO     Data : 2342
2025-07-04 20:08:06 INFO     Hit1 : 0.125534
2025-07-04 20:08:06 INFO     Hit3 : 0.216909
2025-07-04 20:08:06 INFO     Hit10: 0.321947
2025-07-04 20:08:06 INFO     MR   : 896.014518
2025-07-04 20:08:06 INFO     MRR  : 0.191761
2025-07-04 20:08:06 INFO     -------------------------
2025-07-04 20:08:06 INFO     | Iteration: 3/5
2025-07-04 20:08:06 INFO     -------------------------
2025-07-04 20:08:06 INFO     >>>>> Predictor: Training
2025-07-04 20:12:52 INFO     1000 5959 4.635798 69288.6
2025-07-04 20:17:40 INFO     2000 5959 4.636746 69288.6
2025-07-04 20:22:27 INFO     3000 5959 4.629730 69340.6
2025-07-04 20:27:16 INFO     4000 5959 4.628837 69271.3
2025-07-04 20:32:04 INFO     5000 5959 4.659748 69219.2
2025-07-04 20:36:40 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 20:37:50 INFO     Data : 2077
2025-07-04 20:37:50 INFO     Hit1 : 0.090515
2025-07-04 20:37:50 INFO     Hit3 : 0.178142
2025-07-04 20:37:50 INFO     Hit10: 0.302359
2025-07-04 20:37:50 INFO     MR   : 945.693789
2025-07-04 20:37:50 INFO     MRR  : 0.161420
2025-07-04 20:37:50 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 20:39:09 INFO     Data : 2342
2025-07-04 20:39:09 INFO     Hit1 : 0.119129
2025-07-04 20:39:09 INFO     Hit3 : 0.195559
2025-07-04 20:39:09 INFO     Hit10: 0.314688
2025-07-04 20:39:09 INFO     MR   : 877.722673
2025-07-04 20:39:09 INFO     MRR  : 0.181966
2025-07-04 20:39:09 INFO     -------------------------
2025-07-04 20:39:09 INFO     | Iteration: 4/5
2025-07-04 20:39:09 INFO     -------------------------
2025-07-04 20:39:09 INFO     >>>>> Predictor: Training
2025-07-04 20:43:58 INFO     1000 5959 4.608468 69340.6
2025-07-04 20:48:49 INFO     2000 5959 4.577363 69184.5
2025-07-04 20:53:36 INFO     3000 5959 4.654734 69253.9
2025-07-04 20:58:20 INFO     4000 5959 4.616332 69340.6
2025-07-04 21:03:05 INFO     5000 5959 4.623077 69384.0
2025-07-04 21:07:42 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 21:08:51 INFO     Data : 2077
2025-07-04 21:08:51 INFO     Hit1 : 0.090515
2025-07-04 21:08:51 INFO     Hit3 : 0.183438
2025-07-04 21:08:51 INFO     Hit10: 0.313914
2025-07-04 21:08:51 INFO     MR   : 941.969427
2025-07-04 21:08:51 INFO     MRR  : 0.161996
2025-07-04 21:08:51 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 21:10:09 INFO     Data : 2342
2025-07-04 21:10:09 INFO     Hit1 : 0.119129
2025-07-04 21:10:09 INFO     Hit3 : 0.209650
2025-07-04 21:10:09 INFO     Hit10: 0.316823
2025-07-04 21:10:09 INFO     MR   : 873.928480
2025-07-04 21:10:09 INFO     MRR  : 0.186101
2025-07-04 21:10:09 INFO     -------------------------
2025-07-04 21:10:09 INFO     | Iteration: 5/5
2025-07-04 21:10:09 INFO     -------------------------
2025-07-04 21:10:09 INFO     >>>>> Predictor: Training
2025-07-04 21:14:54 INFO     1000 5959 4.613275 69323.3
2025-07-04 21:19:46 INFO     2000 5959 4.597520 69332.0
2025-07-04 21:24:41 INFO     3000 5959 4.637820 69219.2
2025-07-04 21:29:35 INFO     4000 5959 4.621340 69297.3
2025-07-04 21:34:23 INFO     5000 5959 4.602719 69332.0
2025-07-04 21:38:58 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 21:40:06 INFO     Data : 2077
2025-07-04 21:40:06 INFO     Hit1 : 0.085701
2025-07-04 21:40:06 INFO     Hit3 : 0.187289
2025-07-04 21:40:06 INFO     Hit10: 0.315840
2025-07-04 21:40:06 INFO     MR   : 933.037554
2025-07-04 21:40:06 INFO     MRR  : 0.160979
2025-07-04 21:40:06 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 21:41:26 INFO     Data : 2342
2025-07-04 21:41:26 INFO     Hit1 : 0.126388
2025-07-04 21:41:26 INFO     Hit3 : 0.210504
2025-07-04 21:41:26 INFO     Hit10: 0.316823
2025-07-04 21:41:26 INFO     MR   : 864.408625
2025-07-04 21:41:26 INFO     MRR  : 0.191160
2025-07-04 21:41:26 INFO     -------------------------
2025-07-04 21:41:26 INFO     | Final Test MRR: 0.190655
2025-07-04 21:41:26 INFO     -------------------------
