2025-07-02 18:31:37 INFO     is_soft_label: False
2025-07-02 18:31:37 INFO     is_scheduled_sampling: False
2025-07-02 18:31:37 INFO     is_test_mode: False
2025-07-02 18:31:37 INFO     Data loading | DONE!
2025-07-02 18:31:38 INFO     Using full datasets for training, validation, and testing.
2025-07-02 18:31:38 INFO     -------------------------
2025-07-02 18:31:38 INFO     | EM Iteration: 1/5
2025-07-02 18:31:38 INFO     -------------------------
2025-07-02 18:31:38 INFO     >>>>> Using miner's rule
2025-07-02 18:31:38 INFO     Predictor: read 13661 rules from list.
2025-07-02 18:31:39 INFO     Preprocess training set
2025-07-02 18:31:39 INFO     >>>>> Predictor: Training
2025-07-02 18:42:10 INFO     1000 5959 8.299284 69314.6
2025-07-02 18:50:09 INFO     2000 5959 7.689227 69271.3
2025-07-02 18:57:49 INFO     3000 5959 7.425850 69245.2
2025-07-02 19:08:58 INFO     4000 5959 7.285955 69340.6
2025-07-02 19:24:30 INFO     5000 5959 7.136692 69340.6
2025-07-02 19:39:26 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 19:43:16 INFO     Data : 2077
2025-07-02 19:43:16 INFO     Hit1 : 0.065479
2025-07-02 19:43:16 INFO     Hit3 : 0.127106
2025-07-02 19:43:16 INFO     Hit10: 0.199326
2025-07-02 19:43:16 INFO     MR   : 1120.920077
2025-07-02 19:43:16 INFO     MRR  : 0.114382
2025-07-02 19:43:16 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 19:47:34 INFO     Data : 2342
2025-07-02 19:47:34 INFO     Hit1 : 0.078992
2025-07-02 19:47:34 INFO     Hit3 : 0.124253
2025-07-02 19:47:34 INFO     Hit10: 0.208796
2025-07-02 19:47:34 INFO     MR   : 1044.279889
2025-07-02 19:47:34 INFO     MRR  : 0.122250
2025-07-02 19:47:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 20:40:50 INFO     1000 5959
2025-07-02 21:15:39 INFO     2000 5959
2025-07-02 21:47:31 INFO     3000 5959
2025-07-02 22:15:20 INFO     4000 5959
2025-07-02 22:43:11 INFO     5000 5959
2025-07-02 23:11:24 INFO     >>>>> Generator: Training
2025-07-02 23:11:27 INFO     -------------------------
2025-07-02 23:11:27 INFO     | EM Iteration: 2/5
2025-07-02 23:11:27 INFO     -------------------------
2025-07-02 23:11:27 INFO     >>>>> Using Generator's sample rule
2025-07-02 23:11:27 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 23:11:27 INFO     Predictor: read 1910 rules from list.
2025-07-02 23:11:27 INFO     Preprocess training set
2025-07-02 23:11:27 INFO     >>>>> Predictor: Training
2025-07-02 23:12:14 INFO     1000 5959 8.787997 69332.0
2025-07-02 23:13:00 INFO     2000 5959 8.399269 69349.3
2025-07-02 23:13:46 INFO     3000 5959 8.127583 69184.5
2025-07-02 23:14:33 INFO     4000 5959 7.936841 69253.9
2025-07-02 23:15:19 INFO     5000 5959 7.803550 69332.0
2025-07-02 23:16:03 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 23:16:13 INFO     Data : 2077
2025-07-02 23:16:13 INFO     Hit1 : 0.017814
2025-07-02 23:16:13 INFO     Hit3 : 0.032740
2025-07-02 23:16:13 INFO     Hit10: 0.059220
2025-07-02 23:16:13 INFO     MR   : 1454.094367
2025-07-02 23:16:13 INFO     MRR  : 0.033940
2025-07-02 23:16:13 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 23:16:24 INFO     Data : 2342
2025-07-02 23:16:24 INFO     Hit1 : 0.016225
2025-07-02 23:16:24 INFO     Hit3 : 0.035013
2025-07-02 23:16:24 INFO     Hit10: 0.063194
2025-07-02 23:16:24 INFO     MR   : 1341.612084
2025-07-02 23:16:24 INFO     MRR  : 0.034347
2025-07-02 23:16:24 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 23:18:37 INFO     1000 5959
2025-07-02 23:20:50 INFO     2000 5959
2025-07-02 23:23:04 INFO     3000 5959
2025-07-02 23:25:17 INFO     4000 5959
2025-07-02 23:27:30 INFO     5000 5959
2025-07-02 23:29:40 INFO     >>>>> Generator: Training
2025-07-02 23:29:43 INFO     -------------------------
2025-07-02 23:29:43 INFO     | EM Iteration: 3/5
2025-07-02 23:29:43 INFO     -------------------------
2025-07-02 23:29:43 INFO     >>>>> Using Generator's sample rule
2025-07-02 23:29:43 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 23:29:43 INFO     Predictor: read 1910 rules from list.
2025-07-02 23:29:43 INFO     Preprocess training set
2025-07-02 23:29:43 INFO     >>>>> Predictor: Training
2025-07-02 23:30:29 INFO     1000 5959 8.805305 69271.3
2025-07-02 23:31:16 INFO     2000 5959 8.434521 69340.6
2025-07-02 23:32:03 INFO     3000 5959 8.191366 69384.0
2025-07-02 23:32:50 INFO     4000 5959 8.031101 69262.6
2025-07-02 23:33:37 INFO     5000 5959 7.911385 69332.0
2025-07-02 23:34:21 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 23:34:30 INFO     Data : 2077
2025-07-02 23:34:30 INFO     Hit1 : 0.013000
2025-07-02 23:34:30 INFO     Hit3 : 0.019740
2025-07-02 23:34:30 INFO     Hit10: 0.036110
2025-07-02 23:34:30 INFO     MR   : 1498.687049
2025-07-02 23:34:30 INFO     MRR  : 0.023819
2025-07-02 23:34:30 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 23:34:40 INFO     Data : 2342
2025-07-02 23:34:40 INFO     Hit1 : 0.012810
2025-07-02 23:34:40 INFO     Hit3 : 0.020495
2025-07-02 23:34:40 INFO     Hit10: 0.032451
2025-07-02 23:34:40 INFO     MR   : 1390.007686
2025-07-02 23:34:40 INFO     MRR  : 0.023096
2025-07-02 23:34:40 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 23:36:51 INFO     1000 5959
2025-07-02 23:39:02 INFO     2000 5959
2025-07-02 23:41:16 INFO     3000 5959
2025-07-02 23:43:30 INFO     4000 5959
2025-07-02 23:45:44 INFO     5000 5959
2025-07-02 23:47:55 INFO     >>>>> Generator: Training
2025-07-02 23:47:58 INFO     -------------------------
2025-07-02 23:47:58 INFO     | EM Iteration: 4/5
2025-07-02 23:47:58 INFO     -------------------------
2025-07-02 23:47:58 INFO     >>>>> Using Generator's sample rule
2025-07-02 23:47:58 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 23:47:58 INFO     Predictor: read 1936 rules from list.
2025-07-02 23:47:58 INFO     Preprocess training set
2025-07-02 23:47:58 INFO     >>>>> Predictor: Training
2025-07-02 23:48:46 INFO     1000 5959 8.799703 69332.0
2025-07-02 23:49:33 INFO     2000 5959 8.418059 69349.3
2025-07-02 23:50:20 INFO     3000 5959 8.147108 69340.6
2025-07-02 23:51:06 INFO     4000 5959 7.957569 69297.3
2025-07-02 23:51:52 INFO     5000 5959 7.781008 69219.2
2025-07-02 23:52:37 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 23:52:47 INFO     Data : 2077
2025-07-02 23:52:47 INFO     Hit1 : 0.008666
2025-07-02 23:52:47 INFO     Hit3 : 0.021184
2025-07-02 23:52:47 INFO     Hit10: 0.037073
2025-07-02 23:52:47 INFO     MR   : 1518.116755
2025-07-02 23:52:47 INFO     MRR  : 0.022186
2025-07-02 23:52:47 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 23:52:58 INFO     Data : 2342
2025-07-02 23:52:58 INFO     Hit1 : 0.008540
2025-07-02 23:52:58 INFO     Hit3 : 0.017079
2025-07-02 23:52:58 INFO     Hit10: 0.037148
2025-07-02 23:52:58 INFO     MR   : 1393.212639
2025-07-02 23:52:58 INFO     MRR  : 0.020866
2025-07-02 23:52:58 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 23:55:10 INFO     1000 5959
2025-07-02 23:57:24 INFO     2000 5959
2025-07-02 23:59:39 INFO     3000 5959
2025-07-03 00:01:53 INFO     4000 5959
2025-07-03 00:04:07 INFO     5000 5959
2025-07-03 00:06:18 INFO     >>>>> Generator: Training
2025-07-03 00:06:21 INFO     -------------------------
2025-07-03 00:06:21 INFO     | EM Iteration: 5/5
2025-07-03 00:06:21 INFO     -------------------------
2025-07-03 00:06:21 INFO     >>>>> Using Generator's sample rule
2025-07-03 00:06:21 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 00:06:21 INFO     Predictor: read 1971 rules from list.
2025-07-03 00:06:21 INFO     Preprocess training set
2025-07-03 00:06:21 INFO     >>>>> Predictor: Training
2025-07-03 00:07:10 INFO     1000 5959 8.829305 69271.3
2025-07-03 00:07:58 INFO     2000 5959 8.519294 69332.0
2025-07-03 00:08:46 INFO     3000 5959 8.330200 69375.3
2025-07-03 00:09:34 INFO     4000 5959 8.187514 69279.9
2025-07-03 00:10:27 INFO     5000 5959 8.093647 69349.3
2025-07-03 00:11:25 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 00:11:36 INFO     Data : 2077
2025-07-03 00:11:36 INFO     Hit1 : 0.025036
2025-07-03 00:11:36 INFO     Hit3 : 0.054887
2025-07-03 00:11:36 INFO     Hit10: 0.080404
2025-07-03 00:11:36 INFO     MR   : 1415.001926
2025-07-03 00:11:36 INFO     MRR  : 0.047958
2025-07-03 00:11:36 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 00:11:49 INFO     Data : 2342
2025-07-03 00:11:49 INFO     Hit1 : 0.029889
2025-07-03 00:11:49 INFO     Hit3 : 0.052519
2025-07-03 00:11:49 INFO     Hit10: 0.078565
2025-07-03 00:11:49 INFO     MR   : 1324.989112
2025-07-03 00:11:49 INFO     MRR  : 0.050018
2025-07-03 00:11:49 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 00:14:35 INFO     1000 5959
2025-07-03 00:17:21 INFO     2000 5959
2025-07-03 00:20:06 INFO     3000 5959
2025-07-03 00:22:48 INFO     4000 5959
2025-07-03 00:25:32 INFO     5000 5959
2025-07-03 00:28:09 INFO     >>>>> Generator: Training
2025-07-03 00:28:13 INFO     -------------------------
2025-07-03 00:28:13 INFO     | Post-train Generator
2025-07-03 00:28:13 INFO     -------------------------
2025-07-03 00:28:13 INFO     >>>>> Generator: Training
2025-07-03 00:28:49 INFO     [E01000] Total 3.552605 | Main 3.561990 | RelClus 1.872716 | EntType 3.516670
2025-07-03 00:28:49 INFO     -------------------------
2025-07-03 00:28:49 INFO     | Beam Search Best Rules
2025-07-03 00:28:49 INFO     -------------------------
2025-07-03 00:28:49 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 00:28:50 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 00:28:54 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 00:30:02 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 00:30:58 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 00:31:37 INFO     -------------------------
2025-07-03 00:31:37 INFO     | Train Final Predictor+
2025-07-03 00:31:37 INFO     -------------------------
2025-07-03 00:31:37 INFO     Predictor+: read 18420 rules from list.
2025-07-03 00:31:37 INFO     Preprocess training set
2025-07-03 00:31:37 INFO     -------------------------
2025-07-03 00:31:37 INFO     | Iteration: 1/5
2025-07-03 00:31:37 INFO     -------------------------
2025-07-03 00:31:37 INFO     >>>>> Predictor: Training
2025-07-03 00:36:44 INFO     1000 5959 4.873697 69366.7
2025-07-03 00:41:46 INFO     2000 5959 4.743681 69375.3
2025-07-03 00:46:50 INFO     3000 5959 4.714242 69219.2
2025-07-03 00:51:53 INFO     4000 5959 4.705883 69305.9
2025-07-03 00:56:54 INFO     5000 5959 4.665039 69288.6
2025-07-03 01:01:42 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 01:02:56 INFO     Data : 2077
2025-07-03 01:02:56 INFO     Hit1 : 0.092441
2025-07-03 01:02:56 INFO     Hit3 : 0.178142
2025-07-03 01:02:56 INFO     Hit10: 0.317285
2025-07-03 01:02:56 INFO     MR   : 978.035147
2025-07-03 01:02:56 INFO     MRR  : 0.162059
2025-07-03 01:02:56 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 01:04:21 INFO     Data : 2342
2025-07-03 01:04:21 INFO     Hit1 : 0.127242
2025-07-03 01:04:21 INFO     Hit3 : 0.204526
2025-07-03 01:04:21 INFO     Hit10: 0.318104
2025-07-03 01:04:21 INFO     MR   : 900.953672
2025-07-03 01:04:21 INFO     MRR  : 0.188823
2025-07-03 01:04:21 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/PCA_multitask_mmoe_adaptive_matrix_4_type_20250702_183136/predictor.pt
2025-07-03 01:04:21 INFO     -------------------------
2025-07-03 01:04:21 INFO     | Iteration: 2/5
2025-07-03 01:04:21 INFO     -------------------------
2025-07-03 01:04:21 INFO     >>>>> Predictor: Training
2025-07-03 01:09:24 INFO     1000 5959 4.640525 69288.6
2025-07-03 01:14:26 INFO     2000 5959 4.642639 69288.6
2025-07-03 01:19:29 INFO     3000 5959 4.625129 69340.6
2025-07-03 01:24:33 INFO     4000 5959 4.634024 69271.3
2025-07-03 01:29:35 INFO     5000 5959 4.655049 69219.2
2025-07-03 01:34:25 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 01:35:40 INFO     Data : 2077
2025-07-03 01:35:40 INFO     Hit1 : 0.090515
2025-07-03 01:35:40 INFO     Hit3 : 0.174771
2025-07-03 01:35:40 INFO     Hit10: 0.298026
2025-07-03 01:35:40 INFO     MR   : 956.038758
2025-07-03 01:35:40 INFO     MRR  : 0.159383
2025-07-03 01:35:40 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 01:37:04 INFO     Data : 2342
2025-07-03 01:37:04 INFO     Hit1 : 0.108027
2025-07-03 01:37:04 INFO     Hit3 : 0.192997
2025-07-03 01:37:04 INFO     Hit10: 0.307003
2025-07-03 01:37:04 INFO     MR   : 880.253202
2025-07-03 01:37:04 INFO     MRR  : 0.172498
2025-07-03 01:37:04 INFO     -------------------------
2025-07-03 01:37:04 INFO     | Iteration: 3/5
2025-07-03 01:37:04 INFO     -------------------------
2025-07-03 01:37:04 INFO     >>>>> Predictor: Training
2025-07-03 01:42:11 INFO     1000 5959 4.606913 69340.6
2025-07-03 01:47:21 INFO     2000 5959 4.574532 69184.5
2025-07-03 01:52:23 INFO     3000 5959 4.636854 69253.9
2025-07-03 01:57:28 INFO     4000 5959 4.613031 69340.6
2025-07-03 02:02:38 INFO     5000 5959 4.610185 69384.0
2025-07-03 02:07:36 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 02:08:53 INFO     Data : 2077
2025-07-03 02:08:53 INFO     Hit1 : 0.095330
2025-07-03 02:08:53 INFO     Hit3 : 0.185845
2025-07-03 02:08:53 INFO     Hit10: 0.315359
2025-07-03 02:08:53 INFO     MR   : 956.427299
2025-07-03 02:08:53 INFO     MRR  : 0.165612
2025-07-03 02:08:53 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 02:10:19 INFO     Data : 2342
2025-07-03 02:10:19 INFO     Hit1 : 0.122972
2025-07-03 02:10:19 INFO     Hit3 : 0.209223
2025-07-03 02:10:19 INFO     Hit10: 0.315542
2025-07-03 02:10:19 INFO     MR   : 872.598420
2025-07-03 02:10:19 INFO     MRR  : 0.188590
2025-07-03 02:10:19 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/PCA_multitask_mmoe_adaptive_matrix_4_type_20250702_183136/predictor.pt
2025-07-03 02:10:19 INFO     -------------------------
2025-07-03 02:10:19 INFO     | Iteration: 4/5
2025-07-03 02:10:19 INFO     -------------------------
2025-07-03 02:10:19 INFO     >>>>> Predictor: Training
2025-07-03 02:15:22 INFO     1000 5959 4.614888 69323.3
2025-07-03 02:20:25 INFO     2000 5959 4.589589 69332.0
2025-07-03 02:25:28 INFO     3000 5959 4.623508 69219.2
2025-07-03 02:30:32 INFO     4000 5959 4.617271 69297.3
2025-07-03 02:35:38 INFO     5000 5959 4.581583 69332.0
2025-07-03 02:40:33 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 02:41:49 INFO     Data : 2077
2025-07-03 02:41:49 INFO     Hit1 : 0.093404
2025-07-03 02:41:49 INFO     Hit3 : 0.182475
2025-07-03 02:41:49 INFO     Hit10: 0.313914
2025-07-03 02:41:49 INFO     MR   : 922.327155
2025-07-03 02:41:49 INFO     MRR  : 0.164121
2025-07-03 02:41:49 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 02:43:13 INFO     Data : 2342
2025-07-03 02:43:13 INFO     Hit1 : 0.121691
2025-07-03 02:43:13 INFO     Hit3 : 0.208369
2025-07-03 02:43:13 INFO     Hit10: 0.321093
2025-07-03 02:43:13 INFO     MR   : 854.317464
2025-07-03 02:43:13 INFO     MRR  : 0.188458
2025-07-03 02:43:13 INFO     -------------------------
2025-07-03 02:43:13 INFO     | Iteration: 5/5
2025-07-03 02:43:13 INFO     -------------------------
2025-07-03 02:43:13 INFO     >>>>> Predictor: Training
2025-07-03 02:48:19 INFO     1000 5959 4.559011 69245.2
2025-07-03 02:53:27 INFO     2000 5959 4.550088 69262.6
2025-07-03 02:58:37 INFO     3000 5959 4.605361 69332.0
2025-07-03 03:03:43 INFO     4000 5959 4.609644 69366.7
2025-07-03 03:08:52 INFO     5000 5959 4.616272 69262.6
2025-07-03 03:13:44 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 03:15:00 INFO     Data : 2077
2025-07-03 03:15:00 INFO     Hit1 : 0.098700
2025-07-03 03:15:00 INFO     Hit3 : 0.189215
2025-07-03 03:15:00 INFO     Hit10: 0.313433
2025-07-03 03:15:00 INFO     MR   : 921.050554
2025-07-03 03:15:00 INFO     MRR  : 0.169230
2025-07-03 03:15:00 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 03:16:25 INFO     Data : 2342
2025-07-03 03:16:25 INFO     Hit1 : 0.129377
2025-07-03 03:16:25 INFO     Hit3 : 0.207942
2025-07-03 03:16:25 INFO     Hit10: 0.318958
2025-07-03 03:16:25 INFO     MR   : 853.991674
2025-07-03 03:16:25 INFO     MRR  : 0.192457
2025-07-03 03:16:25 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/PCA_multitask_mmoe_adaptive_matrix_4_type_20250702_183136/predictor.pt
2025-07-03 03:16:25 INFO     -------------------------
2025-07-03 03:16:25 INFO     | Final Test MRR: 0.192457
2025-07-03 03:16:25 INFO     -------------------------
