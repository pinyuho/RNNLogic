2025-07-05 20:25:39 INFO     is_soft_label: False
2025-07-05 20:25:39 INFO     is_scheduled_sampling: False
2025-07-05 20:25:39 INFO     is_test_mode: False
2025-07-05 20:25:39 INFO     Data loading | DONE!
2025-07-05 20:25:39 INFO     Using full datasets for training, validation, and testing.
2025-07-05 20:25:39 INFO     -------------------------
2025-07-05 20:25:39 INFO     | EM Iteration: 1/5
2025-07-05 20:25:39 INFO     -------------------------
2025-07-05 20:25:39 INFO     >>>>> Using miner's rule
2025-07-05 20:25:39 INFO     Predictor: read 13661 rules from list.
2025-07-05 20:25:40 INFO     Preprocess training set
2025-07-05 20:25:40 INFO     >>>>> Predictor: Evaluating on valid
2025-07-05 20:27:50 INFO     Data : 2077
2025-07-05 20:27:50 INFO     Hit1 : 0.065479
2025-07-05 20:27:50 INFO     Hit3 : 0.127106
2025-07-05 20:27:50 INFO     Hit10: 0.199326
2025-07-05 20:27:50 INFO     MR   : 1120.902022
2025-07-05 20:27:50 INFO     MRR  : 0.114382
2025-07-05 20:27:50 INFO     >>>>> Predictor: Evaluating on test
2025-07-05 20:30:14 INFO     Data : 2342
2025-07-05 20:30:14 INFO     Hit1 : 0.078992
2025-07-05 20:30:14 INFO     Hit3 : 0.124253
2025-07-05 20:30:14 INFO     Hit10: 0.208796
2025-07-05 20:30:14 INFO     MR   : 1044.269001
2025-07-05 20:30:14 INFO     MRR  : 0.122250
2025-07-05 20:30:14 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-05 21:02:45 INFO     1000 5959
2025-07-05 21:35:37 INFO     2000 5959
2025-07-05 22:08:02 INFO     3000 5959
2025-07-05 22:40:42 INFO     4000 5959
2025-07-05 23:12:47 INFO     5000 5959
2025-07-05 23:45:37 INFO     >>>>> Generator: Training
2025-07-05 23:45:41 INFO     -------------------------
2025-07-05 23:45:41 INFO     | EM Iteration: 2/5
2025-07-05 23:45:41 INFO     -------------------------
2025-07-05 23:45:41 INFO     >>>>> Using Generator's sample rule
2025-07-05 23:45:41 INFO     >>>>> Generator: Rule generation with sampling
2025-07-05 23:45:41 INFO     Predictor: read 1911 rules from list.
2025-07-05 23:45:41 INFO     Preprocess training set
2025-07-05 23:45:41 INFO     >>>>> Predictor: Training
2025-07-05 23:46:35 INFO     1000 5959 8.782327 69314.6
2025-07-05 23:47:29 INFO     2000 5959 8.410087 69271.3
2025-07-05 23:48:23 INFO     3000 5959 8.219261 69245.2
2025-07-05 23:49:17 INFO     4000 5959 8.065555 69340.6
2025-07-05 23:50:11 INFO     5000 5959 7.941184 69340.6
2025-07-05 23:51:03 INFO     >>>>> Predictor: Evaluating on valid
2025-07-05 23:51:13 INFO     Data : 2077
2025-07-05 23:51:13 INFO     Hit1 : 0.025036
2025-07-05 23:51:13 INFO     Hit3 : 0.040924
2025-07-05 23:51:13 INFO     Hit10: 0.064035
2025-07-05 23:51:13 INFO     MR   : 1406.502407
2025-07-05 23:51:13 INFO     MRR  : 0.041153
2025-07-05 23:51:13 INFO     >>>>> Predictor: Evaluating on test
2025-07-05 23:51:25 INFO     Data : 2342
2025-07-05 23:51:25 INFO     Hit1 : 0.019641
2025-07-05 23:51:25 INFO     Hit3 : 0.030743
2025-07-05 23:51:25 INFO     Hit10: 0.056362
2025-07-05 23:51:25 INFO     MR   : 1316.072801
2025-07-05 23:51:25 INFO     MRR  : 0.034766
2025-07-05 23:51:25 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-05 23:54:00 INFO     1000 5959
2025-07-05 23:56:38 INFO     2000 5959
2025-07-05 23:59:10 INFO     3000 5959
2025-07-06 00:01:43 INFO     4000 5959
2025-07-06 00:04:16 INFO     5000 5959
2025-07-06 00:06:49 INFO     >>>>> Generator: Training
2025-07-06 00:06:53 INFO     -------------------------
2025-07-06 00:06:53 INFO     | EM Iteration: 3/5
2025-07-06 00:06:53 INFO     -------------------------
2025-07-06 00:06:53 INFO     >>>>> Using Generator's sample rule
2025-07-06 00:06:53 INFO     >>>>> Generator: Rule generation with sampling
2025-07-06 00:06:53 INFO     Predictor: read 1895 rules from list.
2025-07-06 00:06:53 INFO     Preprocess training set
2025-07-06 00:06:53 INFO     >>>>> Predictor: Training
2025-07-06 00:07:47 INFO     1000 5959 8.811603 69332.0
2025-07-06 00:08:42 INFO     2000 5959 8.474918 69349.3
2025-07-06 00:09:36 INFO     3000 5959 8.263376 69184.5
2025-07-06 00:10:30 INFO     4000 5959 8.094895 69253.9
2025-07-06 00:11:25 INFO     5000 5959 8.003043 69332.0
2025-07-06 00:12:16 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 00:12:27 INFO     Data : 2077
2025-07-06 00:12:27 INFO     Hit1 : 0.000963
2025-07-06 00:12:27 INFO     Hit3 : 0.006740
2025-07-06 00:12:27 INFO     Hit10: 0.017333
2025-07-06 00:12:27 INFO     MR   : 1507.602311
2025-07-06 00:12:27 INFO     MRR  : 0.009847
2025-07-06 00:12:27 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 00:12:38 INFO     Data : 2342
2025-07-06 00:12:38 INFO     Hit1 : 0.001708
2025-07-06 00:12:38 INFO     Hit3 : 0.004697
2025-07-06 00:12:38 INFO     Hit10: 0.013664
2025-07-06 00:12:38 INFO     MR   : 1393.290137
2025-07-06 00:12:38 INFO     MRR  : 0.009002
2025-07-06 00:12:38 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-06 00:15:13 INFO     1000 5959
2025-07-06 00:17:46 INFO     2000 5959
2025-07-06 00:20:19 INFO     3000 5959
2025-07-06 00:22:54 INFO     4000 5959
2025-07-06 00:25:26 INFO     5000 5959
2025-07-06 00:27:56 INFO     >>>>> Generator: Training
2025-07-06 00:28:00 INFO     -------------------------
2025-07-06 00:28:00 INFO     | EM Iteration: 4/5
2025-07-06 00:28:00 INFO     -------------------------
2025-07-06 00:28:00 INFO     >>>>> Using Generator's sample rule
2025-07-06 00:28:00 INFO     >>>>> Generator: Rule generation with sampling
2025-07-06 00:28:00 INFO     Predictor: read 1938 rules from list.
2025-07-06 00:28:00 INFO     Preprocess training set
2025-07-06 00:28:00 INFO     >>>>> Predictor: Training
2025-07-06 00:28:55 INFO     1000 5959 8.796021 69271.3
2025-07-06 00:29:51 INFO     2000 5959 8.415856 69340.6
2025-07-06 00:30:47 INFO     3000 5959 8.157768 69384.0
2025-07-06 00:31:43 INFO     4000 5959 7.991901 69262.6
2025-07-06 00:32:38 INFO     5000 5959 7.849085 69332.0
2025-07-06 00:33:31 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 00:33:42 INFO     Data : 2077
2025-07-06 00:33:42 INFO     Hit1 : 0.001444
2025-07-06 00:33:42 INFO     Hit3 : 0.004333
2025-07-06 00:33:42 INFO     Hit10: 0.014444
2025-07-06 00:33:42 INFO     MR   : 1510.151420
2025-07-06 00:33:42 INFO     MRR  : 0.009348
2025-07-06 00:33:42 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 00:33:54 INFO     Data : 2342
2025-07-06 00:33:54 INFO     Hit1 : 0.001281
2025-07-06 00:33:54 INFO     Hit3 : 0.008540
2025-07-06 00:33:54 INFO     Hit10: 0.017933
2025-07-06 00:33:54 INFO     MR   : 1399.256832
2025-07-06 00:33:54 INFO     MRR  : 0.010711
2025-07-06 00:33:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-06 00:36:29 INFO     1000 5959
2025-07-06 00:39:05 INFO     2000 5959
2025-07-06 00:41:42 INFO     3000 5959
2025-07-06 00:44:20 INFO     4000 5959
2025-07-06 00:46:58 INFO     5000 5959
2025-07-06 00:49:30 INFO     >>>>> Generator: Training
2025-07-06 00:49:34 INFO     -------------------------
2025-07-06 00:49:34 INFO     | EM Iteration: 5/5
2025-07-06 00:49:34 INFO     -------------------------
2025-07-06 00:49:34 INFO     >>>>> Using Generator's sample rule
2025-07-06 00:49:34 INFO     >>>>> Generator: Rule generation with sampling
2025-07-06 00:49:34 INFO     Predictor: read 1972 rules from list.
2025-07-06 00:49:34 INFO     Preprocess training set
2025-07-06 00:49:34 INFO     >>>>> Predictor: Training
2025-07-06 00:50:30 INFO     1000 5959 8.834594 69332.0
2025-07-06 00:51:27 INFO     2000 5959 8.524487 69349.3
2025-07-06 00:52:23 INFO     3000 5959 8.342480 69340.6
2025-07-06 00:53:20 INFO     4000 5959 8.214950 69297.3
2025-07-06 00:54:17 INFO     5000 5959 8.119422 69219.2
2025-07-06 00:55:11 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 00:55:22 INFO     Data : 2077
2025-07-06 00:55:22 INFO     Hit1 : 0.001444
2025-07-06 00:55:22 INFO     Hit3 : 0.006259
2025-07-06 00:55:22 INFO     Hit10: 0.015888
2025-07-06 00:55:22 INFO     MR   : 1543.473038
2025-07-06 00:55:22 INFO     MRR  : 0.010174
2025-07-06 00:55:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 00:55:36 INFO     Data : 2342
2025-07-06 00:55:36 INFO     Hit1 : 0.002989
2025-07-06 00:55:36 INFO     Hit3 : 0.009394
2025-07-06 00:55:36 INFO     Hit10: 0.017933
2025-07-06 00:55:36 INFO     MR   : 1423.962852
2025-07-06 00:55:36 INFO     MRR  : 0.012100
2025-07-06 00:55:36 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-06 00:58:13 INFO     1000 5959
2025-07-06 01:00:51 INFO     2000 5959
2025-07-06 01:03:31 INFO     3000 5959
2025-07-06 01:06:11 INFO     4000 5959
2025-07-06 01:08:48 INFO     5000 5959
2025-07-06 01:11:20 INFO     >>>>> Generator: Training
2025-07-06 01:11:24 INFO     -------------------------
2025-07-06 01:11:24 INFO     | Post-train Generator
2025-07-06 01:11:24 INFO     -------------------------
2025-07-06 01:11:25 INFO     >>>>> Generator: Training
2025-07-06 01:12:10 INFO     [E01000] Total 3.158241 | Main 3.168869 | RelClus 2.129153 | 
2025-07-06 01:12:10 INFO     -------------------------
2025-07-06 01:12:10 INFO     | Beam Search Best Rules
2025-07-06 01:12:10 INFO     -------------------------
2025-07-06 01:12:10 INFO     >>>>> Generator: Rule generation with beam search
2025-07-06 01:12:10 INFO     >>>>> Generator: Rule generation with beam search
2025-07-06 01:12:16 INFO     >>>>> Generator: Rule generation with beam search
2025-07-06 01:13:29 INFO     >>>>> Generator: Rule generation with beam search
2025-07-06 01:14:29 INFO     >>>>> Generator: Rule generation with beam search
2025-07-06 01:15:10 INFO     -------------------------
2025-07-06 01:15:10 INFO     | Train Final Predictor+
2025-07-06 01:15:10 INFO     -------------------------
2025-07-06 01:15:10 INFO     Predictor+: read 18420 rules from list.
2025-07-06 01:15:11 INFO     Preprocess training set
2025-07-06 01:15:11 INFO     -------------------------
2025-07-06 01:15:11 INFO     | Iteration: 1/5
2025-07-06 01:15:11 INFO     -------------------------
2025-07-06 01:15:11 INFO     >>>>> Predictor: Training
2025-07-06 01:20:00 INFO     1000 5959 4.899885 69271.3
2025-07-06 01:24:55 INFO     2000 5959 4.726380 69332.0
2025-07-06 01:29:43 INFO     3000 5959 4.710270 69375.3
2025-07-06 01:34:32 INFO     4000 5959 4.709545 69279.9
2025-07-06 01:39:20 INFO     5000 5959 4.680012 69349.3
2025-07-06 01:43:59 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 01:45:13 INFO     Data : 2077
2025-07-06 01:45:13 INFO     Hit1 : 0.099663
2025-07-06 01:45:13 INFO     Hit3 : 0.183438
2025-07-06 01:45:13 INFO     Hit10: 0.317285
2025-07-06 01:45:13 INFO     MR   : 982.127588
2025-07-06 01:45:13 INFO     MRR  : 0.166752
2025-07-06 01:45:13 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 01:46:36 INFO     Data : 2342
2025-07-06 01:46:36 INFO     Hit1 : 0.130658
2025-07-06 01:46:36 INFO     Hit3 : 0.207942
2025-07-06 01:46:36 INFO     Hit10: 0.318104
2025-07-06 01:46:36 INFO     MR   : 917.146456
2025-07-06 01:46:36 INFO     MRR  : 0.192411
2025-07-06 01:46:36 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/k5_multitask_mmoe_adaptive_matrix_5_type_20250705_202538/predictor.pt
2025-07-06 01:46:36 INFO     -------------------------
2025-07-06 01:46:36 INFO     | Iteration: 2/5
2025-07-06 01:46:36 INFO     -------------------------
2025-07-06 01:46:36 INFO     >>>>> Predictor: Training
2025-07-06 01:51:35 INFO     1000 5959 4.601721 69366.7
2025-07-06 01:56:33 INFO     2000 5959 4.650168 69375.3
2025-07-06 02:01:29 INFO     3000 5959 4.639885 69219.2
2025-07-06 02:06:22 INFO     4000 5959 4.652993 69305.9
2025-07-06 02:11:16 INFO     5000 5959 4.618414 69288.6
2025-07-06 02:15:57 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 02:17:10 INFO     Data : 2077
2025-07-06 02:17:10 INFO     Hit1 : 0.094848
2025-07-06 02:17:10 INFO     Hit3 : 0.186326
2025-07-06 02:17:10 INFO     Hit10: 0.312470
2025-07-06 02:17:10 INFO     MR   : 944.083534
2025-07-06 02:17:10 INFO     MRR  : 0.165016
2025-07-06 02:17:10 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 02:18:32 INFO     Data : 2342
2025-07-06 02:18:32 INFO     Hit1 : 0.123399
2025-07-06 02:18:32 INFO     Hit3 : 0.213920
2025-07-06 02:18:32 INFO     Hit10: 0.321520
2025-07-06 02:18:32 INFO     MR   : 882.294193
2025-07-06 02:18:32 INFO     MRR  : 0.190083
2025-07-06 02:18:32 INFO     -------------------------
2025-07-06 02:18:32 INFO     | Iteration: 3/5
2025-07-06 02:18:32 INFO     -------------------------
2025-07-06 02:18:32 INFO     >>>>> Predictor: Training
2025-07-06 02:23:26 INFO     1000 5959 4.616465 69288.6
2025-07-06 02:28:20 INFO     2000 5959 4.619483 69288.6
2025-07-06 02:33:14 INFO     3000 5959 4.607623 69340.6
2025-07-06 02:37:56 INFO     4000 5959 4.615464 69271.3
2025-07-06 02:42:03 INFO     5000 5959 4.636705 69219.2
2025-07-06 02:46:00 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 02:47:01 INFO     Data : 2077
2025-07-06 02:47:01 INFO     Hit1 : 0.090034
2025-07-06 02:47:01 INFO     Hit3 : 0.175734
2025-07-06 02:47:01 INFO     Hit10: 0.302359
2025-07-06 02:47:01 INFO     MR   : 931.457631
2025-07-06 02:47:01 INFO     MRR  : 0.159460
2025-07-06 02:47:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 02:48:11 INFO     Data : 2342
2025-07-06 02:48:11 INFO     Hit1 : 0.117421
2025-07-06 02:48:11 INFO     Hit3 : 0.198548
2025-07-06 02:48:11 INFO     Hit10: 0.316396
2025-07-06 02:48:11 INFO     MR   : 863.570026
2025-07-06 02:48:11 INFO     MRR  : 0.181372
2025-07-06 02:48:11 INFO     -------------------------
2025-07-06 02:48:11 INFO     | Iteration: 4/5
2025-07-06 02:48:11 INFO     -------------------------
2025-07-06 02:48:11 INFO     >>>>> Predictor: Training
2025-07-06 02:52:18 INFO     1000 5959 4.594975 69340.6
2025-07-06 02:56:25 INFO     2000 5959 4.563088 69184.5
2025-07-06 03:00:35 INFO     3000 5959 4.625873 69253.9
2025-07-06 03:04:49 INFO     4000 5959 4.600963 69340.6
2025-07-06 03:09:04 INFO     5000 5959 4.597233 69384.0
2025-07-06 03:13:09 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 03:14:12 INFO     Data : 2077
2025-07-06 03:14:12 INFO     Hit1 : 0.093885
2025-07-06 03:14:12 INFO     Hit3 : 0.175253
2025-07-06 03:14:12 INFO     Hit10: 0.313433
2025-07-06 03:14:12 INFO     MR   : 927.925855
2025-07-06 03:14:12 INFO     MRR  : 0.163357
2025-07-06 03:14:12 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 03:15:23 INFO     Data : 2342
2025-07-06 03:15:23 INFO     Hit1 : 0.128523
2025-07-06 03:15:23 INFO     Hit3 : 0.215628
2025-07-06 03:15:23 INFO     Hit10: 0.320239
2025-07-06 03:15:23 INFO     MR   : 860.946627
2025-07-06 03:15:23 INFO     MRR  : 0.193117
2025-07-06 03:15:23 INFO     -------------------------
2025-07-06 03:15:23 INFO     | Iteration: 5/5
2025-07-06 03:15:23 INFO     -------------------------
2025-07-06 03:15:23 INFO     >>>>> Predictor: Training
2025-07-06 03:19:34 INFO     1000 5959 4.604284 69323.3
2025-07-06 03:23:45 INFO     2000 5959 4.583071 69332.0
2025-07-06 03:27:56 INFO     3000 5959 4.616077 69219.2
2025-07-06 03:32:07 INFO     4000 5959 4.611757 69297.3
2025-07-06 03:36:18 INFO     5000 5959 4.576291 69332.0
2025-07-06 03:40:19 INFO     >>>>> Predictor: Evaluating on valid
2025-07-06 03:41:21 INFO     Data : 2077
2025-07-06 03:41:21 INFO     Hit1 : 0.090515
2025-07-06 03:41:21 INFO     Hit3 : 0.181030
2025-07-06 03:41:21 INFO     Hit10: 0.313433
2025-07-06 03:41:21 INFO     MR   : 918.955224
2025-07-06 03:41:21 INFO     MRR  : 0.161942
2025-07-06 03:41:21 INFO     >>>>> Predictor: Evaluating on test
2025-07-06 03:42:31 INFO     Data : 2342
2025-07-06 03:42:31 INFO     Hit1 : 0.126815
2025-07-06 03:42:31 INFO     Hit3 : 0.215628
2025-07-06 03:42:31 INFO     Hit10: 0.318104
2025-07-06 03:42:31 INFO     MR   : 853.461998
2025-07-06 03:42:31 INFO     MRR  : 0.192795
2025-07-06 03:42:31 INFO     -------------------------
2025-07-06 03:42:31 INFO     | Final Test MRR: 0.192411
2025-07-06 03:42:31 INFO     -------------------------
