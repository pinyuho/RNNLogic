2025-07-08 23:57:03 INFO     is_soft_label: False
2025-07-08 23:57:03 INFO     is_scheduled_sampling: False
2025-07-08 23:57:03 INFO     is_test_mode: False
2025-07-08 23:57:03 INFO     Data loading | DONE!
2025-07-08 23:57:03 INFO     Using full datasets for training, validation, and testing.
2025-07-08 23:57:03 INFO     -------------------------
2025-07-08 23:57:03 INFO     | EM Iteration: 1/5
2025-07-08 23:57:03 INFO     -------------------------
2025-07-08 23:57:03 INFO     >>>>> Using miner's rule
2025-07-08 23:57:03 INFO     Predictor: read 13661 rules from list.
2025-07-08 23:57:04 INFO     Preprocess training set
2025-07-08 23:57:04 INFO     >>>>> Predictor: Evaluating on valid
2025-07-08 23:59:00 INFO     Data : 2077
2025-07-08 23:59:00 INFO     Hit1 : 0.065479
2025-07-08 23:59:00 INFO     Hit3 : 0.127106
2025-07-08 23:59:00 INFO     Hit10: 0.199326
2025-07-08 23:59:00 INFO     MR   : 1120.902022
2025-07-08 23:59:00 INFO     MRR  : 0.114382
2025-07-08 23:59:00 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 00:01:11 INFO     Data : 2342
2025-07-09 00:01:11 INFO     Hit1 : 0.078992
2025-07-09 00:01:11 INFO     Hit3 : 0.124253
2025-07-09 00:01:11 INFO     Hit10: 0.208796
2025-07-09 00:01:11 INFO     MR   : 1044.269001
2025-07-09 00:01:11 INFO     MRR  : 0.122250
2025-07-09 00:01:11 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 00:29:58 INFO     1000 5959
2025-07-09 00:59:10 INFO     2000 5959
2025-07-09 01:27:45 INFO     3000 5959
2025-07-09 02:02:52 INFO     4000 5959
2025-07-09 02:31:24 INFO     5000 5959
2025-07-09 03:00:25 INFO     >>>>> Generator: Training
2025-07-09 03:00:29 INFO     -------------------------
2025-07-09 03:00:29 INFO     | EM Iteration: 2/5
2025-07-09 03:00:29 INFO     -------------------------
2025-07-09 03:00:29 INFO     >>>>> Using Generator's sample rule
2025-07-09 03:00:29 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 03:00:29 INFO     Predictor: read 1903 rules from list.
2025-07-09 03:00:29 INFO     Preprocess training set
2025-07-09 03:00:29 INFO     >>>>> Predictor: Training
2025-07-09 03:01:17 INFO     1000 5959 8.781979 69314.6
2025-07-09 03:02:05 INFO     2000 5959 8.409340 69271.3
2025-07-09 03:02:52 INFO     3000 5959 8.217232 69245.2
2025-07-09 03:03:40 INFO     4000 5959 8.063792 69340.6
2025-07-09 03:04:28 INFO     5000 5959 7.939228 69340.6
2025-07-09 03:05:13 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 03:05:23 INFO     Data : 2077
2025-07-09 03:05:23 INFO     Hit1 : 0.025036
2025-07-09 03:05:23 INFO     Hit3 : 0.040924
2025-07-09 03:05:23 INFO     Hit10: 0.064516
2025-07-09 03:05:23 INFO     MR   : 1404.619403
2025-07-09 03:05:23 INFO     MRR  : 0.041232
2025-07-09 03:05:23 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 03:05:34 INFO     Data : 2342
2025-07-09 03:05:34 INFO     Hit1 : 0.019641
2025-07-09 03:05:34 INFO     Hit3 : 0.031170
2025-07-09 03:05:34 INFO     Hit10: 0.058497
2025-07-09 03:05:34 INFO     MR   : 1312.399018
2025-07-09 03:05:34 INFO     MRR  : 0.035219
2025-07-09 03:05:34 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 03:07:53 INFO     1000 5959
2025-07-09 03:10:10 INFO     2000 5959
2025-07-09 03:12:27 INFO     3000 5959
2025-07-09 03:14:44 INFO     4000 5959
2025-07-09 03:17:02 INFO     5000 5959
2025-07-09 03:19:15 INFO     >>>>> Generator: Training
2025-07-09 03:19:18 INFO     -------------------------
2025-07-09 03:19:18 INFO     | EM Iteration: 3/5
2025-07-09 03:19:18 INFO     -------------------------
2025-07-09 03:19:18 INFO     >>>>> Using Generator's sample rule
2025-07-09 03:19:18 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 03:19:19 INFO     Predictor: read 1883 rules from list.
2025-07-09 03:19:19 INFO     Preprocess training set
2025-07-09 03:19:19 INFO     >>>>> Predictor: Training
2025-07-09 03:20:06 INFO     1000 5959 8.811985 69332.0
2025-07-09 03:20:53 INFO     2000 5959 8.476361 69349.3
2025-07-09 03:21:39 INFO     3000 5959 8.267045 69184.5
2025-07-09 03:22:27 INFO     4000 5959 8.098960 69253.9
2025-07-09 03:23:14 INFO     5000 5959 8.004688 69332.0
2025-07-09 03:23:59 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 03:24:09 INFO     Data : 2077
2025-07-09 03:24:09 INFO     Hit1 : 0.010592
2025-07-09 03:24:09 INFO     Hit3 : 0.025999
2025-07-09 03:24:09 INFO     Hit10: 0.050554
2025-07-09 03:24:09 INFO     MR   : 1453.134810
2025-07-09 03:24:09 INFO     MRR  : 0.026664
2025-07-09 03:24:09 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 03:24:19 INFO     Data : 2342
2025-07-09 03:24:19 INFO     Hit1 : 0.014091
2025-07-09 03:24:19 INFO     Hit3 : 0.024765
2025-07-09 03:24:19 INFO     Hit10: 0.046541
2025-07-09 03:24:19 INFO     MR   : 1343.767293
2025-07-09 03:24:19 INFO     MRR  : 0.027904
2025-07-09 03:24:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 03:27:13 INFO     1000 5959
2025-07-09 03:29:26 INFO     2000 5959
2025-07-09 03:31:38 INFO     3000 5959
2025-07-09 03:33:54 INFO     4000 5959
2025-07-09 03:36:07 INFO     5000 5959
2025-07-09 03:38:16 INFO     >>>>> Generator: Training
2025-07-09 03:38:20 INFO     -------------------------
2025-07-09 03:38:20 INFO     | EM Iteration: 4/5
2025-07-09 03:38:20 INFO     -------------------------
2025-07-09 03:38:20 INFO     >>>>> Using Generator's sample rule
2025-07-09 03:38:20 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 03:38:20 INFO     Predictor: read 1906 rules from list.
2025-07-09 03:38:20 INFO     Preprocess training set
2025-07-09 03:38:20 INFO     >>>>> Predictor: Training
2025-07-09 03:39:08 INFO     1000 5959 8.793952 69271.3
2025-07-09 03:39:56 INFO     2000 5959 8.411764 69340.6
2025-07-09 03:40:45 INFO     3000 5959 8.152455 69384.0
2025-07-09 03:41:32 INFO     4000 5959 7.981135 69262.6
2025-07-09 03:42:20 INFO     5000 5959 7.839825 69332.0
2025-07-09 03:43:06 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 03:43:16 INFO     Data : 2077
2025-07-09 03:43:16 INFO     Hit1 : 0.001444
2025-07-09 03:43:16 INFO     Hit3 : 0.004333
2025-07-09 03:43:16 INFO     Hit10: 0.014444
2025-07-09 03:43:16 INFO     MR   : 1511.442465
2025-07-09 03:43:16 INFO     MRR  : 0.009346
2025-07-09 03:43:16 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 03:43:27 INFO     Data : 2342
2025-07-09 03:43:27 INFO     Hit1 : 0.001281
2025-07-09 03:43:27 INFO     Hit3 : 0.008540
2025-07-09 03:43:27 INFO     Hit10: 0.017933
2025-07-09 03:43:27 INFO     MR   : 1399.940009
2025-07-09 03:43:27 INFO     MRR  : 0.010701
2025-07-09 03:43:27 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 03:45:44 INFO     1000 5959
2025-07-09 03:48:00 INFO     2000 5959
2025-07-09 03:50:16 INFO     3000 5959
2025-07-09 03:52:35 INFO     4000 5959
2025-07-09 03:54:53 INFO     5000 5959
2025-07-09 03:57:08 INFO     >>>>> Generator: Training
2025-07-09 03:57:11 INFO     -------------------------
2025-07-09 03:57:11 INFO     | EM Iteration: 5/5
2025-07-09 03:57:11 INFO     -------------------------
2025-07-09 03:57:11 INFO     >>>>> Using Generator's sample rule
2025-07-09 03:57:11 INFO     >>>>> Generator: Rule generation with sampling
2025-07-09 03:57:12 INFO     Predictor: read 1922 rules from list.
2025-07-09 03:57:12 INFO     Preprocess training set
2025-07-09 03:57:12 INFO     >>>>> Predictor: Training
2025-07-09 03:57:59 INFO     1000 5959 8.819443 69332.0
2025-07-09 03:58:46 INFO     2000 5959 8.471827 69349.3
2025-07-09 03:59:32 INFO     3000 5959 8.246694 69340.6
2025-07-09 04:00:19 INFO     4000 5959 8.104503 69297.3
2025-07-09 04:01:06 INFO     5000 5959 7.953205 69219.2
2025-07-09 04:01:51 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 04:02:01 INFO     Data : 2077
2025-07-09 04:02:01 INFO     Hit1 : 0.013962
2025-07-09 04:02:01 INFO     Hit3 : 0.022147
2025-07-09 04:02:01 INFO     Hit10: 0.032258
2025-07-09 04:02:01 INFO     MR   : 1536.642273
2025-07-09 04:02:01 INFO     MRR  : 0.024271
2025-07-09 04:02:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 04:02:12 INFO     Data : 2342
2025-07-09 04:02:12 INFO     Hit1 : 0.011102
2025-07-09 04:02:12 INFO     Hit3 : 0.017506
2025-07-09 04:02:12 INFO     Hit10: 0.031170
2025-07-09 04:02:12 INFO     MR   : 1413.320880
2025-07-09 04:02:12 INFO     MRR  : 0.020656
2025-07-09 04:02:12 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-09 04:04:28 INFO     1000 5959
2025-07-09 04:06:44 INFO     2000 5959
2025-07-09 04:08:58 INFO     3000 5959
2025-07-09 04:11:12 INFO     4000 5959
2025-07-09 04:13:26 INFO     5000 5959
2025-07-09 04:15:37 INFO     >>>>> Generator: Training
2025-07-09 04:15:41 INFO     -------------------------
2025-07-09 04:15:41 INFO     | Post-train Generator
2025-07-09 04:15:41 INFO     -------------------------
2025-07-09 04:15:42 INFO     >>>>> Generator: Training
2025-07-09 04:16:20 INFO     [E01000] Total 26.470942 | Main 4.469267 | RelClus 3.094968 | EntType 29.537991
2025-07-09 04:16:20 INFO     -------------------------
2025-07-09 04:16:20 INFO     | Beam Search Best Rules
2025-07-09 04:16:20 INFO     -------------------------
2025-07-09 04:16:20 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 04:16:21 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 04:16:26 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 04:17:32 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 04:18:25 INFO     >>>>> Generator: Rule generation with beam search
2025-07-09 04:19:02 INFO     -------------------------
2025-07-09 04:19:02 INFO     | Train Final Predictor+
2025-07-09 04:19:02 INFO     -------------------------
2025-07-09 04:19:02 INFO     Predictor+: read 18420 rules from list.
2025-07-09 04:19:02 INFO     Preprocess training set
2025-07-09 04:19:02 INFO     -------------------------
2025-07-09 04:19:02 INFO     | Iteration: 1/5
2025-07-09 04:19:02 INFO     -------------------------
2025-07-09 04:19:02 INFO     >>>>> Predictor: Training
2025-07-09 04:25:01 INFO     1000 5959 5.287593 69271.3
2025-07-09 04:30:51 INFO     2000 5959 5.179885 69332.0
2025-07-09 04:36:41 INFO     3000 5959 5.156957 69375.3
2025-07-09 04:42:33 INFO     4000 5959 5.129418 69279.9
2025-07-09 04:48:22 INFO     5000 5959 5.099798 69349.3
2025-07-09 04:53:54 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 04:55:22 INFO     Data : 2077
2025-07-09 04:55:22 INFO     Hit1 : 0.066442
2025-07-09 04:55:22 INFO     Hit3 : 0.120366
2025-07-09 04:55:22 INFO     Hit10: 0.195474
2025-07-09 04:55:22 INFO     MR   : 1251.569571
2025-07-09 04:55:22 INFO     MRR  : 0.108262
2025-07-09 04:55:22 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 04:57:02 INFO     Data : 2342
2025-07-09 04:57:02 INFO     Hit1 : 0.087532
2025-07-09 04:57:02 INFO     Hit3 : 0.138770
2025-07-09 04:57:02 INFO     Hit10: 0.195132
2025-07-09 04:57:02 INFO     MR   : 1164.652007
2025-07-09 04:57:02 INFO     MRR  : 0.125768
2025-07-09 04:57:02 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/ablations/baseline_rotate_multitask_mmoe_adaptive_matrix_3_type_20250708_235702/predictor.pt
2025-07-09 04:57:02 INFO     -------------------------
2025-07-09 04:57:02 INFO     | Iteration: 2/5
2025-07-09 04:57:02 INFO     -------------------------
2025-07-09 04:57:02 INFO     >>>>> Predictor: Training
2025-07-09 05:02:50 INFO     1000 5959 5.076407 69366.7
2025-07-09 05:08:48 INFO     2000 5959 5.089342 69375.3
2025-07-09 05:14:45 INFO     3000 5959 5.088269 69219.2
2025-07-09 05:20:39 INFO     4000 5959 5.084134 69305.9
2025-07-09 05:26:31 INFO     5000 5959 5.069840 69288.6
2025-07-09 05:32:09 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 05:33:38 INFO     Data : 2077
2025-07-09 05:33:38 INFO     Hit1 : 0.064998
2025-07-09 05:33:38 INFO     Hit3 : 0.121329
2025-07-09 05:33:38 INFO     Hit10: 0.196437
2025-07-09 05:33:38 INFO     MR   : 1217.608811
2025-07-09 05:33:38 INFO     MRR  : 0.107564
2025-07-09 05:33:38 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 05:35:19 INFO     Data : 2342
2025-07-09 05:35:19 INFO     Hit1 : 0.089240
2025-07-09 05:35:19 INFO     Hit3 : 0.137489
2025-07-09 05:35:19 INFO     Hit10: 0.195559
2025-07-09 05:35:19 INFO     MR   : 1128.299317
2025-07-09 05:35:19 INFO     MRR  : 0.125273
2025-07-09 05:35:19 INFO     -------------------------
2025-07-09 05:35:19 INFO     | Iteration: 3/5
2025-07-09 05:35:19 INFO     -------------------------
2025-07-09 05:35:19 INFO     >>>>> Predictor: Training
2025-07-09 05:41:07 INFO     1000 5959 5.078017 69288.6
2025-07-09 05:46:56 INFO     2000 5959 5.073949 69288.6
2025-07-09 05:52:45 INFO     3000 5959 5.063484 69340.6
2025-07-09 05:58:33 INFO     4000 5959 5.066078 69271.3
2025-07-09 06:04:22 INFO     5000 5959 5.099227 69219.2
2025-07-09 06:09:56 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 06:11:24 INFO     Data : 2077
2025-07-09 06:11:24 INFO     Hit1 : 0.065961
2025-07-09 06:11:24 INFO     Hit3 : 0.122292
2025-07-09 06:11:24 INFO     Hit10: 0.195474
2025-07-09 06:11:24 INFO     MR   : 1210.168994
2025-07-09 06:11:24 INFO     MRR  : 0.108761
2025-07-09 06:11:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 06:13:04 INFO     Data : 2342
2025-07-09 06:13:04 INFO     Hit1 : 0.093083
2025-07-09 06:13:04 INFO     Hit3 : 0.141332
2025-07-09 06:13:04 INFO     Hit10: 0.192143
2025-07-09 06:13:04 INFO     MR   : 1112.351623
2025-07-09 06:13:04 INFO     MRR  : 0.129071
2025-07-09 06:13:04 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/ablations/baseline_rotate_multitask_mmoe_adaptive_matrix_3_type_20250708_235702/predictor.pt
2025-07-09 06:13:04 INFO     -------------------------
2025-07-09 06:13:04 INFO     | Iteration: 4/5
2025-07-09 06:13:04 INFO     -------------------------
2025-07-09 06:13:04 INFO     >>>>> Predictor: Training
2025-07-09 06:18:53 INFO     1000 5959 5.055609 69340.6
2025-07-09 06:24:43 INFO     2000 5959 5.038186 69184.5
2025-07-09 06:30:32 INFO     3000 5959 5.114019 69253.9
2025-07-09 06:36:20 INFO     4000 5959 5.063359 69340.6
2025-07-09 06:42:11 INFO     5000 5959 5.067112 69384.0
2025-07-09 06:47:51 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 06:49:21 INFO     Data : 2077
2025-07-09 06:49:21 INFO     Hit1 : 0.060183
2025-07-09 06:49:21 INFO     Hit3 : 0.114107
2025-07-09 06:49:21 INFO     Hit10: 0.194511
2025-07-09 06:49:21 INFO     MR   : 1207.680790
2025-07-09 06:49:21 INFO     MRR  : 0.103447
2025-07-09 06:49:21 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 06:51:03 INFO     Data : 2342
2025-07-09 06:51:03 INFO     Hit1 : 0.094364
2025-07-09 06:51:03 INFO     Hit3 : 0.140905
2025-07-09 06:51:03 INFO     Hit10: 0.193851
2025-07-09 06:51:03 INFO     MR   : 1118.556789
2025-07-09 06:51:03 INFO     MRR  : 0.128746
2025-07-09 06:51:03 INFO     -------------------------
2025-07-09 06:51:03 INFO     | Iteration: 5/5
2025-07-09 06:51:03 INFO     -------------------------
2025-07-09 06:51:03 INFO     >>>>> Predictor: Training
2025-07-09 06:56:59 INFO     1000 5959 5.076690 69323.3
2025-07-09 07:02:53 INFO     2000 5959 5.075015 69332.0
2025-07-09 07:08:48 INFO     3000 5959 5.086707 69219.2
2025-07-09 07:14:43 INFO     4000 5959 5.060283 69297.3
2025-07-09 07:20:38 INFO     5000 5959 5.037537 69332.0
2025-07-09 07:26:18 INFO     >>>>> Predictor: Evaluating on valid
2025-07-09 07:27:48 INFO     Data : 2077
2025-07-09 07:27:48 INFO     Hit1 : 0.060664
2025-07-09 07:27:48 INFO     Hit3 : 0.115551
2025-07-09 07:27:48 INFO     Hit10: 0.194511
2025-07-09 07:27:48 INFO     MR   : 1199.096533
2025-07-09 07:27:48 INFO     MRR  : 0.104285
2025-07-09 07:27:48 INFO     >>>>> Predictor: Evaluating on test
2025-07-09 07:29:29 INFO     Data : 2342
2025-07-09 07:29:29 INFO     Hit1 : 0.092229
2025-07-09 07:29:29 INFO     Hit3 : 0.140051
2025-07-09 07:29:29 INFO     Hit10: 0.194278
2025-07-09 07:29:29 INFO     MR   : 1106.288642
2025-07-09 07:29:29 INFO     MRR  : 0.127524
2025-07-09 07:29:29 INFO     -------------------------
2025-07-09 07:29:29 INFO     | Final Test MRR: 0.129071
2025-07-09 07:29:29 INFO     -------------------------
