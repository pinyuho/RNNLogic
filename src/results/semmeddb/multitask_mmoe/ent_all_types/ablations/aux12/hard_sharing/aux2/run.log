2025-07-04 00:11:55 INFO     is_soft_label: False
2025-07-04 00:11:55 INFO     is_scheduled_sampling: False
2025-07-04 00:11:55 INFO     is_test_mode: False
2025-07-04 00:11:55 INFO     Data loading | DONE!
2025-07-04 00:11:55 INFO     Using full datasets for training, validation, and testing.
2025-07-04 00:11:55 INFO     -------------------------
2025-07-04 00:11:55 INFO     | EM Iteration: 1/5
2025-07-04 00:11:55 INFO     -------------------------
2025-07-04 00:11:55 INFO     >>>>> Using miner's rule
2025-07-04 00:11:55 INFO     Predictor: read 13661 rules from list.
2025-07-04 00:11:56 INFO     Preprocess training set
2025-07-04 00:11:56 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 00:13:54 INFO     Data : 2077
2025-07-04 00:13:54 INFO     Hit1 : 0.065479
2025-07-04 00:13:54 INFO     Hit3 : 0.127106
2025-07-04 00:13:54 INFO     Hit10: 0.199326
2025-07-04 00:13:54 INFO     MR   : 1120.902022
2025-07-04 00:13:54 INFO     MRR  : 0.114382
2025-07-04 00:13:54 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 00:16:08 INFO     Data : 2342
2025-07-04 00:16:08 INFO     Hit1 : 0.078992
2025-07-04 00:16:08 INFO     Hit3 : 0.124253
2025-07-04 00:16:08 INFO     Hit10: 0.208796
2025-07-04 00:16:08 INFO     MR   : 1044.269001
2025-07-04 00:16:08 INFO     MRR  : 0.122250
2025-07-04 00:16:08 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 00:46:12 INFO     1000 5959
2025-07-04 01:16:57 INFO     2000 5959
2025-07-04 01:47:11 INFO     3000 5959
2025-07-04 02:16:37 INFO     4000 5959
2025-07-04 02:45:35 INFO     5000 5959
2025-07-04 03:14:56 INFO     >>>>> Generator: Training
2025-07-04 03:14:57 INFO     -------------------------
2025-07-04 03:14:57 INFO     | EM Iteration: 2/5
2025-07-04 03:14:57 INFO     -------------------------
2025-07-04 03:14:57 INFO     >>>>> Using Generator's sample rule
2025-07-04 03:14:57 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 03:14:57 INFO     Predictor: read 1890 rules from list.
2025-07-04 03:14:57 INFO     Preprocess training set
2025-07-04 03:14:57 INFO     >>>>> Predictor: Training
2025-07-04 03:15:44 INFO     1000 5959 8.799099 69314.6
2025-07-04 03:16:31 INFO     2000 5959 8.419061 69271.3
2025-07-04 03:17:18 INFO     3000 5959 8.196811 69245.2
2025-07-04 03:18:04 INFO     4000 5959 8.007201 69340.6
2025-07-04 03:18:51 INFO     5000 5959 7.881886 69340.6
2025-07-04 03:19:35 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 03:19:45 INFO     Data : 2077
2025-07-04 03:19:45 INFO     Hit1 : 0.012518
2025-07-04 03:19:45 INFO     Hit3 : 0.022147
2025-07-04 03:19:45 INFO     Hit10: 0.039961
2025-07-04 03:19:45 INFO     MR   : 1465.686808
2025-07-04 03:19:45 INFO     MRR  : 0.024793
2025-07-04 03:19:45 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 03:19:55 INFO     Data : 2342
2025-07-04 03:19:55 INFO     Hit1 : 0.010248
2025-07-04 03:19:55 INFO     Hit3 : 0.020068
2025-07-04 03:19:55 INFO     Hit10: 0.040137
2025-07-04 03:19:55 INFO     MR   : 1353.945346
2025-07-04 03:19:55 INFO     MRR  : 0.022470
2025-07-04 03:19:55 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 03:22:10 INFO     1000 5959
2025-07-04 03:24:24 INFO     2000 5959
2025-07-04 03:26:38 INFO     3000 5959
2025-07-04 03:28:53 INFO     4000 5959
2025-07-04 03:31:07 INFO     5000 5959
2025-07-04 03:33:18 INFO     >>>>> Generator: Training
2025-07-04 03:33:19 INFO     -------------------------
2025-07-04 03:33:19 INFO     | EM Iteration: 3/5
2025-07-04 03:33:19 INFO     -------------------------
2025-07-04 03:33:19 INFO     >>>>> Using Generator's sample rule
2025-07-04 03:33:19 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 03:33:19 INFO     Predictor: read 1906 rules from list.
2025-07-04 03:33:19 INFO     Preprocess training set
2025-07-04 03:33:19 INFO     >>>>> Predictor: Training
2025-07-04 03:34:05 INFO     1000 5959 8.831771 69332.0
2025-07-04 03:34:52 INFO     2000 5959 8.527367 69349.3
2025-07-04 03:35:39 INFO     3000 5959 8.347020 69184.5
2025-07-04 03:36:25 INFO     4000 5959 8.220646 69253.9
2025-07-04 03:37:12 INFO     5000 5959 8.142592 69332.0
2025-07-04 03:37:57 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 03:38:07 INFO     Data : 2077
2025-07-04 03:38:07 INFO     Hit1 : 0.011074
2025-07-04 03:38:07 INFO     Hit3 : 0.023110
2025-07-04 03:38:07 INFO     Hit10: 0.052480
2025-07-04 03:38:07 INFO     MR   : 1455.065961
2025-07-04 03:38:07 INFO     MRR  : 0.027500
2025-07-04 03:38:07 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 03:38:18 INFO     Data : 2342
2025-07-04 03:38:18 INFO     Hit1 : 0.011102
2025-07-04 03:38:18 INFO     Hit3 : 0.020495
2025-07-04 03:38:18 INFO     Hit10: 0.050811
2025-07-04 03:38:18 INFO     MR   : 1347.527114
2025-07-04 03:38:18 INFO     MRR  : 0.025803
2025-07-04 03:38:18 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 03:40:31 INFO     1000 5959
2025-07-04 03:42:47 INFO     2000 5959
2025-07-04 03:45:05 INFO     3000 5959
2025-07-04 03:47:20 INFO     4000 5959
2025-07-04 03:49:35 INFO     5000 5959
2025-07-04 03:51:45 INFO     >>>>> Generator: Training
2025-07-04 03:51:46 INFO     -------------------------
2025-07-04 03:51:46 INFO     | EM Iteration: 4/5
2025-07-04 03:51:46 INFO     -------------------------
2025-07-04 03:51:46 INFO     >>>>> Using Generator's sample rule
2025-07-04 03:51:46 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 03:51:46 INFO     Predictor: read 1920 rules from list.
2025-07-04 03:51:46 INFO     Preprocess training set
2025-07-04 03:51:46 INFO     >>>>> Predictor: Training
2025-07-04 03:52:34 INFO     1000 5959 8.801966 69271.3
2025-07-04 03:53:21 INFO     2000 5959 8.451755 69340.6
2025-07-04 03:54:10 INFO     3000 5959 8.223736 69384.0
2025-07-04 03:54:57 INFO     4000 5959 8.079947 69262.6
2025-07-04 03:55:46 INFO     5000 5959 7.957931 69332.0
2025-07-04 03:56:32 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 03:56:42 INFO     Data : 2077
2025-07-04 03:56:42 INFO     Hit1 : 0.002407
2025-07-04 03:56:42 INFO     Hit3 : 0.005296
2025-07-04 03:56:42 INFO     Hit10: 0.013481
2025-07-04 03:56:42 INFO     MR   : 1511.397208
2025-07-04 03:56:42 INFO     MRR  : 0.009783
2025-07-04 03:56:42 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 03:56:53 INFO     Data : 2342
2025-07-04 03:56:53 INFO     Hit1 : 0.002135
2025-07-04 03:56:53 INFO     Hit3 : 0.005978
2025-07-04 03:56:53 INFO     Hit10: 0.016225
2025-07-04 03:56:53 INFO     MR   : 1408.448121
2025-07-04 03:56:53 INFO     MRR  : 0.009851
2025-07-04 03:56:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 03:59:11 INFO     1000 5959
2025-07-04 04:01:30 INFO     2000 5959
2025-07-04 04:03:47 INFO     3000 5959
2025-07-04 04:06:12 INFO     4000 5959
2025-07-04 04:08:39 INFO     5000 5959
2025-07-04 04:11:01 INFO     >>>>> Generator: Training
2025-07-04 04:11:02 INFO     -------------------------
2025-07-04 04:11:02 INFO     | EM Iteration: 5/5
2025-07-04 04:11:02 INFO     -------------------------
2025-07-04 04:11:02 INFO     >>>>> Using Generator's sample rule
2025-07-04 04:11:02 INFO     >>>>> Generator: Rule generation with sampling
2025-07-04 04:11:02 INFO     Predictor: read 1941 rules from list.
2025-07-04 04:11:02 INFO     Preprocess training set
2025-07-04 04:11:02 INFO     >>>>> Predictor: Training
2025-07-04 04:11:50 INFO     1000 5959 8.821905 69332.0
2025-07-04 04:12:40 INFO     2000 5959 8.487856 69349.3
2025-07-04 04:13:29 INFO     3000 5959 8.285822 69340.6
2025-07-04 04:14:18 INFO     4000 5959 8.141042 69297.3
2025-07-04 04:15:07 INFO     5000 5959 8.012525 69219.2
2025-07-04 04:15:54 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 04:16:04 INFO     Data : 2077
2025-07-04 04:16:04 INFO     Hit1 : 0.020703
2025-07-04 04:16:04 INFO     Hit3 : 0.049591
2025-07-04 04:16:04 INFO     Hit10: 0.075590
2025-07-04 04:16:04 INFO     MR   : 1453.288878
2025-07-04 04:16:04 INFO     MRR  : 0.042838
2025-07-04 04:16:04 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 04:16:15 INFO     Data : 2342
2025-07-04 04:16:15 INFO     Hit1 : 0.021776
2025-07-04 04:16:15 INFO     Hit3 : 0.052519
2025-07-04 04:16:15 INFO     Hit10: 0.075576
2025-07-04 04:16:15 INFO     MR   : 1349.469044
2025-07-04 04:16:15 INFO     MRR  : 0.044794
2025-07-04 04:16:15 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-04 04:18:35 INFO     1000 5959
2025-07-04 04:20:55 INFO     2000 5959
2025-07-04 04:23:16 INFO     3000 5959
2025-07-04 04:25:38 INFO     4000 5959
2025-07-04 04:28:00 INFO     5000 5959
2025-07-04 04:30:19 INFO     >>>>> Generator: Training
2025-07-04 04:30:22 INFO     -------------------------
2025-07-04 04:30:22 INFO     | Post-train Generator
2025-07-04 04:30:22 INFO     -------------------------
2025-07-04 04:30:22 INFO     >>>>> Generator: Training
2025-07-04 04:30:52 INFO     [E01000] Total 7.230757 | Main 3.747158 | EntType 7.991209
2025-07-04 04:30:52 INFO     -------------------------
2025-07-04 04:30:52 INFO     | Beam Search Best Rules
2025-07-04 04:30:52 INFO     -------------------------
2025-07-04 04:30:52 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 04:30:54 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 04:31:04 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 04:34:46 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 04:38:03 INFO     >>>>> Generator: Rule generation with beam search
2025-07-04 04:40:26 INFO     -------------------------
2025-07-04 04:40:26 INFO     | Train Final Predictor+
2025-07-04 04:40:26 INFO     -------------------------
2025-07-04 04:40:26 INFO     Predictor+: read 18420 rules from list.
2025-07-04 04:40:26 INFO     Preprocess training set
2025-07-04 04:40:26 INFO     -------------------------
2025-07-04 04:40:26 INFO     | Iteration: 1/5
2025-07-04 04:40:26 INFO     -------------------------
2025-07-04 04:40:26 INFO     >>>>> Predictor: Training
2025-07-04 04:44:45 INFO     1000 5959 4.902501 69271.3
2025-07-04 04:49:06 INFO     2000 5959 4.726435 69332.0
2025-07-04 04:53:31 INFO     3000 5959 4.712141 69375.3
2025-07-04 04:57:54 INFO     4000 5959 4.716167 69279.9
2025-07-04 05:02:13 INFO     5000 5959 4.686996 69349.3
2025-07-04 05:06:20 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 05:07:24 INFO     Data : 2077
2025-07-04 05:07:24 INFO     Hit1 : 0.103033
2025-07-04 05:07:24 INFO     Hit3 : 0.188252
2025-07-04 05:07:24 INFO     Hit10: 0.315840
2025-07-04 05:07:24 INFO     MR   : 985.499759
2025-07-04 05:07:24 INFO     MRR  : 0.170527
2025-07-04 05:07:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 05:08:36 INFO     Data : 2342
2025-07-04 05:08:36 INFO     Hit1 : 0.128950
2025-07-04 05:08:36 INFO     Hit3 : 0.205807
2025-07-04 05:08:36 INFO     Hit10: 0.315969
2025-07-04 05:08:36 INFO     MR   : 920.665884
2025-07-04 05:08:36 INFO     MRR  : 0.190739
2025-07-04 05:08:36 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/Aux2_multitask_hard_sharing_adaptive_matrix_3_type_20250704_001153/predictor.pt
2025-07-04 05:08:36 INFO     -------------------------
2025-07-04 05:08:36 INFO     | Iteration: 2/5
2025-07-04 05:08:36 INFO     -------------------------
2025-07-04 05:08:36 INFO     >>>>> Predictor: Training
2025-07-04 05:12:54 INFO     1000 5959 4.605044 69366.7
2025-07-04 05:17:12 INFO     2000 5959 4.654889 69375.3
2025-07-04 05:21:31 INFO     3000 5959 4.640680 69219.2
2025-07-04 05:25:48 INFO     4000 5959 4.655639 69305.9
2025-07-04 05:30:07 INFO     5000 5959 4.620095 69288.6
2025-07-04 05:34:19 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 05:35:24 INFO     Data : 2077
2025-07-04 05:35:24 INFO     Hit1 : 0.090515
2025-07-04 05:35:24 INFO     Hit3 : 0.185845
2025-07-04 05:35:24 INFO     Hit10: 0.307655
2025-07-04 05:35:24 INFO     MR   : 950.729177
2025-07-04 05:35:24 INFO     MRR  : 0.162778
2025-07-04 05:35:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 05:36:38 INFO     Data : 2342
2025-07-04 05:36:38 INFO     Hit1 : 0.121264
2025-07-04 05:36:38 INFO     Hit3 : 0.210931
2025-07-04 05:36:38 INFO     Hit10: 0.316396
2025-07-04 05:36:38 INFO     MR   : 883.730786
2025-07-04 05:36:38 INFO     MRR  : 0.187761
2025-07-04 05:36:38 INFO     -------------------------
2025-07-04 05:36:38 INFO     | Iteration: 3/5
2025-07-04 05:36:38 INFO     -------------------------
2025-07-04 05:36:38 INFO     >>>>> Predictor: Training
2025-07-04 05:40:59 INFO     1000 5959 4.618623 69288.6
2025-07-04 05:45:20 INFO     2000 5959 4.620779 69288.6
2025-07-04 05:49:41 INFO     3000 5959 4.609150 69340.6
2025-07-04 05:54:00 INFO     4000 5959 4.615720 69271.3
2025-07-04 05:58:19 INFO     5000 5959 4.639794 69219.2
2025-07-04 06:02:26 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 06:03:30 INFO     Data : 2077
2025-07-04 06:03:30 INFO     Hit1 : 0.086182
2025-07-04 06:03:30 INFO     Hit3 : 0.176216
2025-07-04 06:03:30 INFO     Hit10: 0.295137
2025-07-04 06:03:30 INFO     MR   : 939.961724
2025-07-04 06:03:30 INFO     MRR  : 0.157177
2025-07-04 06:03:30 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 06:04:42 INFO     Data : 2342
2025-07-04 06:04:42 INFO     Hit1 : 0.109308
2025-07-04 06:04:42 INFO     Hit3 : 0.199829
2025-07-04 06:04:42 INFO     Hit10: 0.314261
2025-07-04 06:04:42 INFO     MR   : 867.030956
2025-07-04 06:04:42 INFO     MRR  : 0.177522
2025-07-04 06:04:42 INFO     -------------------------
2025-07-04 06:04:42 INFO     | Iteration: 4/5
2025-07-04 06:04:42 INFO     -------------------------
2025-07-04 06:04:42 INFO     >>>>> Predictor: Training
2025-07-04 06:09:00 INFO     1000 5959 4.594097 69340.6
2025-07-04 06:13:18 INFO     2000 5959 4.562717 69184.5
2025-07-04 06:17:36 INFO     3000 5959 4.625887 69253.9
2025-07-04 06:21:54 INFO     4000 5959 4.601779 69340.6
2025-07-04 06:26:12 INFO     5000 5959 4.598340 69384.0
2025-07-04 06:30:19 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 06:31:23 INFO     Data : 2077
2025-07-04 06:31:23 INFO     Hit1 : 0.096293
2025-07-04 06:31:23 INFO     Hit3 : 0.180067
2025-07-04 06:31:23 INFO     Hit10: 0.310544
2025-07-04 06:31:23 INFO     MR   : 933.013722
2025-07-04 06:31:23 INFO     MRR  : 0.165302
2025-07-04 06:31:23 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 06:32:35 INFO     Data : 2342
2025-07-04 06:32:35 INFO     Hit1 : 0.122118
2025-07-04 06:32:35 INFO     Hit3 : 0.210504
2025-07-04 06:32:35 INFO     Hit10: 0.319385
2025-07-04 06:32:35 INFO     MR   : 863.593510
2025-07-04 06:32:35 INFO     MRR  : 0.189231
2025-07-04 06:32:35 INFO     -------------------------
2025-07-04 06:32:35 INFO     | Iteration: 5/5
2025-07-04 06:32:35 INFO     -------------------------
2025-07-04 06:32:35 INFO     >>>>> Predictor: Training
2025-07-04 06:36:54 INFO     1000 5959 4.604503 69323.3
2025-07-04 06:41:13 INFO     2000 5959 4.581600 69332.0
2025-07-04 06:45:30 INFO     3000 5959 4.614893 69219.2
2025-07-04 06:49:49 INFO     4000 5959 4.611399 69297.3
2025-07-04 06:54:09 INFO     5000 5959 4.574951 69332.0
2025-07-04 06:58:25 INFO     >>>>> Predictor: Evaluating on valid
2025-07-04 06:59:31 INFO     Data : 2077
2025-07-04 06:59:31 INFO     Hit1 : 0.088589
2025-07-04 06:59:31 INFO     Hit3 : 0.174771
2025-07-04 06:59:31 INFO     Hit10: 0.319692
2025-07-04 06:59:31 INFO     MR   : 923.187289
2025-07-04 06:59:31 INFO     MRR  : 0.159649
2025-07-04 06:59:31 INFO     >>>>> Predictor: Evaluating on test
2025-07-04 07:00:45 INFO     Data : 2342
2025-07-04 07:00:45 INFO     Hit1 : 0.122545
2025-07-04 07:00:45 INFO     Hit3 : 0.207515
2025-07-04 07:00:45 INFO     Hit10: 0.316396
2025-07-04 07:00:45 INFO     MR   : 855.092869
2025-07-04 07:00:45 INFO     MRR  : 0.187881
2025-07-04 07:00:45 INFO     -------------------------
2025-07-04 07:00:45 INFO     | Final Test MRR: 0.190739
2025-07-04 07:00:45 INFO     -------------------------
