2025-07-03 05:10:38 INFO     is_soft_label: False
2025-07-03 05:10:38 INFO     is_scheduled_sampling: False
2025-07-03 05:10:38 INFO     is_test_mode: False
2025-07-03 05:10:38 INFO     Data loading | DONE!
2025-07-03 05:10:38 INFO     Using full datasets for training, validation, and testing.
2025-07-03 05:10:38 INFO     -------------------------
2025-07-03 05:10:38 INFO     | EM Iteration: 1/5
2025-07-03 05:10:38 INFO     -------------------------
2025-07-03 05:10:38 INFO     >>>>> Using miner's rule
2025-07-03 05:10:38 INFO     Predictor: read 13661 rules from list.
2025-07-03 05:10:39 INFO     Preprocess training set
2025-07-03 05:10:39 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 05:12:39 INFO     Data : 2077
2025-07-03 05:12:39 INFO     Hit1 : 0.065479
2025-07-03 05:12:39 INFO     Hit3 : 0.127106
2025-07-03 05:12:39 INFO     Hit10: 0.199326
2025-07-03 05:12:39 INFO     MR   : 1120.902022
2025-07-03 05:12:39 INFO     MRR  : 0.114382
2025-07-03 05:12:39 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 05:14:53 INFO     Data : 2342
2025-07-03 05:14:53 INFO     Hit1 : 0.078992
2025-07-03 05:14:53 INFO     Hit3 : 0.124253
2025-07-03 05:14:53 INFO     Hit10: 0.208796
2025-07-03 05:14:53 INFO     MR   : 1044.269001
2025-07-03 05:14:53 INFO     MRR  : 0.122250
2025-07-03 05:14:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 05:44:42 INFO     1000 5959
2025-07-03 06:15:06 INFO     2000 5959
2025-07-03 06:44:13 INFO     3000 5959
2025-07-03 07:13:12 INFO     4000 5959
2025-07-03 07:41:49 INFO     5000 5959
2025-07-03 08:11:30 INFO     >>>>> Generator: Training
2025-07-03 08:11:32 INFO     -------------------------
2025-07-03 08:11:32 INFO     | EM Iteration: 2/5
2025-07-03 08:11:32 INFO     -------------------------
2025-07-03 08:11:32 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:11:32 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:11:32 INFO     Predictor: read 1900 rules from list.
2025-07-03 08:11:32 INFO     Preprocess training set
2025-07-03 08:11:32 INFO     >>>>> Predictor: Training
2025-07-03 08:12:20 INFO     1000 5959 8.795817 69314.6
2025-07-03 08:13:10 INFO     2000 5959 8.424737 69271.3
2025-07-03 08:13:59 INFO     3000 5959 8.224691 69245.2
2025-07-03 08:14:48 INFO     4000 5959 8.063707 69340.6
2025-07-03 08:15:36 INFO     5000 5959 7.904356 69340.6
2025-07-03 08:16:23 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:16:32 INFO     Data : 2077
2025-07-03 08:16:32 INFO     Hit1 : 0.015407
2025-07-03 08:16:32 INFO     Hit3 : 0.023592
2025-07-03 08:16:32 INFO     Hit10: 0.035147
2025-07-03 08:16:32 INFO     MR   : 1478.270823
2025-07-03 08:16:32 INFO     MRR  : 0.025902
2025-07-03 08:16:32 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:16:43 INFO     Data : 2342
2025-07-03 08:16:43 INFO     Hit1 : 0.011529
2025-07-03 08:16:43 INFO     Hit3 : 0.017933
2025-07-03 08:16:43 INFO     Hit10: 0.029462
2025-07-03 08:16:43 INFO     MR   : 1374.107600
2025-07-03 08:16:43 INFO     MRR  : 0.021287
2025-07-03 08:16:43 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:19:02 INFO     1000 5959
2025-07-03 08:21:19 INFO     2000 5959
2025-07-03 08:23:35 INFO     3000 5959
2025-07-03 08:25:52 INFO     4000 5959
2025-07-03 08:28:10 INFO     5000 5959
2025-07-03 08:30:23 INFO     >>>>> Generator: Training
2025-07-03 08:30:29 INFO     -------------------------
2025-07-03 08:30:29 INFO     | EM Iteration: 3/5
2025-07-03 08:30:29 INFO     -------------------------
2025-07-03 08:30:29 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:30:29 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:30:30 INFO     Predictor: read 1916 rules from list.
2025-07-03 08:30:30 INFO     Preprocess training set
2025-07-03 08:30:30 INFO     >>>>> Predictor: Training
2025-07-03 08:31:19 INFO     1000 5959 8.820295 69332.0
2025-07-03 08:32:10 INFO     2000 5959 8.500766 69349.3
2025-07-03 08:32:59 INFO     3000 5959 8.308992 69184.5
2025-07-03 08:33:49 INFO     4000 5959 8.174524 69253.9
2025-07-03 08:34:40 INFO     5000 5959 8.100267 69332.0
2025-07-03 08:35:27 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:35:37 INFO     Data : 2077
2025-07-03 08:35:37 INFO     Hit1 : 0.009148
2025-07-03 08:35:37 INFO     Hit3 : 0.018777
2025-07-03 08:35:37 INFO     Hit10: 0.034184
2025-07-03 08:35:37 INFO     MR   : 1482.640828
2025-07-03 08:35:37 INFO     MRR  : 0.021228
2025-07-03 08:35:37 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:35:49 INFO     Data : 2342
2025-07-03 08:35:49 INFO     Hit1 : 0.008113
2025-07-03 08:35:49 INFO     Hit3 : 0.013664
2025-07-03 08:35:49 INFO     Hit10: 0.027754
2025-07-03 08:35:49 INFO     MR   : 1378.076644
2025-07-03 08:35:49 INFO     MRR  : 0.018118
2025-07-03 08:35:49 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:38:13 INFO     1000 5959
2025-07-03 08:40:37 INFO     2000 5959
2025-07-03 08:43:01 INFO     3000 5959
2025-07-03 08:45:22 INFO     4000 5959
2025-07-03 08:47:43 INFO     5000 5959
2025-07-03 08:50:00 INFO     >>>>> Generator: Training
2025-07-03 08:50:07 INFO     -------------------------
2025-07-03 08:50:07 INFO     | EM Iteration: 4/5
2025-07-03 08:50:07 INFO     -------------------------
2025-07-03 08:50:07 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:50:07 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:50:07 INFO     Predictor: read 1951 rules from list.
2025-07-03 08:50:07 INFO     Preprocess training set
2025-07-03 08:50:07 INFO     >>>>> Predictor: Training
2025-07-03 08:50:58 INFO     1000 5959 8.809383 69271.3
2025-07-03 08:51:49 INFO     2000 5959 8.460698 69340.6
2025-07-03 08:52:39 INFO     3000 5959 8.235963 69384.0
2025-07-03 08:53:29 INFO     4000 5959 8.096743 69262.6
2025-07-03 08:54:19 INFO     5000 5959 7.972658 69332.0
2025-07-03 08:55:08 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:55:19 INFO     Data : 2077
2025-07-03 08:55:19 INFO     Hit1 : 0.019259
2025-07-03 08:55:19 INFO     Hit3 : 0.035628
2025-07-03 08:55:19 INFO     Hit10: 0.055368
2025-07-03 08:55:19 INFO     MR   : 1457.705344
2025-07-03 08:55:19 INFO     MRR  : 0.035361
2025-07-03 08:55:19 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:55:31 INFO     Data : 2342
2025-07-03 08:55:31 INFO     Hit1 : 0.022630
2025-07-03 08:55:31 INFO     Hit3 : 0.039710
2025-07-03 08:55:31 INFO     Hit10: 0.054654
2025-07-03 08:55:31 INFO     MR   : 1353.465841
2025-07-03 08:55:31 INFO     MRR  : 0.037821
2025-07-03 08:55:31 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:57:52 INFO     1000 5959
2025-07-03 09:00:13 INFO     2000 5959
2025-07-03 09:02:33 INFO     3000 5959
2025-07-03 09:04:54 INFO     4000 5959
2025-07-03 09:07:17 INFO     5000 5959
2025-07-03 09:09:35 INFO     >>>>> Generator: Training
2025-07-03 09:09:42 INFO     -------------------------
2025-07-03 09:09:42 INFO     | EM Iteration: 5/5
2025-07-03 09:09:42 INFO     -------------------------
2025-07-03 09:09:42 INFO     >>>>> Using Generator's sample rule
2025-07-03 09:09:42 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 09:09:42 INFO     Predictor: read 1967 rules from list.
2025-07-03 09:09:42 INFO     Preprocess training set
2025-07-03 09:09:42 INFO     >>>>> Predictor: Training
2025-07-03 09:10:34 INFO     1000 5959 8.817447 69332.0
2025-07-03 09:11:26 INFO     2000 5959 8.470280 69349.3
2025-07-03 09:12:18 INFO     3000 5959 8.261555 69340.6
2025-07-03 09:13:10 INFO     4000 5959 8.134668 69297.3
2025-07-03 09:14:02 INFO     5000 5959 8.048097 69219.2
2025-07-03 09:14:51 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 09:15:01 INFO     Data : 2077
2025-07-03 09:15:01 INFO     Hit1 : 0.006740
2025-07-03 09:15:01 INFO     Hit3 : 0.017333
2025-07-03 09:15:01 INFO     Hit10: 0.041406
2025-07-03 09:15:01 INFO     MR   : 1513.064035
2025-07-03 09:15:01 INFO     MRR  : 0.020570
2025-07-03 09:15:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 09:15:12 INFO     Data : 2342
2025-07-03 09:15:12 INFO     Hit1 : 0.004270
2025-07-03 09:15:12 INFO     Hit3 : 0.012810
2025-07-03 09:15:12 INFO     Hit10: 0.030316
2025-07-03 09:15:12 INFO     MR   : 1389.578352
2025-07-03 09:15:12 INFO     MRR  : 0.016151
2025-07-03 09:15:12 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 09:17:36 INFO     1000 5959
2025-07-03 09:19:59 INFO     2000 5959
2025-07-03 09:22:22 INFO     3000 5959
2025-07-03 09:24:46 INFO     4000 5959
2025-07-03 09:27:09 INFO     5000 5959
2025-07-03 09:29:27 INFO     >>>>> Generator: Training
2025-07-03 09:29:34 INFO     -------------------------
2025-07-03 09:29:34 INFO     | Post-train Generator
2025-07-03 09:29:34 INFO     -------------------------
2025-07-03 09:29:35 INFO     >>>>> Generator: Training
2025-07-03 09:30:42 INFO     [E01000] Total 3.590522 | Main 3.217545 | EntType 3.153398
2025-07-03 09:30:42 INFO     -------------------------
2025-07-03 09:30:42 INFO     | Beam Search Best Rules
2025-07-03 09:30:42 INFO     -------------------------
2025-07-03 09:30:42 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:30:44 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:31:03 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:36:20 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:40:54 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:44:04 INFO     -------------------------
2025-07-03 09:44:04 INFO     | Train Final Predictor+
2025-07-03 09:44:04 INFO     -------------------------
2025-07-03 09:44:04 INFO     Predictor+: read 18420 rules from list.
2025-07-03 09:44:04 INFO     Preprocess training set
2025-07-03 09:44:04 INFO     -------------------------
2025-07-03 09:44:04 INFO     | Iteration: 1/5
2025-07-03 09:44:04 INFO     -------------------------
2025-07-03 09:44:04 INFO     >>>>> Predictor: Training
2025-07-03 09:48:24 INFO     1000 5959 4.901345 69271.3
2025-07-03 09:52:40 INFO     2000 5959 4.725269 69332.0
2025-07-03 09:56:56 INFO     3000 5959 4.706664 69375.3
2025-07-03 10:01:14 INFO     4000 5959 4.708583 69279.9
2025-07-03 10:05:32 INFO     5000 5959 4.679988 69349.3
2025-07-03 10:09:40 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 10:10:44 INFO     Data : 2077
2025-07-03 10:10:44 INFO     Hit1 : 0.101589
2025-07-03 10:10:44 INFO     Hit3 : 0.191623
2025-07-03 10:10:44 INFO     Hit10: 0.313914
2025-07-03 10:10:44 INFO     MR   : 985.911411
2025-07-03 10:10:44 INFO     MRR  : 0.171723
2025-07-03 10:10:44 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 10:11:57 INFO     Data : 2342
2025-07-03 10:11:57 INFO     Hit1 : 0.133219
2025-07-03 10:11:57 INFO     Hit3 : 0.210504
2025-07-03 10:11:57 INFO     Hit10: 0.313407
2025-07-03 10:11:57 INFO     MR   : 920.106533
2025-07-03 10:11:57 INFO     MRR  : 0.193884
2025-07-03 10:11:57 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/Aux2_multitask_mmoe_adaptive_matrix_3_type_20250703_051037/predictor.pt
2025-07-03 10:11:57 INFO     -------------------------
2025-07-03 10:11:57 INFO     | Iteration: 2/5
2025-07-03 10:11:57 INFO     -------------------------
2025-07-03 10:11:57 INFO     >>>>> Predictor: Training
2025-07-03 10:16:19 INFO     1000 5959 4.603698 69366.7
2025-07-03 10:20:41 INFO     2000 5959 4.652041 69375.3
2025-07-03 10:25:03 INFO     3000 5959 4.640575 69219.2
2025-07-03 10:29:27 INFO     4000 5959 4.652045 69305.9
2025-07-03 10:33:53 INFO     5000 5959 4.620036 69288.6
2025-07-03 10:37:59 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 10:39:03 INFO     Data : 2077
2025-07-03 10:39:03 INFO     Hit1 : 0.093404
2025-07-03 10:39:03 INFO     Hit3 : 0.184882
2025-07-03 10:39:03 INFO     Hit10: 0.315840
2025-07-03 10:39:03 INFO     MR   : 945.667068
2025-07-03 10:39:03 INFO     MRR  : 0.164206
2025-07-03 10:39:03 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 10:40:14 INFO     Data : 2342
2025-07-03 10:40:14 INFO     Hit1 : 0.124680
2025-07-03 10:40:14 INFO     Hit3 : 0.205380
2025-07-03 10:40:14 INFO     Hit10: 0.315115
2025-07-03 10:40:14 INFO     MR   : 877.764731
2025-07-03 10:40:14 INFO     MRR  : 0.187962
2025-07-03 10:40:14 INFO     -------------------------
2025-07-03 10:40:14 INFO     | Iteration: 3/5
2025-07-03 10:40:14 INFO     -------------------------
2025-07-03 10:40:14 INFO     >>>>> Predictor: Training
2025-07-03 10:44:33 INFO     1000 5959 4.617347 69288.6
2025-07-03 10:48:50 INFO     2000 5959 4.617539 69288.6
2025-07-03 10:53:08 INFO     3000 5959 4.609476 69340.6
2025-07-03 10:57:25 INFO     4000 5959 4.615847 69271.3
2025-07-03 11:01:45 INFO     5000 5959 4.640767 69219.2
2025-07-03 11:05:57 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 11:07:01 INFO     Data : 2077
2025-07-03 11:07:01 INFO     Hit1 : 0.093404
2025-07-03 11:07:01 INFO     Hit3 : 0.188252
2025-07-03 11:07:01 INFO     Hit10: 0.306211
2025-07-03 11:07:01 INFO     MR   : 931.490852
2025-07-03 11:07:01 INFO     MRR  : 0.164342
2025-07-03 11:07:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 11:08:14 INFO     Data : 2342
2025-07-03 11:08:14 INFO     Hit1 : 0.121264
2025-07-03 11:08:14 INFO     Hit3 : 0.201110
2025-07-03 11:08:14 INFO     Hit10: 0.315115
2025-07-03 11:08:14 INFO     MR   : 859.708155
2025-07-03 11:08:14 INFO     MRR  : 0.184233
2025-07-03 11:08:14 INFO     -------------------------
2025-07-03 11:08:14 INFO     | Iteration: 4/5
2025-07-03 11:08:14 INFO     -------------------------
2025-07-03 11:08:14 INFO     >>>>> Predictor: Training
2025-07-03 11:12:38 INFO     1000 5959 4.593507 69340.6
2025-07-03 11:17:02 INFO     2000 5959 4.564841 69184.5
2025-07-03 11:21:19 INFO     3000 5959 4.624623 69253.9
2025-07-03 11:25:38 INFO     4000 5959 4.604204 69340.6
2025-07-03 11:29:57 INFO     5000 5959 4.599205 69384.0
2025-07-03 11:34:06 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 11:35:12 INFO     Data : 2077
2025-07-03 11:35:12 INFO     Hit1 : 0.097737
2025-07-03 11:35:12 INFO     Hit3 : 0.184401
2025-07-03 11:35:12 INFO     Hit10: 0.313914
2025-07-03 11:35:12 INFO     MR   : 924.328117
2025-07-03 11:35:12 INFO     MRR  : 0.167174
2025-07-03 11:35:12 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 11:36:25 INFO     Data : 2342
2025-07-03 11:36:25 INFO     Hit1 : 0.126815
2025-07-03 11:36:25 INFO     Hit3 : 0.211785
2025-07-03 11:36:25 INFO     Hit10: 0.318958
2025-07-03 11:36:25 INFO     MR   : 856.367208
2025-07-03 11:36:25 INFO     MRR  : 0.191112
2025-07-03 11:36:25 INFO     -------------------------
2025-07-03 11:36:25 INFO     | Iteration: 5/5
2025-07-03 11:36:25 INFO     -------------------------
2025-07-03 11:36:25 INFO     >>>>> Predictor: Training
2025-07-03 11:40:44 INFO     1000 5959 4.605826 69323.3
2025-07-03 11:45:01 INFO     2000 5959 4.585823 69332.0
2025-07-03 11:49:26 INFO     3000 5959 4.617138 69219.2
2025-07-03 11:53:47 INFO     4000 5959 4.612830 69297.3
2025-07-03 11:58:05 INFO     5000 5959 4.575009 69332.0
2025-07-03 12:02:15 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 12:03:18 INFO     Data : 2077
2025-07-03 12:03:18 INFO     Hit1 : 0.090515
2025-07-03 12:03:18 INFO     Hit3 : 0.186326
2025-07-03 12:03:18 INFO     Hit10: 0.314877
2025-07-03 12:03:18 INFO     MR   : 914.831247
2025-07-03 12:03:18 INFO     MRR  : 0.162910
2025-07-03 12:03:18 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 12:04:30 INFO     Data : 2342
2025-07-03 12:04:30 INFO     Hit1 : 0.125534
2025-07-03 12:04:30 INFO     Hit3 : 0.205807
2025-07-03 12:04:30 INFO     Hit10: 0.322374
2025-07-03 12:04:30 INFO     MR   : 848.215841
2025-07-03 12:04:30 INFO     MRR  : 0.189122
2025-07-03 12:04:30 INFO     -------------------------
2025-07-03 12:04:30 INFO     | Final Test MRR: 0.193884
2025-07-03 12:04:30 INFO     -------------------------
