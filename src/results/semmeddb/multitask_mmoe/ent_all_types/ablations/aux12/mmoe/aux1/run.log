2025-07-03 05:04:11 INFO     is_soft_label: False
2025-07-03 05:04:11 INFO     is_scheduled_sampling: False
2025-07-03 05:04:11 INFO     is_test_mode: False
2025-07-03 05:04:12 INFO     Data loading | DONE!
2025-07-03 05:04:12 INFO     Using full datasets for training, validation, and testing.
2025-07-03 05:04:12 INFO     -------------------------
2025-07-03 05:04:12 INFO     | EM Iteration: 1/5
2025-07-03 05:04:12 INFO     -------------------------
2025-07-03 05:04:12 INFO     >>>>> Using miner's rule
2025-07-03 05:04:12 INFO     Predictor: read 13661 rules from list.
2025-07-03 05:04:13 INFO     Preprocess training set
2025-07-03 05:04:13 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 05:06:29 INFO     Data : 2077
2025-07-03 05:06:29 INFO     Hit1 : 0.065479
2025-07-03 05:06:29 INFO     Hit3 : 0.127106
2025-07-03 05:06:29 INFO     Hit10: 0.199326
2025-07-03 05:06:29 INFO     MR   : 1120.902022
2025-07-03 05:06:29 INFO     MRR  : 0.114382
2025-07-03 05:06:29 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 05:09:05 INFO     Data : 2342
2025-07-03 05:09:05 INFO     Hit1 : 0.078992
2025-07-03 05:09:05 INFO     Hit3 : 0.124253
2025-07-03 05:09:05 INFO     Hit10: 0.208796
2025-07-03 05:09:05 INFO     MR   : 1044.269001
2025-07-03 05:09:05 INFO     MRR  : 0.122250
2025-07-03 05:09:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 05:43:24 INFO     1000 5959
2025-07-03 06:17:13 INFO     2000 5959
2025-07-03 06:45:54 INFO     3000 5959
2025-07-03 07:14:41 INFO     4000 5959
2025-07-03 07:43:17 INFO     5000 5959
2025-07-03 08:12:36 INFO     >>>>> Generator: Training
2025-07-03 08:12:39 INFO     -------------------------
2025-07-03 08:12:39 INFO     | EM Iteration: 2/5
2025-07-03 08:12:39 INFO     -------------------------
2025-07-03 08:12:39 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:12:39 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:12:39 INFO     Predictor: read 1891 rules from list.
2025-07-03 08:12:39 INFO     Preprocess training set
2025-07-03 08:12:39 INFO     >>>>> Predictor: Training
2025-07-03 08:13:28 INFO     1000 5959 8.791968 69314.6
2025-07-03 08:14:17 INFO     2000 5959 8.414538 69271.3
2025-07-03 08:15:06 INFO     3000 5959 8.209817 69245.2
2025-07-03 08:15:54 INFO     4000 5959 8.040273 69340.6
2025-07-03 08:16:43 INFO     5000 5959 7.874914 69340.6
2025-07-03 08:17:30 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:17:40 INFO     Data : 2077
2025-07-03 08:17:40 INFO     Hit1 : 0.014925
2025-07-03 08:17:40 INFO     Hit3 : 0.023592
2025-07-03 08:17:40 INFO     Hit10: 0.034665
2025-07-03 08:17:40 INFO     MR   : 1479.807896
2025-07-03 08:17:40 INFO     MRR  : 0.025649
2025-07-03 08:17:40 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:17:51 INFO     Data : 2342
2025-07-03 08:17:51 INFO     Hit1 : 0.011529
2025-07-03 08:17:51 INFO     Hit3 : 0.017933
2025-07-03 08:17:51 INFO     Hit10: 0.028608
2025-07-03 08:17:51 INFO     MR   : 1374.993595
2025-07-03 08:17:51 INFO     MRR  : 0.021256
2025-07-03 08:17:51 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:20:11 INFO     1000 5959
2025-07-03 08:22:27 INFO     2000 5959
2025-07-03 08:24:46 INFO     3000 5959
2025-07-03 08:27:04 INFO     4000 5959
2025-07-03 08:29:20 INFO     5000 5959
2025-07-03 08:31:40 INFO     >>>>> Generator: Training
2025-07-03 08:31:42 INFO     -------------------------
2025-07-03 08:31:42 INFO     | EM Iteration: 3/5
2025-07-03 08:31:42 INFO     -------------------------
2025-07-03 08:31:42 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:31:42 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:31:42 INFO     Predictor: read 1881 rules from list.
2025-07-03 08:31:42 INFO     Preprocess training set
2025-07-03 08:31:42 INFO     >>>>> Predictor: Training
2025-07-03 08:32:32 INFO     1000 5959 8.817966 69332.0
2025-07-03 08:33:21 INFO     2000 5959 8.496171 69349.3
2025-07-03 08:34:10 INFO     3000 5959 8.297967 69184.5
2025-07-03 08:34:59 INFO     4000 5959 8.154565 69253.9
2025-07-03 08:35:47 INFO     5000 5959 8.082996 69332.0
2025-07-03 08:36:33 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:36:42 INFO     Data : 2077
2025-07-03 08:36:42 INFO     Hit1 : 0.012037
2025-07-03 08:36:42 INFO     Hit3 : 0.022629
2025-07-03 08:36:42 INFO     Hit10: 0.044776
2025-07-03 08:36:42 INFO     MR   : 1472.454261
2025-07-03 08:36:42 INFO     MRR  : 0.025627
2025-07-03 08:36:42 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:36:53 INFO     Data : 2342
2025-07-03 08:36:53 INFO     Hit1 : 0.013664
2025-07-03 08:36:53 INFO     Hit3 : 0.020495
2025-07-03 08:36:53 INFO     Hit10: 0.038856
2025-07-03 08:36:53 INFO     MR   : 1372.969257
2025-07-03 08:36:53 INFO     MRR  : 0.024762
2025-07-03 08:36:53 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:39:11 INFO     1000 5959
2025-07-03 08:41:28 INFO     2000 5959
2025-07-03 08:43:47 INFO     3000 5959
2025-07-03 08:46:08 INFO     4000 5959
2025-07-03 08:48:28 INFO     5000 5959
2025-07-03 08:50:50 INFO     >>>>> Generator: Training
2025-07-03 08:50:52 INFO     -------------------------
2025-07-03 08:50:52 INFO     | EM Iteration: 4/5
2025-07-03 08:50:52 INFO     -------------------------
2025-07-03 08:50:52 INFO     >>>>> Using Generator's sample rule
2025-07-03 08:50:52 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 08:50:52 INFO     Predictor: read 1857 rules from list.
2025-07-03 08:50:52 INFO     Preprocess training set
2025-07-03 08:50:52 INFO     >>>>> Predictor: Training
2025-07-03 08:51:40 INFO     1000 5959 8.806676 69271.3
2025-07-03 08:52:27 INFO     2000 5959 8.455466 69340.6
2025-07-03 08:53:14 INFO     3000 5959 8.234434 69384.0
2025-07-03 08:54:02 INFO     4000 5959 8.075242 69262.6
2025-07-03 08:54:49 INFO     5000 5959 7.951823 69332.0
2025-07-03 08:55:34 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 08:55:43 INFO     Data : 2077
2025-07-03 08:55:43 INFO     Hit1 : 0.029369
2025-07-03 08:55:43 INFO     Hit3 : 0.044295
2025-07-03 08:55:43 INFO     Hit10: 0.064998
2025-07-03 08:55:43 INFO     MR   : 1445.252768
2025-07-03 08:55:43 INFO     MRR  : 0.045124
2025-07-03 08:55:43 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 08:55:54 INFO     Data : 2342
2025-07-03 08:55:54 INFO     Hit1 : 0.033732
2025-07-03 08:55:54 INFO     Hit3 : 0.049530
2025-07-03 08:55:54 INFO     Hit10: 0.067037
2025-07-03 08:55:54 INFO     MR   : 1344.635568
2025-07-03 08:55:54 INFO     MRR  : 0.048749
2025-07-03 08:55:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 08:58:10 INFO     1000 5959
2025-07-03 09:00:28 INFO     2000 5959
2025-07-03 09:02:45 INFO     3000 5959
2025-07-03 09:05:02 INFO     4000 5959
2025-07-03 09:07:16 INFO     5000 5959
2025-07-03 09:09:28 INFO     >>>>> Generator: Training
2025-07-03 09:09:30 INFO     -------------------------
2025-07-03 09:09:30 INFO     | EM Iteration: 5/5
2025-07-03 09:09:30 INFO     -------------------------
2025-07-03 09:09:30 INFO     >>>>> Using Generator's sample rule
2025-07-03 09:09:30 INFO     >>>>> Generator: Rule generation with sampling
2025-07-03 09:09:30 INFO     Predictor: read 1723 rules from list.
2025-07-03 09:09:30 INFO     Preprocess training set
2025-07-03 09:09:30 INFO     >>>>> Predictor: Training
2025-07-03 09:10:18 INFO     1000 5959 8.749783 69332.0
2025-07-03 09:11:00 INFO     2000 5959 8.262693 69349.3
2025-07-03 09:11:42 INFO     3000 5959 7.930582 69340.6
2025-07-03 09:12:24 INFO     4000 5959 7.650981 69297.3
2025-07-03 09:13:06 INFO     5000 5959 7.415622 69219.2
2025-07-03 09:13:47 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 09:13:56 INFO     Data : 2077
2025-07-03 09:13:56 INFO     Hit1 : 0.021184
2025-07-03 09:13:56 INFO     Hit3 : 0.035628
2025-07-03 09:13:56 INFO     Hit10: 0.054405
2025-07-03 09:13:56 INFO     MR   : 1488.803563
2025-07-03 09:13:56 INFO     MRR  : 0.035576
2025-07-03 09:13:56 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 09:14:07 INFO     Data : 2342
2025-07-03 09:14:07 INFO     Hit1 : 0.023484
2025-07-03 09:14:07 INFO     Hit3 : 0.032451
2025-07-03 09:14:07 INFO     Hit10: 0.055508
2025-07-03 09:14:07 INFO     MR   : 1385.533732
2025-07-03 09:14:07 INFO     MRR  : 0.036559
2025-07-03 09:14:07 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-03 09:16:16 INFO     1000 5959
2025-07-03 09:18:25 INFO     2000 5959
2025-07-03 09:20:35 INFO     3000 5959
2025-07-03 09:22:44 INFO     4000 5959
2025-07-03 09:24:51 INFO     5000 5959
2025-07-03 09:26:56 INFO     >>>>> Generator: Training
2025-07-03 09:26:58 INFO     -------------------------
2025-07-03 09:26:58 INFO     | Post-train Generator
2025-07-03 09:26:58 INFO     -------------------------
2025-07-03 09:27:00 INFO     >>>>> Generator: Training
2025-07-03 09:27:22 INFO     [E01000] Total 2.007669 | Main 2.423339 | RelClus 1.016991 | 
2025-07-03 09:27:22 INFO     -------------------------
2025-07-03 09:27:22 INFO     | Beam Search Best Rules
2025-07-03 09:27:22 INFO     -------------------------
2025-07-03 09:27:22 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:27:22 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:27:26 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:28:25 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:29:13 INFO     >>>>> Generator: Rule generation with beam search
2025-07-03 09:30:51 INFO     -------------------------
2025-07-03 09:30:51 INFO     | Train Final Predictor+
2025-07-03 09:30:51 INFO     -------------------------
2025-07-03 09:30:51 INFO     Predictor+: read 18420 rules from list.
2025-07-03 09:30:51 INFO     Preprocess training set
2025-07-03 09:30:51 INFO     -------------------------
2025-07-03 09:30:51 INFO     | Iteration: 1/5
2025-07-03 09:30:51 INFO     -------------------------
2025-07-03 09:30:51 INFO     >>>>> Predictor: Training
2025-07-03 09:45:25 INFO     1000 5959 5.144310 69271.3
2025-07-03 09:50:08 INFO     2000 5959 4.978089 69332.0
2025-07-03 09:54:52 INFO     3000 5959 4.949970 69375.3
2025-07-03 09:59:34 INFO     4000 5959 4.945231 69279.9
2025-07-03 10:04:20 INFO     5000 5959 4.901184 69349.3
2025-07-03 10:08:52 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 10:10:05 INFO     Data : 2077
2025-07-03 10:10:05 INFO     Hit1 : 0.093404
2025-07-03 10:10:05 INFO     Hit3 : 0.177179
2025-07-03 10:10:05 INFO     Hit10: 0.295137
2025-07-03 10:10:05 INFO     MR   : 1047.422244
2025-07-03 10:10:05 INFO     MRR  : 0.157676
2025-07-03 10:10:05 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 10:11:26 INFO     Data : 2342
2025-07-03 10:11:26 INFO     Hit1 : 0.116567
2025-07-03 10:11:26 INFO     Hit3 : 0.195132
2025-07-03 10:11:26 INFO     Hit10: 0.294193
2025-07-03 10:11:26 INFO     MR   : 968.695132
2025-07-03 10:11:26 INFO     MRR  : 0.175143
2025-07-03 10:11:26 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/Aux1_multitask_mmoe_adaptive_matrix_3_type_20250703_050410/predictor.pt
2025-07-03 10:11:26 INFO     -------------------------
2025-07-03 10:11:26 INFO     | Iteration: 2/5
2025-07-03 10:11:26 INFO     -------------------------
2025-07-03 10:11:26 INFO     >>>>> Predictor: Training
2025-07-03 10:16:10 INFO     1000 5959 4.855787 69366.7
2025-07-03 10:20:54 INFO     2000 5959 4.873394 69375.3
2025-07-03 10:25:40 INFO     3000 5959 4.852407 69219.2
2025-07-03 10:30:23 INFO     4000 5959 4.892417 69305.9
2025-07-03 10:35:12 INFO     5000 5959 4.854934 69288.6
2025-07-03 10:39:49 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 10:41:02 INFO     Data : 2077
2025-07-03 10:41:02 INFO     Hit1 : 0.088108
2025-07-03 10:41:02 INFO     Hit3 : 0.178142
2025-07-03 10:41:02 INFO     Hit10: 0.289841
2025-07-03 10:41:02 INFO     MR   : 1017.556572
2025-07-03 10:41:02 INFO     MRR  : 0.154458
2025-07-03 10:41:02 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 10:42:25 INFO     Data : 2342
2025-07-03 10:42:25 INFO     Hit1 : 0.110589
2025-07-03 10:42:25 INFO     Hit3 : 0.190436
2025-07-03 10:42:25 INFO     Hit10: 0.294620
2025-07-03 10:42:25 INFO     MR   : 935.429547
2025-07-03 10:42:25 INFO     MRR  : 0.172457
2025-07-03 10:42:25 INFO     -------------------------
2025-07-03 10:42:25 INFO     | Iteration: 3/5
2025-07-03 10:42:25 INFO     -------------------------
2025-07-03 10:42:25 INFO     >>>>> Predictor: Training
2025-07-03 10:47:12 INFO     1000 5959 4.863495 69288.6
2025-07-03 10:51:58 INFO     2000 5959 4.852817 69288.6
2025-07-03 10:56:50 INFO     3000 5959 4.838925 69340.6
2025-07-03 11:01:38 INFO     4000 5959 4.841621 69271.3
2025-07-03 11:06:23 INFO     5000 5959 4.885189 69219.2
2025-07-03 11:10:58 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 11:12:12 INFO     Data : 2077
2025-07-03 11:12:12 INFO     Hit1 : 0.086182
2025-07-03 11:12:12 INFO     Hit3 : 0.167068
2025-07-03 11:12:12 INFO     Hit10: 0.284064
2025-07-03 11:12:12 INFO     MR   : 1007.438854
2025-07-03 11:12:12 INFO     MRR  : 0.149797
2025-07-03 11:12:12 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 11:13:36 INFO     Data : 2342
2025-07-03 11:13:36 INFO     Hit1 : 0.108881
2025-07-03 11:13:36 INFO     Hit3 : 0.187020
2025-07-03 11:13:36 INFO     Hit10: 0.290777
2025-07-03 11:13:36 INFO     MR   : 922.491247
2025-07-03 11:13:36 INFO     MRR  : 0.168296
2025-07-03 11:13:36 INFO     -------------------------
2025-07-03 11:13:36 INFO     | Iteration: 4/5
2025-07-03 11:13:36 INFO     -------------------------
2025-07-03 11:13:36 INFO     >>>>> Predictor: Training
2025-07-03 11:18:25 INFO     1000 5959 4.827332 69340.6
2025-07-03 11:23:13 INFO     2000 5959 4.794196 69184.5
2025-07-03 11:28:01 INFO     3000 5959 4.891804 69253.9
2025-07-03 11:32:50 INFO     4000 5959 4.843992 69340.6
2025-07-03 11:37:36 INFO     5000 5959 4.833489 69384.0
2025-07-03 11:42:16 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 11:43:30 INFO     Data : 2077
2025-07-03 11:43:30 INFO     Hit1 : 0.088108
2025-07-03 11:43:30 INFO     Hit3 : 0.171401
2025-07-03 11:43:30 INFO     Hit10: 0.289360
2025-07-03 11:43:30 INFO     MR   : 1003.662975
2025-07-03 11:43:30 INFO     MRR  : 0.152697
2025-07-03 11:43:30 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 11:44:52 INFO     Data : 2342
2025-07-03 11:44:52 INFO     Hit1 : 0.116994
2025-07-03 11:44:52 INFO     Hit3 : 0.187447
2025-07-03 11:44:52 INFO     Hit10: 0.295474
2025-07-03 11:44:52 INFO     MR   : 922.437020
2025-07-03 11:44:52 INFO     MRR  : 0.173863
2025-07-03 11:44:52 INFO     -------------------------
2025-07-03 11:44:52 INFO     | Iteration: 5/5
2025-07-03 11:44:52 INFO     -------------------------
2025-07-03 11:44:52 INFO     >>>>> Predictor: Training
2025-07-03 11:49:37 INFO     1000 5959 4.835061 69323.3
2025-07-03 11:54:25 INFO     2000 5959 4.832136 69332.0
2025-07-03 11:59:07 INFO     3000 5959 4.867917 69219.2
2025-07-03 12:03:50 INFO     4000 5959 4.840863 69297.3
2025-07-03 12:08:26 INFO     5000 5959 4.809552 69332.0
2025-07-03 12:12:48 INFO     >>>>> Predictor: Evaluating on valid
2025-07-03 12:13:58 INFO     Data : 2077
2025-07-03 12:13:58 INFO     Hit1 : 0.086663
2025-07-03 12:13:58 INFO     Hit3 : 0.168512
2025-07-03 12:13:58 INFO     Hit10: 0.295137
2025-07-03 12:13:58 INFO     MR   : 994.085941
2025-07-03 12:13:58 INFO     MRR  : 0.151688
2025-07-03 12:13:58 INFO     >>>>> Predictor: Evaluating on test
2025-07-03 12:15:16 INFO     Data : 2342
2025-07-03 12:15:16 INFO     Hit1 : 0.119983
2025-07-03 12:15:16 INFO     Hit3 : 0.191716
2025-07-03 12:15:16 INFO     Hit10: 0.292485
2025-07-03 12:15:16 INFO     MR   : 912.348420
2025-07-03 12:15:16 INFO     MRR  : 0.177335
2025-07-03 12:15:16 INFO     -------------------------
2025-07-03 12:15:16 INFO     | Final Test MRR: 0.175143
2025-07-03 12:15:16 INFO     -------------------------
