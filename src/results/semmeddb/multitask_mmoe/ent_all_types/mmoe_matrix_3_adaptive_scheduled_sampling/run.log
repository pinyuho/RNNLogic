2025-07-01 22:25:38 INFO     is_soft_label: False
2025-07-01 22:25:38 INFO     is_scheduled_sampling: True
2025-07-01 22:25:38 INFO     is_test_mode: False
2025-07-01 22:25:39 INFO     Data loading | DONE!
2025-07-01 22:25:39 INFO     Using full datasets for training, validation, and testing.
2025-07-01 22:25:39 INFO     -------------------------
2025-07-01 22:25:39 INFO     | EM Iteration: 1/5
2025-07-01 22:25:39 INFO     -------------------------
2025-07-01 22:25:39 INFO     >>>>> Using miner's rule
2025-07-01 22:25:39 INFO     Predictor: read 13661 rules from list.
2025-07-01 22:25:40 INFO     Preprocess training set
2025-07-01 22:25:40 INFO     >>>>> Predictor: Training
2025-07-01 22:34:09 INFO     1000 5959 8.299284 69314.6
2025-07-01 22:42:31 INFO     2000 5959 7.689227 69271.3
2025-07-01 22:50:38 INFO     3000 5959 7.425850 69245.2
2025-07-01 22:58:43 INFO     4000 5959 7.285955 69340.6
2025-07-01 23:06:47 INFO     5000 5959 7.136692 69340.6
2025-07-01 23:14:29 INFO     >>>>> Predictor: Evaluating on valid
2025-07-01 23:16:28 INFO     Data : 2077
2025-07-01 23:16:28 INFO     Hit1 : 0.065479
2025-07-01 23:16:28 INFO     Hit3 : 0.127106
2025-07-01 23:16:28 INFO     Hit10: 0.199326
2025-07-01 23:16:28 INFO     MR   : 1120.920077
2025-07-01 23:16:28 INFO     MRR  : 0.114382
2025-07-01 23:16:28 INFO     >>>>> Predictor: Evaluating on test
2025-07-01 23:18:42 INFO     Data : 2342
2025-07-01 23:18:42 INFO     Hit1 : 0.078992
2025-07-01 23:18:42 INFO     Hit3 : 0.124253
2025-07-01 23:18:42 INFO     Hit10: 0.208796
2025-07-01 23:18:42 INFO     MR   : 1044.279889
2025-07-01 23:18:42 INFO     MRR  : 0.122250
2025-07-01 23:18:42 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-01 23:49:48 INFO     1000 5959
2025-07-02 00:20:49 INFO     2000 5959
2025-07-02 00:51:01 INFO     3000 5959
2025-07-02 01:21:32 INFO     4000 5959
2025-07-02 01:52:04 INFO     5000 5959
2025-07-02 02:22:53 INFO     >>>>> Generator: Training
2025-07-02 02:23:03 INFO     -------------------------
2025-07-02 02:23:03 INFO     | EM Iteration: 2/5
2025-07-02 02:23:03 INFO     -------------------------
2025-07-02 02:23:03 INFO     >>>>> Using Generator's sample rule
2025-07-02 02:23:03 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 02:23:03 INFO     Predictor: read 1910 rules from list.
2025-07-02 02:23:03 INFO     Preprocess training set
2025-07-02 02:23:03 INFO     >>>>> Predictor: Training
2025-07-02 02:23:54 INFO     1000 5959 8.787997 69332.0
2025-07-02 02:24:45 INFO     2000 5959 8.399269 69349.3
2025-07-02 02:25:36 INFO     3000 5959 8.127584 69184.5
2025-07-02 02:26:27 INFO     4000 5959 7.936841 69253.9
2025-07-02 02:27:18 INFO     5000 5959 7.803550 69332.0
2025-07-02 02:28:06 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 02:28:16 INFO     Data : 2077
2025-07-02 02:28:16 INFO     Hit1 : 0.017814
2025-07-02 02:28:16 INFO     Hit3 : 0.032740
2025-07-02 02:28:16 INFO     Hit10: 0.059220
2025-07-02 02:28:16 INFO     MR   : 1454.150698
2025-07-02 02:28:16 INFO     MRR  : 0.033940
2025-07-02 02:28:16 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 02:28:28 INFO     Data : 2342
2025-07-02 02:28:28 INFO     Hit1 : 0.016225
2025-07-02 02:28:28 INFO     Hit3 : 0.035013
2025-07-02 02:28:28 INFO     Hit10: 0.063194
2025-07-02 02:28:28 INFO     MR   : 1341.873612
2025-07-02 02:28:28 INFO     MRR  : 0.034347
2025-07-02 02:28:28 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 02:30:53 INFO     1000 5959
2025-07-02 02:33:17 INFO     2000 5959
2025-07-02 02:35:41 INFO     3000 5959
2025-07-02 02:38:08 INFO     4000 5959
2025-07-02 02:40:37 INFO     5000 5959
2025-07-02 02:43:03 INFO     >>>>> Generator: Training
2025-07-02 02:43:14 INFO     -------------------------
2025-07-02 02:43:14 INFO     | EM Iteration: 3/5
2025-07-02 02:43:14 INFO     -------------------------
2025-07-02 02:43:14 INFO     >>>>> Using Generator's sample rule
2025-07-02 02:43:14 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 02:43:15 INFO     Predictor: read 1905 rules from list.
2025-07-02 02:43:15 INFO     Preprocess training set
2025-07-02 02:43:15 INFO     >>>>> Predictor: Training
2025-07-02 02:44:08 INFO     1000 5959 8.807493 69271.3
2025-07-02 02:45:01 INFO     2000 5959 8.441009 69340.6
2025-07-02 02:45:53 INFO     3000 5959 8.201155 69384.0
2025-07-02 02:46:46 INFO     4000 5959 8.041814 69262.6
2025-07-02 02:47:38 INFO     5000 5959 7.921003 69332.0
2025-07-02 02:48:27 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 02:48:37 INFO     Data : 2077
2025-07-02 02:48:37 INFO     Hit1 : 0.013000
2025-07-02 02:48:37 INFO     Hit3 : 0.019740
2025-07-02 02:48:37 INFO     Hit10: 0.036110
2025-07-02 02:48:37 INFO     MR   : 1495.984112
2025-07-02 02:48:37 INFO     MRR  : 0.023821
2025-07-02 02:48:37 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 02:48:49 INFO     Data : 2342
2025-07-02 02:48:49 INFO     Hit1 : 0.012810
2025-07-02 02:48:49 INFO     Hit3 : 0.020495
2025-07-02 02:48:49 INFO     Hit10: 0.032451
2025-07-02 02:48:49 INFO     MR   : 1388.719898
2025-07-02 02:48:49 INFO     MRR  : 0.023096
2025-07-02 02:48:49 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 02:51:11 INFO     1000 5959
2025-07-02 02:53:37 INFO     2000 5959
2025-07-02 02:56:02 INFO     3000 5959
2025-07-02 02:58:28 INFO     4000 5959
2025-07-02 03:00:53 INFO     5000 5959
2025-07-02 03:03:16 INFO     >>>>> Generator: Training
2025-07-02 03:03:25 INFO     -------------------------
2025-07-02 03:03:25 INFO     | EM Iteration: 4/5
2025-07-02 03:03:25 INFO     -------------------------
2025-07-02 03:03:25 INFO     >>>>> Using Generator's sample rule
2025-07-02 03:03:25 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 03:03:26 INFO     Predictor: read 1919 rules from list.
2025-07-02 03:03:26 INFO     Preprocess training set
2025-07-02 03:03:26 INFO     >>>>> Predictor: Training
2025-07-02 03:04:19 INFO     1000 5959 8.798375 69332.0
2025-07-02 03:05:13 INFO     2000 5959 8.414864 69349.3
2025-07-02 03:06:06 INFO     3000 5959 8.142123 69340.6
2025-07-02 03:06:59 INFO     4000 5959 7.950515 69297.3
2025-07-02 03:07:52 INFO     5000 5959 7.771981 69219.2
2025-07-02 03:08:42 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 03:08:52 INFO     Data : 2077
2025-07-02 03:08:52 INFO     Hit1 : 0.014444
2025-07-02 03:08:52 INFO     Hit3 : 0.024555
2025-07-02 03:08:52 INFO     Hit10: 0.047183
2025-07-02 03:08:52 INFO     MR   : 1511.070534
2025-07-02 03:08:52 INFO     MRR  : 0.028209
2025-07-02 03:08:52 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 03:09:04 INFO     Data : 2342
2025-07-02 03:09:04 INFO     Hit1 : 0.008540
2025-07-02 03:09:04 INFO     Hit3 : 0.019641
2025-07-02 03:09:04 INFO     Hit10: 0.041418
2025-07-02 03:09:04 INFO     MR   : 1384.874466
2025-07-02 03:09:04 INFO     MRR  : 0.022053
2025-07-02 03:09:04 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 03:11:31 INFO     1000 5959
2025-07-02 03:13:57 INFO     2000 5959
2025-07-02 03:16:22 INFO     3000 5959
2025-07-02 03:18:48 INFO     4000 5959
2025-07-02 03:21:14 INFO     5000 5959
2025-07-02 03:23:36 INFO     >>>>> Generator: Training
2025-07-02 03:23:46 INFO     -------------------------
2025-07-02 03:23:46 INFO     | EM Iteration: 5/5
2025-07-02 03:23:46 INFO     -------------------------
2025-07-02 03:23:46 INFO     >>>>> Using Generator's sample rule
2025-07-02 03:23:46 INFO     >>>>> Generator: Rule generation with sampling
2025-07-02 03:23:47 INFO     Predictor: read 1939 rules from list.
2025-07-02 03:23:47 INFO     Preprocess training set
2025-07-02 03:23:47 INFO     >>>>> Predictor: Training
2025-07-02 03:24:41 INFO     1000 5959 8.806431 69271.3
2025-07-02 03:25:36 INFO     2000 5959 8.459677 69332.0
2025-07-02 03:26:30 INFO     3000 5959 8.234499 69375.3
2025-07-02 03:27:25 INFO     4000 5959 8.047813 69279.9
2025-07-02 03:28:20 INFO     5000 5959 7.905718 69349.3
2025-07-02 03:29:12 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 03:29:24 INFO     Data : 2077
2025-07-02 03:29:24 INFO     Hit1 : 0.023592
2025-07-02 03:29:24 INFO     Hit3 : 0.050554
2025-07-02 03:29:24 INFO     Hit10: 0.082812
2025-07-02 03:29:24 INFO     MR   : 1416.480741
2025-07-02 03:29:24 INFO     MRR  : 0.046069
2025-07-02 03:29:24 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 03:29:37 INFO     Data : 2342
2025-07-02 03:29:37 INFO     Hit1 : 0.027754
2025-07-02 03:29:37 INFO     Hit3 : 0.050384
2025-07-02 03:29:37 INFO     Hit10: 0.077284
2025-07-02 03:29:37 INFO     MR   : 1324.141759
2025-07-02 03:29:37 INFO     MRR  : 0.048599
2025-07-02 03:29:37 INFO     >>>>> Predictor: Computing H scores of rules
2025-07-02 03:32:05 INFO     1000 5959
2025-07-02 03:34:34 INFO     2000 5959
2025-07-02 03:37:03 INFO     3000 5959
2025-07-02 03:39:31 INFO     4000 5959
2025-07-02 03:42:00 INFO     5000 5959
2025-07-02 03:44:25 INFO     >>>>> Generator: Training
2025-07-02 03:44:35 INFO     -------------------------
2025-07-02 03:44:35 INFO     | Post-train Generator
2025-07-02 03:44:35 INFO     -------------------------
2025-07-02 03:44:36 INFO     >>>>> Generator: Training
2025-07-02 03:46:20 INFO     [E01000] Total 30.433082 | Main 6.829542 | RelClus 6.730161 | EntType 35.768389
2025-07-02 03:46:20 INFO     -------------------------
2025-07-02 03:46:20 INFO     | Beam Search Best Rules
2025-07-02 03:46:20 INFO     -------------------------
2025-07-02 03:46:20 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 03:46:22 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 03:46:42 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 03:52:10 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 03:56:42 INFO     >>>>> Generator: Rule generation with beam search
2025-07-02 04:00:05 INFO     -------------------------
2025-07-02 04:00:05 INFO     | Train Final Predictor+
2025-07-02 04:00:05 INFO     -------------------------
2025-07-02 04:00:06 INFO     Predictor+: read 18420 rules from list.
2025-07-02 04:00:06 INFO     Preprocess training set
2025-07-02 04:00:06 INFO     -------------------------
2025-07-02 04:00:06 INFO     | Iteration: 1/5
2025-07-02 04:00:06 INFO     -------------------------
2025-07-02 04:00:06 INFO     >>>>> Predictor: Training
2025-07-02 04:04:57 INFO     1000 5959 5.301984 69366.7
2025-07-02 04:09:46 INFO     2000 5959 5.157953 69375.3
2025-07-02 04:14:33 INFO     3000 5959 5.127891 69219.2
2025-07-02 04:19:20 INFO     4000 5959 5.117482 69305.9
2025-07-02 04:24:06 INFO     5000 5959 5.089751 69288.6
2025-07-02 04:28:40 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 04:29:56 INFO     Data : 2077
2025-07-02 04:29:56 INFO     Hit1 : 0.067405
2025-07-02 04:29:56 INFO     Hit3 : 0.117959
2025-07-02 04:29:56 INFO     Hit10: 0.196919
2025-07-02 04:29:56 INFO     MR   : 1245.555850
2025-07-02 04:29:56 INFO     MRR  : 0.109141
2025-07-02 04:29:56 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 04:31:20 INFO     Data : 2342
2025-07-02 04:31:20 INFO     Hit1 : 0.088813
2025-07-02 04:31:20 INFO     Hit3 : 0.138770
2025-07-02 04:31:20 INFO     Hit10: 0.190009
2025-07-02 04:31:20 INFO     MR   : 1149.828352
2025-07-02 04:31:20 INFO     MRR  : 0.124893
2025-07-02 04:31:20 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_mmoe_adaptive_matrix_3_scheduled_sampling_20250701_222537/predictor.pt
2025-07-02 04:31:20 INFO     -------------------------
2025-07-02 04:31:20 INFO     | Iteration: 2/5
2025-07-02 04:31:20 INFO     -------------------------
2025-07-02 04:31:20 INFO     >>>>> Predictor: Training
2025-07-02 04:36:05 INFO     1000 5959 5.072525 69288.6
2025-07-02 04:40:54 INFO     2000 5959 5.077743 69288.6
2025-07-02 04:45:40 INFO     3000 5959 5.062196 69340.6
2025-07-02 04:50:24 INFO     4000 5959 5.052813 69271.3
2025-07-02 04:55:08 INFO     5000 5959 5.084868 69219.2
2025-07-02 04:59:43 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 05:00:57 INFO     Data : 2077
2025-07-02 05:00:57 INFO     Hit1 : 0.065961
2025-07-02 05:00:57 INFO     Hit3 : 0.120366
2025-07-02 05:00:57 INFO     Hit10: 0.193548
2025-07-02 05:00:57 INFO     MR   : 1212.200530
2025-07-02 05:00:57 INFO     MRR  : 0.107997
2025-07-02 05:00:57 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 05:02:21 INFO     Data : 2342
2025-07-02 05:02:21 INFO     Hit1 : 0.092229
2025-07-02 05:02:21 INFO     Hit3 : 0.137916
2025-07-02 05:02:21 INFO     Hit10: 0.186166
2025-07-02 05:02:21 INFO     MR   : 1117.297182
2025-07-02 05:02:21 INFO     MRR  : 0.126680
2025-07-02 05:02:21 INFO     -------------------------
2025-07-02 05:02:21 INFO     | Iteration: 3/5
2025-07-02 05:02:21 INFO     -------------------------
2025-07-02 05:02:21 INFO     >>>>> Predictor: Training
2025-07-02 05:07:07 INFO     1000 5959 5.037099 69340.6
2025-07-02 05:11:55 INFO     2000 5959 5.021864 69184.5
2025-07-02 05:16:40 INFO     3000 5959 5.103030 69253.9
2025-07-02 05:21:26 INFO     4000 5959 5.047738 69340.6
2025-07-02 05:26:13 INFO     5000 5959 5.047894 69384.0
2025-07-02 05:30:47 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 05:32:01 INFO     Data : 2077
2025-07-02 05:32:01 INFO     Hit1 : 0.062109
2025-07-02 05:32:01 INFO     Hit3 : 0.117959
2025-07-02 05:32:01 INFO     Hit10: 0.197400
2025-07-02 05:32:01 INFO     MR   : 1202.864949
2025-07-02 05:32:01 INFO     MRR  : 0.105640
2025-07-02 05:32:01 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 05:33:24 INFO     Data : 2342
2025-07-02 05:33:24 INFO     Hit1 : 0.090094
2025-07-02 05:33:24 INFO     Hit3 : 0.136635
2025-07-02 05:33:24 INFO     Hit10: 0.189155
2025-07-02 05:33:24 INFO     MR   : 1115.695132
2025-07-02 05:33:24 INFO     MRR  : 0.125380
2025-07-02 05:33:24 INFO     -------------------------
2025-07-02 05:33:24 INFO     | Iteration: 4/5
2025-07-02 05:33:24 INFO     -------------------------
2025-07-02 05:33:24 INFO     >>>>> Predictor: Training
2025-07-02 05:38:07 INFO     1000 5959 5.058145 69323.3
2025-07-02 05:42:54 INFO     2000 5959 5.056875 69332.0
2025-07-02 05:47:31 INFO     3000 5959 5.063240 69219.2
2025-07-02 05:52:07 INFO     4000 5959 5.041169 69297.3
2025-07-02 05:56:43 INFO     5000 5959 5.021350 69332.0
2025-07-02 06:01:09 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 06:02:21 INFO     Data : 2077
2025-07-02 06:02:21 INFO     Hit1 : 0.064035
2025-07-02 06:02:21 INFO     Hit3 : 0.120847
2025-07-02 06:02:21 INFO     Hit10: 0.194993
2025-07-02 06:02:21 INFO     MR   : 1186.471594
2025-07-02 06:02:21 INFO     MRR  : 0.108063
2025-07-02 06:02:21 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 06:03:44 INFO     Data : 2342
2025-07-02 06:03:44 INFO     Hit1 : 0.091375
2025-07-02 06:03:44 INFO     Hit3 : 0.136635
2025-07-02 06:03:44 INFO     Hit10: 0.188728
2025-07-02 06:03:44 INFO     MR   : 1099.080060
2025-07-02 06:03:44 INFO     MRR  : 0.126587
2025-07-02 06:03:44 INFO     -------------------------
2025-07-02 06:03:44 INFO     | Iteration: 5/5
2025-07-02 06:03:44 INFO     -------------------------
2025-07-02 06:03:44 INFO     >>>>> Predictor: Training
2025-07-02 06:08:22 INFO     1000 5959 4.998107 69245.2
2025-07-02 06:13:04 INFO     2000 5959 5.011137 69262.6
2025-07-02 06:17:46 INFO     3000 5959 5.084212 69332.0
2025-07-02 06:22:31 INFO     4000 5959 5.058758 69366.7
2025-07-02 06:27:13 INFO     5000 5959 5.062279 69262.6
2025-07-02 06:31:39 INFO     >>>>> Predictor: Evaluating on valid
2025-07-02 06:32:50 INFO     Data : 2077
2025-07-02 06:32:50 INFO     Hit1 : 0.068368
2025-07-02 06:32:50 INFO     Hit3 : 0.123736
2025-07-02 06:32:50 INFO     Hit10: 0.199326
2025-07-02 06:32:50 INFO     MR   : 1187.815599
2025-07-02 06:32:50 INFO     MRR  : 0.109665
2025-07-02 06:32:50 INFO     >>>>> Predictor: Evaluating on test
2025-07-02 06:34:11 INFO     Data : 2342
2025-07-02 06:34:11 INFO     Hit1 : 0.090948
2025-07-02 06:34:11 INFO     Hit3 : 0.136208
2025-07-02 06:34:11 INFO     Hit10: 0.192997
2025-07-02 06:34:11 INFO     MR   : 1105.209650
2025-07-02 06:34:11 INFO     MRR  : 0.127112
2025-07-02 06:34:11 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/ent_all_types/multitask_mmoe_adaptive_matrix_3_scheduled_sampling_20250701_222537/predictor.pt
2025-07-02 06:34:11 INFO     -------------------------
2025-07-02 06:34:11 INFO     | Final Test MRR: 0.127112
2025-07-02 06:34:11 INFO     -------------------------
