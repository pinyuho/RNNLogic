2025-06-29 23:49:21 INFO     Data loading | DONE!
2025-06-29 23:49:22 INFO     Using full datasets for training, validation, and testing.
2025-06-29 23:49:22 INFO     -------------------------
2025-06-29 23:49:22 INFO     | EM Iteration: 1/5
2025-06-29 23:49:22 INFO     -------------------------
2025-06-29 23:49:22 INFO     >>>>> Using miner's rule
2025-06-29 23:49:22 INFO     Predictor: read 13661 rules from list.
2025-06-29 23:49:22 INFO     Preprocess training set
2025-06-29 23:49:22 INFO     >>>>> Predictor: Training
2025-06-29 23:58:52 INFO     1000 5959 8.299284 69314.6
2025-06-30 00:08:19 INFO     2000 5959 7.689227 69271.3
2025-06-30 00:17:25 INFO     3000 5959 7.425850 69245.2
2025-06-30 00:26:38 INFO     4000 5959 7.285955 69340.6
2025-06-30 00:35:53 INFO     5000 5959 7.136692 69340.6
2025-06-30 00:44:50 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 00:47:10 INFO     Data : 2077
2025-06-30 00:47:10 INFO     Hit1 : 0.065479
2025-06-30 00:47:10 INFO     Hit3 : 0.127106
2025-06-30 00:47:10 INFO     Hit10: 0.199326
2025-06-30 00:47:10 INFO     MR   : 1120.920077
2025-06-30 00:47:10 INFO     MRR  : 0.114382
2025-06-30 00:47:10 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 00:49:42 INFO     Data : 2342
2025-06-30 00:49:42 INFO     Hit1 : 0.078992
2025-06-30 00:49:42 INFO     Hit3 : 0.124253
2025-06-30 00:49:42 INFO     Hit10: 0.208796
2025-06-30 00:49:42 INFO     MR   : 1044.279889
2025-06-30 00:49:42 INFO     MRR  : 0.122250
2025-06-30 00:49:42 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 01:24:45 INFO     1000 5959
2025-06-30 01:59:21 INFO     2000 5959
2025-06-30 02:33:20 INFO     3000 5959
2025-06-30 03:07:24 INFO     4000 5959
2025-06-30 03:41:48 INFO     5000 5959
2025-06-30 04:17:06 INFO     >>>>> Generator: Training
2025-06-30 04:17:10 INFO     -------------------------
2025-06-30 04:17:10 INFO     | EM Iteration: 2/5
2025-06-30 04:17:10 INFO     -------------------------
2025-06-30 04:17:10 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:17:10 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:17:10 INFO     Predictor: read 1904 rules from list.
2025-06-30 04:17:10 INFO     Preprocess training set
2025-06-30 04:17:10 INFO     >>>>> Predictor: Training
2025-06-30 04:18:06 INFO     1000 5959 8.787464 69332.0
2025-06-30 04:18:54 INFO     2000 5959 8.398173 69349.3
2025-06-30 04:19:43 INFO     3000 5959 8.126257 69184.5
2025-06-30 04:20:32 INFO     4000 5959 7.935438 69253.9
2025-06-30 04:21:21 INFO     5000 5959 7.802489 69332.0
2025-06-30 04:22:07 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:22:17 INFO     Data : 2077
2025-06-30 04:22:17 INFO     Hit1 : 0.018296
2025-06-30 04:22:17 INFO     Hit3 : 0.032740
2025-06-30 04:22:17 INFO     Hit10: 0.060664
2025-06-30 04:22:17 INFO     MR   : 1451.351468
2025-06-30 04:22:17 INFO     MRR  : 0.034410
2025-06-30 04:22:17 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:22:29 INFO     Data : 2342
2025-06-30 04:22:29 INFO     Hit1 : 0.018360
2025-06-30 04:22:29 INFO     Hit3 : 0.036294
2025-06-30 04:22:29 INFO     Hit10: 0.064048
2025-06-30 04:22:29 INFO     MR   : 1339.881298
2025-06-30 04:22:29 INFO     MRR  : 0.036042
2025-06-30 04:22:29 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:24:49 INFO     1000 5959
2025-06-30 04:27:10 INFO     2000 5959
2025-06-30 04:29:40 INFO     3000 5959
2025-06-30 04:32:01 INFO     4000 5959
2025-06-30 04:34:24 INFO     5000 5959
2025-06-30 04:36:42 INFO     >>>>> Generator: Training
2025-06-30 04:36:45 INFO     -------------------------
2025-06-30 04:36:45 INFO     | EM Iteration: 3/5
2025-06-30 04:36:45 INFO     -------------------------
2025-06-30 04:36:45 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:36:45 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:36:45 INFO     Predictor: read 1883 rules from list.
2025-06-30 04:36:45 INFO     Preprocess training set
2025-06-30 04:36:45 INFO     >>>>> Predictor: Training
2025-06-30 04:37:34 INFO     1000 5959 8.805212 69271.3
2025-06-30 04:38:21 INFO     2000 5959 8.433574 69340.6
2025-06-30 04:39:09 INFO     3000 5959 8.187820 69384.0
2025-06-30 04:39:57 INFO     4000 5959 8.023671 69262.6
2025-06-30 04:40:44 INFO     5000 5959 7.902470 69332.0
2025-06-30 04:41:30 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:41:39 INFO     Data : 2077
2025-06-30 04:41:39 INFO     Hit1 : 0.013000
2025-06-30 04:41:39 INFO     Hit3 : 0.019740
2025-06-30 04:41:39 INFO     Hit10: 0.036110
2025-06-30 04:41:39 INFO     MR   : 1495.286712
2025-06-30 04:41:39 INFO     MRR  : 0.023818
2025-06-30 04:41:39 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:41:50 INFO     Data : 2342
2025-06-30 04:41:50 INFO     Hit1 : 0.012810
2025-06-30 04:41:50 INFO     Hit3 : 0.020495
2025-06-30 04:41:50 INFO     Hit10: 0.032451
2025-06-30 04:41:50 INFO     MR   : 1387.798249
2025-06-30 04:41:50 INFO     MRR  : 0.023086
2025-06-30 04:41:50 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:44:07 INFO     1000 5959
2025-06-30 04:46:24 INFO     2000 5959
2025-06-30 04:48:49 INFO     3000 5959
2025-06-30 04:51:08 INFO     4000 5959
2025-06-30 04:53:25 INFO     5000 5959
2025-06-30 04:55:38 INFO     >>>>> Generator: Training
2025-06-30 04:55:41 INFO     -------------------------
2025-06-30 04:55:41 INFO     | EM Iteration: 4/5
2025-06-30 04:55:41 INFO     -------------------------
2025-06-30 04:55:41 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:55:41 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:55:41 INFO     Predictor: read 1862 rules from list.
2025-06-30 04:55:41 INFO     Preprocess training set
2025-06-30 04:55:41 INFO     >>>>> Predictor: Training
2025-06-30 04:56:28 INFO     1000 5959 8.797468 69332.0
2025-06-30 04:57:15 INFO     2000 5959 8.412964 69349.3
2025-06-30 04:58:01 INFO     3000 5959 8.138549 69340.6
2025-06-30 04:58:48 INFO     4000 5959 7.944433 69297.3
2025-06-30 04:59:34 INFO     5000 5959 7.763990 69219.2
2025-06-30 05:00:19 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:00:28 INFO     Data : 2077
2025-06-30 05:00:28 INFO     Hit1 : 0.027443
2025-06-30 05:00:28 INFO     Hit3 : 0.045258
2025-06-30 05:00:28 INFO     Hit10: 0.065479
2025-06-30 05:00:28 INFO     MR   : 1474.557053
2025-06-30 05:00:28 INFO     MRR  : 0.043990
2025-06-30 05:00:28 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:00:39 INFO     Data : 2342
2025-06-30 05:00:39 INFO     Hit1 : 0.019641
2025-06-30 05:00:39 INFO     Hit3 : 0.040564
2025-06-30 05:00:39 INFO     Hit10: 0.066183
2025-06-30 05:00:39 INFO     MR   : 1363.219044
2025-06-30 05:00:39 INFO     MRR  : 0.038684
2025-06-30 05:00:39 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 05:02:53 INFO     1000 5959
2025-06-30 05:05:24 INFO     2000 5959
2025-06-30 05:16:42 INFO     3000 5959
2025-06-30 05:21:00 INFO     4000 5959
2025-06-30 05:23:13 INFO     5000 5959
2025-06-30 05:25:23 INFO     >>>>> Generator: Training
2025-06-30 05:25:25 INFO     -------------------------
2025-06-30 05:25:25 INFO     | EM Iteration: 5/5
2025-06-30 05:25:25 INFO     -------------------------
2025-06-30 05:25:25 INFO     >>>>> Using Generator's sample rule
2025-06-30 05:25:25 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 05:25:25 INFO     Predictor: read 1709 rules from list.
2025-06-30 05:25:25 INFO     Preprocess training set
2025-06-30 05:25:25 INFO     >>>>> Predictor: Training
2025-06-30 05:26:07 INFO     1000 5959 8.790601 69271.3
2025-06-30 05:26:50 INFO     2000 5959 8.390885 69332.0
2025-06-30 05:27:32 INFO     3000 5959 8.137609 69375.3
2025-06-30 05:28:15 INFO     4000 5959 7.945192 69279.9
2025-06-30 05:28:57 INFO     5000 5959 7.810893 69349.3
2025-06-30 05:29:37 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:29:46 INFO     Data : 2077
2025-06-30 05:29:46 INFO     Hit1 : 0.015407
2025-06-30 05:29:46 INFO     Hit3 : 0.029369
2025-06-30 05:29:46 INFO     Hit10: 0.060183
2025-06-30 05:29:46 INFO     MR   : 1427.884689
2025-06-30 05:29:46 INFO     MRR  : 0.033079
2025-06-30 05:29:46 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:29:55 INFO     Data : 2342
2025-06-30 05:29:55 INFO     Hit1 : 0.016652
2025-06-30 05:29:55 INFO     Hit3 : 0.029889
2025-06-30 05:29:55 INFO     Hit10: 0.052519
2025-06-30 05:29:55 INFO     MR   : 1316.325576
2025-06-30 05:29:55 INFO     MRR  : 0.033241
2025-06-30 05:29:55 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 05:32:00 INFO     1000 5959
2025-06-30 05:34:05 INFO     2000 5959
2025-06-30 05:36:11 INFO     3000 5959
2025-06-30 05:38:17 INFO     4000 5959
2025-06-30 05:40:23 INFO     5000 5959
2025-06-30 05:42:27 INFO     >>>>> Generator: Training
2025-06-30 05:42:30 INFO     -------------------------
2025-06-30 05:42:30 INFO     | Post-train Generator
2025-06-30 05:42:30 INFO     -------------------------
2025-06-30 05:42:31 INFO     >>>>> Generator: Training
2025-06-30 05:43:00 INFO     [E01000] Total 2.526185 | Main 2.584812 | RelClus 1.774768 | EntType 2.808587
2025-06-30 05:43:00 INFO     -------------------------
2025-06-30 05:43:00 INFO     | Beam Search Best Rules
2025-06-30 05:43:00 INFO     -------------------------
2025-06-30 05:43:00 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:43:00 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:43:04 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:44:04 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:44:54 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:45:28 INFO     -------------------------
2025-06-30 05:45:28 INFO     | Train Final Predictor+
2025-06-30 05:45:28 INFO     -------------------------
2025-06-30 05:45:28 INFO     Predictor+: read 18420 rules from list.
2025-06-30 05:45:28 INFO     Preprocess training set
2025-06-30 05:45:28 INFO     -------------------------
2025-06-30 05:45:28 INFO     | Iteration: 1/5
2025-06-30 05:45:28 INFO     -------------------------
2025-06-30 05:45:28 INFO     >>>>> Predictor: Training
2025-06-30 05:50:05 INFO     1000 5959 4.909668 69366.7
2025-06-30 05:54:46 INFO     2000 5959 4.742220 69375.3
2025-06-30 05:59:30 INFO     3000 5959 4.710566 69219.2
2025-06-30 06:04:13 INFO     4000 5959 4.703490 69305.9
2025-06-30 06:08:53 INFO     5000 5959 4.663824 69288.6
2025-06-30 06:13:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:14:29 INFO     Data : 2077
2025-06-30 06:14:29 INFO     Hit1 : 0.094367
2025-06-30 06:14:29 INFO     Hit3 : 0.183919
2025-06-30 06:14:29 INFO     Hit10: 0.318729
2025-06-30 06:14:29 INFO     MR   : 975.709677
2025-06-30 06:14:29 INFO     MRR  : 0.164676
2025-06-30 06:14:29 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:15:45 INFO     Data : 2342
2025-06-30 06:15:45 INFO     Hit1 : 0.126815
2025-06-30 06:15:45 INFO     Hit3 : 0.212212
2025-06-30 06:15:45 INFO     Hit10: 0.318958
2025-06-30 06:15:45 INFO     MR   : 898.533945
2025-06-30 06:15:45 INFO     MRR  : 0.191741
2025-06-30 06:15:45 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_8_20250629_234920/predictor.pt
2025-06-30 06:15:45 INFO     -------------------------
2025-06-30 06:15:45 INFO     | Iteration: 2/5
2025-06-30 06:15:45 INFO     -------------------------
2025-06-30 06:15:45 INFO     >>>>> Predictor: Training
2025-06-30 06:20:28 INFO     1000 5959 4.634410 69288.6
2025-06-30 06:25:14 INFO     2000 5959 4.637529 69288.6
2025-06-30 06:30:00 INFO     3000 5959 4.617531 69340.6
2025-06-30 06:34:42 INFO     4000 5959 4.626656 69271.3
2025-06-30 06:39:27 INFO     5000 5959 4.648247 69219.2
2025-06-30 06:43:54 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:45:02 INFO     Data : 2077
2025-06-30 06:45:02 INFO     Hit1 : 0.091478
2025-06-30 06:45:02 INFO     Hit3 : 0.179104
2025-06-30 06:45:02 INFO     Hit10: 0.304285
2025-06-30 06:45:02 INFO     MR   : 948.137458
2025-06-30 06:45:02 INFO     MRR  : 0.162198
2025-06-30 06:45:02 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:46:18 INFO     Data : 2342
2025-06-30 06:46:18 INFO     Hit1 : 0.118702
2025-06-30 06:46:18 INFO     Hit3 : 0.199402
2025-06-30 06:46:18 INFO     Hit10: 0.318958
2025-06-30 06:46:18 INFO     MR   : 875.622118
2025-06-30 06:46:18 INFO     MRR  : 0.182152
2025-06-30 06:46:18 INFO     -------------------------
2025-06-30 06:46:18 INFO     | Iteration: 3/5
2025-06-30 06:46:18 INFO     -------------------------
2025-06-30 06:46:18 INFO     >>>>> Predictor: Training
2025-06-30 06:51:00 INFO     1000 5959 4.598731 69340.6
2025-06-30 06:55:39 INFO     2000 5959 4.569134 69184.5
2025-06-30 07:00:15 INFO     3000 5959 4.626796 69253.9
2025-06-30 07:04:56 INFO     4000 5959 4.604608 69340.6
2025-06-30 07:09:35 INFO     5000 5959 4.602785 69384.0
2025-06-30 07:14:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:15:12 INFO     Data : 2077
2025-06-30 07:15:12 INFO     Hit1 : 0.094367
2025-06-30 07:15:12 INFO     Hit3 : 0.185845
2025-06-30 07:15:12 INFO     Hit10: 0.310063
2025-06-30 07:15:12 INFO     MR   : 931.364468
2025-06-30 07:15:12 INFO     MRR  : 0.164614
2025-06-30 07:15:12 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:16:28 INFO     Data : 2342
2025-06-30 07:16:28 INFO     Hit1 : 0.121264
2025-06-30 07:16:28 INFO     Hit3 : 0.209223
2025-06-30 07:16:28 INFO     Hit10: 0.315542
2025-06-30 07:16:28 INFO     MR   : 859.917805
2025-06-30 07:16:28 INFO     MRR  : 0.187067
2025-06-30 07:16:28 INFO     -------------------------
2025-06-30 07:16:28 INFO     | Iteration: 4/5
2025-06-30 07:16:28 INFO     -------------------------
2025-06-30 07:16:28 INFO     >>>>> Predictor: Training
2025-06-30 07:21:14 INFO     1000 5959 4.601591 69323.3
2025-06-30 07:25:59 INFO     2000 5959 4.579053 69332.0
2025-06-30 07:30:40 INFO     3000 5959 4.613627 69219.2
2025-06-30 07:35:20 INFO     4000 5959 4.608690 69297.3
2025-06-30 07:40:04 INFO     5000 5959 4.573342 69332.0
2025-06-30 07:44:33 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:45:41 INFO     Data : 2077
2025-06-30 07:45:41 INFO     Hit1 : 0.090034
2025-06-30 07:45:41 INFO     Hit3 : 0.178142
2025-06-30 07:45:41 INFO     Hit10: 0.312951
2025-06-30 07:45:41 INFO     MR   : 918.604478
2025-06-30 07:45:41 INFO     MRR  : 0.161992
2025-06-30 07:45:41 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:46:57 INFO     Data : 2342
2025-06-30 07:46:57 INFO     Hit1 : 0.126815
2025-06-30 07:46:57 INFO     Hit3 : 0.207942
2025-06-30 07:46:57 INFO     Hit10: 0.315542
2025-06-30 07:46:57 INFO     MR   : 849.454740
2025-06-30 07:46:57 INFO     MRR  : 0.189767
2025-06-30 07:46:57 INFO     -------------------------
2025-06-30 07:46:57 INFO     | Iteration: 5/5
2025-06-30 07:46:57 INFO     -------------------------
2025-06-30 07:46:57 INFO     >>>>> Predictor: Training
2025-06-30 07:51:35 INFO     1000 5959 4.545118 69245.2
2025-06-30 07:56:12 INFO     2000 5959 4.539790 69262.6
2025-06-30 08:00:50 INFO     3000 5959 4.593092 69332.0
2025-06-30 08:05:26 INFO     4000 5959 4.597850 69366.7
2025-06-30 08:09:59 INFO     5000 5959 4.609038 69262.6
2025-06-30 08:14:25 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 08:15:33 INFO     Data : 2077
2025-06-30 08:15:33 INFO     Hit1 : 0.093885
2025-06-30 08:15:33 INFO     Hit3 : 0.186326
2025-06-30 08:15:33 INFO     Hit10: 0.309581
2025-06-30 08:15:33 INFO     MR   : 918.985797
2025-06-30 08:15:33 INFO     MRR  : 0.163590
2025-06-30 08:15:33 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 08:16:46 INFO     Data : 2342
2025-06-30 08:16:46 INFO     Hit1 : 0.130231
2025-06-30 08:16:46 INFO     Hit3 : 0.204953
2025-06-30 08:16:46 INFO     Hit10: 0.315542
2025-06-30 08:16:46 INFO     MR   : 850.517506
2025-06-30 08:16:46 INFO     MRR  : 0.191059
2025-06-30 08:16:46 INFO     -------------------------
2025-06-30 08:16:46 INFO     | Final Test MRR: 0.191741
2025-06-30 08:16:46 INFO     -------------------------
