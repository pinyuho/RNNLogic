2025-06-30 12:11:25 INFO     Data loading | DONE!
2025-06-30 12:11:25 INFO     Using full datasets for training, validation, and testing.
2025-06-30 12:11:25 INFO     -------------------------
2025-06-30 12:11:25 INFO     | EM Iteration: 1/5
2025-06-30 12:11:25 INFO     -------------------------
2025-06-30 12:11:25 INFO     >>>>> Using miner's rule
2025-06-30 12:11:25 INFO     Predictor: read 13661 rules from list.
2025-06-30 12:11:25 INFO     Preprocess training set
2025-06-30 12:11:25 INFO     >>>>> Predictor: Training
2025-06-30 12:19:20 INFO     1000 5959 8.299284 69314.6
2025-06-30 12:27:17 INFO     2000 5959 7.689227 69271.3
2025-06-30 12:35:09 INFO     3000 5959 7.425850 69245.2
2025-06-30 12:52:20 INFO     4000 5959 7.285955 69340.6
2025-06-30 13:00:09 INFO     5000 5959 7.136692 69340.6
2025-06-30 13:07:39 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 13:09:34 INFO     Data : 2077
2025-06-30 13:09:34 INFO     Hit1 : 0.065479
2025-06-30 13:09:34 INFO     Hit3 : 0.127106
2025-06-30 13:09:34 INFO     Hit10: 0.199326
2025-06-30 13:09:34 INFO     MR   : 1120.920077
2025-06-30 13:09:34 INFO     MRR  : 0.114382
2025-06-30 13:09:34 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 13:11:43 INFO     Data : 2342
2025-06-30 13:11:43 INFO     Hit1 : 0.078992
2025-06-30 13:11:43 INFO     Hit3 : 0.124253
2025-06-30 13:11:43 INFO     Hit10: 0.208796
2025-06-30 13:11:43 INFO     MR   : 1044.279889
2025-06-30 13:11:43 INFO     MRR  : 0.122250
2025-06-30 13:11:43 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 13:41:03 INFO     1000 5959
2025-06-30 14:10:25 INFO     2000 5959
2025-06-30 14:38:46 INFO     3000 5959
2025-06-30 15:08:51 INFO     4000 5959
2025-06-30 15:42:57 INFO     5000 5959
2025-06-30 16:16:45 INFO     >>>>> Generator: Training
2025-06-30 16:16:49 INFO     -------------------------
2025-06-30 16:16:49 INFO     | EM Iteration: 2/5
2025-06-30 16:16:49 INFO     -------------------------
2025-06-30 16:16:49 INFO     >>>>> Using Generator's sample rule
2025-06-30 16:16:49 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 16:16:49 INFO     Predictor: read 1904 rules from list.
2025-06-30 16:16:49 INFO     Preprocess training set
2025-06-30 16:16:49 INFO     >>>>> Predictor: Training
2025-06-30 16:17:44 INFO     1000 5959 8.787460 69332.0
2025-06-30 16:18:41 INFO     2000 5959 8.398163 69349.3
2025-06-30 16:19:41 INFO     3000 5959 8.126240 69184.5
2025-06-30 16:20:41 INFO     4000 5959 7.935416 69253.9
2025-06-30 16:21:36 INFO     5000 5959 7.802460 69332.0
2025-06-30 16:22:30 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 16:22:41 INFO     Data : 2077
2025-06-30 16:22:41 INFO     Hit1 : 0.018296
2025-06-30 16:22:41 INFO     Hit3 : 0.032740
2025-06-30 16:22:41 INFO     Hit10: 0.060664
2025-06-30 16:22:41 INFO     MR   : 1450.219788
2025-06-30 16:22:41 INFO     MRR  : 0.034410
2025-06-30 16:22:41 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 16:22:54 INFO     Data : 2342
2025-06-30 16:22:54 INFO     Hit1 : 0.018360
2025-06-30 16:22:54 INFO     Hit3 : 0.036294
2025-06-30 16:22:54 INFO     Hit10: 0.064048
2025-06-30 16:22:54 INFO     MR   : 1338.621264
2025-06-30 16:22:54 INFO     MRR  : 0.036042
2025-06-30 16:22:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 16:25:33 INFO     1000 5959
2025-06-30 16:28:25 INFO     2000 5959
2025-06-30 16:31:11 INFO     3000 5959
2025-06-30 16:33:54 INFO     4000 5959
2025-06-30 16:36:38 INFO     5000 5959
2025-06-30 16:39:15 INFO     >>>>> Generator: Training
2025-06-30 16:39:19 INFO     -------------------------
2025-06-30 16:39:19 INFO     | EM Iteration: 3/5
2025-06-30 16:39:19 INFO     -------------------------
2025-06-30 16:39:19 INFO     >>>>> Using Generator's sample rule
2025-06-30 16:39:19 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 16:39:19 INFO     Predictor: read 1884 rules from list.
2025-06-30 16:39:19 INFO     Preprocess training set
2025-06-30 16:39:19 INFO     >>>>> Predictor: Training
2025-06-30 16:40:15 INFO     1000 5959 8.806314 69271.3
2025-06-30 16:41:11 INFO     2000 5959 8.436189 69340.6
2025-06-30 16:42:06 INFO     3000 5959 8.192469 69384.0
2025-06-30 16:43:03 INFO     4000 5959 8.030529 69262.6
2025-06-30 16:44:00 INFO     5000 5959 7.906215 69332.0
2025-06-30 16:44:54 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 16:45:06 INFO     Data : 2077
2025-06-30 16:45:06 INFO     Hit1 : 0.013962
2025-06-30 16:45:06 INFO     Hit3 : 0.020703
2025-06-30 16:45:06 INFO     Hit10: 0.036591
2025-06-30 16:45:06 INFO     MR   : 1496.557535
2025-06-30 16:45:06 INFO     MRR  : 0.024648
2025-06-30 16:45:06 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 16:45:18 INFO     Data : 2342
2025-06-30 16:45:18 INFO     Hit1 : 0.013237
2025-06-30 16:45:18 INFO     Hit3 : 0.021776
2025-06-30 16:45:18 INFO     Hit10: 0.033305
2025-06-30 16:45:18 INFO     MR   : 1389.054654
2025-06-30 16:45:18 INFO     MRR  : 0.023756
2025-06-30 16:45:18 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 16:48:05 INFO     1000 5959
2025-06-30 16:50:47 INFO     2000 5959
2025-06-30 16:53:27 INFO     3000 5959
2025-06-30 16:56:05 INFO     4000 5959
2025-06-30 16:58:43 INFO     5000 5959
2025-06-30 17:01:16 INFO     >>>>> Generator: Training
2025-06-30 17:01:19 INFO     -------------------------
2025-06-30 17:01:19 INFO     | EM Iteration: 4/5
2025-06-30 17:01:19 INFO     -------------------------
2025-06-30 17:01:19 INFO     >>>>> Using Generator's sample rule
2025-06-30 17:01:19 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 17:01:19 INFO     Predictor: read 1856 rules from list.
2025-06-30 17:01:19 INFO     Preprocess training set
2025-06-30 17:01:19 INFO     >>>>> Predictor: Training
2025-06-30 17:02:14 INFO     1000 5959 8.795465 69332.0
2025-06-30 17:03:09 INFO     2000 5959 8.406544 69349.3
2025-06-30 17:04:03 INFO     3000 5959 8.130092 69340.6
2025-06-30 17:04:57 INFO     4000 5959 7.934503 69297.3
2025-06-30 17:05:51 INFO     5000 5959 7.754640 69219.2
2025-06-30 17:06:51 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 17:07:02 INFO     Data : 2077
2025-06-30 17:07:02 INFO     Hit1 : 0.026962
2025-06-30 17:07:02 INFO     Hit3 : 0.042850
2025-06-30 17:07:02 INFO     Hit10: 0.065961
2025-06-30 17:07:02 INFO     MR   : 1475.062831
2025-06-30 17:07:02 INFO     MRR  : 0.043346
2025-06-30 17:07:02 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 17:07:15 INFO     Data : 2342
2025-06-30 17:07:15 INFO     Hit1 : 0.019214
2025-06-30 17:07:15 INFO     Hit3 : 0.040564
2025-06-30 17:07:15 INFO     Hit10: 0.065329
2025-06-30 17:07:15 INFO     MR   : 1362.161827
2025-06-30 17:07:15 INFO     MRR  : 0.038244
2025-06-30 17:07:15 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 17:09:51 INFO     1000 5959
2025-06-30 17:12:30 INFO     2000 5959
2025-06-30 17:15:04 INFO     3000 5959
2025-06-30 17:17:39 INFO     4000 5959
2025-06-30 17:20:14 INFO     5000 5959
2025-06-30 17:22:46 INFO     >>>>> Generator: Training
2025-06-30 17:22:49 INFO     -------------------------
2025-06-30 17:22:49 INFO     | EM Iteration: 5/5
2025-06-30 17:22:49 INFO     -------------------------
2025-06-30 17:22:49 INFO     >>>>> Using Generator's sample rule
2025-06-30 17:22:49 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 17:22:49 INFO     Predictor: read 1702 rules from list.
2025-06-30 17:22:49 INFO     Preprocess training set
2025-06-30 17:22:49 INFO     >>>>> Predictor: Training
2025-06-30 17:23:40 INFO     1000 5959 8.791684 69271.3
2025-06-30 17:24:32 INFO     2000 5959 8.396191 69332.0
2025-06-30 17:25:25 INFO     3000 5959 8.140425 69375.3
2025-06-30 17:26:18 INFO     4000 5959 7.943202 69279.9
2025-06-30 17:27:10 INFO     5000 5959 7.809849 69349.3
2025-06-30 17:28:09 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 17:28:20 INFO     Data : 2077
2025-06-30 17:28:20 INFO     Hit1 : 0.025999
2025-06-30 17:28:20 INFO     Hit3 : 0.051998
2025-06-30 17:28:20 INFO     Hit10: 0.092922
2025-06-30 17:28:20 INFO     MR   : 1378.733269
2025-06-30 17:28:20 INFO     MRR  : 0.050532
2025-06-30 17:28:20 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 17:28:32 INFO     Data : 2342
2025-06-30 17:28:32 INFO     Hit1 : 0.029462
2025-06-30 17:28:32 INFO     Hit3 : 0.049530
2025-06-30 17:28:32 INFO     Hit10: 0.084970
2025-06-30 17:28:32 INFO     MR   : 1273.356319
2025-06-30 17:28:32 INFO     MRR  : 0.051352
2025-06-30 17:28:32 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 17:31:06 INFO     1000 5959
2025-06-30 17:33:40 INFO     2000 5959
2025-06-30 17:36:14 INFO     3000 5959
2025-06-30 17:38:45 INFO     4000 5959
2025-06-30 17:41:12 INFO     5000 5959
2025-06-30 17:43:34 INFO     >>>>> Generator: Training
2025-06-30 17:43:38 INFO     -------------------------
2025-06-30 17:43:38 INFO     | Post-train Generator
2025-06-30 17:43:38 INFO     -------------------------
2025-06-30 17:43:39 INFO     >>>>> Generator: Training
2025-06-30 17:44:14 INFO     [E01000] Total 2.452462 | Main 2.594994 | RelClus 0.876234 | EntType 2.888433
2025-06-30 17:44:14 INFO     -------------------------
2025-06-30 17:44:14 INFO     | Beam Search Best Rules
2025-06-30 17:44:14 INFO     -------------------------
2025-06-30 17:44:14 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:44:14 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:44:19 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:45:27 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:46:22 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 17:47:01 INFO     -------------------------
2025-06-30 17:47:01 INFO     | Train Final Predictor+
2025-06-30 17:47:01 INFO     -------------------------
2025-06-30 17:47:01 INFO     Predictor+: read 18420 rules from list.
2025-06-30 17:47:01 INFO     Preprocess training set
2025-06-30 17:47:01 INFO     -------------------------
2025-06-30 17:47:01 INFO     | Iteration: 1/5
2025-06-30 17:47:01 INFO     -------------------------
2025-06-30 17:47:01 INFO     >>>>> Predictor: Training
2025-06-30 17:57:39 INFO     1000 5959 4.900780 69366.7
2025-06-30 18:09:11 INFO     2000 5959 4.742120 69375.3
2025-06-30 18:14:43 INFO     3000 5959 4.711069 69219.2
2025-06-30 18:20:12 INFO     4000 5959 4.702864 69305.9
2025-06-30 18:25:38 INFO     5000 5959 4.663484 69288.6
2025-06-30 18:30:55 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 18:32:16 INFO     Data : 2077
2025-06-30 18:32:16 INFO     Hit1 : 0.089552
2025-06-30 18:32:16 INFO     Hit3 : 0.185364
2025-06-30 18:32:16 INFO     Hit10: 0.320173
2025-06-30 18:32:16 INFO     MR   : 970.869283
2025-06-30 18:32:16 INFO     MRR  : 0.162652
2025-06-30 18:32:16 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 18:33:46 INFO     Data : 2342
2025-06-30 18:33:46 INFO     Hit1 : 0.129804
2025-06-30 18:33:46 INFO     Hit3 : 0.212639
2025-06-30 18:33:46 INFO     Hit10: 0.318104
2025-06-30 18:33:46 INFO     MR   : 898.412041
2025-06-30 18:33:46 INFO     MRR  : 0.192946
2025-06-30 18:33:46 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250630_121123/predictor.pt
2025-06-30 18:33:46 INFO     -------------------------
2025-06-30 18:33:46 INFO     | Iteration: 2/5
2025-06-30 18:33:46 INFO     -------------------------
2025-06-30 18:33:46 INFO     >>>>> Predictor: Training
2025-06-30 18:39:19 INFO     1000 5959 4.633566 69288.6
2025-06-30 18:44:47 INFO     2000 5959 4.637555 69288.6
2025-06-30 18:50:19 INFO     3000 5959 4.615836 69340.6
2025-06-30 18:55:49 INFO     4000 5959 4.628048 69271.3
2025-06-30 19:01:21 INFO     5000 5959 4.647496 69219.2
2025-06-30 19:06:37 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 19:07:59 INFO     Data : 2077
2025-06-30 19:07:59 INFO     Hit1 : 0.084738
2025-06-30 19:07:59 INFO     Hit3 : 0.175734
2025-06-30 19:07:59 INFO     Hit10: 0.300915
2025-06-30 19:07:59 INFO     MR   : 946.283823
2025-06-30 19:07:59 INFO     MRR  : 0.157221
2025-06-30 19:07:59 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 19:09:30 INFO     Data : 2342
2025-06-30 19:09:30 INFO     Hit1 : 0.114432
2025-06-30 19:09:30 INFO     Hit3 : 0.194705
2025-06-30 19:09:30 INFO     Hit10: 0.312980
2025-06-30 19:09:30 INFO     MR   : 871.259180
2025-06-30 19:09:30 INFO     MRR  : 0.178952
2025-06-30 19:09:30 INFO     -------------------------
2025-06-30 19:09:30 INFO     | Iteration: 3/5
2025-06-30 19:09:30 INFO     -------------------------
2025-06-30 19:09:30 INFO     >>>>> Predictor: Training
2025-06-30 19:14:58 INFO     1000 5959 4.598747 69340.6
2025-06-30 19:20:26 INFO     2000 5959 4.570338 69184.5
2025-06-30 19:25:57 INFO     3000 5959 4.627657 69253.9
2025-06-30 19:31:27 INFO     4000 5959 4.604319 69340.6
2025-06-30 19:36:58 INFO     5000 5959 4.601776 69384.0
2025-06-30 19:42:11 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 19:43:32 INFO     Data : 2077
2025-06-30 19:43:32 INFO     Hit1 : 0.096774
2025-06-30 19:43:32 INFO     Hit3 : 0.191623
2025-06-30 19:43:32 INFO     Hit10: 0.316803
2025-06-30 19:43:32 INFO     MR   : 931.837747
2025-06-30 19:43:32 INFO     MRR  : 0.166413
2025-06-30 19:43:32 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 19:45:03 INFO     Data : 2342
2025-06-30 19:45:03 INFO     Hit1 : 0.125534
2025-06-30 19:45:03 INFO     Hit3 : 0.212212
2025-06-30 19:45:03 INFO     Hit10: 0.322374
2025-06-30 19:45:03 INFO     MR   : 863.893894
2025-06-30 19:45:03 INFO     MRR  : 0.189971
2025-06-30 19:45:03 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250630_121123/predictor.pt
2025-06-30 19:45:03 INFO     -------------------------
2025-06-30 19:45:03 INFO     | Iteration: 4/5
2025-06-30 19:45:03 INFO     -------------------------
2025-06-30 19:45:03 INFO     >>>>> Predictor: Training
2025-06-30 19:50:29 INFO     1000 5959 4.602407 69323.3
2025-06-30 19:56:02 INFO     2000 5959 4.578581 69332.0
2025-06-30 20:01:28 INFO     3000 5959 4.613158 69219.2
2025-06-30 20:06:55 INFO     4000 5959 4.609621 69297.3
2025-06-30 20:12:21 INFO     5000 5959 4.571100 69332.0
2025-06-30 20:17:33 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 20:18:53 INFO     Data : 2077
2025-06-30 20:18:53 INFO     Hit1 : 0.092441
2025-06-30 20:18:53 INFO     Hit3 : 0.177660
2025-06-30 20:18:53 INFO     Hit10: 0.312951
2025-06-30 20:18:53 INFO     MR   : 919.056572
2025-06-30 20:18:53 INFO     MRR  : 0.161656
2025-06-30 20:18:53 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 20:20:25 INFO     Data : 2342
2025-06-30 20:20:25 INFO     Hit1 : 0.125107
2025-06-30 20:20:25 INFO     Hit3 : 0.207942
2025-06-30 20:20:25 INFO     Hit10: 0.318104
2025-06-30 20:20:25 INFO     MR   : 853.119342
2025-06-30 20:20:25 INFO     MRR  : 0.188489
2025-06-30 20:20:25 INFO     -------------------------
2025-06-30 20:20:25 INFO     | Iteration: 5/5
2025-06-30 20:20:25 INFO     -------------------------
2025-06-30 20:20:25 INFO     >>>>> Predictor: Training
2025-06-30 20:25:54 INFO     1000 5959 4.543250 69245.2
2025-06-30 20:31:25 INFO     2000 5959 4.540017 69262.6
2025-06-30 20:36:48 INFO     3000 5959 4.594374 69332.0
2025-06-30 20:42:08 INFO     4000 5959 4.597613 69366.7
2025-06-30 20:47:30 INFO     5000 5959 4.609602 69262.6
2025-06-30 20:52:41 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 20:54:01 INFO     Data : 2077
2025-06-30 20:54:01 INFO     Hit1 : 0.099182
2025-06-30 20:54:01 INFO     Hit3 : 0.183438
2025-06-30 20:54:01 INFO     Hit10: 0.308137
2025-06-30 20:54:01 INFO     MR   : 917.589552
2025-06-30 20:54:01 INFO     MRR  : 0.167357
2025-06-30 20:54:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 20:55:16 INFO     Data : 2342
2025-06-30 20:55:16 INFO     Hit1 : 0.128523
2025-06-30 20:55:16 INFO     Hit3 : 0.217336
2025-06-30 20:55:16 INFO     Hit10: 0.317677
2025-06-30 20:55:16 INFO     MR   : 850.287788
2025-06-30 20:55:16 INFO     MRR  : 0.192734
2025-06-30 20:55:16 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250630_121123/predictor.pt
2025-06-30 20:55:16 INFO     -------------------------
2025-06-30 20:55:16 INFO     | Final Test MRR: 0.192734
2025-06-30 20:55:16 INFO     -------------------------
