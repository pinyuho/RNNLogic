2025-06-26 11:08:57 INFO     Data loading | DONE!
2025-06-26 11:08:57 INFO     Using full datasets for training, validation, and testing.
2025-06-26 11:08:57 INFO     -------------------------
2025-06-26 11:08:57 INFO     | EM Iteration: 1/5
2025-06-26 11:08:57 INFO     -------------------------
2025-06-26 11:08:57 INFO     >>>>> Using miner's rule
2025-06-26 11:08:57 INFO     Predictor: read 13661 rules from list.
2025-06-26 11:08:58 INFO     Preprocess training set
2025-06-26 11:08:58 INFO     >>>>> Predictor: Training
2025-06-26 11:16:54 INFO     1000 5959 8.299284 69314.6
2025-06-26 11:24:43 INFO     2000 5959 7.689227 69271.3
2025-06-26 11:33:02 INFO     3000 5959 7.425850 69245.2
2025-06-26 11:41:56 INFO     4000 5959 7.285955 69340.6
2025-06-26 11:50:49 INFO     5000 5959 7.136692 69340.6
2025-06-26 11:59:20 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 12:01:31 INFO     Data : 2077
2025-06-26 12:01:31 INFO     Hit1 : 0.065479
2025-06-26 12:01:31 INFO     Hit3 : 0.127106
2025-06-26 12:01:31 INFO     Hit10: 0.199326
2025-06-26 12:01:31 INFO     MR   : 1120.920077
2025-06-26 12:01:31 INFO     MRR  : 0.114382
2025-06-26 12:01:31 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 12:03:56 INFO     Data : 2342
2025-06-26 12:03:56 INFO     Hit1 : 0.078992
2025-06-26 12:03:56 INFO     Hit3 : 0.124253
2025-06-26 12:03:56 INFO     Hit10: 0.208796
2025-06-26 12:03:56 INFO     MR   : 1044.279889
2025-06-26 12:03:56 INFO     MRR  : 0.122250
2025-06-26 12:03:56 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 12:37:38 INFO     1000 5959
2025-06-26 13:09:25 INFO     2000 5959
2025-06-26 13:42:10 INFO     3000 5959
2025-06-26 14:13:59 INFO     4000 5959
2025-06-26 14:43:35 INFO     5000 5959
2025-06-26 15:15:02 INFO     >>>>> Generator: Training
2025-06-26 15:15:05 INFO     -------------------------
2025-06-26 15:15:05 INFO     | EM Iteration: 2/5
2025-06-26 15:15:05 INFO     -------------------------
2025-06-26 15:15:05 INFO     >>>>> Using Generator's sample rule
2025-06-26 15:15:05 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 15:15:05 INFO     Predictor: read 1904 rules from list.
2025-06-26 15:15:05 INFO     Preprocess training set
2025-06-26 15:15:05 INFO     >>>>> Predictor: Training
2025-06-26 15:16:01 INFO     1000 5959 8.787460 69332.0
2025-06-26 15:16:56 INFO     2000 5959 8.398163 69349.3
2025-06-26 15:17:50 INFO     3000 5959 8.126240 69184.5
2025-06-26 15:18:46 INFO     4000 5959 7.935416 69253.9
2025-06-26 15:19:42 INFO     5000 5959 7.802460 69332.0
2025-06-26 15:20:34 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 15:20:45 INFO     Data : 2077
2025-06-26 15:20:45 INFO     Hit1 : 0.018296
2025-06-26 15:20:45 INFO     Hit3 : 0.032740
2025-06-26 15:20:45 INFO     Hit10: 0.060664
2025-06-26 15:20:45 INFO     MR   : 1450.291767
2025-06-26 15:20:45 INFO     MRR  : 0.034410
2025-06-26 15:20:45 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 15:20:58 INFO     Data : 2342
2025-06-26 15:20:58 INFO     Hit1 : 0.018360
2025-06-26 15:20:58 INFO     Hit3 : 0.036294
2025-06-26 15:20:58 INFO     Hit10: 0.064048
2025-06-26 15:20:58 INFO     MR   : 1338.615927
2025-06-26 15:20:58 INFO     MRR  : 0.036042
2025-06-26 15:20:58 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 15:23:37 INFO     1000 5959
2025-06-26 15:26:16 INFO     2000 5959
2025-06-26 15:28:59 INFO     3000 5959
2025-06-26 15:31:42 INFO     4000 5959
2025-06-26 15:34:21 INFO     5000 5959
2025-06-26 15:36:56 INFO     >>>>> Generator: Training
2025-06-26 15:36:59 INFO     -------------------------
2025-06-26 15:36:59 INFO     | EM Iteration: 3/5
2025-06-26 15:36:59 INFO     -------------------------
2025-06-26 15:36:59 INFO     >>>>> Using Generator's sample rule
2025-06-26 15:36:59 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 15:36:59 INFO     Predictor: read 1884 rules from list.
2025-06-26 15:36:59 INFO     Preprocess training set
2025-06-26 15:36:59 INFO     >>>>> Predictor: Training
2025-06-26 15:37:53 INFO     1000 5959 8.806314 69271.3
2025-06-26 15:38:47 INFO     2000 5959 8.436189 69340.6
2025-06-26 15:39:41 INFO     3000 5959 8.192469 69384.0
2025-06-26 15:40:36 INFO     4000 5959 8.030529 69262.6
2025-06-26 15:41:31 INFO     5000 5959 7.906215 69332.0
2025-06-26 15:42:23 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 15:42:35 INFO     Data : 2077
2025-06-26 15:42:35 INFO     Hit1 : 0.013962
2025-06-26 15:42:35 INFO     Hit3 : 0.020703
2025-06-26 15:42:35 INFO     Hit10: 0.036591
2025-06-26 15:42:35 INFO     MR   : 1496.564275
2025-06-26 15:42:35 INFO     MRR  : 0.024648
2025-06-26 15:42:35 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 15:42:47 INFO     Data : 2342
2025-06-26 15:42:47 INFO     Hit1 : 0.013237
2025-06-26 15:42:47 INFO     Hit3 : 0.021776
2025-06-26 15:42:47 INFO     Hit10: 0.033305
2025-06-26 15:42:47 INFO     MR   : 1389.057643
2025-06-26 15:42:47 INFO     MRR  : 0.023756
2025-06-26 15:42:47 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 15:45:26 INFO     1000 5959
2025-06-26 15:48:03 INFO     2000 5959
2025-06-26 15:50:41 INFO     3000 5959
2025-06-26 15:53:20 INFO     4000 5959
2025-06-26 15:55:58 INFO     5000 5959
2025-06-26 15:58:29 INFO     >>>>> Generator: Training
2025-06-26 15:58:32 INFO     -------------------------
2025-06-26 15:58:32 INFO     | EM Iteration: 4/5
2025-06-26 15:58:32 INFO     -------------------------
2025-06-26 15:58:32 INFO     >>>>> Using Generator's sample rule
2025-06-26 15:58:32 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 15:58:32 INFO     Predictor: read 1855 rules from list.
2025-06-26 15:58:32 INFO     Preprocess training set
2025-06-26 15:58:32 INFO     >>>>> Predictor: Training
2025-06-26 15:59:25 INFO     1000 5959 8.794539 69332.0
2025-06-26 16:00:17 INFO     2000 5959 8.403702 69349.3
2025-06-26 16:01:10 INFO     3000 5959 8.126275 69340.6
2025-06-26 16:02:03 INFO     4000 5959 7.926581 69297.3
2025-06-26 16:02:55 INFO     5000 5959 7.744766 69219.2
2025-06-26 16:03:44 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 16:03:55 INFO     Data : 2077
2025-06-26 16:03:55 INFO     Hit1 : 0.026962
2025-06-26 16:03:55 INFO     Hit3 : 0.042850
2025-06-26 16:03:55 INFO     Hit10: 0.065961
2025-06-26 16:03:55 INFO     MR   : 1474.959798
2025-06-26 16:03:55 INFO     MRR  : 0.043350
2025-06-26 16:03:55 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 16:04:08 INFO     Data : 2342
2025-06-26 16:04:08 INFO     Hit1 : 0.019214
2025-06-26 16:04:08 INFO     Hit3 : 0.040564
2025-06-26 16:04:08 INFO     Hit10: 0.065329
2025-06-26 16:04:08 INFO     MR   : 1361.349274
2025-06-26 16:04:08 INFO     MRR  : 0.038245
2025-06-26 16:04:08 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 16:06:42 INFO     1000 5959
2025-06-26 16:09:15 INFO     2000 5959
2025-06-26 16:11:48 INFO     3000 5959
2025-06-26 16:14:20 INFO     4000 5959
2025-06-26 16:16:50 INFO     5000 5959
2025-06-26 16:19:19 INFO     >>>>> Generator: Training
2025-06-26 16:19:22 INFO     -------------------------
2025-06-26 16:19:22 INFO     | EM Iteration: 5/5
2025-06-26 16:19:22 INFO     -------------------------
2025-06-26 16:19:22 INFO     >>>>> Using Generator's sample rule
2025-06-26 16:19:22 INFO     >>>>> Generator: Rule generation with sampling
2025-06-26 16:19:22 INFO     Predictor: read 1693 rules from list.
2025-06-26 16:19:22 INFO     Preprocess training set
2025-06-26 16:19:22 INFO     >>>>> Predictor: Training
2025-06-26 16:20:12 INFO     1000 5959 8.791471 69271.3
2025-06-26 16:21:00 INFO     2000 5959 8.397553 69332.0
2025-06-26 16:21:49 INFO     3000 5959 8.145029 69375.3
2025-06-26 16:22:37 INFO     4000 5959 7.947861 69279.9
2025-06-26 16:23:24 INFO     5000 5959 7.814852 69349.3
2025-06-26 16:24:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 16:24:13 INFO     Data : 2077
2025-06-26 16:24:13 INFO     Hit1 : 0.025999
2025-06-26 16:24:13 INFO     Hit3 : 0.051998
2025-06-26 16:24:13 INFO     Hit10: 0.092922
2025-06-26 16:24:13 INFO     MR   : 1377.705344
2025-06-26 16:24:13 INFO     MRR  : 0.050533
2025-06-26 16:24:13 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 16:24:23 INFO     Data : 2342
2025-06-26 16:24:23 INFO     Hit1 : 0.029462
2025-06-26 16:24:23 INFO     Hit3 : 0.049530
2025-06-26 16:24:23 INFO     Hit10: 0.084970
2025-06-26 16:24:23 INFO     MR   : 1272.853757
2025-06-26 16:24:23 INFO     MRR  : 0.051331
2025-06-26 16:24:23 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 16:26:28 INFO     1000 5959
2025-06-26 16:28:32 INFO     2000 5959
2025-06-26 16:30:37 INFO     3000 5959
2025-06-26 16:32:40 INFO     4000 5959
2025-06-26 16:34:43 INFO     5000 5959
2025-06-26 16:36:43 INFO     >>>>> Generator: Training
2025-06-26 16:36:45 INFO     -------------------------
2025-06-26 16:36:45 INFO     | Post-train Generator
2025-06-26 16:36:45 INFO     -------------------------
2025-06-26 16:36:46 INFO     >>>>> Generator: Training
2025-06-26 16:37:13 INFO     [E01000] Total 2.425759 | main 2.604448 | aux_rel_cluster 0.547164 | aux_ent_type 2.874837
2025-06-26 16:37:13 INFO     -------------------------
2025-06-26 16:37:13 INFO     | Beam Search Best Rules
2025-06-26 16:37:13 INFO     -------------------------
2025-06-26 16:37:13 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 16:37:14 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 16:37:18 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 16:38:16 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 16:39:04 INFO     >>>>> Generator: Rule generation with beam search
2025-06-26 16:39:37 INFO     -------------------------
2025-06-26 16:39:37 INFO     | Train Final Predictor+
2025-06-26 16:39:37 INFO     -------------------------
2025-06-26 16:39:37 INFO     Predictor+: read 18420 rules from list.
2025-06-26 16:39:37 INFO     Preprocess training set
2025-06-26 16:39:37 INFO     -------------------------
2025-06-26 16:39:37 INFO     | Iteration: 1/5
2025-06-26 16:39:37 INFO     -------------------------
2025-06-26 16:39:37 INFO     >>>>> Predictor: Training
2025-06-26 16:44:06 INFO     1000 5959 4.883030 69366.7
2025-06-26 16:48:57 INFO     2000 5959 4.741444 69375.3
2025-06-26 16:54:09 INFO     3000 5959 4.712756 69219.2
2025-06-26 16:59:22 INFO     4000 5959 4.706359 69305.9
2025-06-26 17:04:34 INFO     5000 5959 4.664388 69288.6
2025-06-26 17:09:36 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 17:10:54 INFO     Data : 2077
2025-06-26 17:10:54 INFO     Hit1 : 0.093885
2025-06-26 17:10:54 INFO     Hit3 : 0.186326
2025-06-26 17:10:54 INFO     Hit10: 0.315840
2025-06-26 17:10:54 INFO     MR   : 971.953057
2025-06-26 17:10:54 INFO     MRR  : 0.165577
2025-06-26 17:10:54 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 17:12:20 INFO     Data : 2342
2025-06-26 17:12:20 INFO     Hit1 : 0.125961
2025-06-26 17:12:20 INFO     Hit3 : 0.212639
2025-06-26 17:12:20 INFO     Hit10: 0.317677
2025-06-26 17:12:20 INFO     MR   : 899.712425
2025-06-26 17:12:20 INFO     MRR  : 0.191780
2025-06-26 17:12:20 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/20250626_110855/predictor.pt
2025-06-26 17:12:20 INFO     -------------------------
2025-06-26 17:12:20 INFO     | Iteration: 2/5
2025-06-26 17:12:20 INFO     -------------------------
2025-06-26 17:12:20 INFO     >>>>> Predictor: Training
2025-06-26 17:17:34 INFO     1000 5959 4.635540 69288.6
2025-06-26 17:22:47 INFO     2000 5959 4.635811 69288.6
2025-06-26 17:28:00 INFO     3000 5959 4.618465 69340.6
2025-06-26 17:33:20 INFO     4000 5959 4.628443 69271.3
2025-06-26 17:38:40 INFO     5000 5959 4.648983 69219.2
2025-06-26 17:43:43 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 17:44:58 INFO     Data : 2077
2025-06-26 17:44:58 INFO     Hit1 : 0.092441
2025-06-26 17:44:58 INFO     Hit3 : 0.177660
2025-06-26 17:44:58 INFO     Hit10: 0.301878
2025-06-26 17:44:58 INFO     MR   : 953.349783
2025-06-26 17:44:58 INFO     MRR  : 0.160127
2025-06-26 17:44:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 17:46:24 INFO     Data : 2342
2025-06-26 17:46:24 INFO     Hit1 : 0.114432
2025-06-26 17:46:24 INFO     Hit3 : 0.198975
2025-06-26 17:46:24 INFO     Hit10: 0.318531
2025-06-26 17:46:24 INFO     MR   : 874.702391
2025-06-26 17:46:24 INFO     MRR  : 0.179267
2025-06-26 17:46:24 INFO     -------------------------
2025-06-26 17:46:24 INFO     | Iteration: 3/5
2025-06-26 17:46:24 INFO     -------------------------
2025-06-26 17:46:24 INFO     >>>>> Predictor: Training
2025-06-26 17:51:36 INFO     1000 5959 4.601313 69340.6
2025-06-26 17:56:46 INFO     2000 5959 4.569999 69184.5
2025-06-26 18:01:56 INFO     3000 5959 4.627290 69253.9
2025-06-26 18:07:06 INFO     4000 5959 4.608452 69340.6
2025-06-26 18:12:25 INFO     5000 5959 4.601452 69384.0
2025-06-26 18:16:56 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 18:18:01 INFO     Data : 2077
2025-06-26 18:18:01 INFO     Hit1 : 0.094367
2025-06-26 18:18:01 INFO     Hit3 : 0.189697
2025-06-26 18:18:01 INFO     Hit10: 0.317766
2025-06-26 18:18:01 INFO     MR   : 935.576793
2025-06-26 18:18:01 INFO     MRR  : 0.166302
2025-06-26 18:18:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 18:19:15 INFO     Data : 2342
2025-06-26 18:19:15 INFO     Hit1 : 0.125534
2025-06-26 18:19:15 INFO     Hit3 : 0.209223
2025-06-26 18:19:15 INFO     Hit10: 0.315542
2025-06-26 18:19:15 INFO     MR   : 860.456661
2025-06-26 18:19:15 INFO     MRR  : 0.190082
2025-06-26 18:19:15 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/20250626_110855/predictor.pt
2025-06-26 18:19:15 INFO     -------------------------
2025-06-26 18:19:15 INFO     | Iteration: 4/5
2025-06-26 18:19:15 INFO     -------------------------
2025-06-26 18:19:15 INFO     >>>>> Predictor: Training
2025-06-26 18:23:42 INFO     1000 5959 4.604553 69323.3
2025-06-26 18:28:10 INFO     2000 5959 4.583182 69332.0
2025-06-26 18:32:37 INFO     3000 5959 4.615243 69219.2
2025-06-26 18:37:01 INFO     4000 5959 4.610179 69297.3
2025-06-26 18:41:25 INFO     5000 5959 4.570833 69332.0
2025-06-26 18:45:39 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 18:46:43 INFO     Data : 2077
2025-06-26 18:46:43 INFO     Hit1 : 0.089071
2025-06-26 18:46:43 INFO     Hit3 : 0.183919
2025-06-26 18:46:43 INFO     Hit10: 0.324506
2025-06-26 18:46:43 INFO     MR   : 937.068849
2025-06-26 18:46:43 INFO     MRR  : 0.162435
2025-06-26 18:46:43 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 18:47:56 INFO     Data : 2342
2025-06-26 18:47:56 INFO     Hit1 : 0.130231
2025-06-26 18:47:56 INFO     Hit3 : 0.205380
2025-06-26 18:47:56 INFO     Hit10: 0.318531
2025-06-26 18:47:56 INFO     MR   : 856.801025
2025-06-26 18:47:56 INFO     MRR  : 0.190868
2025-06-26 18:47:56 INFO     -------------------------
2025-06-26 18:47:56 INFO     | Iteration: 5/5
2025-06-26 18:47:56 INFO     -------------------------
2025-06-26 18:47:56 INFO     >>>>> Predictor: Training
2025-06-26 18:52:21 INFO     1000 5959 4.548565 69245.2
2025-06-26 18:56:45 INFO     2000 5959 4.541859 69262.6
2025-06-26 19:01:09 INFO     3000 5959 4.597937 69332.0
2025-06-26 19:05:34 INFO     4000 5959 4.598040 69366.7
2025-06-26 19:09:58 INFO     5000 5959 4.606187 69262.6
2025-06-26 19:14:11 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 19:15:15 INFO     Data : 2077
2025-06-26 19:15:15 INFO     Hit1 : 0.094367
2025-06-26 19:15:15 INFO     Hit3 : 0.186326
2025-06-26 19:15:15 INFO     Hit10: 0.317766
2025-06-26 19:15:15 INFO     MR   : 921.678142
2025-06-26 19:15:15 INFO     MRR  : 0.166402
2025-06-26 19:15:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 19:16:28 INFO     Data : 2342
2025-06-26 19:16:28 INFO     Hit1 : 0.132792
2025-06-26 19:16:28 INFO     Hit3 : 0.216909
2025-06-26 19:16:28 INFO     Hit10: 0.320239
2025-06-26 19:16:28 INFO     MR   : 849.219044
2025-06-26 19:16:28 INFO     MRR  : 0.195971
2025-06-26 19:16:28 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/20250626_110855/predictor.pt
2025-06-26 19:16:28 INFO     -------------------------
2025-06-26 19:16:28 INFO     | Final Test MRR: 0.195971
2025-06-26 19:16:28 INFO     -------------------------
