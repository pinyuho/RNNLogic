2025-06-28 14:56:31 INFO     Data loading | DONE!
2025-06-28 14:56:31 INFO     Using full datasets for training, validation, and testing.
2025-06-28 14:56:31 INFO     -------------------------
2025-06-28 14:56:31 INFO     | EM Iteration: 1/5
2025-06-28 14:56:31 INFO     -------------------------
2025-06-28 14:56:31 INFO     >>>>> Using miner's rule
2025-06-28 14:56:31 INFO     Predictor: read 13661 rules from list.
2025-06-28 14:56:32 INFO     Preprocess training set
2025-06-28 14:56:32 INFO     >>>>> Predictor: Training
2025-06-28 15:04:23 INFO     1000 5959 8.299284 69314.6
2025-06-28 15:12:04 INFO     2000 5959 7.689227 69271.3
2025-06-28 15:19:40 INFO     3000 5959 7.425850 69245.2
2025-06-28 15:27:16 INFO     4000 5959 7.285955 69340.6
2025-06-28 15:34:58 INFO     5000 5959 7.136692 69340.6
2025-06-28 15:42:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 15:44:22 INFO     Data : 2077
2025-06-28 15:44:22 INFO     Hit1 : 0.065479
2025-06-28 15:44:22 INFO     Hit3 : 0.127106
2025-06-28 15:44:22 INFO     Hit10: 0.199326
2025-06-28 15:44:22 INFO     MR   : 1120.920077
2025-06-28 15:44:22 INFO     MRR  : 0.114382
2025-06-28 15:44:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 15:46:33 INFO     Data : 2342
2025-06-28 15:46:33 INFO     Hit1 : 0.078992
2025-06-28 15:46:33 INFO     Hit3 : 0.124253
2025-06-28 15:46:33 INFO     Hit10: 0.208796
2025-06-28 15:46:33 INFO     MR   : 1044.279889
2025-06-28 15:46:33 INFO     MRR  : 0.122250
2025-06-28 15:46:33 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 16:16:02 INFO     1000 5959
2025-06-28 16:49:01 INFO     2000 5959
2025-06-28 17:21:40 INFO     3000 5959
2025-06-28 17:54:39 INFO     4000 5959
2025-06-28 18:25:22 INFO     5000 5959
2025-06-28 18:53:44 INFO     >>>>> Generator: Training
2025-06-28 18:53:46 INFO     -------------------------
2025-06-28 18:53:46 INFO     | EM Iteration: 2/5
2025-06-28 18:53:46 INFO     -------------------------
2025-06-28 18:53:46 INFO     >>>>> Using Generator's sample rule
2025-06-28 18:53:46 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 18:53:47 INFO     Predictor: read 1904 rules from list.
2025-06-28 18:53:47 INFO     Preprocess training set
2025-06-28 18:53:47 INFO     >>>>> Predictor: Training
2025-06-28 18:54:34 INFO     1000 5959 8.787460 69332.0
2025-06-28 18:55:22 INFO     2000 5959 8.398163 69349.3
2025-06-28 18:56:09 INFO     3000 5959 8.126240 69184.5
2025-06-28 18:56:56 INFO     4000 5959 7.935416 69253.9
2025-06-28 18:57:42 INFO     5000 5959 7.802460 69332.0
2025-06-28 18:58:27 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 18:58:37 INFO     Data : 2077
2025-06-28 18:58:37 INFO     Hit1 : 0.018296
2025-06-28 18:58:37 INFO     Hit3 : 0.032740
2025-06-28 18:58:37 INFO     Hit10: 0.060664
2025-06-28 18:58:37 INFO     MR   : 1450.291767
2025-06-28 18:58:37 INFO     MRR  : 0.034410
2025-06-28 18:58:37 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 18:58:48 INFO     Data : 2342
2025-06-28 18:58:48 INFO     Hit1 : 0.018360
2025-06-28 18:58:48 INFO     Hit3 : 0.036294
2025-06-28 18:58:48 INFO     Hit10: 0.064048
2025-06-28 18:58:48 INFO     MR   : 1338.615927
2025-06-28 18:58:48 INFO     MRR  : 0.036042
2025-06-28 18:58:48 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 19:01:07 INFO     1000 5959
2025-06-28 19:03:24 INFO     2000 5959
2025-06-28 19:05:40 INFO     3000 5959
2025-06-28 19:07:58 INFO     4000 5959
2025-06-28 19:10:14 INFO     5000 5959
2025-06-28 19:12:27 INFO     >>>>> Generator: Training
2025-06-28 19:12:30 INFO     -------------------------
2025-06-28 19:12:30 INFO     | EM Iteration: 3/5
2025-06-28 19:12:30 INFO     -------------------------
2025-06-28 19:12:30 INFO     >>>>> Using Generator's sample rule
2025-06-28 19:12:30 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 19:12:30 INFO     Predictor: read 1884 rules from list.
2025-06-28 19:12:30 INFO     Preprocess training set
2025-06-28 19:12:30 INFO     >>>>> Predictor: Training
2025-06-28 19:13:16 INFO     1000 5959 8.806314 69271.3
2025-06-28 19:14:02 INFO     2000 5959 8.436189 69340.6
2025-06-28 19:14:48 INFO     3000 5959 8.192469 69384.0
2025-06-28 19:15:34 INFO     4000 5959 8.030529 69262.6
2025-06-28 19:16:21 INFO     5000 5959 7.906215 69332.0
2025-06-28 19:17:05 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 19:17:15 INFO     Data : 2077
2025-06-28 19:17:15 INFO     Hit1 : 0.013962
2025-06-28 19:17:15 INFO     Hit3 : 0.020703
2025-06-28 19:17:15 INFO     Hit10: 0.036591
2025-06-28 19:17:15 INFO     MR   : 1496.564275
2025-06-28 19:17:15 INFO     MRR  : 0.024648
2025-06-28 19:17:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 19:17:25 INFO     Data : 2342
2025-06-28 19:17:25 INFO     Hit1 : 0.013237
2025-06-28 19:17:25 INFO     Hit3 : 0.021776
2025-06-28 19:17:25 INFO     Hit10: 0.033305
2025-06-28 19:17:25 INFO     MR   : 1389.057643
2025-06-28 19:17:25 INFO     MRR  : 0.023756
2025-06-28 19:17:25 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 19:19:36 INFO     1000 5959
2025-06-28 19:21:47 INFO     2000 5959
2025-06-28 19:23:58 INFO     3000 5959
2025-06-28 19:26:09 INFO     4000 5959
2025-06-28 19:28:21 INFO     5000 5959
2025-06-28 19:30:30 INFO     >>>>> Generator: Training
2025-06-28 19:30:33 INFO     -------------------------
2025-06-28 19:30:33 INFO     | EM Iteration: 4/5
2025-06-28 19:30:33 INFO     -------------------------
2025-06-28 19:30:33 INFO     >>>>> Using Generator's sample rule
2025-06-28 19:30:33 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 19:30:33 INFO     Predictor: read 1855 rules from list.
2025-06-28 19:30:33 INFO     Preprocess training set
2025-06-28 19:30:33 INFO     >>>>> Predictor: Training
2025-06-28 19:31:17 INFO     1000 5959 8.794539 69332.0
2025-06-28 19:32:01 INFO     2000 5959 8.403702 69349.3
2025-06-28 19:32:45 INFO     3000 5959 8.126275 69340.6
2025-06-28 19:33:29 INFO     4000 5959 7.926581 69297.3
2025-06-28 19:34:13 INFO     5000 5959 7.744766 69219.2
2025-06-28 19:34:56 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 19:35:05 INFO     Data : 2077
2025-06-28 19:35:05 INFO     Hit1 : 0.026962
2025-06-28 19:35:05 INFO     Hit3 : 0.042850
2025-06-28 19:35:05 INFO     Hit10: 0.065961
2025-06-28 19:35:05 INFO     MR   : 1474.959798
2025-06-28 19:35:05 INFO     MRR  : 0.043350
2025-06-28 19:35:05 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 19:35:15 INFO     Data : 2342
2025-06-28 19:35:15 INFO     Hit1 : 0.019214
2025-06-28 19:35:15 INFO     Hit3 : 0.040564
2025-06-28 19:35:15 INFO     Hit10: 0.065329
2025-06-28 19:35:15 INFO     MR   : 1361.349274
2025-06-28 19:35:15 INFO     MRR  : 0.038245
2025-06-28 19:35:15 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 19:37:24 INFO     1000 5959
2025-06-28 19:39:32 INFO     2000 5959
2025-06-28 19:41:40 INFO     3000 5959
2025-06-28 19:43:49 INFO     4000 5959
2025-06-28 19:45:57 INFO     5000 5959
2025-06-28 19:48:02 INFO     >>>>> Generator: Training
2025-06-28 19:48:05 INFO     -------------------------
2025-06-28 19:48:05 INFO     | EM Iteration: 5/5
2025-06-28 19:48:05 INFO     -------------------------
2025-06-28 19:48:05 INFO     >>>>> Using Generator's sample rule
2025-06-28 19:48:05 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 19:48:05 INFO     Predictor: read 1693 rules from list.
2025-06-28 19:48:05 INFO     Preprocess training set
2025-06-28 19:48:05 INFO     >>>>> Predictor: Training
2025-06-28 19:48:45 INFO     1000 5959 8.791471 69271.3
2025-06-28 19:49:26 INFO     2000 5959 8.397553 69332.0
2025-06-28 19:50:06 INFO     3000 5959 8.145029 69375.3
2025-06-28 19:50:47 INFO     4000 5959 7.947861 69279.9
2025-06-28 19:51:27 INFO     5000 5959 7.814852 69349.3
2025-06-28 19:52:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 19:52:14 INFO     Data : 2077
2025-06-28 19:52:14 INFO     Hit1 : 0.025999
2025-06-28 19:52:14 INFO     Hit3 : 0.051998
2025-06-28 19:52:14 INFO     Hit10: 0.092922
2025-06-28 19:52:14 INFO     MR   : 1377.705344
2025-06-28 19:52:14 INFO     MRR  : 0.050533
2025-06-28 19:52:14 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 19:52:23 INFO     Data : 2342
2025-06-28 19:52:23 INFO     Hit1 : 0.029462
2025-06-28 19:52:23 INFO     Hit3 : 0.049530
2025-06-28 19:52:23 INFO     Hit10: 0.084970
2025-06-28 19:52:23 INFO     MR   : 1272.853757
2025-06-28 19:52:23 INFO     MRR  : 0.051331
2025-06-28 19:52:23 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 19:54:24 INFO     1000 5959
2025-06-28 19:56:26 INFO     2000 5959
2025-06-28 19:58:28 INFO     3000 5959
2025-06-28 20:00:30 INFO     4000 5959
2025-06-28 20:02:33 INFO     5000 5959
2025-06-28 20:04:32 INFO     >>>>> Generator: Training
2025-06-28 20:04:35 INFO     -------------------------
2025-06-28 20:04:35 INFO     | Post-train Generator
2025-06-28 20:04:35 INFO     -------------------------
2025-06-28 20:04:36 INFO     >>>>> Generator: Training
2025-06-28 20:05:02 INFO     [E01000] Total 2.425759 | Main 2.604448 | RelClus 0.547164 | EntType 2.874837
2025-06-28 20:05:02 INFO     -------------------------
2025-06-28 20:05:02 INFO     | Beam Search Best Rules
2025-06-28 20:05:02 INFO     -------------------------
2025-06-28 20:05:02 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 20:05:03 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 20:05:07 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 20:06:03 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 20:06:49 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 20:07:21 INFO     -------------------------
2025-06-28 20:07:21 INFO     | Train Final Predictor+
2025-06-28 20:07:21 INFO     -------------------------
2025-06-28 20:07:21 INFO     Predictor+: read 18420 rules from list.
2025-06-28 20:07:21 INFO     Preprocess training set
2025-06-28 20:07:21 INFO     -------------------------
2025-06-28 20:07:21 INFO     | Iteration: 1/5
2025-06-28 20:07:21 INFO     -------------------------
2025-06-28 20:07:21 INFO     >>>>> Predictor: Training
2025-06-28 20:11:46 INFO     1000 5959 4.882889 69366.7
2025-06-28 20:16:11 INFO     2000 5959 4.741440 69375.3
2025-06-28 20:20:35 INFO     3000 5959 4.713648 69219.2
2025-06-28 20:25:00 INFO     4000 5959 4.704966 69305.9
2025-06-28 20:29:25 INFO     5000 5959 4.663397 69288.6
2025-06-28 20:33:39 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 20:34:44 INFO     Data : 2077
2025-06-28 20:34:44 INFO     Hit1 : 0.091960
2025-06-28 20:34:44 INFO     Hit3 : 0.184401
2025-06-28 20:34:44 INFO     Hit10: 0.320655
2025-06-28 20:34:44 INFO     MR   : 970.616996
2025-06-28 20:34:44 INFO     MRR  : 0.163389
2025-06-28 20:34:44 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 20:35:57 INFO     Data : 2342
2025-06-28 20:35:57 INFO     Hit1 : 0.126815
2025-06-28 20:35:57 INFO     Hit3 : 0.211785
2025-06-28 20:35:57 INFO     Hit10: 0.317250
2025-06-28 20:35:57 INFO     MR   : 898.447481
2025-06-28 20:35:57 INFO     MRR  : 0.192347
2025-06-28 20:35:57 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250628_145629/predictor.pt
2025-06-28 20:35:57 INFO     -------------------------
2025-06-28 20:35:57 INFO     | Iteration: 2/5
2025-06-28 20:35:57 INFO     -------------------------
2025-06-28 20:35:57 INFO     >>>>> Predictor: Training
2025-06-28 20:40:22 INFO     1000 5959 4.633587 69288.6
2025-06-28 20:44:48 INFO     2000 5959 4.636652 69288.6
2025-06-28 20:49:15 INFO     3000 5959 4.617677 69340.6
2025-06-28 20:53:41 INFO     4000 5959 4.628393 69271.3
2025-06-28 20:58:06 INFO     5000 5959 4.648827 69219.2
2025-06-28 21:02:22 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 21:03:26 INFO     Data : 2077
2025-06-28 21:03:26 INFO     Hit1 : 0.092922
2025-06-28 21:03:26 INFO     Hit3 : 0.181030
2025-06-28 21:03:26 INFO     Hit10: 0.306211
2025-06-28 21:03:26 INFO     MR   : 947.169957
2025-06-28 21:03:26 INFO     MRR  : 0.161252
2025-06-28 21:03:26 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 21:04:40 INFO     Data : 2342
2025-06-28 21:04:40 INFO     Hit1 : 0.116140
2025-06-28 21:04:40 INFO     Hit3 : 0.195986
2025-06-28 21:04:40 INFO     Hit10: 0.316823
2025-06-28 21:04:40 INFO     MR   : 872.568104
2025-06-28 21:04:40 INFO     MRR  : 0.179760
2025-06-28 21:04:40 INFO     -------------------------
2025-06-28 21:04:40 INFO     | Iteration: 3/5
2025-06-28 21:04:40 INFO     -------------------------
2025-06-28 21:04:40 INFO     >>>>> Predictor: Training
2025-06-28 21:09:05 INFO     1000 5959 4.600153 69340.6
2025-06-28 21:13:32 INFO     2000 5959 4.570417 69184.5
2025-06-28 21:17:57 INFO     3000 5959 4.628595 69253.9
2025-06-28 21:22:25 INFO     4000 5959 4.604622 69340.6
2025-06-28 21:26:55 INFO     5000 5959 4.603282 69384.0
2025-06-28 21:31:13 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 21:32:19 INFO     Data : 2077
2025-06-28 21:32:19 INFO     Hit1 : 0.098700
2025-06-28 21:32:19 INFO     Hit3 : 0.184882
2025-06-28 21:32:19 INFO     Hit10: 0.312951
2025-06-28 21:32:19 INFO     MR   : 935.245787
2025-06-28 21:32:19 INFO     MRR  : 0.167473
2025-06-28 21:32:19 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 21:33:34 INFO     Data : 2342
2025-06-28 21:33:34 INFO     Hit1 : 0.125961
2025-06-28 21:33:34 INFO     Hit3 : 0.209223
2025-06-28 21:33:34 INFO     Hit10: 0.321947
2025-06-28 21:33:34 INFO     MR   : 861.365073
2025-06-28 21:33:34 INFO     MRR  : 0.190136
2025-06-28 21:33:34 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250628_145629/predictor.pt
2025-06-28 21:33:34 INFO     -------------------------
2025-06-28 21:33:34 INFO     | Iteration: 4/5
2025-06-28 21:33:34 INFO     -------------------------
2025-06-28 21:33:34 INFO     >>>>> Predictor: Training
2025-06-28 21:38:04 INFO     1000 5959 4.604373 69323.3
2025-06-28 21:42:34 INFO     2000 5959 4.584105 69332.0
2025-06-28 21:47:03 INFO     3000 5959 4.615610 69219.2
2025-06-28 21:51:33 INFO     4000 5959 4.611392 69297.3
2025-06-28 21:56:04 INFO     5000 5959 4.570994 69332.0
2025-06-28 22:00:24 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 22:01:30 INFO     Data : 2077
2025-06-28 22:01:30 INFO     Hit1 : 0.085701
2025-06-28 22:01:30 INFO     Hit3 : 0.182475
2025-06-28 22:01:30 INFO     Hit10: 0.315840
2025-06-28 22:01:30 INFO     MR   : 926.327636
2025-06-28 22:01:30 INFO     MRR  : 0.160139
2025-06-28 22:01:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 22:02:44 INFO     Data : 2342
2025-06-28 22:02:44 INFO     Hit1 : 0.126388
2025-06-28 22:02:44 INFO     Hit3 : 0.208369
2025-06-28 22:02:44 INFO     Hit10: 0.323655
2025-06-28 22:02:44 INFO     MR   : 852.292272
2025-06-28 22:02:44 INFO     MRR  : 0.190387
2025-06-28 22:02:44 INFO     -------------------------
2025-06-28 22:02:44 INFO     | Iteration: 5/5
2025-06-28 22:02:44 INFO     -------------------------
2025-06-28 22:02:44 INFO     >>>>> Predictor: Training
2025-06-28 22:07:15 INFO     1000 5959 4.547054 69245.2
2025-06-28 22:11:44 INFO     2000 5959 4.542120 69262.6
2025-06-28 22:16:14 INFO     3000 5959 4.598098 69332.0
2025-06-28 22:20:43 INFO     4000 5959 4.599124 69366.7
2025-06-28 22:25:12 INFO     5000 5959 4.607579 69262.6
2025-06-28 22:29:31 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 22:30:37 INFO     Data : 2077
2025-06-28 22:30:37 INFO     Hit1 : 0.092922
2025-06-28 22:30:37 INFO     Hit3 : 0.182956
2025-06-28 22:30:37 INFO     Hit10: 0.313433
2025-06-28 22:30:37 INFO     MR   : 920.516129
2025-06-28 22:30:37 INFO     MRR  : 0.164376
2025-06-28 22:30:37 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 22:31:51 INFO     Data : 2342
2025-06-28 22:31:51 INFO     Hit1 : 0.127669
2025-06-28 22:31:51 INFO     Hit3 : 0.212639
2025-06-28 22:31:51 INFO     Hit10: 0.318104
2025-06-28 22:31:51 INFO     MR   : 848.329633
2025-06-28 22:31:51 INFO     MRR  : 0.191625
2025-06-28 22:31:51 INFO     -------------------------
2025-06-28 22:31:51 INFO     | Final Test MRR: 0.190136
2025-06-28 22:31:51 INFO     -------------------------
