2025-06-27 23:03:48 INFO     Data loading | DONE!
2025-06-27 23:03:48 INFO     Using full datasets for training, validation, and testing.
2025-06-27 23:03:49 INFO     -------------------------
2025-06-27 23:03:49 INFO     | EM Iteration: 1/5
2025-06-27 23:03:49 INFO     -------------------------
2025-06-27 23:03:49 INFO     >>>>> Using miner's rule
2025-06-27 23:03:49 INFO     Predictor: read 13661 rules from list.
2025-06-27 23:03:49 INFO     Preprocess training set
2025-06-27 23:03:49 INFO     >>>>> Predictor: Training
2025-06-27 23:12:51 INFO     1000 5959 8.299284 69314.6
2025-06-27 23:21:57 INFO     2000 5959 7.689227 69271.3
2025-06-27 23:30:38 INFO     3000 5959 7.425850 69245.2
2025-06-27 23:39:33 INFO     4000 5959 7.285955 69340.6
2025-06-27 23:48:28 INFO     5000 5959 7.136692 69340.6
2025-06-27 23:56:57 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 23:59:09 INFO     Data : 2077
2025-06-27 23:59:09 INFO     Hit1 : 0.065479
2025-06-27 23:59:09 INFO     Hit3 : 0.127106
2025-06-27 23:59:09 INFO     Hit10: 0.199326
2025-06-27 23:59:09 INFO     MR   : 1120.920077
2025-06-27 23:59:09 INFO     MRR  : 0.114382
2025-06-27 23:59:09 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 00:01:36 INFO     Data : 2342
2025-06-28 00:01:36 INFO     Hit1 : 0.078992
2025-06-28 00:01:36 INFO     Hit3 : 0.124253
2025-06-28 00:01:36 INFO     Hit10: 0.208796
2025-06-28 00:01:36 INFO     MR   : 1044.279889
2025-06-28 00:01:36 INFO     MRR  : 0.122250
2025-06-28 00:01:36 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 00:32:05 INFO     1000 5959
2025-06-28 01:05:27 INFO     2000 5959
2025-06-28 01:37:36 INFO     3000 5959
2025-06-28 02:10:24 INFO     4000 5959
2025-06-28 02:40:36 INFO     5000 5959
2025-06-28 03:09:13 INFO     >>>>> Generator: Training
2025-06-28 03:09:16 INFO     -------------------------
2025-06-28 03:09:16 INFO     | EM Iteration: 2/5
2025-06-28 03:09:16 INFO     -------------------------
2025-06-28 03:09:16 INFO     >>>>> Using Generator's sample rule
2025-06-28 03:09:16 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 03:09:16 INFO     Predictor: read 1910 rules from list.
2025-06-28 03:09:16 INFO     Preprocess training set
2025-06-28 03:09:16 INFO     >>>>> Predictor: Training
2025-06-28 03:10:03 INFO     1000 5959 8.788000 69332.0
2025-06-28 03:10:49 INFO     2000 5959 8.399275 69349.3
2025-06-28 03:11:36 INFO     3000 5959 8.127595 69184.5
2025-06-28 03:12:24 INFO     4000 5959 7.936858 69253.9
2025-06-28 03:13:11 INFO     5000 5959 7.803566 69332.0
2025-06-28 03:13:56 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 03:14:06 INFO     Data : 2077
2025-06-28 03:14:06 INFO     Hit1 : 0.017814
2025-06-28 03:14:06 INFO     Hit3 : 0.032740
2025-06-28 03:14:06 INFO     Hit10: 0.059220
2025-06-28 03:14:06 INFO     MR   : 1453.192585
2025-06-28 03:14:06 INFO     MRR  : 0.033940
2025-06-28 03:14:06 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 03:14:17 INFO     Data : 2342
2025-06-28 03:14:17 INFO     Hit1 : 0.016225
2025-06-28 03:14:17 INFO     Hit3 : 0.035013
2025-06-28 03:14:17 INFO     Hit10: 0.063194
2025-06-28 03:14:17 INFO     MR   : 1341.299317
2025-06-28 03:14:17 INFO     MRR  : 0.034347
2025-06-28 03:14:17 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 03:16:32 INFO     1000 5959
2025-06-28 03:18:47 INFO     2000 5959
2025-06-28 03:21:02 INFO     3000 5959
2025-06-28 03:23:18 INFO     4000 5959
2025-06-28 03:25:35 INFO     5000 5959
2025-06-28 03:27:48 INFO     >>>>> Generator: Training
2025-06-28 03:27:51 INFO     -------------------------
2025-06-28 03:27:51 INFO     | EM Iteration: 3/5
2025-06-28 03:27:51 INFO     -------------------------
2025-06-28 03:27:51 INFO     >>>>> Using Generator's sample rule
2025-06-28 03:27:51 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 03:27:51 INFO     Predictor: read 1906 rules from list.
2025-06-28 03:27:51 INFO     Preprocess training set
2025-06-28 03:27:51 INFO     >>>>> Predictor: Training
2025-06-28 03:28:38 INFO     1000 5959 8.807479 69271.3
2025-06-28 03:29:25 INFO     2000 5959 8.440770 69340.6
2025-06-28 03:30:12 INFO     3000 5959 8.200751 69384.0
2025-06-28 03:30:59 INFO     4000 5959 8.041156 69262.6
2025-06-28 03:31:46 INFO     5000 5959 7.919747 69332.0
2025-06-28 03:32:31 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 03:32:40 INFO     Data : 2077
2025-06-28 03:32:40 INFO     Hit1 : 0.013000
2025-06-28 03:32:40 INFO     Hit3 : 0.019740
2025-06-28 03:32:40 INFO     Hit10: 0.036110
2025-06-28 03:32:40 INFO     MR   : 1499.752528
2025-06-28 03:32:40 INFO     MRR  : 0.023846
2025-06-28 03:32:40 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 03:32:51 INFO     Data : 2342
2025-06-28 03:32:51 INFO     Hit1 : 0.012810
2025-06-28 03:32:51 INFO     Hit3 : 0.020495
2025-06-28 03:32:51 INFO     Hit10: 0.032451
2025-06-28 03:32:51 INFO     MR   : 1390.752989
2025-06-28 03:32:51 INFO     MRR  : 0.023097
2025-06-28 03:32:51 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 03:35:04 INFO     1000 5959
2025-06-28 03:37:17 INFO     2000 5959
2025-06-28 03:39:32 INFO     3000 5959
2025-06-28 03:41:48 INFO     4000 5959
2025-06-28 03:44:01 INFO     5000 5959
2025-06-28 03:46:09 INFO     >>>>> Generator: Training
2025-06-28 03:46:12 INFO     -------------------------
2025-06-28 03:46:12 INFO     | EM Iteration: 4/5
2025-06-28 03:46:12 INFO     -------------------------
2025-06-28 03:46:12 INFO     >>>>> Using Generator's sample rule
2025-06-28 03:46:12 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 03:46:12 INFO     Predictor: read 1936 rules from list.
2025-06-28 03:46:12 INFO     Preprocess training set
2025-06-28 03:46:12 INFO     >>>>> Predictor: Training
2025-06-28 03:46:59 INFO     1000 5959 8.799614 69332.0
2025-06-28 03:47:45 INFO     2000 5959 8.419732 69349.3
2025-06-28 03:48:31 INFO     3000 5959 8.149974 69340.6
2025-06-28 03:49:18 INFO     4000 5959 7.958683 69297.3
2025-06-28 03:50:04 INFO     5000 5959 7.781244 69219.2
2025-06-28 03:50:48 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 03:50:58 INFO     Data : 2077
2025-06-28 03:50:58 INFO     Hit1 : 0.023592
2025-06-28 03:50:58 INFO     Hit3 : 0.041887
2025-06-28 03:50:58 INFO     Hit10: 0.068849
2025-06-28 03:50:58 INFO     MR   : 1473.547424
2025-06-28 03:50:58 INFO     MRR  : 0.042332
2025-06-28 03:50:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 03:51:09 INFO     Data : 2342
2025-06-28 03:51:09 INFO     Hit1 : 0.019641
2025-06-28 03:51:09 INFO     Hit3 : 0.037575
2025-06-28 03:51:09 INFO     Hit10: 0.062340
2025-06-28 03:51:09 INFO     MR   : 1358.955807
2025-06-28 03:51:09 INFO     MRR  : 0.037257
2025-06-28 03:51:09 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 03:53:22 INFO     1000 5959
2025-06-28 03:55:36 INFO     2000 5959
2025-06-28 03:57:49 INFO     3000 5959
2025-06-28 04:00:02 INFO     4000 5959
2025-06-28 04:02:15 INFO     5000 5959
2025-06-28 04:04:24 INFO     >>>>> Generator: Training
2025-06-28 04:04:27 INFO     -------------------------
2025-06-28 04:04:27 INFO     | EM Iteration: 5/5
2025-06-28 04:04:27 INFO     -------------------------
2025-06-28 04:04:27 INFO     >>>>> Using Generator's sample rule
2025-06-28 04:04:27 INFO     >>>>> Generator: Rule generation with sampling
2025-06-28 04:04:27 INFO     Predictor: read 1967 rules from list.
2025-06-28 04:04:27 INFO     Preprocess training set
2025-06-28 04:04:27 INFO     >>>>> Predictor: Training
2025-06-28 04:05:15 INFO     1000 5959 8.821022 69271.3
2025-06-28 04:06:04 INFO     2000 5959 8.501697 69332.0
2025-06-28 04:06:53 INFO     3000 5959 8.301524 69375.3
2025-06-28 04:07:42 INFO     4000 5959 8.154458 69279.9
2025-06-28 04:08:30 INFO     5000 5959 8.029042 69349.3
2025-06-28 04:09:17 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 04:09:27 INFO     Data : 2077
2025-06-28 04:09:27 INFO     Hit1 : 0.025036
2025-06-28 04:09:27 INFO     Hit3 : 0.054887
2025-06-28 04:09:27 INFO     Hit10: 0.080404
2025-06-28 04:09:27 INFO     MR   : 1415.794656
2025-06-28 04:09:27 INFO     MRR  : 0.048052
2025-06-28 04:09:27 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 04:09:38 INFO     Data : 2342
2025-06-28 04:09:38 INFO     Hit1 : 0.031170
2025-06-28 04:09:38 INFO     Hit3 : 0.052092
2025-06-28 04:09:38 INFO     Hit10: 0.079419
2025-06-28 04:09:38 INFO     MR   : 1325.249360
2025-06-28 04:09:38 INFO     MRR  : 0.050787
2025-06-28 04:09:38 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-28 04:11:56 INFO     1000 5959
2025-06-28 04:14:13 INFO     2000 5959
2025-06-28 04:16:30 INFO     3000 5959
2025-06-28 04:18:47 INFO     4000 5959
2025-06-28 04:21:05 INFO     5000 5959
2025-06-28 04:23:18 INFO     >>>>> Generator: Training
2025-06-28 04:23:20 INFO     -------------------------
2025-06-28 04:23:20 INFO     | Post-train Generator
2025-06-28 04:23:20 INFO     -------------------------
2025-06-28 04:23:21 INFO     >>>>> Generator: Training
2025-06-28 04:23:48 INFO     [E01000] Total 3.316246 | Main 3.175897 | RelClus 1.915257 | EntType 3.280555
2025-06-28 04:23:48 INFO     -------------------------
2025-06-28 04:23:48 INFO     | Beam Search Best Rules
2025-06-28 04:23:48 INFO     -------------------------
2025-06-28 04:23:48 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 04:23:49 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 04:23:53 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 04:24:49 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 04:25:36 INFO     >>>>> Generator: Rule generation with beam search
2025-06-28 04:26:09 INFO     -------------------------
2025-06-28 04:26:09 INFO     | Train Final Predictor+
2025-06-28 04:26:09 INFO     -------------------------
2025-06-28 04:26:09 INFO     Predictor+: read 18420 rules from list.
2025-06-28 04:26:09 INFO     Preprocess training set
2025-06-28 04:26:09 INFO     -------------------------
2025-06-28 04:26:09 INFO     | Iteration: 1/5
2025-06-28 04:26:09 INFO     -------------------------
2025-06-28 04:26:09 INFO     >>>>> Predictor: Training
2025-06-28 04:30:24 INFO     1000 5959 4.870182 69366.7
2025-06-28 04:34:38 INFO     2000 5959 4.746041 69375.3
2025-06-28 04:38:53 INFO     3000 5959 4.716387 69219.2
2025-06-28 04:43:07 INFO     4000 5959 4.707194 69305.9
2025-06-28 04:47:22 INFO     5000 5959 4.667371 69288.6
2025-06-28 04:51:26 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 04:52:30 INFO     Data : 2077
2025-06-28 04:52:30 INFO     Hit1 : 0.094367
2025-06-28 04:52:30 INFO     Hit3 : 0.181512
2025-06-28 04:52:30 INFO     Hit10: 0.318729
2025-06-28 04:52:30 INFO     MR   : 976.995185
2025-06-28 04:52:30 INFO     MRR  : 0.164570
2025-06-28 04:52:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 04:53:41 INFO     Data : 2342
2025-06-28 04:53:41 INFO     Hit1 : 0.131085
2025-06-28 04:53:41 INFO     Hit3 : 0.208369
2025-06-28 04:53:41 INFO     Hit10: 0.317677
2025-06-28 04:53:41 INFO     MR   : 902.147737
2025-06-28 04:53:41 INFO     MRR  : 0.192662
2025-06-28 04:53:41 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250627_230347/predictor.pt
2025-06-28 04:53:41 INFO     -------------------------
2025-06-28 04:53:41 INFO     | Iteration: 2/5
2025-06-28 04:53:41 INFO     -------------------------
2025-06-28 04:53:41 INFO     >>>>> Predictor: Training
2025-06-28 04:57:57 INFO     1000 5959 4.641934 69288.6
2025-06-28 05:02:06 INFO     2000 5959 4.644136 69288.6
2025-06-28 05:06:15 INFO     3000 5959 4.627084 69340.6
2025-06-28 05:10:27 INFO     4000 5959 4.640600 69271.3
2025-06-28 05:14:38 INFO     5000 5959 4.657569 69219.2
2025-06-28 05:18:39 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 05:19:42 INFO     Data : 2077
2025-06-28 05:19:42 INFO     Hit1 : 0.092922
2025-06-28 05:19:42 INFO     Hit3 : 0.179586
2025-06-28 05:19:42 INFO     Hit10: 0.304766
2025-06-28 05:19:42 INFO     MR   : 951.741935
2025-06-28 05:19:42 INFO     MRR  : 0.161864
2025-06-28 05:19:42 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 05:20:53 INFO     Data : 2342
2025-06-28 05:20:53 INFO     Hit1 : 0.111870
2025-06-28 05:20:53 INFO     Hit3 : 0.198548
2025-06-28 05:20:53 INFO     Hit10: 0.315115
2025-06-28 05:20:53 INFO     MR   : 876.418019
2025-06-28 05:20:53 INFO     MRR  : 0.178131
2025-06-28 05:20:53 INFO     -------------------------
2025-06-28 05:20:53 INFO     | Iteration: 3/5
2025-06-28 05:20:53 INFO     -------------------------
2025-06-28 05:20:53 INFO     >>>>> Predictor: Training
2025-06-28 05:25:05 INFO     1000 5959 4.608367 69340.6
2025-06-28 05:29:17 INFO     2000 5959 4.578122 69184.5
2025-06-28 05:33:28 INFO     3000 5959 4.640299 69253.9
2025-06-28 05:37:40 INFO     4000 5959 4.618234 69340.6
2025-06-28 05:41:51 INFO     5000 5959 4.612491 69384.0
2025-06-28 05:45:51 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 05:46:53 INFO     Data : 2077
2025-06-28 05:46:53 INFO     Hit1 : 0.101107
2025-06-28 05:46:53 INFO     Hit3 : 0.181030
2025-06-28 05:46:53 INFO     Hit10: 0.313914
2025-06-28 05:46:53 INFO     MR   : 938.251083
2025-06-28 05:46:53 INFO     MRR  : 0.167942
2025-06-28 05:46:53 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 05:48:03 INFO     Data : 2342
2025-06-28 05:48:03 INFO     Hit1 : 0.128950
2025-06-28 05:48:03 INFO     Hit3 : 0.206234
2025-06-28 05:48:03 INFO     Hit10: 0.321093
2025-06-28 05:48:03 INFO     MR   : 866.140692
2025-06-28 05:48:03 INFO     MRR  : 0.191819
2025-06-28 05:48:03 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250627_230347/predictor.pt
2025-06-28 05:48:03 INFO     -------------------------
2025-06-28 05:48:03 INFO     | Iteration: 4/5
2025-06-28 05:48:03 INFO     -------------------------
2025-06-28 05:48:03 INFO     >>>>> Predictor: Training
2025-06-28 05:52:11 INFO     1000 5959 4.617514 69323.3
2025-06-28 05:56:19 INFO     2000 5959 4.591403 69332.0
2025-06-28 06:00:26 INFO     3000 5959 4.625810 69219.2
2025-06-28 06:04:39 INFO     4000 5959 4.619126 69297.3
2025-06-28 06:08:54 INFO     5000 5959 4.584105 69332.0
2025-06-28 06:13:00 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 06:14:04 INFO     Data : 2077
2025-06-28 06:14:04 INFO     Hit1 : 0.097256
2025-06-28 06:14:04 INFO     Hit3 : 0.183438
2025-06-28 06:14:04 INFO     Hit10: 0.317766
2025-06-28 06:14:04 INFO     MR   : 924.994704
2025-06-28 06:14:04 INFO     MRR  : 0.166701
2025-06-28 06:14:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 06:15:16 INFO     Data : 2342
2025-06-28 06:15:16 INFO     Hit1 : 0.133219
2025-06-28 06:15:16 INFO     Hit3 : 0.212212
2025-06-28 06:15:16 INFO     Hit10: 0.317677
2025-06-28 06:15:16 INFO     MR   : 855.876815
2025-06-28 06:15:16 INFO     MRR  : 0.195308
2025-06-28 06:15:16 INFO     -------------------------
2025-06-28 06:15:16 INFO     | Iteration: 5/5
2025-06-28 06:15:16 INFO     -------------------------
2025-06-28 06:15:16 INFO     >>>>> Predictor: Training
2025-06-28 06:19:32 INFO     1000 5959 4.559219 69245.2
2025-06-28 06:23:43 INFO     2000 5959 4.551966 69262.6
2025-06-28 06:27:50 INFO     3000 5959 4.606478 69332.0
2025-06-28 06:32:01 INFO     4000 5959 4.611383 69366.7
2025-06-28 06:36:08 INFO     5000 5959 4.620366 69262.6
2025-06-28 06:40:05 INFO     >>>>> Predictor: Evaluating on valid
2025-06-28 06:41:07 INFO     Data : 2077
2025-06-28 06:41:07 INFO     Hit1 : 0.103996
2025-06-28 06:41:07 INFO     Hit3 : 0.185364
2025-06-28 06:41:07 INFO     Hit10: 0.313433
2025-06-28 06:41:07 INFO     MR   : 922.633847
2025-06-28 06:41:07 INFO     MRR  : 0.171091
2025-06-28 06:41:07 INFO     >>>>> Predictor: Evaluating on test
2025-06-28 06:42:16 INFO     Data : 2342
2025-06-28 06:42:16 INFO     Hit1 : 0.128523
2025-06-28 06:42:16 INFO     Hit3 : 0.215628
2025-06-28 06:42:16 INFO     Hit10: 0.315542
2025-06-28 06:42:16 INFO     MR   : 854.909479
2025-06-28 06:42:16 INFO     MRR  : 0.192340
2025-06-28 06:42:16 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_3_20250627_230347/predictor.pt
2025-06-28 06:42:16 INFO     -------------------------
2025-06-28 06:42:16 INFO     | Final Test MRR: 0.192340
2025-06-28 06:42:16 INFO     -------------------------
