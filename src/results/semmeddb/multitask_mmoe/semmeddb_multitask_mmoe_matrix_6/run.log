2025-06-29 23:51:33 INFO     Data loading | DONE!
2025-06-29 23:51:33 INFO     Using full datasets for training, validation, and testing.
2025-06-29 23:51:33 INFO     -------------------------
2025-06-29 23:51:33 INFO     | EM Iteration: 1/5
2025-06-29 23:51:33 INFO     -------------------------
2025-06-29 23:51:33 INFO     >>>>> Using miner's rule
2025-06-29 23:51:33 INFO     Predictor: read 13661 rules from list.
2025-06-29 23:51:34 INFO     Preprocess training set
2025-06-29 23:51:34 INFO     >>>>> Predictor: Training
2025-06-29 23:59:58 INFO     1000 5959 8.299284 69314.6
2025-06-30 00:08:15 INFO     2000 5959 7.689227 69271.3
2025-06-30 00:16:14 INFO     3000 5959 7.425850 69245.2
2025-06-30 00:24:26 INFO     4000 5959 7.285955 69340.6
2025-06-30 00:32:38 INFO     5000 5959 7.136692 69340.6
2025-06-30 00:40:29 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 00:42:31 INFO     Data : 2077
2025-06-30 00:42:31 INFO     Hit1 : 0.065479
2025-06-30 00:42:31 INFO     Hit3 : 0.127106
2025-06-30 00:42:31 INFO     Hit10: 0.199326
2025-06-30 00:42:31 INFO     MR   : 1120.920077
2025-06-30 00:42:31 INFO     MRR  : 0.114382
2025-06-30 00:42:31 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 00:44:46 INFO     Data : 2342
2025-06-30 00:44:46 INFO     Hit1 : 0.078992
2025-06-30 00:44:46 INFO     Hit3 : 0.124253
2025-06-30 00:44:46 INFO     Hit10: 0.208796
2025-06-30 00:44:46 INFO     MR   : 1044.279889
2025-06-30 00:44:46 INFO     MRR  : 0.122250
2025-06-30 00:44:46 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 01:16:02 INFO     1000 5959
2025-06-30 01:46:52 INFO     2000 5959
2025-06-30 02:17:00 INFO     3000 5959
2025-06-30 02:47:18 INFO     4000 5959
2025-06-30 03:17:47 INFO     5000 5959
2025-06-30 03:48:44 INFO     >>>>> Generator: Training
2025-06-30 03:48:53 INFO     -------------------------
2025-06-30 03:48:53 INFO     | EM Iteration: 2/5
2025-06-30 03:48:53 INFO     -------------------------
2025-06-30 03:48:53 INFO     >>>>> Using Generator's sample rule
2025-06-30 03:48:53 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 03:48:54 INFO     Predictor: read 1906 rules from list.
2025-06-30 03:48:54 INFO     Preprocess training set
2025-06-30 03:48:54 INFO     >>>>> Predictor: Training
2025-06-30 03:49:44 INFO     1000 5959 8.787476 69332.0
2025-06-30 03:50:35 INFO     2000 5959 8.398160 69349.3
2025-06-30 03:51:26 INFO     3000 5959 8.126260 69184.5
2025-06-30 03:52:16 INFO     4000 5959 7.935441 69253.9
2025-06-30 03:53:08 INFO     5000 5959 7.802471 69332.0
2025-06-30 03:53:56 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 03:54:07 INFO     Data : 2077
2025-06-30 03:54:07 INFO     Hit1 : 0.018296
2025-06-30 03:54:07 INFO     Hit3 : 0.032740
2025-06-30 03:54:07 INFO     Hit10: 0.060664
2025-06-30 03:54:07 INFO     MR   : 1452.574627
2025-06-30 03:54:07 INFO     MRR  : 0.034410
2025-06-30 03:54:07 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 03:54:19 INFO     Data : 2342
2025-06-30 03:54:19 INFO     Hit1 : 0.018360
2025-06-30 03:54:19 INFO     Hit3 : 0.036294
2025-06-30 03:54:19 INFO     Hit10: 0.064048
2025-06-30 03:54:19 INFO     MR   : 1340.637276
2025-06-30 03:54:19 INFO     MRR  : 0.036042
2025-06-30 03:54:19 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 03:56:45 INFO     1000 5959
2025-06-30 03:59:13 INFO     2000 5959
2025-06-30 04:01:40 INFO     3000 5959
2025-06-30 04:04:08 INFO     4000 5959
2025-06-30 04:06:32 INFO     5000 5959
2025-06-30 04:08:54 INFO     >>>>> Generator: Training
2025-06-30 04:09:02 INFO     -------------------------
2025-06-30 04:09:02 INFO     | EM Iteration: 3/5
2025-06-30 04:09:02 INFO     -------------------------
2025-06-30 04:09:02 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:09:02 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:09:03 INFO     Predictor: read 1886 rules from list.
2025-06-30 04:09:03 INFO     Preprocess training set
2025-06-30 04:09:03 INFO     >>>>> Predictor: Training
2025-06-30 04:09:54 INFO     1000 5959 8.805263 69271.3
2025-06-30 04:10:45 INFO     2000 5959 8.433749 69340.6
2025-06-30 04:11:37 INFO     3000 5959 8.187949 69384.0
2025-06-30 04:12:27 INFO     4000 5959 8.023776 69262.6
2025-06-30 04:13:17 INFO     5000 5959 7.902552 69332.0
2025-06-30 04:14:05 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:14:15 INFO     Data : 2077
2025-06-30 04:14:15 INFO     Hit1 : 0.013000
2025-06-30 04:14:15 INFO     Hit3 : 0.019740
2025-06-30 04:14:15 INFO     Hit10: 0.036110
2025-06-30 04:14:15 INFO     MR   : 1498.267212
2025-06-30 04:14:15 INFO     MRR  : 0.023819
2025-06-30 04:14:15 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:14:26 INFO     Data : 2342
2025-06-30 04:14:26 INFO     Hit1 : 0.012810
2025-06-30 04:14:26 INFO     Hit3 : 0.020495
2025-06-30 04:14:26 INFO     Hit10: 0.032451
2025-06-30 04:14:26 INFO     MR   : 1389.743168
2025-06-30 04:14:26 INFO     MRR  : 0.023078
2025-06-30 04:14:26 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:16:47 INFO     1000 5959
2025-06-30 04:19:12 INFO     2000 5959
2025-06-30 04:21:35 INFO     3000 5959
2025-06-30 04:23:56 INFO     4000 5959
2025-06-30 04:26:18 INFO     5000 5959
2025-06-30 04:28:35 INFO     >>>>> Generator: Training
2025-06-30 04:28:45 INFO     -------------------------
2025-06-30 04:28:45 INFO     | EM Iteration: 4/5
2025-06-30 04:28:45 INFO     -------------------------
2025-06-30 04:28:45 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:28:45 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:28:45 INFO     Predictor: read 1869 rules from list.
2025-06-30 04:28:45 INFO     Preprocess training set
2025-06-30 04:28:45 INFO     >>>>> Predictor: Training
2025-06-30 04:29:33 INFO     1000 5959 8.795982 69332.0
2025-06-30 04:30:20 INFO     2000 5959 8.408008 69349.3
2025-06-30 04:31:07 INFO     3000 5959 8.130086 69340.6
2025-06-30 04:31:54 INFO     4000 5959 7.933438 69297.3
2025-06-30 04:32:41 INFO     5000 5959 7.752270 69219.2
2025-06-30 04:33:25 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:33:35 INFO     Data : 2077
2025-06-30 04:33:35 INFO     Hit1 : 0.035147
2025-06-30 04:33:35 INFO     Hit3 : 0.062109
2025-06-30 04:33:35 INFO     Hit10: 0.090515
2025-06-30 04:33:35 INFO     MR   : 1432.709437
2025-06-30 04:33:35 INFO     MRR  : 0.058255
2025-06-30 04:33:35 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:33:46 INFO     Data : 2342
2025-06-30 04:33:46 INFO     Hit1 : 0.032451
2025-06-30 04:33:46 INFO     Hit3 : 0.060632
2025-06-30 04:33:46 INFO     Hit10: 0.090521
2025-06-30 04:33:46 INFO     MR   : 1331.554441
2025-06-30 04:33:46 INFO     MRR  : 0.056206
2025-06-30 04:33:46 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:36:02 INFO     1000 5959
2025-06-30 04:38:20 INFO     2000 5959
2025-06-30 04:40:37 INFO     3000 5959
2025-06-30 04:42:54 INFO     4000 5959
2025-06-30 04:45:10 INFO     5000 5959
2025-06-30 04:47:24 INFO     >>>>> Generator: Training
2025-06-30 04:47:34 INFO     -------------------------
2025-06-30 04:47:34 INFO     | EM Iteration: 5/5
2025-06-30 04:47:34 INFO     -------------------------
2025-06-30 04:47:34 INFO     >>>>> Using Generator's sample rule
2025-06-30 04:47:34 INFO     >>>>> Generator: Rule generation with sampling
2025-06-30 04:47:34 INFO     Predictor: read 1708 rules from list.
2025-06-30 04:47:34 INFO     Preprocess training set
2025-06-30 04:47:34 INFO     >>>>> Predictor: Training
2025-06-30 04:48:17 INFO     1000 5959 8.798162 69271.3
2025-06-30 04:49:00 INFO     2000 5959 8.428705 69332.0
2025-06-30 04:49:43 INFO     3000 5959 8.195794 69375.3
2025-06-30 04:50:27 INFO     4000 5959 8.014858 69279.9
2025-06-30 04:51:10 INFO     5000 5959 7.900923 69349.3
2025-06-30 04:51:52 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 04:52:01 INFO     Data : 2077
2025-06-30 04:52:01 INFO     Hit1 : 0.025999
2025-06-30 04:52:01 INFO     Hit3 : 0.051998
2025-06-30 04:52:01 INFO     Hit10: 0.091960
2025-06-30 04:52:01 INFO     MR   : 1376.842802
2025-06-30 04:52:01 INFO     MRR  : 0.050451
2025-06-30 04:52:01 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 04:52:10 INFO     Data : 2342
2025-06-30 04:52:10 INFO     Hit1 : 0.027754
2025-06-30 04:52:10 INFO     Hit3 : 0.048249
2025-06-30 04:52:10 INFO     Hit10: 0.083689
2025-06-30 04:52:10 INFO     MR   : 1272.001708
2025-06-30 04:52:10 INFO     MRR  : 0.049921
2025-06-30 04:52:10 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-30 04:54:18 INFO     1000 5959
2025-06-30 04:56:28 INFO     2000 5959
2025-06-30 04:58:37 INFO     3000 5959
2025-06-30 05:00:46 INFO     4000 5959
2025-06-30 05:02:54 INFO     5000 5959
2025-06-30 05:05:01 INFO     >>>>> Generator: Training
2025-06-30 05:05:09 INFO     -------------------------
2025-06-30 05:05:09 INFO     | Post-train Generator
2025-06-30 05:05:09 INFO     -------------------------
2025-06-30 05:05:11 INFO     >>>>> Generator: Training
2025-06-30 05:06:42 INFO     [E01000] Total 2.508038 | Main 2.586174 | RelClus 1.479896 | EntType 2.911093
2025-06-30 05:06:42 INFO     -------------------------
2025-06-30 05:06:42 INFO     | Beam Search Best Rules
2025-06-30 05:06:42 INFO     -------------------------
2025-06-30 05:06:42 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:06:45 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:07:04 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:12:05 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:16:21 INFO     >>>>> Generator: Rule generation with beam search
2025-06-30 05:19:18 INFO     -------------------------
2025-06-30 05:19:18 INFO     | Train Final Predictor+
2025-06-30 05:19:18 INFO     -------------------------
2025-06-30 05:19:18 INFO     Predictor+: read 18420 rules from list.
2025-06-30 05:19:18 INFO     Preprocess training set
2025-06-30 05:19:18 INFO     -------------------------
2025-06-30 05:19:18 INFO     | Iteration: 1/5
2025-06-30 05:19:18 INFO     -------------------------
2025-06-30 05:19:18 INFO     >>>>> Predictor: Training
2025-06-30 05:23:56 INFO     1000 5959 4.914594 69366.7
2025-06-30 05:28:39 INFO     2000 5959 4.748533 69375.3
2025-06-30 05:33:20 INFO     3000 5959 4.719820 69219.2
2025-06-30 05:38:03 INFO     4000 5959 4.710271 69305.9
2025-06-30 05:42:40 INFO     5000 5959 4.670098 69288.6
2025-06-30 05:47:04 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 05:48:12 INFO     Data : 2077
2025-06-30 05:48:12 INFO     Hit1 : 0.096293
2025-06-30 05:48:12 INFO     Hit3 : 0.183919
2025-06-30 05:48:12 INFO     Hit10: 0.315840
2025-06-30 05:48:12 INFO     MR   : 973.670920
2025-06-30 05:48:12 INFO     MRR  : 0.166251
2025-06-30 05:48:12 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 05:49:28 INFO     Data : 2342
2025-06-30 05:49:28 INFO     Hit1 : 0.125534
2025-06-30 05:49:28 INFO     Hit3 : 0.208796
2025-06-30 05:49:28 INFO     Hit10: 0.318531
2025-06-30 05:49:28 INFO     MR   : 896.444065
2025-06-30 05:49:28 INFO     MRR  : 0.189709
2025-06-30 05:49:28 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_mmoe_6_20250629_235132/predictor.pt
2025-06-30 05:49:28 INFO     -------------------------
2025-06-30 05:49:28 INFO     | Iteration: 2/5
2025-06-30 05:49:28 INFO     -------------------------
2025-06-30 05:49:28 INFO     >>>>> Predictor: Training
2025-06-30 05:54:03 INFO     1000 5959 4.645459 69288.6
2025-06-30 05:58:41 INFO     2000 5959 4.647383 69288.6
2025-06-30 06:03:20 INFO     3000 5959 4.623006 69340.6
2025-06-30 06:07:58 INFO     4000 5959 4.632749 69271.3
2025-06-30 06:12:36 INFO     5000 5959 4.657796 69219.2
2025-06-30 06:17:05 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:18:14 INFO     Data : 2077
2025-06-30 06:18:14 INFO     Hit1 : 0.083775
2025-06-30 06:18:14 INFO     Hit3 : 0.171883
2025-06-30 06:18:14 INFO     Hit10: 0.298989
2025-06-30 06:18:14 INFO     MR   : 949.980982
2025-06-30 06:18:14 INFO     MRR  : 0.155074
2025-06-30 06:18:14 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:19:32 INFO     Data : 2342
2025-06-30 06:19:32 INFO     Hit1 : 0.115286
2025-06-30 06:19:32 INFO     Hit3 : 0.195132
2025-06-30 06:19:32 INFO     Hit10: 0.314261
2025-06-30 06:19:32 INFO     MR   : 872.492528
2025-06-30 06:19:32 INFO     MRR  : 0.178589
2025-06-30 06:19:32 INFO     -------------------------
2025-06-30 06:19:32 INFO     | Iteration: 3/5
2025-06-30 06:19:32 INFO     -------------------------
2025-06-30 06:19:32 INFO     >>>>> Predictor: Training
2025-06-30 06:24:10 INFO     1000 5959 4.610492 69340.6
2025-06-30 06:28:47 INFO     2000 5959 4.580904 69184.5
2025-06-30 06:33:25 INFO     3000 5959 4.636313 69253.9
2025-06-30 06:38:00 INFO     4000 5959 4.609811 69340.6
2025-06-30 06:42:35 INFO     5000 5959 4.607991 69384.0
2025-06-30 06:46:58 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 06:48:06 INFO     Data : 2077
2025-06-30 06:48:06 INFO     Hit1 : 0.093404
2025-06-30 06:48:06 INFO     Hit3 : 0.183919
2025-06-30 06:48:06 INFO     Hit10: 0.311026
2025-06-30 06:48:06 INFO     MR   : 931.188012
2025-06-30 06:48:06 INFO     MRR  : 0.164064
2025-06-30 06:48:06 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 06:49:22 INFO     Data : 2342
2025-06-30 06:49:22 INFO     Hit1 : 0.128950
2025-06-30 06:49:22 INFO     Hit3 : 0.209650
2025-06-30 06:49:22 INFO     Hit10: 0.314688
2025-06-30 06:49:22 INFO     MR   : 860.884927
2025-06-30 06:49:22 INFO     MRR  : 0.190540
2025-06-30 06:49:22 INFO     -------------------------
2025-06-30 06:49:22 INFO     | Iteration: 4/5
2025-06-30 06:49:22 INFO     -------------------------
2025-06-30 06:49:22 INFO     >>>>> Predictor: Training
2025-06-30 06:53:57 INFO     1000 5959 4.610719 69323.3
2025-06-30 06:58:35 INFO     2000 5959 4.587364 69332.0
2025-06-30 07:03:15 INFO     3000 5959 4.620249 69219.2
2025-06-30 07:07:56 INFO     4000 5959 4.622626 69297.3
2025-06-30 07:12:30 INFO     5000 5959 4.580795 69332.0
2025-06-30 07:16:54 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:18:02 INFO     Data : 2077
2025-06-30 07:18:02 INFO     Hit1 : 0.090034
2025-06-30 07:18:02 INFO     Hit3 : 0.184882
2025-06-30 07:18:02 INFO     Hit10: 0.313433
2025-06-30 07:18:02 INFO     MR   : 925.490852
2025-06-30 07:18:02 INFO     MRR  : 0.161765
2025-06-30 07:18:02 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:19:18 INFO     Data : 2342
2025-06-30 07:19:18 INFO     Hit1 : 0.130658
2025-06-30 07:19:18 INFO     Hit3 : 0.211785
2025-06-30 07:19:18 INFO     Hit10: 0.315542
2025-06-30 07:19:18 INFO     MR   : 854.201110
2025-06-30 07:19:18 INFO     MRR  : 0.192287
2025-06-30 07:19:18 INFO     -------------------------
2025-06-30 07:19:18 INFO     | Iteration: 5/5
2025-06-30 07:19:18 INFO     -------------------------
2025-06-30 07:19:18 INFO     >>>>> Predictor: Training
2025-06-30 07:23:52 INFO     1000 5959 4.554216 69245.2
2025-06-30 07:28:31 INFO     2000 5959 4.548519 69262.6
2025-06-30 07:33:15 INFO     3000 5959 4.603237 69332.0
2025-06-30 07:37:57 INFO     4000 5959 4.605406 69366.7
2025-06-30 07:42:35 INFO     5000 5959 4.617129 69262.6
2025-06-30 07:47:08 INFO     >>>>> Predictor: Evaluating on valid
2025-06-30 07:48:18 INFO     Data : 2077
2025-06-30 07:48:18 INFO     Hit1 : 0.091478
2025-06-30 07:48:18 INFO     Hit3 : 0.172364
2025-06-30 07:48:18 INFO     Hit10: 0.308618
2025-06-30 07:48:18 INFO     MR   : 920.551757
2025-06-30 07:48:18 INFO     MRR  : 0.160784
2025-06-30 07:48:18 INFO     >>>>> Predictor: Evaluating on test
2025-06-30 07:49:37 INFO     Data : 2342
2025-06-30 07:49:37 INFO     Hit1 : 0.126388
2025-06-30 07:49:37 INFO     Hit3 : 0.204526
2025-06-30 07:49:37 INFO     Hit10: 0.315115
2025-06-30 07:49:37 INFO     MR   : 855.502348
2025-06-30 07:49:37 INFO     MRR  : 0.188243
2025-06-30 07:49:37 INFO     -------------------------
2025-06-30 07:49:37 INFO     | Final Test MRR: 0.189709
2025-06-30 07:49:37 INFO     -------------------------
