2025-06-27 10:25:00 INFO     Data loading | DONE!
2025-06-27 10:25:00 INFO     Using full datasets for training, validation, and testing.
2025-06-27 10:25:00 INFO     -------------------------
2025-06-27 10:25:00 INFO     | EM Iteration: 1/5
2025-06-27 10:25:00 INFO     -------------------------
2025-06-27 10:25:00 INFO     >>>>> Using miner's rule
2025-06-27 10:25:00 INFO     Predictor: read 13661 rules from list.
2025-06-27 10:25:01 INFO     Preprocess training set
2025-06-27 10:25:01 INFO     >>>>> Predictor: Training
2025-06-27 10:32:43 INFO     1000 5959 8.299284 69314.6
2025-06-27 10:40:22 INFO     2000 5959 7.689227 69271.3
2025-06-27 10:47:43 INFO     3000 5959 7.425850 69245.2
2025-06-27 10:55:10 INFO     4000 5959 7.285955 69340.6
2025-06-27 11:02:44 INFO     5000 5959 7.136692 69340.6
2025-06-27 11:10:02 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 11:11:55 INFO     Data : 2077
2025-06-27 11:11:55 INFO     Hit1 : 0.065479
2025-06-27 11:11:55 INFO     Hit3 : 0.127106
2025-06-27 11:11:55 INFO     Hit10: 0.199326
2025-06-27 11:11:55 INFO     MR   : 1120.920077
2025-06-27 11:11:55 INFO     MRR  : 0.114382
2025-06-27 11:11:55 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 11:14:03 INFO     Data : 2342
2025-06-27 11:14:03 INFO     Hit1 : 0.078992
2025-06-27 11:14:03 INFO     Hit3 : 0.124253
2025-06-27 11:14:03 INFO     Hit10: 0.208796
2025-06-27 11:14:03 INFO     MR   : 1044.279889
2025-06-27 11:14:03 INFO     MRR  : 0.122250
2025-06-27 11:14:03 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 11:44:15 INFO     1000 5959
2025-06-27 12:21:01 INFO     2000 5959
2025-06-27 12:57:38 INFO     3000 5959
2025-06-27 13:34:18 INFO     4000 5959
2025-06-27 14:07:03 INFO     5000 5959
2025-06-27 14:35:36 INFO     >>>>> Generator: Training
2025-06-27 14:35:37 INFO     -------------------------
2025-06-27 14:35:37 INFO     | EM Iteration: 2/5
2025-06-27 14:35:37 INFO     -------------------------
2025-06-27 14:35:37 INFO     >>>>> Using Generator's sample rule
2025-06-27 14:35:37 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 14:35:37 INFO     Predictor: read 1876 rules from list.
2025-06-27 14:35:37 INFO     Preprocess training set
2025-06-27 14:35:37 INFO     >>>>> Predictor: Training
2025-06-27 14:36:22 INFO     1000 5959 8.798643 69332.0
2025-06-27 14:37:08 INFO     2000 5959 8.421757 69349.3
2025-06-27 14:37:53 INFO     3000 5959 8.177750 69184.5
2025-06-27 14:38:39 INFO     4000 5959 7.990411 69253.9
2025-06-27 14:39:24 INFO     5000 5959 7.856989 69332.0
2025-06-27 14:40:07 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 14:40:17 INFO     Data : 2077
2025-06-27 14:40:17 INFO     Hit1 : 0.012037
2025-06-27 14:40:17 INFO     Hit3 : 0.022629
2025-06-27 14:40:17 INFO     Hit10: 0.042850
2025-06-27 14:40:17 INFO     MR   : 1480.959076
2025-06-27 14:40:17 INFO     MRR  : 0.025082
2025-06-27 14:40:17 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 14:40:28 INFO     Data : 2342
2025-06-27 14:40:28 INFO     Hit1 : 0.011529
2025-06-27 14:40:28 INFO     Hit3 : 0.020068
2025-06-27 14:40:28 INFO     Hit10: 0.040564
2025-06-27 14:40:28 INFO     MR   : 1362.793553
2025-06-27 14:40:28 INFO     MRR  : 0.023653
2025-06-27 14:40:28 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 14:42:40 INFO     1000 5959
2025-06-27 14:44:53 INFO     2000 5959
2025-06-27 14:47:07 INFO     3000 5959
2025-06-27 14:49:19 INFO     4000 5959
2025-06-27 14:51:35 INFO     5000 5959
2025-06-27 14:53:46 INFO     >>>>> Generator: Training
2025-06-27 14:53:48 INFO     -------------------------
2025-06-27 14:53:48 INFO     | EM Iteration: 3/5
2025-06-27 14:53:48 INFO     -------------------------
2025-06-27 14:53:48 INFO     >>>>> Using Generator's sample rule
2025-06-27 14:53:48 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 14:53:48 INFO     Predictor: read 1868 rules from list.
2025-06-27 14:53:48 INFO     Preprocess training set
2025-06-27 14:53:48 INFO     >>>>> Predictor: Training
2025-06-27 14:54:34 INFO     1000 5959 8.783918 69271.3
2025-06-27 14:55:19 INFO     2000 5959 8.396180 69340.6
2025-06-27 14:56:06 INFO     3000 5959 8.112075 69384.0
2025-06-27 14:56:52 INFO     4000 5959 7.935302 69262.6
2025-06-27 14:57:38 INFO     5000 5959 7.798320 69332.0
2025-06-27 14:58:21 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 14:58:30 INFO     Data : 2077
2025-06-27 14:58:30 INFO     Hit1 : 0.013000
2025-06-27 14:58:30 INFO     Hit3 : 0.026962
2025-06-27 14:58:30 INFO     Hit10: 0.063072
2025-06-27 14:58:30 INFO     MR   : 1454.843524
2025-06-27 14:58:30 INFO     MRR  : 0.031329
2025-06-27 14:58:30 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 14:58:41 INFO     Data : 2342
2025-06-27 14:58:41 INFO     Hit1 : 0.011529
2025-06-27 14:58:41 INFO     Hit3 : 0.028181
2025-06-27 14:58:41 INFO     Hit10: 0.059778
2025-06-27 14:58:41 INFO     MR   : 1353.545901
2025-06-27 14:58:41 INFO     MRR  : 0.029602
2025-06-27 14:58:41 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:00:54 INFO     1000 5959
2025-06-27 15:03:08 INFO     2000 5959
2025-06-27 15:05:20 INFO     3000 5959
2025-06-27 15:07:33 INFO     4000 5959
2025-06-27 15:09:47 INFO     5000 5959
2025-06-27 15:12:03 INFO     >>>>> Generator: Training
2025-06-27 15:12:04 INFO     -------------------------
2025-06-27 15:12:04 INFO     | EM Iteration: 4/5
2025-06-27 15:12:04 INFO     -------------------------
2025-06-27 15:12:04 INFO     >>>>> Using Generator's sample rule
2025-06-27 15:12:04 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 15:12:04 INFO     Predictor: read 1829 rules from list.
2025-06-27 15:12:04 INFO     Preprocess training set
2025-06-27 15:12:04 INFO     >>>>> Predictor: Training
2025-06-27 15:12:51 INFO     1000 5959 8.784388 69332.0
2025-06-27 15:13:39 INFO     2000 5959 8.380326 69349.3
2025-06-27 15:14:25 INFO     3000 5959 8.130445 69340.6
2025-06-27 15:15:12 INFO     4000 5959 7.931115 69297.3
2025-06-27 15:16:00 INFO     5000 5959 7.776129 69219.2
2025-06-27 15:16:45 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 15:16:54 INFO     Data : 2077
2025-06-27 15:16:54 INFO     Hit1 : 0.005778
2025-06-27 15:16:54 INFO     Hit3 : 0.013962
2025-06-27 15:16:54 INFO     Hit10: 0.025518
2025-06-27 15:16:54 INFO     MR   : 1528.439817
2025-06-27 15:16:54 INFO     MRR  : 0.016049
2025-06-27 15:16:54 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 15:17:05 INFO     Data : 2342
2025-06-27 15:17:05 INFO     Hit1 : 0.002989
2025-06-27 15:17:05 INFO     Hit3 : 0.011529
2025-06-27 15:17:05 INFO     Hit10: 0.021349
2025-06-27 15:17:05 INFO     MR   : 1406.525833
2025-06-27 15:17:05 INFO     MRR  : 0.013233
2025-06-27 15:17:05 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:19:20 INFO     1000 5959
2025-06-27 15:21:37 INFO     2000 5959
2025-06-27 15:23:53 INFO     3000 5959
2025-06-27 15:26:09 INFO     4000 5959
2025-06-27 15:28:24 INFO     5000 5959
2025-06-27 15:30:35 INFO     >>>>> Generator: Training
2025-06-27 15:30:37 INFO     -------------------------
2025-06-27 15:30:37 INFO     | EM Iteration: 5/5
2025-06-27 15:30:37 INFO     -------------------------
2025-06-27 15:30:37 INFO     >>>>> Using Generator's sample rule
2025-06-27 15:30:37 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 15:30:37 INFO     Predictor: read 1719 rules from list.
2025-06-27 15:30:37 INFO     Preprocess training set
2025-06-27 15:30:37 INFO     >>>>> Predictor: Training
2025-06-27 15:31:20 INFO     1000 5959 8.782062 69271.3
2025-06-27 15:32:03 INFO     2000 5959 8.359201 69332.0
2025-06-27 15:32:46 INFO     3000 5959 8.070970 69375.3
2025-06-27 15:33:29 INFO     4000 5959 7.859779 69279.9
2025-06-27 15:34:10 INFO     5000 5959 7.687891 69349.3
2025-06-27 15:34:49 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 15:34:58 INFO     Data : 2077
2025-06-27 15:34:58 INFO     Hit1 : 0.038036
2025-06-27 15:34:58 INFO     Hit3 : 0.064998
2025-06-27 15:34:58 INFO     Hit10: 0.090034
2025-06-27 15:34:58 INFO     MR   : 1410.684401
2025-06-27 15:34:58 INFO     MRR  : 0.059397
2025-06-27 15:34:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 15:35:07 INFO     Data : 2342
2025-06-27 15:35:07 INFO     Hit1 : 0.041845
2025-06-27 15:35:07 INFO     Hit3 : 0.065329
2025-06-27 15:35:07 INFO     Hit10: 0.088386
2025-06-27 15:35:07 INFO     MR   : 1316.509180
2025-06-27 15:35:07 INFO     MRR  : 0.061929
2025-06-27 15:35:07 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 15:37:10 INFO     1000 5959
2025-06-27 15:39:13 INFO     2000 5959
2025-06-27 15:41:23 INFO     3000 5959
2025-06-27 15:43:33 INFO     4000 5959
2025-06-27 15:45:42 INFO     5000 5959
2025-06-27 15:47:47 INFO     >>>>> Generator: Training
2025-06-27 15:47:49 INFO     -------------------------
2025-06-27 15:47:49 INFO     | Post-train Generator
2025-06-27 15:47:49 INFO     -------------------------
2025-06-27 15:47:50 INFO     >>>>> Generator: Training
2025-06-27 15:48:06 INFO     [E01000] Total 3.067318 | main 2.677555 | aux_rel_cluster 0.568289 | aux_ent_type 8.684457
2025-06-27 15:48:06 INFO     -------------------------
2025-06-27 15:48:06 INFO     | Beam Search Best Rules
2025-06-27 15:48:06 INFO     -------------------------
2025-06-27 15:48:06 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:06 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:09 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:48:56 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:49:37 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 15:50:05 INFO     -------------------------
2025-06-27 15:50:05 INFO     | Train Final Predictor+
2025-06-27 15:50:05 INFO     -------------------------
2025-06-27 15:50:05 INFO     Predictor+: read 18420 rules from list.
2025-06-27 15:50:05 INFO     Preprocess training set
2025-06-27 15:50:05 INFO     -------------------------
2025-06-27 15:50:05 INFO     | Iteration: 1/5
2025-06-27 15:50:05 INFO     -------------------------
2025-06-27 15:50:05 INFO     >>>>> Predictor: Training
2025-06-27 15:54:30 INFO     1000 5959 4.875591 69366.7
2025-06-27 15:58:56 INFO     2000 5959 4.748836 69375.3
2025-06-27 16:03:25 INFO     3000 5959 4.717498 69219.2
2025-06-27 16:07:48 INFO     4000 5959 4.707682 69305.9
2025-06-27 16:12:08 INFO     5000 5959 4.670831 69288.6
2025-06-27 16:16:17 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 16:17:22 INFO     Data : 2077
2025-06-27 16:17:22 INFO     Hit1 : 0.095330
2025-06-27 16:17:22 INFO     Hit3 : 0.187289
2025-06-27 16:17:22 INFO     Hit10: 0.313433
2025-06-27 16:17:22 INFO     MR   : 972.651180
2025-06-27 16:17:22 INFO     MRR  : 0.165820
2025-06-27 16:17:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 16:18:35 INFO     Data : 2342
2025-06-27 16:18:35 INFO     Hit1 : 0.128096
2025-06-27 16:18:35 INFO     Hit3 : 0.209650
2025-06-27 16:18:35 INFO     Hit10: 0.317250
2025-06-27 16:18:35 INFO     MR   : 897.822588
2025-06-27 16:18:35 INFO     MRR  : 0.190269
2025-06-27 16:18:35 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_hard_sharing_3_20250627_102459/predictor.pt
2025-06-27 16:18:35 INFO     -------------------------
2025-06-27 16:18:35 INFO     | Iteration: 2/5
2025-06-27 16:18:35 INFO     -------------------------
2025-06-27 16:18:35 INFO     >>>>> Predictor: Training
2025-06-27 16:22:55 INFO     1000 5959 4.645226 69288.6
2025-06-27 16:27:15 INFO     2000 5959 4.647719 69288.6
2025-06-27 16:31:30 INFO     3000 5959 4.629891 69340.6
2025-06-27 16:35:43 INFO     4000 5959 4.636690 69271.3
2025-06-27 16:39:54 INFO     5000 5959 4.658320 69219.2
2025-06-27 16:43:56 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 16:45:00 INFO     Data : 2077
2025-06-27 16:45:00 INFO     Hit1 : 0.090034
2025-06-27 16:45:00 INFO     Hit3 : 0.182475
2025-06-27 16:45:00 INFO     Hit10: 0.302359
2025-06-27 16:45:00 INFO     MR   : 962.670438
2025-06-27 16:45:00 INFO     MRR  : 0.161450
2025-06-27 16:45:00 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 16:46:11 INFO     Data : 2342
2025-06-27 16:46:11 INFO     Hit1 : 0.118275
2025-06-27 16:46:11 INFO     Hit3 : 0.201110
2025-06-27 16:46:11 INFO     Hit10: 0.313407
2025-06-27 16:46:11 INFO     MR   : 883.560632
2025-06-27 16:46:11 INFO     MRR  : 0.182434
2025-06-27 16:46:11 INFO     -------------------------
2025-06-27 16:46:11 INFO     | Iteration: 3/5
2025-06-27 16:46:11 INFO     -------------------------
2025-06-27 16:46:11 INFO     >>>>> Predictor: Training
2025-06-27 16:50:43 INFO     1000 5959 4.611316 69340.6
2025-06-27 16:55:40 INFO     2000 5959 4.580002 69184.5
2025-06-27 17:00:37 INFO     3000 5959 4.638791 69253.9
2025-06-27 17:05:34 INFO     4000 5959 4.618595 69340.6
2025-06-27 17:10:33 INFO     5000 5959 4.615708 69384.0
2025-06-27 17:15:22 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 17:16:37 INFO     Data : 2077
2025-06-27 17:16:37 INFO     Hit1 : 0.094367
2025-06-27 17:16:37 INFO     Hit3 : 0.179104
2025-06-27 17:16:37 INFO     Hit10: 0.310063
2025-06-27 17:16:37 INFO     MR   : 944.933077
2025-06-27 17:16:37 INFO     MRR  : 0.163235
2025-06-27 17:16:37 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 17:18:02 INFO     Data : 2342
2025-06-27 17:18:02 INFO     Hit1 : 0.127242
2025-06-27 17:18:02 INFO     Hit3 : 0.201110
2025-06-27 17:18:02 INFO     Hit10: 0.319385
2025-06-27 17:18:02 INFO     MR   : 869.064475
2025-06-27 17:18:02 INFO     MRR  : 0.188173
2025-06-27 17:18:02 INFO     -------------------------
2025-06-27 17:18:02 INFO     | Iteration: 4/5
2025-06-27 17:18:02 INFO     -------------------------
2025-06-27 17:18:02 INFO     >>>>> Predictor: Training
2025-06-27 17:23:07 INFO     1000 5959 4.619203 69323.3
2025-06-27 17:28:11 INFO     2000 5959 4.593332 69332.0
2025-06-27 17:33:12 INFO     3000 5959 4.627969 69219.2
2025-06-27 17:38:15 INFO     4000 5959 4.621211 69297.3
2025-06-27 17:43:19 INFO     5000 5959 4.586489 69332.0
2025-06-27 17:48:09 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 17:49:23 INFO     Data : 2077
2025-06-27 17:49:23 INFO     Hit1 : 0.093885
2025-06-27 17:49:23 INFO     Hit3 : 0.183919
2025-06-27 17:49:23 INFO     Hit10: 0.311026
2025-06-27 17:49:23 INFO     MR   : 927.002648
2025-06-27 17:49:23 INFO     MRR  : 0.165097
2025-06-27 17:49:23 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 17:50:46 INFO     Data : 2342
2025-06-27 17:50:46 INFO     Hit1 : 0.131085
2025-06-27 17:50:46 INFO     Hit3 : 0.206234
2025-06-27 17:50:46 INFO     Hit10: 0.321520
2025-06-27 17:50:46 INFO     MR   : 856.511742
2025-06-27 17:50:46 INFO     MRR  : 0.192542
2025-06-27 17:50:46 INFO     -------------------------
2025-06-27 17:50:46 INFO     | Iteration: 5/5
2025-06-27 17:50:46 INFO     -------------------------
2025-06-27 17:50:46 INFO     >>>>> Predictor: Training
2025-06-27 17:55:40 INFO     1000 5959 4.560424 69245.2
2025-06-27 18:00:33 INFO     2000 5959 4.552656 69262.6
2025-06-27 18:05:28 INFO     3000 5959 4.610292 69332.0
2025-06-27 18:10:24 INFO     4000 5959 4.613616 69366.7
2025-06-27 18:15:19 INFO     5000 5959 4.622824 69262.6
2025-06-27 18:20:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 18:21:20 INFO     Data : 2077
2025-06-27 18:21:20 INFO     Hit1 : 0.098219
2025-06-27 18:21:20 INFO     Hit3 : 0.186326
2025-06-27 18:21:20 INFO     Hit10: 0.308137
2025-06-27 18:21:20 INFO     MR   : 925.314636
2025-06-27 18:21:20 INFO     MRR  : 0.167375
2025-06-27 18:21:20 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 18:22:42 INFO     Data : 2342
2025-06-27 18:22:42 INFO     Hit1 : 0.133219
2025-06-27 18:22:42 INFO     Hit3 : 0.208796
2025-06-27 18:22:42 INFO     Hit10: 0.320666
2025-06-27 18:22:42 INFO     MR   : 856.851836
2025-06-27 18:22:42 INFO     MRR  : 0.194398
2025-06-27 18:22:42 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/semmeddb_multitask_hard_sharing_3_20250627_102459/predictor.pt
2025-06-27 18:22:42 INFO     -------------------------
2025-06-27 18:22:42 INFO     | Final Test MRR: 0.194398
2025-06-27 18:22:42 INFO     -------------------------
