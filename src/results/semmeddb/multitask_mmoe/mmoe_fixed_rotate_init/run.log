2025-06-26 21:21:00 INFO     Data loading | DONE!
2025-06-26 21:21:00 INFO     Using full datasets for training, validation, and testing.
2025-06-26 21:21:00 INFO     -------------------------
2025-06-26 21:21:00 INFO     | EM Iteration: 1/5
2025-06-26 21:21:00 INFO     -------------------------
2025-06-26 21:21:00 INFO     >>>>> Using miner's rule
2025-06-26 21:21:00 INFO     Predictor: read 13661 rules from list.
2025-06-26 21:21:01 INFO     Preprocess training set
2025-06-26 21:21:01 INFO     >>>>> Predictor: Training
2025-06-26 21:29:04 INFO     1000 5959 8.299284 69314.6
2025-06-26 21:36:50 INFO     2000 5959 7.689227 69271.3
2025-06-26 21:44:27 INFO     3000 5959 7.425850 69245.2
2025-06-26 21:51:58 INFO     4000 5959 7.285955 69340.6
2025-06-26 21:59:40 INFO     5000 5959 7.136692 69340.6
2025-06-26 22:07:06 INFO     >>>>> Predictor: Evaluating on valid
2025-06-26 22:09:02 INFO     Data : 2077
2025-06-26 22:09:02 INFO     Hit1 : 0.065479
2025-06-26 22:09:02 INFO     Hit3 : 0.127106
2025-06-26 22:09:02 INFO     Hit10: 0.199326
2025-06-26 22:09:02 INFO     MR   : 1120.920077
2025-06-26 22:09:02 INFO     MRR  : 0.114382
2025-06-26 22:09:02 INFO     >>>>> Predictor: Evaluating on test
2025-06-26 22:11:13 INFO     Data : 2342
2025-06-26 22:11:13 INFO     Hit1 : 0.078992
2025-06-26 22:11:13 INFO     Hit3 : 0.124253
2025-06-26 22:11:13 INFO     Hit10: 0.208796
2025-06-26 22:11:13 INFO     MR   : 1044.279889
2025-06-26 22:11:13 INFO     MRR  : 0.122250
2025-06-26 22:11:13 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-26 22:41:26 INFO     1000 5959
2025-06-26 23:12:48 INFO     2000 5959
2025-06-26 23:49:04 INFO     3000 5959
2025-06-27 00:26:25 INFO     4000 5959
2025-06-27 01:05:46 INFO     5000 5959
2025-06-27 01:44:27 INFO     >>>>> Generator: Training
2025-06-27 01:44:30 INFO     -------------------------
2025-06-27 01:44:30 INFO     | EM Iteration: 2/5
2025-06-27 01:44:30 INFO     -------------------------
2025-06-27 01:44:30 INFO     >>>>> Using Generator's sample rule
2025-06-27 01:44:30 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 01:44:30 INFO     Predictor: read 1901 rules from list.
2025-06-27 01:44:30 INFO     Preprocess training set
2025-06-27 01:44:30 INFO     >>>>> Predictor: Training
2025-06-27 01:45:30 INFO     1000 5959 8.787825 69332.0
2025-06-27 01:46:27 INFO     2000 5959 8.398759 69349.3
2025-06-27 01:47:28 INFO     3000 5959 8.127315 69184.5
2025-06-27 01:48:32 INFO     4000 5959 7.936895 69253.9
2025-06-27 01:49:29 INFO     5000 5959 7.806201 69332.0
2025-06-27 01:50:25 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 01:50:38 INFO     Data : 2077
2025-06-27 01:50:38 INFO     Hit1 : 0.018296
2025-06-27 01:50:38 INFO     Hit3 : 0.033221
2025-06-27 01:50:38 INFO     Hit10: 0.060183
2025-06-27 01:50:38 INFO     MR   : 1451.934280
2025-06-27 01:50:38 INFO     MRR  : 0.034253
2025-06-27 01:50:38 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 01:50:54 INFO     Data : 2342
2025-06-27 01:50:54 INFO     Hit1 : 0.018360
2025-06-27 01:50:54 INFO     Hit3 : 0.035867
2025-06-27 01:50:54 INFO     Hit10: 0.064048
2025-06-27 01:50:54 INFO     MR   : 1340.332195
2025-06-27 01:50:54 INFO     MRR  : 0.035968
2025-06-27 01:50:54 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 01:53:54 INFO     1000 5959
2025-06-27 01:56:10 INFO     2000 5959
2025-06-27 01:58:27 INFO     3000 5959
2025-06-27 02:00:42 INFO     4000 5959
2025-06-27 02:03:00 INFO     5000 5959
2025-06-27 02:05:17 INFO     >>>>> Generator: Training
2025-06-27 02:05:19 INFO     -------------------------
2025-06-27 02:05:19 INFO     | EM Iteration: 3/5
2025-06-27 02:05:19 INFO     -------------------------
2025-06-27 02:05:19 INFO     >>>>> Using Generator's sample rule
2025-06-27 02:05:19 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 02:05:19 INFO     Predictor: read 1893 rules from list.
2025-06-27 02:05:19 INFO     Preprocess training set
2025-06-27 02:05:19 INFO     >>>>> Predictor: Training
2025-06-27 02:06:08 INFO     1000 5959 8.806694 69271.3
2025-06-27 02:06:57 INFO     2000 5959 8.438421 69340.6
2025-06-27 02:07:46 INFO     3000 5959 8.195397 69384.0
2025-06-27 02:08:35 INFO     4000 5959 8.034990 69262.6
2025-06-27 02:09:25 INFO     5000 5959 7.911739 69332.0
2025-06-27 02:10:12 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 02:10:22 INFO     Data : 2077
2025-06-27 02:10:22 INFO     Hit1 : 0.013000
2025-06-27 02:10:22 INFO     Hit3 : 0.019740
2025-06-27 02:10:22 INFO     Hit10: 0.036110
2025-06-27 02:10:22 INFO     MR   : 1499.617477
2025-06-27 02:10:22 INFO     MRR  : 0.023824
2025-06-27 02:10:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 02:10:33 INFO     Data : 2342
2025-06-27 02:10:33 INFO     Hit1 : 0.012810
2025-06-27 02:10:33 INFO     Hit3 : 0.020495
2025-06-27 02:10:33 INFO     Hit10: 0.032451
2025-06-27 02:10:33 INFO     MR   : 1390.439795
2025-06-27 02:10:33 INFO     MRR  : 0.023090
2025-06-27 02:10:33 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 02:12:53 INFO     1000 5959
2025-06-27 02:15:13 INFO     2000 5959
2025-06-27 02:17:34 INFO     3000 5959
2025-06-27 02:19:57 INFO     4000 5959
2025-06-27 02:22:24 INFO     5000 5959
2025-06-27 02:24:45 INFO     >>>>> Generator: Training
2025-06-27 02:24:48 INFO     -------------------------
2025-06-27 02:24:48 INFO     | EM Iteration: 4/5
2025-06-27 02:24:48 INFO     -------------------------
2025-06-27 02:24:48 INFO     >>>>> Using Generator's sample rule
2025-06-27 02:24:48 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 02:24:48 INFO     Predictor: read 1907 rules from list.
2025-06-27 02:24:48 INFO     Preprocess training set
2025-06-27 02:24:48 INFO     >>>>> Predictor: Training
2025-06-27 02:25:40 INFO     1000 5959 8.798019 69332.0
2025-06-27 02:26:32 INFO     2000 5959 8.414700 69349.3
2025-06-27 02:27:25 INFO     3000 5959 8.140743 69340.6
2025-06-27 02:28:17 INFO     4000 5959 7.948893 69297.3
2025-06-27 02:29:09 INFO     5000 5959 7.769412 69219.2
2025-06-27 02:30:00 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 02:30:10 INFO     Data : 2077
2025-06-27 02:30:10 INFO     Hit1 : 0.013962
2025-06-27 02:30:10 INFO     Hit3 : 0.024555
2025-06-27 02:30:10 INFO     Hit10: 0.043332
2025-06-27 02:30:10 INFO     MR   : 1517.722436
2025-06-27 02:30:10 INFO     MRR  : 0.027283
2025-06-27 02:30:10 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 02:30:22 INFO     Data : 2342
2025-06-27 02:30:22 INFO     Hit1 : 0.007259
2025-06-27 02:30:22 INFO     Hit3 : 0.017506
2025-06-27 02:30:22 INFO     Hit10: 0.040137
2025-06-27 02:30:22 INFO     MR   : 1392.893894
2025-06-27 02:30:22 INFO     MRR  : 0.020336
2025-06-27 02:30:22 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 02:32:47 INFO     1000 5959
2025-06-27 02:35:12 INFO     2000 5959
2025-06-27 02:37:37 INFO     3000 5959
2025-06-27 02:39:56 INFO     4000 5959
2025-06-27 02:42:18 INFO     5000 5959
2025-06-27 02:44:35 INFO     >>>>> Generator: Training
2025-06-27 02:44:38 INFO     -------------------------
2025-06-27 02:44:38 INFO     | EM Iteration: 5/5
2025-06-27 02:44:38 INFO     -------------------------
2025-06-27 02:44:38 INFO     >>>>> Using Generator's sample rule
2025-06-27 02:44:38 INFO     >>>>> Generator: Rule generation with sampling
2025-06-27 02:44:38 INFO     Predictor: read 1902 rules from list.
2025-06-27 02:44:38 INFO     Preprocess training set
2025-06-27 02:44:38 INFO     >>>>> Predictor: Training
2025-06-27 02:45:32 INFO     1000 5959 8.797918 69271.3
2025-06-27 02:46:26 INFO     2000 5959 8.431381 69332.0
2025-06-27 02:47:20 INFO     3000 5959 8.184792 69375.3
2025-06-27 02:48:11 INFO     4000 5959 7.982279 69279.9
2025-06-27 02:49:04 INFO     5000 5959 7.830084 69349.3
2025-06-27 02:49:53 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 02:50:04 INFO     Data : 2077
2025-06-27 02:50:04 INFO     Hit1 : 0.029851
2025-06-27 02:50:04 INFO     Hit3 : 0.062590
2025-06-27 02:50:04 INFO     Hit10: 0.096774
2025-06-27 02:50:04 INFO     MR   : 1380.832932
2025-06-27 02:50:04 INFO     MRR  : 0.056132
2025-06-27 02:50:04 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 02:50:16 INFO     Data : 2342
2025-06-27 02:50:16 INFO     Hit1 : 0.033305
2025-06-27 02:50:16 INFO     Hit3 : 0.063194
2025-06-27 02:50:16 INFO     Hit10: 0.093510
2025-06-27 02:50:16 INFO     MR   : 1289.942143
2025-06-27 02:50:16 INFO     MRR  : 0.057932
2025-06-27 02:50:16 INFO     >>>>> Predictor: Computing H scores of rules
2025-06-27 02:52:40 INFO     1000 5959
2025-06-27 02:55:09 INFO     2000 5959
2025-06-27 02:57:32 INFO     3000 5959
2025-06-27 02:59:59 INFO     4000 5959
2025-06-27 03:02:27 INFO     5000 5959
2025-06-27 03:04:50 INFO     >>>>> Generator: Training
2025-06-27 03:04:53 INFO     -------------------------
2025-06-27 03:04:53 INFO     | Post-train Generator
2025-06-27 03:04:53 INFO     -------------------------
2025-06-27 03:04:54 INFO     >>>>> Generator: Training
2025-06-27 03:05:25 INFO     [E01000] Total 5.182148 | main 2.608265 | aux_rel_cluster 0.698403 | aux_ent_type 30.256953
2025-06-27 03:05:25 INFO     -------------------------
2025-06-27 03:05:25 INFO     | Beam Search Best Rules
2025-06-27 03:05:25 INFO     -------------------------
2025-06-27 03:05:25 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 03:05:26 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 03:05:30 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 03:06:33 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 03:07:25 INFO     >>>>> Generator: Rule generation with beam search
2025-06-27 03:08:01 INFO     -------------------------
2025-06-27 03:08:01 INFO     | Train Final Predictor+
2025-06-27 03:08:01 INFO     -------------------------
2025-06-27 03:08:01 INFO     Predictor+: read 18420 rules from list.
2025-06-27 03:08:01 INFO     Preprocess training set
2025-06-27 03:08:01 INFO     -------------------------
2025-06-27 03:08:01 INFO     | Iteration: 1/5
2025-06-27 03:08:01 INFO     -------------------------
2025-06-27 03:08:01 INFO     >>>>> Predictor: Training
2025-06-27 03:12:46 INFO     1000 5959 4.870933 69366.7
2025-06-27 03:17:21 INFO     2000 5959 4.746739 69375.3
2025-06-27 03:21:43 INFO     3000 5959 4.715959 69219.2
2025-06-27 03:26:12 INFO     4000 5959 4.709845 69305.9
2025-06-27 03:30:54 INFO     5000 5959 4.669222 69288.6
2025-06-27 03:35:28 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 03:36:39 INFO     Data : 2077
2025-06-27 03:36:39 INFO     Hit1 : 0.092441
2025-06-27 03:36:39 INFO     Hit3 : 0.180067
2025-06-27 03:36:39 INFO     Hit10: 0.309100
2025-06-27 03:36:39 INFO     MR   : 981.150698
2025-06-27 03:36:39 INFO     MRR  : 0.161555
2025-06-27 03:36:39 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 03:38:00 INFO     Data : 2342
2025-06-27 03:38:00 INFO     Hit1 : 0.128523
2025-06-27 03:38:00 INFO     Hit3 : 0.206661
2025-06-27 03:38:00 INFO     Hit10: 0.316823
2025-06-27 03:38:00 INFO     MR   : 904.149445
2025-06-27 03:38:00 INFO     MRR  : 0.190758
2025-06-27 03:38:00 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/rotate_init_semmeddb_multitask_mmoe_3_20250626_212059/predictor.pt
2025-06-27 03:38:00 INFO     -------------------------
2025-06-27 03:38:00 INFO     | Iteration: 2/5
2025-06-27 03:38:00 INFO     -------------------------
2025-06-27 03:38:00 INFO     >>>>> Predictor: Training
2025-06-27 03:42:48 INFO     1000 5959 4.642511 69288.6
2025-06-27 03:47:30 INFO     2000 5959 4.646520 69288.6
2025-06-27 03:52:11 INFO     3000 5959 4.627623 69340.6
2025-06-27 03:56:53 INFO     4000 5959 4.636314 69271.3
2025-06-27 04:01:40 INFO     5000 5959 4.657452 69219.2
2025-06-27 04:06:09 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 04:07:20 INFO     Data : 2077
2025-06-27 04:07:20 INFO     Hit1 : 0.086182
2025-06-27 04:07:20 INFO     Hit3 : 0.176697
2025-06-27 04:07:20 INFO     Hit10: 0.295137
2025-06-27 04:07:20 INFO     MR   : 947.242658
2025-06-27 04:07:20 INFO     MRR  : 0.156154
2025-06-27 04:07:20 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 04:08:41 INFO     Data : 2342
2025-06-27 04:08:41 INFO     Hit1 : 0.106746
2025-06-27 04:08:41 INFO     Hit3 : 0.191289
2025-06-27 04:08:41 INFO     Hit10: 0.318531
2025-06-27 04:08:41 INFO     MR   : 874.542485
2025-06-27 04:08:41 INFO     MRR  : 0.172491
2025-06-27 04:08:41 INFO     -------------------------
2025-06-27 04:08:41 INFO     | Iteration: 3/5
2025-06-27 04:08:41 INFO     -------------------------
2025-06-27 04:08:41 INFO     >>>>> Predictor: Training
2025-06-27 04:13:30 INFO     1000 5959 4.609611 69340.6
2025-06-27 04:18:09 INFO     2000 5959 4.578126 69184.5
2025-06-27 04:22:58 INFO     3000 5959 4.640063 69253.9
2025-06-27 04:27:42 INFO     4000 5959 4.615839 69340.6
2025-06-27 04:32:20 INFO     5000 5959 4.612138 69384.0
2025-06-27 04:36:49 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 04:37:58 INFO     Data : 2077
2025-06-27 04:37:58 INFO     Hit1 : 0.099663
2025-06-27 04:37:58 INFO     Hit3 : 0.181993
2025-06-27 04:37:58 INFO     Hit10: 0.304285
2025-06-27 04:37:58 INFO     MR   : 935.121810
2025-06-27 04:37:58 INFO     MRR  : 0.166074
2025-06-27 04:37:58 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 04:39:14 INFO     Data : 2342
2025-06-27 04:39:14 INFO     Hit1 : 0.125961
2025-06-27 04:39:14 INFO     Hit3 : 0.207942
2025-06-27 04:39:14 INFO     Hit10: 0.318531
2025-06-27 04:39:14 INFO     MR   : 862.811699
2025-06-27 04:39:14 INFO     MRR  : 0.189006
2025-06-27 04:39:14 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/rotate_init_semmeddb_multitask_mmoe_3_20250626_212059/predictor.pt
2025-06-27 04:39:14 INFO     -------------------------
2025-06-27 04:39:14 INFO     | Iteration: 4/5
2025-06-27 04:39:14 INFO     -------------------------
2025-06-27 04:39:14 INFO     >>>>> Predictor: Training
2025-06-27 04:43:40 INFO     1000 5959 4.615388 69323.3
2025-06-27 04:48:09 INFO     2000 5959 4.592977 69332.0
2025-06-27 04:52:45 INFO     3000 5959 4.626463 69219.2
2025-06-27 04:57:24 INFO     4000 5959 4.619615 69297.3
2025-06-27 05:01:56 INFO     5000 5959 4.586003 69332.0
2025-06-27 05:06:14 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 05:07:22 INFO     Data : 2077
2025-06-27 05:07:22 INFO     Hit1 : 0.094848
2025-06-27 05:07:22 INFO     Hit3 : 0.181512
2025-06-27 05:07:22 INFO     Hit10: 0.315359
2025-06-27 05:07:22 INFO     MR   : 921.898893
2025-06-27 05:07:22 INFO     MRR  : 0.165355
2025-06-27 05:07:22 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 05:08:38 INFO     Data : 2342
2025-06-27 05:08:38 INFO     Hit1 : 0.128096
2025-06-27 05:08:38 INFO     Hit3 : 0.208796
2025-06-27 05:08:38 INFO     Hit10: 0.321093
2025-06-27 05:08:38 INFO     MR   : 854.286721
2025-06-27 05:08:38 INFO     MRR  : 0.191193
2025-06-27 05:08:38 INFO     -------------------------
2025-06-27 05:08:38 INFO     | Iteration: 5/5
2025-06-27 05:08:38 INFO     -------------------------
2025-06-27 05:08:38 INFO     >>>>> Predictor: Training
2025-06-27 05:13:09 INFO     1000 5959 4.560208 69245.2
2025-06-27 05:17:45 INFO     2000 5959 4.551546 69262.6
2025-06-27 05:22:29 INFO     3000 5959 4.607439 69332.0
2025-06-27 05:27:11 INFO     4000 5959 4.611009 69366.7
2025-06-27 05:31:48 INFO     5000 5959 4.622235 69262.6
2025-06-27 05:36:14 INFO     >>>>> Predictor: Evaluating on valid
2025-06-27 05:37:24 INFO     Data : 2077
2025-06-27 05:37:24 INFO     Hit1 : 0.098219
2025-06-27 05:37:24 INFO     Hit3 : 0.189215
2025-06-27 05:37:24 INFO     Hit10: 0.314877
2025-06-27 05:37:24 INFO     MR   : 921.792489
2025-06-27 05:37:24 INFO     MRR  : 0.168733
2025-06-27 05:37:24 INFO     >>>>> Predictor: Evaluating on test
2025-06-27 05:38:43 INFO     Data : 2342
2025-06-27 05:38:43 INFO     Hit1 : 0.131512
2025-06-27 05:38:43 INFO     Hit3 : 0.206234
2025-06-27 05:38:43 INFO     Hit10: 0.318104
2025-06-27 05:38:43 INFO     MR   : 852.904355
2025-06-27 05:38:43 INFO     MRR  : 0.192832
2025-06-27 05:38:43 INFO     Save checkpoint to results/semmeddb/multitask_mmoe/rotate_init_semmeddb_multitask_mmoe_3_20250626_212059/predictor.pt
2025-06-27 05:38:43 INFO     -------------------------
2025-06-27 05:38:43 INFO     | Final Test MRR: 0.192832
2025-06-27 05:38:43 INFO     -------------------------
