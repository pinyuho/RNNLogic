2025-04-23 18:32:08 INFO     Predictor: read 178 rules from list.
2025-04-23 18:35:41 INFO     Predictor+: read 20306 rules from list.
-------------------------
2025-04-23 18:30:20 INFO     >>>>> Generator: Training
2025-04-23 18:30:32 INFO     [E1000] Total: 1.245665 | Main: 1.504819 | Aux: 0.737527 | Topk_Loss: 2.037326
2025-04-23 18:30:43 INFO     [E2000] Total: 1.155326 | Main: 1.386035 | Aux: 0.686946 | Topk_Loss: 1.943050
2025-04-23 18:30:53 INFO     [E3000] Total: 1.142550 | Main: 1.368946 | Aux: 0.680730 | Topk_Loss: 1.908575
2025-04-23 18:31:03 INFO     [E4000] Total: 1.125109 | Main: 1.345360 | Aux: 0.675141 | Topk_Loss: 1.896242
2025-04-23 18:31:14 INFO     [E5000] Total: 1.127141 | Main: 1.348359 | Aux: 0.671184 | Topk_Loss: 1.874842
2025-04-23 18:31:24 INFO     [E6000] Total: 1.124181 | Main: 1.344495 | Aux: 0.670620 | Topk_Loss: 1.865987
2025-04-23 18:31:34 INFO     [E7000] Total: 1.123446 | Main: 1.343755 | Aux: 0.670456 | Topk_Loss: 1.867034
2025-04-23 18:31:45 INFO     [E8000] Total: 1.122482 | Main: 1.341049 | Aux: 0.670313 | Topk_Loss: 1.855575
2025-04-23 18:31:56 INFO     [E9000] Total: 1.113814 | Main: 1.330560 | Aux: 0.668702 | Topk_Loss: 1.855226
2025-04-23 18:32:07 INFO     [E10000] Total: 1.109279 | Main: 1.324696 | Aux: 0.665698 | Topk_Loss: 1.848537
2025-04-23 18:32:07 INFO     -------------------------
2025-04-23 18:32:07 INFO     | EM Iteration: 1/1
2025-04-23 18:32:07 INFO     -------------------------
2025-04-23 18:32:07 INFO     >>>>> Generator: Rule generation with sampling
2025-04-23 18:32:07 INFO     Predictor: read 178 rules from list.
2025-04-23 18:32:07 INFO     Initializing distributed process group
2025-04-23 18:32:08 INFO     Preprocess training set
2025-04-23 18:32:08 INFO     >>>>> Predictor: Training
2025-04-23 18:32:10 INFO     100 10860 10.413995 327544.0
2025-04-23 18:32:12 INFO     200 10860 10.095690 327544.0
2025-04-23 18:32:14 INFO     300 10860 9.777509 327544.0
2025-04-23 18:32:15 INFO     400 10860 9.614334 327544.0
2025-04-23 18:32:17 INFO     500 10860 9.544651 327544.0
2025-04-23 18:32:19 INFO     600 10860 9.171738 327544.0
2025-04-23 18:32:20 INFO     700 10860 8.833021 327544.0
2025-04-23 18:32:22 INFO     800 10860 9.032418 327544.0
2025-04-23 18:32:23 INFO     900 10860 8.738114 327544.0
2025-04-23 18:32:25 INFO     1000 10860 8.550962 327544.0
2025-04-23 18:32:25 INFO     >>>>> Predictor: Evaluating on valid
2025-04-23 18:32:31 INFO     Data : 6068
2025-04-23 18:32:31 INFO     Hit1 : 0.355636
2025-04-23 18:32:31 INFO     Hit3 : 0.381812
2025-04-23 18:32:31 INFO     Hit10: 0.400506
2025-04-23 18:32:31 INFO     MR   : 11016.264997
2025-04-23 18:32:31 INFO     MRR  : 0.372848
2025-04-23 18:32:31 INFO     >>>>> Predictor: Evaluating on test
2025-04-23 18:32:37 INFO     Data : 6268
2025-04-23 18:32:37 INFO     Hit1 : 0.362237
2025-04-23 18:32:37 INFO     Hit3 : 0.380903
2025-04-23 18:32:37 INFO     Hit10: 0.401776
2025-04-23 18:32:37 INFO     MR   : 11384.490747
2025-04-23 18:32:37 INFO     MRR  : 0.375863
2025-04-23 18:32:37 INFO     >>>>> Predictor: Computing H scores of rules
2025-04-23 18:32:49 INFO     1000 10860
2025-04-23 18:33:00 INFO     2000 10860
2025-04-23 18:33:11 INFO     3000 10860
2025-04-23 18:33:22 INFO     4000 10860
2025-04-23 18:33:34 INFO     5000 10860
2025-04-23 18:33:45 INFO     6000 10860
2025-04-23 18:33:56 INFO     7000 10860
2025-04-23 18:34:07 INFO     8000 10860
2025-04-23 18:34:18 INFO     9000 10860
2025-04-23 18:34:29 INFO     10000 10860
2025-04-23 18:34:44 INFO     >>>>> Generator: Training
2025-04-23 18:34:45 INFO     -------------------------
2025-04-23 18:34:45 INFO     | Post-train Generator
2025-04-23 18:34:45 INFO     -------------------------
2025-04-23 18:34:45 INFO     >>>>> Generator: Training
2025-04-23 18:34:53 INFO     [E1000] Total: 0.416927 | Main: 0.208490 | Aux: 0.350047 | Topk_Loss: 1.116748
2025-04-23 18:34:53 INFO     -------------------------
2025-04-23 18:34:53 INFO     | Beam Search Best Rules
2025-04-23 18:34:53 INFO     -------------------------
2025-04-23 18:34:53 INFO     >>>>> Generator: Rule generation with beam search
2025-04-23 18:34:54 INFO     >>>>> Generator: Rule generation with beam search
2025-04-23 18:34:56 INFO     >>>>> Generator: Rule generation with beam search
2025-04-23 18:35:19 INFO     >>>>> Generator: Rule generation with beam search
2025-04-23 18:35:32 INFO     >>>>> Generator: Rule generation with beam search
2025-04-23 18:35:42 INFO     -------------------------
2025-04-23 18:35:42 INFO     | Train Final Predictor+
2025-04-23 18:35:42 INFO     -------------------------
2025-04-23 18:35:42 INFO     Predictor+: read 20306 rules from list.
2025-04-23 18:35:42 INFO     Preprocess training set
2025-04-23 18:35:42 INFO     -------------------------
2025-04-23 18:35:42 INFO     | Iteration: 1/1
2025-04-23 18:35:42 INFO     -------------------------
2025-04-23 18:35:42 INFO     >>>>> Predictor: Training
2025-04-23 18:37:09 INFO     100 10860 5.900321 327544.0
2025-04-23 18:38:38 INFO     200 10860 4.350757 327544.0
2025-04-23 18:40:03 INFO     300 10860 4.110048 325906.3
2025-04-23 18:41:36 INFO     400 10860 4.697243 327544.0
2025-04-23 18:43:02 INFO     500 10860 4.257044 327544.0
2025-04-23 18:44:35 INFO     600 10860 4.446016 327544.0
2025-04-23 18:46:07 INFO     700 10860 4.800327 327544.0
2025-04-23 18:47:38 INFO     800 10860 4.538572 327544.0
2025-04-23 18:49:02 INFO     900 10860 4.195230 327544.0
2025-04-23 18:50:26 INFO     1000 10860 4.756211 327544.0
2025-04-23 18:50:26 INFO     >>>>> Predictor: Evaluating on valid
2025-04-23 18:55:14 INFO     Data : 6068
2025-04-23 18:55:14 INFO     Hit1 : 0.426664
2025-04-23 18:55:14 INFO     Hit3 : 0.481429
2025-04-23 18:55:14 INFO     Hit10: 0.535061
2025-04-23 18:55:14 INFO     MR   : 6995.307020
2025-04-23 18:55:14 INFO     MRR  : 0.464190
2025-04-23 18:55:14 INFO     >>>>> Predictor: Evaluating on test
2025-04-23 19:00:11 INFO     Data : 6268
2025-04-23 19:00:11 INFO     Hit1 : 0.435227
2025-04-23 19:00:11 INFO     Hit3 : 0.482025
2025-04-23 19:00:11 INFO     Hit10: 0.542371
2025-04-23 19:00:11 INFO     MR   : 7177.539885
2025-04-23 19:00:11 INFO     MRR  : 0.469989
2025-04-23 19:00:11 INFO     Save checkpoint to wn18rr/multitask/lexname/adaptive_topk_small/predictor.pt
2025-04-23 19:00:11 INFO     -------------------------
2025-04-23 19:00:11 INFO     | Final Test MRR: 0.469989
2025-04-23 19:00:11 INFO     -------------------------
